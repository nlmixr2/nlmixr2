<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Control for bobyqa estimation method in nlmixr2 — bobyqaControl • nlmixr2</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Control for bobyqa estimation method in nlmixr2 — bobyqaControl"><meta name="description" content="Control for bobyqa estimation method in nlmixr2"><meta property="og:description" content="Control for bobyqa estimation method in nlmixr2"><meta property="og:image" content="https://nlmixr2.github.io/nlmixr2/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nlmixr2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/running_nlmixr.html">Introduction to Running Nlmixr</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-endpoints.html">Using Multiple Endpoints in Nlmixr</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Going further</h6></li>
    <li><a class="dropdown-item" href="../articles/modelPiping.html">Model Piping</a></li>
    <li><a class="dropdown-item" href="../articles/broom.html">Sweeping models to tidy datasets (broom)</a></li>
    <li><a class="dropdown-item" href="../articles/censoring.html">Censoring in nlmixr2 (M3 and others)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/xgxr-nlmixr-ggpmx.html">Integrated development with xgxr/nlmixr/ggPMX</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/citations.html">Citations of nlmixr2</a></li>
    <li><a class="dropdown-item" href="../articles/nlmixr2-team-and-advisory-committee.html">Who we are</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-example-models" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-chalkboard-teacher"></span> Example models</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-example-models"><li><a class="dropdown-item" href="../articles/addingCovariances.html">Phenobarbatol with correlations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/nimo.html">Nonlinear PK/PD -- Nimotuzumab</a></li>
    <li><a class="dropdown-item" href="../articles/mavoglurant.html">PBPK -- Mavoglurant</a></li>
    <li><a class="dropdown-item" href="../articles/wbc.html">PKPD -- Myelosuppression model</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2/raw/main/CheatSheet_nlmixr_220621.pdf"><span class="fa fa-scroll fa-lg"></span> Cheat Sheet</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://doi.org/10.1002/psp4.12445"><span class="fa fas fa-life-ring"></span> Tutorial</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o fa-lg"></span> Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2/releases"><span class="fa fa-download"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Control for bobyqa estimation method in nlmixr2</h1>
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nlmixr2/blob/v3.0.2/R/hardReexports.R" class="external-link"><code>R/hardReexports.R</code></a></small>
      <div class="d-none name"><code>bobyqaControl.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Control for bobyqa estimation method in nlmixr2</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bobyqaControl</span><span class="op">(</span></span>
<span>  npt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rhobeg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rhoend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iprint <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  maxfun <span class="op">=</span> <span class="fl">100000L</span>,</span>
<span>  returnBobyqa <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stickyRecalcN <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  maxOdeRecalc <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  odeRecalcFactor <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  useColor <span class="op">=</span> <span class="fu">crayon</span><span class="fu">::</span><span class="fu"><a href="http://r-lib.github.io/crayon/reference/has_color.html" class="external-link">has_color</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  printNcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"width"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">23</span><span class="op">)</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>  print <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  normType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rescale2"</span>, <span class="st">"mean"</span>, <span class="st">"rescale"</span>, <span class="st">"std"</span>, <span class="st">"len"</span>, <span class="st">"constant"</span><span class="op">)</span>,</span>
<span>  scaleType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nlmixr2"</span>, <span class="st">"norm"</span>, <span class="st">"mult"</span>, <span class="st">"multAdd"</span><span class="op">)</span>,</span>
<span>  scaleCmax <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  scaleCmin <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  scaleC <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scaleTo <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rxControl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  optExpression <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sumProd <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  literalFix <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  addProp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"combined2"</span>, <span class="st">"combined1"</span><span class="op">)</span>,</span>
<span>  calcTables <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  compress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  covMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>  adjObf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ci <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  sigdig <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sigdigTable <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-npt">npt<a class="anchor" aria-label="anchor" href="#arg-npt"></a></dt>
<dd><p>The number of points used to approximate the objective
function via a quadratic approximation. The value of npt must be
in the interval [n+2,(n+1)(n+2)/2] where n is the number of
parameters in `par`. Choices that exceed 2*n+1 are not
recommended.  If not defined, it will be set to min(n * 2, n+2).</p></dd>


<dt id="arg-rhobeg">rhobeg<a class="anchor" aria-label="anchor" href="#arg-rhobeg"></a></dt>
<dd><p>`rhobeg` and `rhoend` must be set to the initial and
final values of a trust region radius, so both must be positive
with `0 &lt; rhoend &lt; rhobeg`. Typically `rhobeg` should be about
one tenth of the greatest expected change to a variable.  If the
user does not provide a value, this will be set to `min(0.95, 0.2
* max(abs(par)))`.  Note also that smallest difference
`abs(upper-lower)` should be greater than or equal to `rhobeg*2`.
If this is not the case then `rhobeg` will be adjusted.</p></dd>


<dt id="arg-rhoend">rhoend<a class="anchor" aria-label="anchor" href="#arg-rhoend"></a></dt>
<dd><p>The smallest value of the trust region radius that is
allowed. If not defined, then 1e-6 times the value set for
`rhobeg` will be used.</p></dd>


<dt id="arg-iprint">iprint<a class="anchor" aria-label="anchor" href="#arg-iprint"></a></dt>
<dd><p>The value of `iprint` should be set to an integer
value in `0, 1, 2, 3, ...`, which controls the amount of
printing.  Specifically, there is no output if `iprint=0` and
there is output only at the start and the return if `iprint=1`.
Otherwise, each new value of `rho` is printed, with the best
vector of variables so far and the corresponding value of the
objective function. Further, each new value of the objective
function with its variables are output if `iprint=3`.  If `iprint
&gt; 3`, the objective function value and corresponding variables
are output every `iprint` evaluations.  Default value is `0`.</p></dd>


<dt id="arg-maxfun">maxfun<a class="anchor" aria-label="anchor" href="#arg-maxfun"></a></dt>
<dd><p>The maximum allowed number of function
evaluations. If this is exceeded, the method will terminate.</p></dd>


<dt id="arg-returnbobyqa">returnBobyqa<a class="anchor" aria-label="anchor" href="#arg-returnbobyqa"></a></dt>
<dd><p>return the bobyqa output instead of the nlmixr2
fit</p></dd>


<dt id="arg-stickyrecalcn">stickyRecalcN<a class="anchor" aria-label="anchor" href="#arg-stickyrecalcn"></a></dt>
<dd><p>The number of bad ODE solves before reducing
the atol/rtol for the rest of the problem.</p></dd>


<dt id="arg-maxoderecalc">maxOdeRecalc<a class="anchor" aria-label="anchor" href="#arg-maxoderecalc"></a></dt>
<dd><p>Maximum number of times to reduce the ODE
tolerances and try to resolve the system if there was a bad
ODE solve.</p></dd>


<dt id="arg-oderecalcfactor">odeRecalcFactor<a class="anchor" aria-label="anchor" href="#arg-oderecalcfactor"></a></dt>
<dd><p>The ODE recalculation factor when ODE
solving goes bad, this is the factor the rtol/atol is reduced</p></dd>


<dt id="arg-usecolor">useColor<a class="anchor" aria-label="anchor" href="#arg-usecolor"></a></dt>
<dd><p>Boolean indicating if focei can use ASCII color codes</p></dd>


<dt id="arg-printncol">printNcol<a class="anchor" aria-label="anchor" href="#arg-printncol"></a></dt>
<dd><p>Number of columns to printout before wrapping
parameter estimates/gradient</p></dd>


<dt id="arg-print">print<a class="anchor" aria-label="anchor" href="#arg-print"></a></dt>
<dd><p>Integer representing when the outer step is
printed. When this is 0 or do not print the iterations.  1 is
print every function evaluation (default), 5 is print every 5
evaluations.</p></dd>


<dt id="arg-normtype">normType<a class="anchor" aria-label="anchor" href="#arg-normtype"></a></dt>
<dd><p>This is the type of parameter
    normalization/scaling used to get the scaled initial values
    for nlmixr2.  These are used with <code>scaleType</code> of.</p>
<p>With the exception of <code>rescale2</code>, these come
    from
    <a href="https://en.wikipedia.org/wiki/Feature_scaling" class="external-link">Feature
    Scaling</a>. The <code>rescale2</code> The rescaling is the same type
    described in the
    <a href="http://apmonitor.com/me575/uploads/Main/optimization_book.pdf" class="external-link">OptdesX</a>
    software manual.</p>
<p>In general, all all scaling formula can be described by:</p>
<p>$$v_{scaled}$$ = ($$v_{unscaled}-C_{1}$$)/$$C_{2}$$</p>

<p>Where</p>

<p>The other data normalization approaches follow the following formula</p>
<p>$$v_{scaled}$$ = ($$v_{unscaled}-C_{1}$$)/$$C_{2}$$</p>
<ul><li><p><code>rescale2</code> This scales all parameters from (-1 to 1).
    The relative differences between the parameters are preserved
    with this approach and the constants are:</p>
<p>$$C_{1}$$ = (max(all unscaled values)+min(all unscaled values))/2</p>
<p>$$C_{2}$$ = (max(all unscaled values) - min(all unscaled values))/2</p></li>
<li><p><code>rescale</code> or min-max normalization. This rescales all
    parameters from (0 to 1).  As in the <code>rescale2</code> the
    relative differences are preserved.  In this approach:</p>
<p>$$C_{1}$$ = min(all unscaled values)</p>
<p>$$C_{2}$$ = max(all unscaled values) - min(all unscaled values)</p></li>
<li><p><code>mean</code> or mean normalization.  This rescales to center
    the parameters around the mean but the parameters are from 0
    to 1.  In this approach:</p>
<p>$$C_{1}$$ = mean(all unscaled values)</p>
<p>$$C_{2}$$ = max(all unscaled values) - min(all unscaled values)</p></li>
<li><p><code>std</code> or standardization.  This standardizes by the mean
     and standard deviation.  In this approach:</p>
<p>$$C_{1}$$ = mean(all unscaled values)</p>
<p>$$C_{2}$$ = sd(all unscaled values)</p></li>
<li><p><code>len</code> or unit length scaling.  This scales the
   parameters to the unit length.  For this approach we use the Euclidean length, that
   is:</p>
<p>$$C_{1}$$ = 0</p>
<p>$$C_{2}$$ = $$\sqrt(v_1^2 + v_2^2 + \cdots + v_n^2)$$</p></li>
<li><p><code>constant</code> which does not perform data normalization. That is</p>
<p>$$C_{1}$$ = 0</p>
<p>$$C_{2}$$ = 1</p></li>
</ul></dd>


<dt id="arg-scaletype">scaleType<a class="anchor" aria-label="anchor" href="#arg-scaletype"></a></dt>
<dd><p>The scaling scheme for nlmixr2.  The supported types are:</p>
<ul><li><p><code>nlmixr2</code>  In this approach the scaling is performed by the following equation:</p>
<p>$$v_{scaled}$$ = ($$v_{current} - v_{init}$$)*scaleC[i] + scaleTo</p>
<p>The <code>scaleTo</code> parameter is specified by the <code>normType</code>,
and the scales are specified by <code>scaleC</code>.</p></li>
<li><p><code>norm</code> This approach uses the simple scaling provided
    by the <code>normType</code> argument.</p></li>
<li><p><code>mult</code> This approach does not use the data
normalization provided by <code>normType</code>, but rather uses
multiplicative scaling to a constant provided by the <code>scaleTo</code>
argument.</p>
<p>In this case:</p>
<p>$$v_{scaled}$$ = $$v_{current}$$/$$v_{init}$$*scaleTo</p></li>
<li><p><code>multAdd</code> This approach changes the scaling based on
the parameter being specified.  If a parameter is defined in an
exponential block (ie exp(theta)), then it is scaled on a
linearly, that is:</p>
<p>$$v_{scaled}$$ = ($$v_{current}-v_{init}$$) + scaleTo</p>
<p>Otherwise the parameter is scaled multiplicatively.</p>
<p>$$v_{scaled}$$ = $$v_{current}$$/$$v_{init}$$*scaleTo</p></li>
</ul></dd>


<dt id="arg-scalecmax">scaleCmax<a class="anchor" aria-label="anchor" href="#arg-scalecmax"></a></dt>
<dd><p>Maximum value of the scaleC to prevent overflow.</p></dd>


<dt id="arg-scalecmin">scaleCmin<a class="anchor" aria-label="anchor" href="#arg-scalecmin"></a></dt>
<dd><p>Minimum value of the scaleC to prevent underflow.</p></dd>


<dt id="arg-scalec">scaleC<a class="anchor" aria-label="anchor" href="#arg-scalec"></a></dt>
<dd><p>The scaling constant used with
    <code>scaleType=nlmixr2</code>.  When not specified, it is based on
    the type of parameter that is estimated.  The idea is to keep
    the derivatives similar on a log scale to have similar
    gradient sizes.  Hence parameters like log(exp(theta)) would
    have a scaling factor of 1 and log(theta) would have a scaling
    factor of ini_value (to scale by 1/value; ie
    d/dt(log(ini_value)) = 1/ini_value or scaleC=ini_value)</p>
<p></p><ul><li><p>For parameters in an exponential (ie exp(theta)) or
   parameters specifying powers, boxCox or yeoJohnson
   transformations , this is 1.</p></li>
<li><p>For additive, proportional, lognormal error structures,
   these are given by 0.5*abs(initial_estimate)</p></li>
<li><p>Factorials are scaled by abs(1/digamma(initial_estimate+1))</p></li>
<li><p>parameters in a log scale (ie log(theta)) are transformed
   by log(abs(initial_estimate))*abs(initial_estimate)</p></li>
</ul><p>These parameter scaling coefficients are chose to try to keep
   similar slopes among parameters.  That is they all follow the
   slopes approximately on a log-scale.</p>
<p>While these are chosen in a logical manner, they may not always
   apply.  You can specify each parameters scaling factor by this
   parameter if you wish.</p></dd>


<dt id="arg-scaleto">scaleTo<a class="anchor" aria-label="anchor" href="#arg-scaleto"></a></dt>
<dd><p>Scale the initial parameter estimate to this value.
By default this is 1.  When zero or below, no scaling is performed.</p></dd>


<dt id="arg-rxcontrol">rxControl<a class="anchor" aria-label="anchor" href="#arg-rxcontrol"></a></dt>
<dd><p>`rxode2` ODE solving options during fitting, created with `rxControl()`</p></dd>


<dt id="arg-optexpression">optExpression<a class="anchor" aria-label="anchor" href="#arg-optexpression"></a></dt>
<dd><p>Optimize the rxode2 expression to speed up
calculation. By default this is turned on.</p></dd>


<dt id="arg-sumprod">sumProd<a class="anchor" aria-label="anchor" href="#arg-sumprod"></a></dt>
<dd><p>Is a boolean indicating if the model should change
multiplication to high precision multiplication and sums to
high precision sums using the PreciseSums package.  By default
this is <code>FALSE</code>.</p></dd>


<dt id="arg-literalfix">literalFix<a class="anchor" aria-label="anchor" href="#arg-literalfix"></a></dt>
<dd><p>boolean, substitute fixed population values as
literals and re-adjust ui and parameter estimates after
optimization; Default is `TRUE`.</p></dd>


<dt id="arg-addprop">addProp<a class="anchor" aria-label="anchor" href="#arg-addprop"></a></dt>
<dd><p>specifies the type of additive plus proportional
  errors, the one where standard deviations add (combined1) or the
  type where the variances add (combined2).</p>
<p>The combined1 error type can be described by the following equation:</p>
<p>$$y = f + (a + b\times f^c) \times \varepsilon$$</p>
<p>The combined2 error model can be described by the following equation:</p>
<p>$$y = f + \sqrt{a^2 + b^2\times f^{2\times c}} \times \varepsilon$$</p>
<p>Where:</p>
<p>- y represents the observed value</p>
<p>- f represents the predicted value</p>
<p>- a  is the additive standard deviation</p>
<p>- b is the proportional/power standard deviation</p>
<p>- c is the power exponent (in the proportional case c=1)</p></dd>


<dt id="arg-calctables">calcTables<a class="anchor" aria-label="anchor" href="#arg-calctables"></a></dt>
<dd><p>This boolean is to determine if the foceiFit
will calculate tables. By default this is <code>TRUE</code></p></dd>


<dt id="arg-compress">compress<a class="anchor" aria-label="anchor" href="#arg-compress"></a></dt>
<dd><p>Should the object have compressed items</p></dd>


<dt id="arg-covmethod">covMethod<a class="anchor" aria-label="anchor" href="#arg-covmethod"></a></dt>
<dd><p>Method for calculating covariance.  In this
    discussion, R is the Hessian matrix of the objective
    function. The S matrix is the sum of individual
    gradient cross-product (evaluated at the individual empirical
    Bayes estimates).</p>
<ul><li><p>"<code>r,s</code>" Uses the sandwich matrix to calculate the
 covariance, that is: <code>solve(R) %*% S %*% solve(R)</code></p></li>
<li><p>"<code>r</code>" Uses the Hessian matrix to calculate the
 covariance as <code>2 %*% solve(R)</code></p></li>
<li><p>"<code>s</code>" Uses the cross-product matrix to calculate the
 covariance as <code>4 %*% solve(S)</code></p></li>
<li><p>"" Does not calculate the covariance step.</p></li>
</ul></dd>


<dt id="arg-adjobf">adjObf<a class="anchor" aria-label="anchor" href="#arg-adjobf"></a></dt>
<dd><p>is a boolean to indicate if the objective function
should be adjusted to be closer to NONMEM's default objective
function.  By default this is <code>TRUE</code></p></dd>


<dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>Confidence level for some tables.  By default this is
0.95 or 95% confidence.</p></dd>


<dt id="arg-sigdig">sigdig<a class="anchor" aria-label="anchor" href="#arg-sigdig"></a></dt>
<dd><p>Optimization significant digits. This controls:</p>
<ul><li><p>The tolerance of the inner and outer optimization is <code>10^-sigdig</code></p></li>
<li><p>The tolerance of the ODE solvers is
 <code>0.5*10^(-sigdig-2)</code>; For the sensitivity equations and
 steady-state solutions the default is <code>0.5*10^(-sigdig-1.5)</code>
 (sensitivity changes only applicable for liblsoda)</p></li>
<li><p>The tolerance of the boundary check is <code>5 * 10 ^ (-sigdig + 1)</code></p></li>
</ul></dd>


<dt id="arg-sigdigtable">sigdigTable<a class="anchor" aria-label="anchor" href="#arg-sigdigtable"></a></dt>
<dd><p>Significant digits in the final output table.
If not specified, then it matches the significant digits in the
`sigdig` optimization algorithm.  If `sigdig` is NULL, use 3.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="https://nlmixr2.github.io/nlmixr2est/reference/bobyqaControl.html">nlmixr2est::bobyqaControl()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>bobqya control structure</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Matthew L. Fidler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># A logit regression example with emax model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>i<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dsn</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dsn</span><span class="op">$</span><span class="va">DV</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="va">dsn</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="va">dsn</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">E0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span>   <span class="va">Em</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span>   <span class="va">E50</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>   <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/fix.html" class="external-link">fix</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">v</span> <span class="op">&lt;-</span> <span class="va">E0</span><span class="op">+</span><span class="va">Em</span><span class="op">*</span><span class="va">time</span><span class="op">^</span><span class="va">g</span><span class="op">/</span><span class="op">(</span><span class="va">E50</span><span class="op">^</span><span class="va">g</span><span class="op">+</span><span class="va">time</span><span class="op">^</span><span class="va">g</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu">ll</span><span class="op">(</span><span class="va">bin</span><span class="op">)</span> <span class="op">~</span> <span class="va">DV</span> <span class="op">*</span> <span class="va">v</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/nlmixr2est/reference/nlmixr2.html">nlmixr</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">dsn</span>, est<span class="op">=</span><span class="st">"bobyqa"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → pruning branches (`if`/`else`) of population log-likelihood model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → loading llik model into <span style="color: #0000BB;">symengine</span> environment...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → finding duplicate expressions in population log-likelihood model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → optimizing duplicate expressions in population log-likelihood model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → calculating covariance</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → loading into <span style="color: #0000BB;">symengine</span> environment...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → pruning branches (`if`/`else`) of full model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → finding duplicate expressions in EBE model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → optimizing duplicate expressions in EBE model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → compiling EBE model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → Calculating residuals/tables</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → compress origData in nlmixr2 object, save 9096</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → compress parHistData in nlmixr2 object, save 15552</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r²</span><span style="font-weight: bold;"> log-likelihood </span><span style="color: #BBBB00; font-weight: bold;">bobyqa</span><span style="font-weight: bold;"> ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lPop -681.2477 1162.629 1177.353      -578.3147        197.8405        48.07442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            setup table compress    other</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elapsed 0.003156 0.037     0.01 2.555844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span>  <span style="font-weight: bold;">%RSE</span>   <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(SD)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">E0</span>  -0.7442 0.2571 34.54 -0.7442 (-1.248, -0.2404)                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Em</span>    4.627  1.575 34.04       4.627 (1.54, 7.714)                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">E50</span>   2.376 0.9338  39.3     2.376 (0.5458, 4.206)                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">g</span>         2  <span style="color: #00BB00; font-weight: bold;">FIXED</span> <span style="color: #00BB00; font-weight: bold;">FIXED</span>                         2                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Censoring (<span style="color: #0000BB; font-weight: bold;">$censInformation</span>): No censoring</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,000 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ID      TIME    DV  IPRED      v</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1     0.030<span style="text-decoration: underline;">4</span>     1 -<span style="color: #BB0000;">1.13</span>  -<span style="color: #BB0000;">0.743</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1     0.032<span style="text-decoration: underline;">0</span>     0 -<span style="color: #BB0000;">0.389</span> -<span style="color: #BB0000;">0.743</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1     0.032<span style="text-decoration: underline;">9</span>     0 -<span style="color: #BB0000;">0.389</span> -<span style="color: #BB0000;">0.743</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 997 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># you can also get the nlm output with</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit2</span><span class="op">$</span><span class="va">bobyqa</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parameter estimates: -0.744249036396639, 4.62703353089203, 2.37602005800094 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> objective: 578.314687574017 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of function evaluations: 238 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The nlm control has been modified slightly to include</span></span></span>
<span class="r-in"><span><span class="co"># extra components and name the parameters</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Fidler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

