<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Control Options for SAEM"><title>Control Options for SAEM — saemControl • nlmixr2</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Control Options for SAEM — saemControl"><meta property="og:description" content="Control Options for SAEM"><meta property="og:image" content="https://nlmixr2.github.io/nlmixr2/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nlmixr2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fas fa fas fa-book"></span>
     
    Articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <h6 class="dropdown-header" data-toc-skip>Getting started</h6>
    <a class="dropdown-item" href="../articles/running_nlmixr.html">Introduction to Running Nlmixr</a>
    <a class="dropdown-item" href="../articles/multiple-endpoints.html">Using Multiple Endpoints in Nlmixr</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Going further</h6>
    <a class="dropdown-item" href="../articles/modelPiping.html">Model Piping</a>
    <a class="dropdown-item" href="../articles/broom.html">Sweeping models to tidy datasets (broom)</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/xgxr-nlmixr-ggpmx.html">Integrated development with xgxr/nlmixr/ggPMX</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--example-models">
    <span class="fas fa fas fa-chalkboard-teacher"></span>
     
    Example models
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--example-models">
    <a class="dropdown-item" href="../articles/addingCovariances.html">Phenobarbatol with correlations</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/nimo.html">Nonlinear PK/PD -- Nimotuzumab</a>
    <a class="dropdown-item" href="../articles/mavoglurant.html">PBPK -- Mavoglurant</a>
    <a class="dropdown-item" href="../articles/wbc.html">PKPD -- Myelosuppression model</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2/raw/main/CheatSheet_nlmixr_220621.pdf">
    <span class="fa fa-scroll fa-lg"></span>
     
    Cheat Sheet
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://doi.org/10.1002/psp4.12445">
    <span class="fas fa fas fa-life-ring"></span>
     
    Tutorial
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o fa-lg"></span>
     
    Functions
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2/releases">
    <span class="fa fa-download"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Control Options for SAEM</h1>
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nlmixr2/blob/HEAD/R/hardReexports.R" class="external-link"><code>R/hardReexports.R</code></a></small>
      <div class="d-none name"><code>saemControl.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Control Options for SAEM</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">saemControl</span><span class="op">(</span></span>
<span>  seed <span class="op">=</span> <span class="fl">99</span>,</span>
<span>  nBurn <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  nEm <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  nmc <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  print <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  trace <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  covMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linFim"</span>, <span class="st">"fim"</span>, <span class="st">"r,s"</span>, <span class="st">"r"</span>, <span class="st">"s"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>  calcTables <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  logLik <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nnodesGq <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  nsdGq <span class="op">=</span> <span class="fl">1.6</span>,</span>
<span>  optExpression <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  adjObf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sumProd <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  addProp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"combined2"</span>, <span class="st">"combined1"</span><span class="op">)</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  itmax <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nelder-mead"</span>, <span class="st">"newuoa"</span><span class="op">)</span>,</span>
<span>  powRange <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  lambdaRange <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  odeRecalcFactor <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  maxOdeRecalc <span class="op">=</span> <span class="fl">5L</span>,</span>
<span>  perSa <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  perNoCor <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  perFixOmega <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  perFixResid <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  compress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rxControl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigdig <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigdigTable <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ci <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  muRefCov <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>seed</dt>
<dd><p>Random Seed for SAEM step.  (Needs to be set for
reproducibility.)  By default this is 99.</p></dd>


<dt>nBurn</dt>
<dd><p>Number of iterations in the first phase, ie the  MCMC/Stochastic Approximation
steps. This is equivalent to Monolix's <code>K_0</code> or <code>K_b</code>.</p></dd>


<dt>nEm</dt>
<dd><p>Number of iterations in the Expectation-Maximization
(EM) Step. This is equivalent to Monolix's <code>K_1</code>.</p></dd>


<dt>nmc</dt>
<dd><p>Number of Markov Chains. By default this is 3.  When
you increase the number of chains the numerical integration by
MC method will be more accurate at the cost of more
computation.  In Monolix this is equivalent to <code>L</code>.</p></dd>


<dt>nu</dt>
<dd><p>This is a vector of 3 integers. They represent the
    numbers of transitions of the three different kernels used in
    the Hasting-Metropolis algorithm.  The default value is <code>c(2,2,2)</code>,
    representing 40 for each transition initially (each value is
    multiplied by 20).</p>
<p>The first value represents the initial number of multi-variate
    Gibbs samples are taken from a normal distribution.</p>
<p>The second value represents the number of uni-variate, or multi-
    dimensional random walk Gibbs samples are taken.</p>
<p>The third value represents the number of bootstrap/reshuffling or
    uni-dimensional random samples are taken.</p></dd>


<dt>print</dt>
<dd><p>The number it iterations that are completed before
anything is printed to the console.  By default, this is 1.</p></dd>


<dt>trace</dt>
<dd><p>An integer indicating if you want to trace(1) the
SAEM algorithm process.  Useful for debugging, but not for
typical fitting.</p></dd>


<dt>covMethod</dt>
<dd><p>Method for calculating covariance.  In this
    discussion, R is the Hessian matrix of the objective
    function. The S matrix is the sum of each individual's
    gradient cross-product (evaluated at the individual empirical
    Bayes estimates).</p>
<p>"<code>linFim</code>" Use the Linearized Fisher Information Matrix to calculate the covariance.</p>
<p>"<code>fim</code>" Use the SAEM-calculated Fisher Information Matrix to calculate the covariance.</p>
<p>"<code>r,s</code>" Uses the sandwich matrix to calculate the covariance, that is: \(R^-1 \times S \times R^-1\)</p>
<p>"<code>r</code>" Uses the Hessian matrix to calculate the covariance as \(2\times R^-1\)</p>
<p>"<code>s</code>" Uses the crossproduct matrix to calculate the covariance as \(4\times S^-1\)</p>
<p>"" Does not calculate the covariance step.</p></dd>


<dt>calcTables</dt>
<dd><p>This boolean is to determine if the foceiFit
will calculate tables. By default this is <code>TRUE</code></p></dd>


<dt>logLik</dt>
<dd><p>boolean indicating that log-likelihood should be
calculate by Gaussian quadrature.</p></dd>


<dt>nnodesGq</dt>
<dd><p>number of nodes to use for the Gaussian
quadrature when computing the likelihood with this method
(defaults to 1, equivalent to the Laplaclian likelihood)</p></dd>


<dt>nsdGq</dt>
<dd><p>span (in SD) over which to integrate when computing
the likelihood by Gaussian quadrature. Defaults to 3 (eg 3
times the SD)</p></dd>


<dt>optExpression</dt>
<dd><p>Optimize the rxode2 expression to speed up
calculation. By default this is turned on.</p></dd>


<dt>adjObf</dt>
<dd><p>is a boolean to indicate if the objective function
should be adjusted to be closer to NONMEM's default objective
function.  By default this is <code>TRUE</code></p></dd>


<dt>sumProd</dt>
<dd><p>Is a boolean indicating if the model should change
multiplication to high precision multiplication and sums to
high precision sums using the PreciseSums package.  By default
this is <code>FALSE</code>.</p></dd>


<dt>addProp</dt>
<dd><p>specifies the type of additive plus proportional
  errors, the one where standard deviations add (combined1) or the
  type where the variances add (combined2).</p>
<p>The combined1 error type can be described by the following equation:</p>
<p>y = f + (a + b*f^c)*err</p>
<p>The combined2 error model can be described by the following equation:</p>
<p>y = f + sqrt(a^2 + b^2*(f^c)^2)*err</p>
<p>Where:</p>
<p>- y represents the observed value</p>
<p>- f represents the predicted value</p>
<p>- a  is the additive standard deviation</p>
<p>- b is the proportional/power standard deviation</p>
<p>- c is the power exponent (in the proportional case c=1)</p></dd>


<dt>tol</dt>
<dd><p>This is the tolerance for the regression models used
for complex residual errors (ie add+prop etc)</p></dd>


<dt>itmax</dt>
<dd><p>This is the maximum number of iterations for the
regression models used for complex residual errors.  The number
of iterations is itmax*number of parameters</p></dd>


<dt>type</dt>
<dd><p>indicates the type of optimization for the residuals; Can be one of c("nelder-mead", "newuoa")</p></dd>


<dt>powRange</dt>
<dd><p>This indicates the range that powers can take for residual errors;  By default this is 10 indicating the range is c(-10, 10)</p></dd>


<dt>lambdaRange</dt>
<dd><p>This indicates the range that Box-Cox and Yeo-Johnson parameters are constrained to be;  The default is 3 indicating the range c(-3,3)</p></dd>


<dt>odeRecalcFactor</dt>
<dd><p>The ODE recalculation factor when ODE
solving goes bad, this is the factor the rtol/atol is reduced</p></dd>


<dt>maxOdeRecalc</dt>
<dd><p>Maximum number of times to reduce the ODE
tolerances and try to resolve the system if there was a bad
ODE solve.</p></dd>


<dt>perSa</dt>
<dd><p>This is the percent of the time the `nBurn`
iterations in phase runs runs a simulated annealing.</p></dd>


<dt>perNoCor</dt>
<dd><p>This is the percentage of the MCMC phase of the SAEM
algorithm where the variance/covariance matrix has no
correlations. By default this is 0.75 or 75<!-- % of the -->
Monte-carlo iteration.</p></dd>


<dt>perFixOmega</dt>
<dd><p>This is the percentage of the `nBurn` phase
where the omega values are unfixed to allow better exploration
of the likelihood surface.  After this time, the omegas are
fixed during optimization.</p></dd>


<dt>perFixResid</dt>
<dd><p>This is the percentage of the `nBurn` phase
where the residual components are unfixed to allow better
exploration of the likelihood surface.</p></dd>


<dt>compress</dt>
<dd><p>Should the object have compressed items</p></dd>


<dt>rxControl</dt>
<dd><p>`rxode2` ODE solving options during fitting, created with `rxControl()`</p></dd>


<dt>sigdig</dt>
<dd><p>Specifies the "significant digits" that the ode
solving requests.  When specified this controls the relative and
absolute tolerances of the ODE solvers.  By default the tolerance
is <code>0.5*10^(-sigdig-2)</code> for regular ODEs. For the
sensitivity equations and steady-state solutions the default is
<code>0.5*10^(-sigdig-1.5)</code> (sensitivity changes only applicable
for liblsoda).  By default this is unspecified (<code>NULL</code>) and uses
the standard <code>atol</code>/<code>rtol</code>.</p></dd>


<dt>sigdigTable</dt>
<dd><p>Significant digits in the final output table.
If not specified, then it matches the significant digits in the
`sigdig` optimization algorithm.  If `sigdig` is NULL, use 3.</p></dd>


<dt>ci</dt>
<dd><p>Confidence level for some tables.  By default this is
0.95 or 95% confidence.</p></dd>


<dt>muRefCov</dt>
<dd><p>This controls if mu-referenced covariates in `saem`
are handled differently than non mu-referenced covariates.  When
`TRUE`, mu-referenced covariates have special handling.  When
`FALSE` mu-referenced covariates are treated the same as any
other input parameter.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to <code><a href="https://rdrr.io/pkg/nlmixr2est/man/saemControl.html" class="external-link">nlmixr2est::saemControl()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>List of options to be used in <code><a href="https://rdrr.io/pkg/nlmixr2est/man/nlmixr2.html" class="external-link">nlmixr2</a></code> fit for
    SAEM.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Wenping Wang &amp; Matthew L. Fidler</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Matthew Fidler.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

