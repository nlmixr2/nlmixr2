[{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://nlmixr2.github.io/nlmixr2/articles/addingCovariances.html","id":"adding-covariances-between-random-effects","dir":"Articles","previous_headings":"","what":"Adding Covariances between random effects","title":"Random Effect Covariances","text":"can simply add co-variances two random effects adding effects together model specification block, eta.cl+eta.v ~. statement, specify lower triangular matrix fit c(). example phenobarbitol data:","code":"## Load phenobarbitol data library(nlmixr2)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/addingCovariances.html","id":"model-specification","dir":"Articles","previous_headings":"Adding Covariances between random effects","what":"Model Specification","title":"Random Effect Covariances","text":"","code":"pheno <- function() {   ini({     tcl <- log(0.008) # typical value of clearance     tv <-  log(0.6)   # typical value of volume     ## var(eta.cl)     eta.cl + eta.v ~ c(1,                         0.01, 1) ## cov(eta.cl, eta.v), var(eta.v)                       # interindividual variability on clearance and volume     add.err <- 0.1    # residual variability   })   model({     cl <- exp(tcl + eta.cl) # individual value of clearance     v <- exp(tv + eta.v)    # individual value of volume     ke <- cl / v            # elimination rate constant     d/dt(A1) = - ke * A1    # model differential equation     cp = A1 / v             # concentration in plasma     cp ~ add(add.err)       # define error model   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/addingCovariances.html","id":"fit-with-saem","dir":"Articles","previous_headings":"Adding Covariances between random effects","what":"Fit with SAEM","title":"Random Effect Covariances","text":"","code":"fit <- nlmixr(pheno, pheno_sd, \"saem\",               control=list(print=0),                table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  print(fit) #> ── nlmixr² SAEM OBJF by FOCEi approximation ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 689.3203 986.1912 1004.452      -487.0956        6.033342        5.252589 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance   saem table compress #> elapsed 0.003649  1.9e-05   0.066028 12.319 4.223    0.018 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>          Est.     SE %RSE    Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tcl     -5.02  0.075  1.5 0.00663 (0.00573, 0.00769)     51.8      3.26%  #> tv       0.35 0.0548 15.7          1.42 (1.27, 1.58)     41.9      1.40%  #> add.err  2.76                                   2.76                      #>   #>   Covariance Type ($covMethod): linFim #>   Correlations in between subject variability (BSV) matrix: #>     cor:eta.v,eta.cl  #>           0.946   #>   #>  #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Censoring ($censInformation): No censoring #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 155 × 26 #>   ID     TIME    DV EPRED  ERES   NPDE     NPD   PDE    PD  PRED    RES    WRES #>   <fct> <dbl> <dbl> <dbl> <dbl>  <dbl>   <dbl> <dbl> <dbl> <dbl>  <dbl>   <dbl> #> 1 1        2   17.3  18.9 -1.58 -0.350 -0.0920 0.363 0.463  17.5 -0.162 -0.0214 #> 2 1      112.  31    29.7  1.25  0.245  0.245  0.597 0.597  28.0  2.98   0.244  #> 3 2        2    9.7  11.4 -1.71 -0.664 -0.202  0.253 0.42   10.5 -0.777 -0.154  #> # ℹ 152 more rows #> # ℹ 14 more variables: IPRED <dbl>, IRES <dbl>, IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.cl <dbl>, eta.v <dbl>, A1 <dbl>, cl <dbl>, #> #   v <dbl>, ke <dbl>, tad <dbl>, dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/addingCovariances.html","id":"basic-goodness-of-fit-plots","dir":"Articles","previous_headings":"Adding Covariances between random effects","what":"Basic Goodness of Fit Plots","title":"Random Effect Covariances","text":"individual plots great, better see actual curves; can augPred","code":"plot(fit) plot(augPred(fit))"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/addingCovariances.html","id":"two-types-of-vpcs","dir":"Articles","previous_headings":"Adding Covariances between random effects","what":"Two types of VPCs","title":"Random Effect Covariances","text":"","code":"library(ggplot2) p1 <- vpcPlot(fit, show=list(obs_dv=TRUE)); #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 p1 <- p1 + ylab(\"Concentrations\")  ## A prediction-corrected VPC p2 <- vpcPlot(fit, pred_corr = TRUE, show=list(obs_dv=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 p2 <- p2 + ylab(\"Prediction-Corrected Concentrations\")  library(patchwork) p1 / p2"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"the-broom-and-broom-mixed-packages","dir":"Articles","previous_headings":"","what":"The broom and broom.mixed packages","title":"Using broom with nlmixr2","text":"broom broom.mixed packages attempt put standard model outputs data frames. nlmixr supports tidy glance methods support augment time. Using model covariance term, Phenobarbital model, can explore different types output used tidy functions. explore , first run model:","code":"library(nlmixr2) library(broom.mixed)  pheno <- function() {   # Pheno with covariance   ini({     tcl <- log(0.008) # typical value of clearance     tv <-  log(0.6)   # typical value of volume     ## var(eta.cl)     eta.cl + eta.v ~ c(1,                        0.01, 1) ## cov(eta.cl, eta.v), var(eta.v)     # interindividual variability on clearance and volume     add.err <- 0.1    # residual variability   })   model({     cl <- exp(tcl + eta.cl) # individual value of clearance     v <- exp(tv + eta.v)    # individual value of volume     ke <- cl / v            # elimination rate constant     d/dt(A1) = - ke * A1    # model differential equation     cp = A1 / v             # concentration in plasma     cp ~ add(add.err)       # define error model   }) }  ## We will run it two ways to allow comparisons fit.s <- nlmixr(pheno, pheno_sd, \"saem\", control=list(logLik=TRUE, print=0),                 table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  fit.f <- nlmixr(pheno, pheno_sd, \"focei\",                 control=list(print=0),                 table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done #> [====|====|====|====|====|====|====|====|====|====] 0:00:00"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"glancing-at-the-goodness-of-fit-metrics","dir":"Articles","previous_headings":"","what":"Glancing at the goodness of fit metrics","title":"Using broom with nlmixr2","text":"Often fitting data, want glance fit see well fits. broom, glance give summary fit metrics goodness fit: Note nlmixr possible one fit metric (based different quadratures, FOCEi approximation etc). However, glance returns fit metrics current. wish can set objective function focei objective function (already calculated CWRES). Now glance gives gauss3_1.6 values. course can always change type objective function nlmixr uses: setting back SAEM default objective function FOCEi, glance(fit.s) values : convenience, can glance objects:","code":"glance(fit.s) #> # A tibble: 2 × 6 #>    OBJF   AIC   BIC logLik `Condition#(Cov)` `Condition#(Cor)` #>   <dbl> <dbl> <dbl>  <dbl>             <dbl>             <dbl> #> 1  689.  986. 1004.  -487.              6.03              5.25 #> 2  698.  995. 1013.  -492.              6.03              5.25 setOfv(fit.s,\"gauss3_1.6\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 glance(fit.s) #> # A tibble: 3 × 6 #>    OBJF   AIC   BIC logLik `Condition#(Cov)` `Condition#(Cor)` #>   <dbl> <dbl> <dbl>  <dbl>             <dbl>             <dbl> #> 1  689.  986. 1004.  -487.              6.03              5.25 #> 2  698.  995. 1013.  -492.              6.03              5.25 #> 3  698.  995. 1013.  -492.              6.03              5.25 setOfv(fit.s,\"FOCEi\") # Setting objective function to focei glance(fit.s) #> # A tibble: 3 × 6 #>    OBJF   AIC   BIC logLik `Condition#(Cov)` `Condition#(Cor)` #>   <dbl> <dbl> <dbl>  <dbl>             <dbl>             <dbl> #> 1  689.  986. 1004.  -487.              6.03              5.25 #> 2  698.  995. 1013.  -492.              6.03              5.25 #> 3  698.  995. 1013.  -492.              6.03              5.25 glance(fit.s, type=\"FOCEi\") #> # A tibble: 3 × 6 #>    OBJF   AIC   BIC logLik `Condition#(Cov)` `Condition#(Cor)` #>   <dbl> <dbl> <dbl>  <dbl>             <dbl>             <dbl> #> 1  689.  986. 1004.  -487.              6.03              5.25 #> 2  698.  995. 1013.  -492.              6.03              5.25 #> 3  698.  995. 1013.  -492.              6.03              5.25"},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"tidying-of-overall-fit-parameters","dir":"Articles","previous_headings":"Tidying the model parameters","what":"Tidying of overall fit parameters","title":"Using broom with nlmixr2","text":"can also tidy model estimates data frame broom processing. can useful integrating 3rd parting modeling packages. consistent parameter format, tasks multiple types models can automated applied. default function tidy, applied fit object provides overall parameter information tidy dataset: Note default parameters actually estimated nlmixr, back-transformed values table printout. course, mu-referenced models, may want exponentiate terms. broom package allows apply exponentiation parameters, : Note:, accordance rest broom package, parameters exponentiated, standard errors transformed approximate standard error formula: se(exp(x))≈exp(model estimatex)×sex\\textrm{se}(\\exp(x)) \\approx \\exp(\\textrm{model estimate}_x)\\times \\textrm{se}_x. can confusing confidence intervals (described later) using actual standard error back-transforming exponentiated scale. reason default nlmixr’s broom interface exponentiate=FALSE, : want, can also use parsed back-transformation used nlmixr tables (ie fit$parFixedDf). Please note uses approximate back-transformation standard errors log-scaled back-transformed values. done : Also note, time writing default separator variables ., doesn’t work well model giving cor__eta.v.eta.cl. can easily change : gives easier way parse value: cor__eta.v..eta.cl","code":"tidy(fit.s) #> # A tibble: 6 × 7 #>   effect   group         term              estimate std.error statistic  p.value #>   <chr>    <chr>         <chr>                <dbl>     <dbl>     <dbl>    <dbl> #> 1 fixed    NA            tcl                 -5.02     0.0750    -66.9   1   e+0 #> 2 fixed    NA            tv                   0.350    0.0548      6.37  1.09e-9 #> 3 ran_pars ID            sd__eta.cl           0.488   NA          NA    NA       #> 4 ran_pars ID            sd__eta.v            0.402   NA          NA    NA       #> 5 ran_pars ID            cor__eta.v.eta.cl    0.946   NA          NA    NA       #> 6 ran_pars Residual(add) add.err              2.76    NA          NA    NA ## Transformation applied on every parameter tidy(fit.s, exponentiate=TRUE) #> # A tibble: 6 × 7 #>   effect   group         term             estimate std.error statistic   p.value #>   <chr>    <chr>         <chr>               <dbl>     <dbl>     <dbl>     <dbl> #> 1 fixed    NA            tcl               0.00663  0.000498      13.3  1.75e-27 #> 2 fixed    NA            tv                1.42     0.0778        18.2  4.27e-40 #> 3 ran_pars ID            sd__eta.cl        0.488   NA             NA   NA        #> 4 ran_pars ID            sd__eta.v         0.402   NA             NA   NA        #> 5 ran_pars ID            cor__eta.v.eta.…  0.946   NA             NA   NA        #> 6 ran_pars Residual(add) add.err           2.76    NA             NA   NA tidy(fit.s, exponentiate=FALSE) ## No transformation applied #> # A tibble: 6 × 7 #>   effect   group         term              estimate std.error statistic  p.value #>   <chr>    <chr>         <chr>                <dbl>     <dbl>     <dbl>    <dbl> #> 1 fixed    NA            tcl                 -5.02     0.0750    -66.9   1   e+0 #> 2 fixed    NA            tv                   0.350    0.0548      6.37  1.09e-9 #> 3 ran_pars ID            sd__eta.cl           0.488   NA          NA    NA       #> 4 ran_pars ID            sd__eta.v            0.402   NA          NA    NA       #> 5 ran_pars ID            cor__eta.v.eta.cl    0.946   NA          NA    NA       #> 6 ran_pars Residual(add) add.err              2.76    NA          NA    NA ## Transformation applied to log-scaled population parameters tidy(fit.s, exponentiate=NA) #> # A tibble: 6 × 7 #>   effect   group         term             estimate std.error statistic   p.value #>   <chr>    <chr>         <chr>               <dbl>     <dbl>     <dbl>     <dbl> #> 1 fixed    NA            tcl               0.00663  0.000498      13.3  1.75e-27 #> 2 fixed    NA            tv                1.42     0.0778        18.2  4.27e-40 #> 3 ran_pars ID            sd__eta.cl        0.488   NA             NA   NA        #> 4 ran_pars ID            sd__eta.v         0.402   NA             NA   NA        #> 5 ran_pars ID            cor__eta.v.eta.…  0.946   NA             NA   NA        #> 6 ran_pars Residual(add) add.err           2.76    NA             NA   NA options(broom.mixed.sep2=\"..\") tidy(fit.s) #> # A tibble: 6 × 7 #>   effect   group         term              estimate std.error statistic  p.value #>   <chr>    <chr>         <chr>                <dbl>     <dbl>     <dbl>    <dbl> #> 1 fixed    NA            tcl                 -5.02     0.0750    -66.9   1   e+0 #> 2 fixed    NA            tv                   0.350    0.0548      6.37  1.09e-9 #> 3 ran_pars ID            sd__eta.cl           0.488   NA          NA    NA       #> 4 ran_pars ID            sd__eta.v            0.402   NA          NA    NA       #> 5 ran_pars ID            cor__eta.v..eta.…    0.946   NA          NA    NA       #> 6 ran_pars Residual(add) add.err              2.76    NA          NA    NA"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"adding-a-confidence-interval-to-the-parameters","dir":"Articles","previous_headings":"Tidying the model parameters","what":"Adding a confidence interval to the parameters","title":"Using broom with nlmixr2","text":"default R method confint works nlmixr fit objects: transforms variables described . can still use exponentiate parameter control display confidence interval: However, broom also implemented way make data tidy dataset. easiest way get values nlmixr dataset use: confidence interval scale specified exponentiate, default estimated scale. want confidence adaptive back-transformed scale, simply use following:","code":"confint(fit.s) #>          model.est   estimate      2.5 %     97.5 % #> tcl     -5.0154795 0.00663445 -5.1625159 -4.8684431 #> tv       0.3495036 1.41836329  0.2420439  0.4569632 #> add.err  2.7649251 2.76492510         NA         NA confint(fit.s, exponentiate=FALSE) #>          model.est   estimate      2.5 %     97.5 % #> tcl     -5.0154795 0.00663445 -5.1625159 -4.8684431 #> tv       0.3495036 1.41836329  0.2420439  0.4569632 #> add.err  2.7649251 2.76492510         NA         NA tidy(fit.s, conf.level=0.9) #> # A tibble: 6 × 9 #>   effect   group  term  estimate std.error statistic  p.value conf.low conf.high #>   <chr>    <chr>  <chr>    <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl> #> 1 fixed    NA     tcl     -5.02     0.0750    -66.9   1   e+0   -5.14     -4.89  #> 2 fixed    NA     tv       0.350    0.0548      6.37  1.09e-9    0.259     0.440 #> 3 ran_pars ID     sd__…    0.488   NA          NA    NA         NA        NA     #> 4 ran_pars ID     sd__…    0.402   NA          NA    NA         NA        NA     #> 5 ran_pars ID     cor_…    0.946   NA          NA    NA         NA        NA     #> 6 ran_pars Resid… add.…    2.76    NA          NA    NA         NA        NA tidy(fit.s, conf.level=0.9, exponentiate=NA) #> # A tibble: 6 × 9 #>   effect   group term  estimate std.error statistic   p.value conf.low conf.high #>   <chr>    <chr> <chr>    <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl> #> 1 fixed    NA    tcl    0.00663  0.000498      13.3  1.75e-27  0.00586   0.00751 #> 2 fixed    NA    tv     1.42     0.0778        18.2  4.27e-40  1.30      1.55    #> 3 ran_pars ID    sd__…  0.488   NA             NA   NA        NA        NA       #> 4 ran_pars ID    sd__…  0.402   NA             NA   NA        NA        NA       #> 5 ran_pars ID    cor_…  0.946   NA             NA   NA        NA        NA       #> 6 ran_pars Resi… add.…  2.76    NA             NA   NA        NA        NA"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"extracting-other-model-information-with-tidy","dir":"Articles","previous_headings":"","what":"Extracting other model information with tidy","title":"Using broom with nlmixr2","text":"type information extracted can controlled effects argument.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"extracting-only-fixed-effect-parameters","dir":"Articles","previous_headings":"Extracting other model information with tidy","what":"Extracting only fixed effect parameters","title":"Using broom with nlmixr2","text":"fixed effect parameters can extracted effects=\"fixed\"","code":"tidy(fit.s, effects=\"fixed\") #> # A tibble: 2 × 6 #>   effect term  estimate std.error statistic       p.value #>   <chr>  <chr>    <dbl>     <dbl>     <dbl>         <dbl> #> 1 fixed  tcl     -5.02     0.0750    -66.9  1             #> 2 fixed  tv       0.350    0.0548      6.37 0.00000000109"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"extracting-only-random-parameters","dir":"Articles","previous_headings":"Extracting other model information with tidy","what":"Extracting only random parameters","title":"Using broom with nlmixr2","text":"random standard deviations can extracted effects=\"ran_pars\":","code":"tidy(fit.s, effects=\"ran_pars\") #> # A tibble: 4 × 4 #>   effect   group         term               estimate #>   <chr>    <chr>         <chr>                 <dbl> #> 1 ran_pars ID            sd__eta.cl            0.488 #> 2 ran_pars ID            sd__eta.v             0.402 #> 3 ran_pars ID            cor__eta.v..eta.cl    0.946 #> 4 ran_pars Residual(add) add.err               2.76"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"extracting-random-values-also-called-etas","dir":"Articles","previous_headings":"Extracting other model information with tidy","what":"Extracting random values (also called ETAs)","title":"Using broom with nlmixr2","text":"random values, NONMEM ETAs, can extracted effects=\"ran_vals\" effects=\"random\" duplicate method running effects broom package supports effects=\"random\" broom.mixed package supports effects=\"ran_vals\".","code":"head(tidy(fit.s, effects=\"ran_vals\")) #> # A tibble: 6 × 5 #>   effect   group level term   estimate #>   <chr>    <chr> <fct> <fct>     <dbl> #> 1 ran_vals ID    1     eta.cl  -0.0854 #> 2 ran_vals ID    2     eta.cl  -0.232  #> 3 ran_vals ID    3     eta.cl   0.257  #> 4 ran_vals ID    4     eta.cl  -0.522  #> 5 ran_vals ID    5     eta.cl   0.316  #> 6 ran_vals ID    6     eta.cl  -0.163"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"extracting-random-coefficients","dir":"Articles","previous_headings":"Extracting other model information with tidy","what":"Extracting random coefficients","title":"Using broom with nlmixr2","text":"Random coefficients population fixed effect parameter + random effect parameter, possibly transformed correct scale. case can extract information nlmixr fit object : can also changed exponentiate argument:","code":"head(tidy(fit.s, effects=\"ran_coef\")) #> # A tibble: 6 × 5 #>   effect   group level term  estimate #>   <chr>    <chr> <fct> <fct>    <dbl> #> 1 ran_coef ID    1     tcl      -5.10 #> 2 ran_coef ID    2     tcl      -5.25 #> 3 ran_coef ID    3     tcl      -4.76 #> 4 ran_coef ID    4     tcl      -5.54 #> 5 ran_coef ID    5     tcl      -4.70 #> 6 ran_coef ID    6     tcl      -5.18 head(tidy(fit.s, effects=\"ran_coef\", exponentiate=NA)) #> # A tibble: 6 × 5 #>   effect   group level term  estimate #>   <chr>    <chr> <fct> <fct>    <dbl> #> 1 ran_coef ID    1     tcl    0.00609 #> 2 ran_coef ID    2     tcl    0.00526 #> 3 ran_coef ID    3     tcl    0.00858 #> 4 ran_coef ID    4     tcl    0.00393 #> 5 ran_coef ID    5     tcl    0.00910 #> 6 ran_coef ID    6     tcl    0.00564 head(tidy(fit.s, effects=\"ran_coef\", exponentiate=TRUE)) #> # A tibble: 6 × 5 #>   effect   group level term  estimate #>   <chr>    <chr> <fct> <fct>    <dbl> #> 1 ran_coef ID    1     tcl    0.00609 #> 2 ran_coef ID    2     tcl    0.00526 #> 3 ran_coef ID    3     tcl    0.00858 #> 4 ran_coef ID    4     tcl    0.00393 #> 5 ran_coef ID    5     tcl    0.00910 #> 6 ran_coef ID    6     tcl    0.00564"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/censoring.html","id":"censoring-support-in-nlmixr","dir":"Articles","previous_headings":"","what":"Censoring support in nlmixr","title":"Censoring in nlmixr","text":"general, censoring observation measured researcher knows something certain number. 2001, Beal introduced censoring pharmacometric community described common ways deal missing data. methods , data structure used nlmixr support : Estimate Likelihood observation censored limit. concentrations limit quantitation (left censored), can specify nlmixr two columns: DV, CENS. value censored, DV limit quantification, CENS 1. rest non-censored values, DV keeps normal value CENS 0. censored value limit quantitation (right censored), DV remains limit quantification CENS -1. expansion M3 method. cases, like PK, can also assume observations actually positive. Therefore, may want adjust likelihood take consideration fact. can accomplished nlmixr well adding LIMIT column. case left censored problem, can specify concentration LIMIT DV. works right left censored values. data columns LIMIT CENS, based Monolix method handling censored data.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/censoring.html","id":"data-output-for-censored-data-in-nlmixr","dir":"Articles","previous_headings":"","what":"Data output for censored data in nlmixr","title":"Censoring in nlmixr","text":"censored data output, often useful see predictions perform censored area. accomplish , simulated value used show prediction noise. used calculate standard residual values nlmixr. default, value simulated truncated normal distribution model assumptions censoring information specified data (though can use CDF method used npde package instead calculating npdes well). simulated value replaces original DV used calculate residuals requested. original limit information output lowerLim upperLim.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"citations","dir":"Articles","previous_headings":"","what":"Citations","title":"nlmixr2 Citations","text":"document, attempt keep list published scientific work reported using nlmixr fashion. used nlmixr nlmixr2 (mixrverse package) work, please let us know can add list.","code":""},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section","dir":"Articles","previous_headings":"Citations > Publications","what":"2019","title":"nlmixr2 Citations","text":"Helmlinger G, Sokolov V, Peskov K, Hallow KM, Kosinsky Y, Voronova V, et al. Quantitative Systems Pharmacology: Exemplar Model-Building Workflow Applications Cardiovascular, Metabolic, Oncology Drug Development. CPT: Pharmacometrics & Systems Pharmacology. 2019;8(6):380–95. 10.1002/psp4.12426 Fidler M, Wilkins JJ, Hooijmaijers R, Post TM, Schoemaker R, Trame MN, et al. Nonlinear Mixed-Effects Model Development Simulation Using nlmixr Related R Open-Source Packages. CPT: Pharmacometrics & Systems Pharmacology. 2019;8(9):621–33. 10.1002/psp4.12445 Schoemaker R, Fidler M, Laveille C, Wilkins JJ, Hooijmaijers R, Post TM, et al. Performance SAEM FOCEI Algorithms Open-Source, Nonlinear Mixed Effect Modeling Tool nlmixr. CPT: Pharmacometrics & Systems Pharmacology. 2019;8(12):923–30. 10.1002/psp4.12471","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-1","dir":"Articles","previous_headings":"Citations > Publications","what":"2020","title":"nlmixr2 Citations","text":"Mwandigha LM, Fraser KJ, Racine-Poon , Mouksassi MS, Ghani AC. Power calculations cluster randomized trials (CRTs) right-truncated Poisson-distributed outcomes: motivating example malaria vector control trial. International Journal Epidemiology. 2020 Jun 1;49(3):954–62. 10.1093/ije/dyz277","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-2","dir":"Articles","previous_headings":"Citations > Publications","what":"2021","title":"nlmixr2 Citations","text":"Fidler M, Hooijmaijers R, Schoemaker R, Wilkins JJ, Xiong Y, Wang W. R nlmixr gateway statistics pharmacometrics. CPT: Pharmacometrics & Systems Pharmacology. 2021;10(4):283–5. 10.1002/psp4.12618 Lombard , Mistry H, Aarons L, Ogungbenro K. Dose individualisation oncology using chemotherapy-induced neutropenia: Example docetaxel non-small cell lung cancer patients. British Journal Clinical Pharmacology. 2021;87(4):2053–63. 10.1111/bcp.14614 Lu J, Deng K, Zhang X, Liu G, Guan Y. Neural-ODE pharmacokinetics modeling advantage alternative machine learning models predicting new dosing regimens. iScience. 2021 Jul 23;24(7). 10.1016/j.isci.2021.102804 Välitalo PAJ. Pharmacometric estimation methods aggregate data, including data simulated pharmacometric models. J Pharmacokinet Pharmacodyn. 2021 Oct 1;48(5):623–38. 10.1007/s10928-021-09760-1 Goers R, Coman Schmid D, Jäggi VF, Paioni P, Okoniewski MJ, Parker , et al. SwissPKcdw – clinical data warehouse optimization pediatric dosing regimens. CPT: Pharmacometrics & Systems Pharmacology. 2021;10(12):1578–87. 10.1002/psp4.12723 Jaisser F, Tan X, Chi S, Liu J, Wang P, Bush M, et al. Non-Steroidal Mineralocorticoid Receptor Antagonist KBP-5074 Limits Albuminuria Improved Therapeutic Index Compared Eplerenone Rat Model Mineralocorticoid-Induced Renal Injury. Frontiers Pharmacology. 2021;12. 10.3389/fphar.2021.604928 Medhora M, Phadnis P, Narayanan J, Gasperetti T, Zielonka J, Moulder JE, et al. Radiation Increases Bioavailability Lisinopril, Mitigator Radiation-Induced Toxicities. Frontiers Pharmacology. 2021;12. 10.3389/fphar.2021.646076","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-3","dir":"Articles","previous_headings":"Citations > Publications","what":"2022","title":"nlmixr2 Citations","text":"Lee SY. Bayesian Nonlinear Models Repeated Measurement Data: Overview, Implementation, Applications. Mathematics. 2022 Jan;10(6):898. 10.3390/math10060898 Aghamiri SS, Amin R, Helikar T. Recent applications quantitative systems pharmacology machine learning models across diseases. J Pharmacokinet Pharmacodyn. 2022 Feb 1;49(1):19–37. 10.1007/s10928-021-09790-9 Soeorg H, Sverrisdóttir E, Andersen M, Lund TM, Sessa M. PHARMACOM-EPI Framework Integrating Pharmacometric Modelling Pharmacoepidemiological Research Using Real-World Data: Application Assess Death Associated Valproate. Clinical Pharmacology & Therapeutics. 2022;111(4):840–56. 10.1002/cpt.2502 Liakopoulos , Aulin LBS, Buffoni M, Fragkiskou E, Coen van Hasselt JG, Rozen DE. Allele-specific collateral fitness effects determine dynamics fluoroquinolone resistance evolution. Proceedings National Academy Sciences. 2022 May 3;119(18):e2121768119. 10.1073/pnas.2121768119 Mehta K, Guo T, Wallis RS, van der Graaf PH, van Hasselt JGC. Quantitative Systems Pharmacology Modeling Framework Autophagy Tuberculosis: Application Adjunctive Metformin Host-Directed Therapy. Antimicrobial Agents Chemotherapy. 2022 Jul 14;66(8):e00366-22. 10.1128/aac.00366-22 Agyeman AA, T, Chan PLS, Lonsdale , Hadjichrysanthou C, Mahungu T, et al. Comparative assessment viral dynamic models SARS-CoV-2 pharmacodynamic assessment early treatment trials. British Journal Clinical Pharmacology. 2022;88(12):5428–33. 10.1111/bcp.15518 Aulin LBS, Tandar ST, van Zijp T, van Ballegooie E, van der Graaf PH, Saleh MAA, et al. Physiologically Based Modelling Framework Prediction Pulmonary Pharmacokinetics Antimicrobial Target Site Concentrations. Clin Pharmacokinet. 2022 Dec 1;61(12):1735–48. 10.1007/s40262-022-01186-3 Kloprogge F, Ortiz Canseco J, Phee L, Sadouki Z, Kipper K, Witney AA, et al. Emergence phenotypic genotypic antimicrobial resistance Mycobacterium tuberculosis. Sci Rep. 2022 Dec 11;12(1):21429. 10.1038/s41598-022-25827-6 Voulgarelis D, Bulusu KC, Yates JWT. Comparison classical tumour growth models patient derived cell-line derived xenografts using nonlinear mixed-effects framework. Journal Biological Dynamics. 2022 Dec 31;16(1):160–85. 10.1080/17513758.2022.2061615","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-4","dir":"Articles","previous_headings":"Citations > Publications","what":"2023","title":"nlmixr2 Citations","text":"Mak WY, Ooi QX, Cruz CV, Looi , Yuen KH, Standing JF. Assessment nlmixr R package population pharmacokinetic modeling: metformin case study. British Journal Clinical Pharmacology. 2023;89(1):330–9. 10.1111/bcp.15496 Mehta K, Guo T, van der Graaf PH, van Hasselt JGC. Predictions Bedaquiline Pretomanid Target Attainment Lung Lesions Tuberculosis Patients using Translational Minimal Physiologically Based Pharmacokinetic Modeling. Clin Pharmacokinet. 2023 Mar 1;62(3):519–32. 10.1007/s40262-023-01217-7 Yang W, Mak W, Gwee , Gu M, Wu Y, Shi Y, et al. Establishment Evaluation Parametric Population Pharmacokinetic Model Repository Ganciclovir Valganciclovir. Pharmaceutics. 2023 Jul;15(7):1801. 10.3390/pharmaceutics15071801 Ibrahim EIK, Karlsson MO, Friberg LE. Assessment ibrutinib scheduling leukocyte, lymph node size blood pressure dynamics chronic lymphocytic leukemia pharmacokinetic-pharmacodynamic models. CPT: Pharmacometrics & Systems Pharmacology. 2023;12(9):1305–18. 10.1002/psp4.13010 Zhang S, Agyeman AA, Hadjichrysanthou C, Standing JF. SARS-CoV-2 viral dynamic modeling inform model selection timing efficacy antiviral therapy. CPT: Pharmacometrics & Systems Pharmacology. 2023;12(10):1450–60. 10.1002/psp4.13022 Barrett JS, Betourne , Walls RL, Lasater K, Russell S, Borens , et al. future rare disease drug development: rare disease cures accelerator data analytics platform (RDCA-DAP). J Pharmacokinet Pharmacodyn. 2023 Dec 1;50(6):507–19. 10.1007/s10928-023-09859-7","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-5","dir":"Articles","previous_headings":"Citations > Publications","what":"2024","title":"nlmixr2 Citations","text":"Kovács L, Ferenci T, Gombos B, Füredi , Rudas , Szakács G, et al. Positive Impulsive Control Tumor Therapy—Cyber-Medical Approach. IEEE Transactions Systems, Man, Cybernetics: Systems. 2024 Jan;54(1):597–608. 10.1109/TSMC.2023.3315637 Lepak AJ, VanScoy B, Rubino C, Ambrose PG, Andes DR. vivo pharmacodynamic characterization next-generation polyene, SF001, invasive pulmonary aspergillosis mouse model. Antimicrobial Agents Chemotherapy. 2024 Feb 6;0(0):e01631-23. 10.1128/aac.01631-23 Standing JF, Buggiotti L, Guerra-Assuncao JA, Woodall M, Ellis S, Agyeman AA, et al. Randomized controlled trial molnupiravir SARS-CoV-2 viral antibody response -risk adult outpatients. Nat Commun. 2024 Feb 23;15(1):1652. 10.1038/s41467-024-45641-0","code":""},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-6","dir":"Articles","previous_headings":"Citations > Conference Proceedings","what":"2016","title":"nlmixr2 Citations","text":"Fidler M, Schoemaker R, Xiong Y, Wilkins J, Laveille C, Wang W. W-66. nlmixr: open-source package pharmacometric modelling R. Abstracts accepted American Conference Pharmacometrics 2016 (ACoP7). J Pharmacokinet Pharmacodyn. 2016 43(S1):S115. 10.1007/s10928-016-9485-x","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-7","dir":"Articles","previous_headings":"Citations > Conference Proceedings","what":"2017","title":"nlmixr2 Citations","text":"Erhardt E, Jacobs T, Gasparini M. Comparison pharmacokinetic parameters estimated experimental R package ‘nlmixr’ MONOLIX. PAGE 2017 (Budapest, Hungary): Abstr 7247 Schoemaker R, Fidler M, Xiong Y, Wilkins J, Trame MN, Laveille C, Wang W. T-012. nlmixr: open-source package pharmacometric modelling R. Abstracts American Conference Pharmacometrics 2017 (ACoP8). J Pharmacokinet Pharmacodyn. 2017 44(S1):S60. 10.1007/s10928-017-9536-y Schoemaker R, Fidler M, Xiong Y, Wilkins J, Trame M, Laveille C, Wang W. nlmixr: open-source package pharmacometric modelling R. PAGE 2017 (Budapest, Hungary): Abstr 7102","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-8","dir":"Articles","previous_headings":"Citations > Conference Proceedings","what":"2018","title":"nlmixr2 Citations","text":"Bartels C, Bieth B, Dumortier T, Baltcheva , Bhattacharya S, Ludwig , Demin , Gassem , Renard D. ggPMX: toolbox easily generate comprehensive set model diagnostic plots population models. PAGE 2018 (Montreux, Switzerland): Abstr 8423 Fidler M, Xiong Y, Schoemaker R, Wilkins J, Trame MN, Post T, Hooijmaijers R, Wang W. W-058. Exploring inductive linearization population pharmacokinetic pharmacodynamic models. Abstracts Ninth American Conference Pharmacometrics (ACoP9). J Pharmacokinet Pharmacodyn. 2018 45(S1):S116. 10.1007/s10928-018-9606-9 Hooijmaijers R, Fidler M, Schoemaker R, Trame MN, Wang W, Wilkins J, Xiong Y, Post T. ShinyMixR: project-centric R/Shiny run management tool nlmixr. PAGE 2018 (Montreux, Switzerland): Abstr 8452 Erhardt EM, Ursino M, Jacobs T, Biewenga J, Gasparini M. Bayesian knowledge integration vitro–vivo correlation (IVIVC) model. PAGE 2018 (Montreux, Switzerland): Abstr 8689","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-9","dir":"Articles","previous_headings":"Citations > Conference Proceedings","what":"2019","title":"nlmixr2 Citations","text":"Baltcheva , Bartels C, Dumortier T, Bhattacharya S, Paule , Ludwig , Demin , Gassem , Renard D, Bieth B. ggPMX: open-source R package pharmacometric model diagnostic plots. PAGE 2019 (Stockholm, Sweden): Abstr 9013 Schoemaker S, Fidler M, Laveille C, Wilkins JJ, Hooijmaijers R, Post TM, Trame MN, Xiong Y, Wang W. Performance SAEM FOCEI algorithms open-source non-linear mixed effect modelling tool nlmixr. PAGE 2019 (Stockholm, Sweden): Abstr 8978","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-10","dir":"Articles","previous_headings":"Citations > Conference Proceedings","what":"2021","title":"nlmixr2 Citations","text":"Aulin LBS, Liakopoulos , Rozen DE, van Hasselt JGC. Model-based design innovative treatment strategies suppress antimicrobial resistance using collateral sensitivity. PAGE 2021 (Virtual): Abstr 9792 Ibrahim E, Karlsson MO, Friberg LE. Pharmacokinetic-pharmacodynamic (PK-PD) modeling leukocyte dynamics lymph node size chronic lymphocytic leukaemia patients treated ibrutinib. PAGE 2021 (Virtual): Abstr 9682 Jung WJ, Hwang T, Jung S, Savic RM, Chae JW, Yun HY. Web based platform clinical pharmacokinetic consultation service (CPCS) Non-linear Mixed Effect Model. PAGE 2021 (Virtual): Abstr 9727 Pham AD, van Hasselt JGC. Modelling rate extent resistance development colistin Klebsiella pneumoniae. PAGE 2021 (Virtual): Abstr 9774 Tran QT, Lee CH, Kim MG, Kim M, Kim H, Chae JW, Yun HY. Overview Korean Pharmacometrics Modeling Library web-based pharmacometrics platform. PAGE 2021 (Virtual): Abstr 9865 Vavilov S, Sokolov V, Zhudenkov K, Stolbov L, Peskov K. Parameter estimation nonlinear fixed-effects QSP models: benchmark optimization methods. PAGE 2021 (Virtual): Abstr 9755","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-11","dir":"Articles","previous_headings":"Citations > Conference Proceedings","what":"2022","title":"nlmixr2 Citations","text":"Bieth B, Fidler M, Baltcheva . ggPMX: re-imagine diagnostics plots. PAGE 2022 (Ljubljana, Slovenia): Abstr 9998 Liu C, Cojutti PG, Bussini L, Rosselli Del Turco E, Bartoletti M, Pea F. Comparison performances open-source R package “nlmixr” vs. Monolix population pharmacokinetics continuous infusion meropenem patients onco-hematological malignancies. PAGE 2022 (Ljubljana, Slovenia): Abstr 10210 Nordgren R, Belin S, Yngman G, Huang Z, Carter SJ, Chen X, Qutishat O, Hamdan , Wang S, Yang T, Assawasuwannakit P, Buatois S, Abrantes JA, Hooker AC, Karlsson MO. Pharmpy: versatile open-source library pharmacometrics. PAGE 2022 (Ljubljana, Slovenia): Abstr 10096","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/citations.html","id":"section-12","dir":"Articles","previous_headings":"Citations > Conference Proceedings","what":"2023","title":"nlmixr2 Citations","text":"Cheng , Solas C, Howley E, McGarrity O, Rajani K, Breuer J, Standing J, Kreins . Favipiravir pharmacokinetics immunocompromised infants children chronic RNA viral infections. PAGE 2023 (Coruña, Spain): Abstr 10570 Codina MS, Pham AD, van Os W, al Jalali V, Matzneller P, Wölfl-Duchek M, Vychytil , Reiter B, Stimpfl T, van Hasselt JG, Zeitlinger M. Evaluating ceftazidime-avibactam exposure patients undergoing automated peritoneal dialysis using population pharmacokinetic modelling. PAGE 2023 (Coruña, Spain): Abstr 10707 Combes FP, Fidler M, Ochsenbein D, Illis W, Subrahmanyam K, Ho Y-Y. Benchmarking Industrial Computing Environments - Pharmacometrics Study (BICEPS). PAGE 2023 (Coruña, Spain): Abstr 10604 Duong , Marsot . NONMEM versus nlmixr2 : example external evaluation gentamicin Pop-PK models. PAGE 2023 (Coruña, Spain): Abstr 10602 Fidler M, Denney WS, Harrold J, Hooijmaijers R, Schoemaker R, Taubert M, Trame M, Papathanasiou T, Wilkins J. nlmixr2, rxode2 NONMEM: interchangeable models using babelmixr2 nonmem2rx. PAGE 2023 (Coruña, Spain): Abstr 10313 Huang Z, Standing JF, Kloprogge F. Development exploration exhaustive, stepwise, heuristic algorithms automated population pharmacokinetic modelling. PAGE 2023 (Coruña, Spain): Abstr 10704. Jeon H, Sung T, Jung W, Chae J-W, Yun H-Y. Construction model-based PK-PD software platform using R package considering compatibility nlme structured model. PAGE 2023 (Coruña, Spain): Abstr 10432 Nordgren R, Belin S, Chen X, Borg J, Huang Z, Qutishat O, Shi K, Liu X, Wang S, Mohamed S, Mirasbekov S, Hooker AC, Karlsson MO. Pharmpy: versatile open-source library pharmacometrics. PAGE 2023 (Coruña, Spain): Abstr 10508 Xu C, Yu J, Cao W, Lu H, Yao Z, Sun X, Zhang K, Luo J, Zheng Q, Zheng H. PyMaS: population pharmacometric modeling Python. PAGE 2023 (Coruña, Spain): Abstr 10676","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"nlmixr-model","dir":"Articles","previous_headings":"","what":"nlmixr model","title":"mavoglurant -- physiologically-based PK","text":"","code":"library(nlmixr2) library(xpose) library(xpose.nlmixr2) library(ggplot2)  pbpk <- function(){   ini({     ##theta=exp(c(1.1, .3, 2, 7.6, .003, .3))     lKbBR = 1.1     lKbMU = 0.3     lKbAD = 2     lCLint = 7.6     lKbBO = 0.03     lKbRB = 0.3     eta.LClint ~ 4     add.err <- 1     prop.err <- 10   })   model({     KbBR = exp(lKbBR)     KbMU = exp(lKbMU)     KbAD = exp(lKbAD)     CLint= exp(lCLint + eta.LClint)     KbBO = exp(lKbBO)     KbRB = exp(lKbRB)      ## Regional blood flows     CO  = (187.00*WT^0.81)*60/1000;         # Cardiac output (L/h) from White et al (1968)     QHT = 4.0 *CO/100;     QBR = 12.0*CO/100;     QMU = 17.0*CO/100;     QAD = 5.0 *CO/100;     QSK = 5.0 *CO/100;     QSP = 3.0 *CO/100;     QPA = 1.0 *CO/100;     QLI = 25.5*CO/100;     QST = 1.0 *CO/100;     QGU = 14.0*CO/100;     QHA = QLI - (QSP + QPA + QST + QGU); # Hepatic artery blood flow     QBO = 5.0 *CO/100;     QKI = 19.0*CO/100;     QRB = CO - (QHT + QBR + QMU + QAD + QSK + QLI + QBO + QKI);     QLU = QHT + QBR + QMU + QAD + QSK + QLI + QBO + QKI + QRB;      ## Organs' volumes = organs' weights / organs' density     VLU = (0.76 *WT/100)/1.051;     VHT = (0.47 *WT/100)/1.030;     VBR = (2.00 *WT/100)/1.036;     VMU = (40.00*WT/100)/1.041;     VAD = (21.42*WT/100)/0.916;     VSK = (3.71 *WT/100)/1.116;     VSP = (0.26 *WT/100)/1.054;     VPA = (0.14 *WT/100)/1.045;     VLI = (2.57 *WT/100)/1.040;     VST = (0.21 *WT/100)/1.050;     VGU = (1.44 *WT/100)/1.043;     VBO = (14.29*WT/100)/1.990;     VKI = (0.44 *WT/100)/1.050;     VAB = (2.81 *WT/100)/1.040;     VVB = (5.62 *WT/100)/1.040;     VRB = (3.86 *WT/100)/1.040;      ## Fixed parameters     BP = 0.61;      # Blood:plasma partition coefficient     fup = 0.028;    # Fraction unbound in plasma     fub = fup/BP;   # Fraction unbound in blood      KbLU = exp(0.8334);     KbHT = exp(1.1205);     KbSK = exp(-.5238);     KbSP = exp(0.3224);     KbPA = exp(0.3224);     KbLI = exp(1.7604);     KbST = exp(0.3224);     KbGU = exp(1.2026);     KbKI = exp(1.3171);      ##-----------------------------------------     S15 = VVB*BP/1000;     C15 = Venous_Blood/S15      ##-----------------------------------------     d/dt(Lungs) = QLU*(Venous_Blood/VVB - Lungs/KbLU/VLU);     d/dt(Heart) = QHT*(Arterial_Blood/VAB - Heart/KbHT/VHT);     d/dt(Brain) = QBR*(Arterial_Blood/VAB - Brain/KbBR/VBR);     d/dt(Muscles) = QMU*(Arterial_Blood/VAB - Muscles/KbMU/VMU);     d/dt(Adipose) = QAD*(Arterial_Blood/VAB - Adipose/KbAD/VAD);     d/dt(Skin) = QSK*(Arterial_Blood/VAB - Skin/KbSK/VSK);     d/dt(Spleen) = QSP*(Arterial_Blood/VAB - Spleen/KbSP/VSP);     d/dt(Pancreas) = QPA*(Arterial_Blood/VAB - Pancreas/KbPA/VPA);     d/dt(Liver) = QHA*Arterial_Blood/VAB + QSP*Spleen/KbSP/VSP + QPA*Pancreas/KbPA/VPA + QST*Stomach/KbST/VST + QGU*Gut/KbGU/VGU - CLint*fub*Liver/KbLI/VLI - QLI*Liver/KbLI/VLI;     d/dt(Stomach) = QST*(Arterial_Blood/VAB - Stomach/KbST/VST);     d/dt(Gut) = QGU*(Arterial_Blood/VAB - Gut/KbGU/VGU);     d/dt(Bones) = QBO*(Arterial_Blood/VAB - Bones/KbBO/VBO);     d/dt(Kidneys) = QKI*(Arterial_Blood/VAB - Kidneys/KbKI/VKI);     d/dt(Arterial_Blood) = QLU*(Lungs/KbLU/VLU - Arterial_Blood/VAB);     d/dt(Venous_Blood) = QHT*Heart/KbHT/VHT + QBR*Brain/KbBR/VBR + QMU*Muscles/KbMU/VMU + QAD*Adipose/KbAD/VAD + QSK*Skin/KbSK/VSK + QLI*Liver/KbLI/VLI + QBO*Bones/KbBO/VBO + QKI*Kidneys/KbKI/VKI + QRB*Rest_of_Body/KbRB/VRB - QLU*Venous_Blood/VVB;     d/dt(Rest_of_Body) = QRB*(Arterial_Blood/VAB - Rest_of_Body/KbRB/VRB);      C15 ~ add(add.err) + prop(prop.err)   }) }  dat <- nlmixr2data::mavoglurant dat$occ = unlist(with(dat, tapply(EVID, ID, function(x) cumsum(x>0)))) dat = subset(dat, occ==1) dat = subset(dat, ID<812) ## First 20 dat = subset(dat, EVID>0 | DV>0) dat$CMT[dat$CMT == 0]  <- 1; dat$CMT[dat$EVID == 1]  <- \"Venous_Blood\" ## Compartment dosed to is Venous Blood dat$CMT[dat$EVID != 1]  <- \"C15\" ## Observing C15  gofs <- function(fit){     ################################################################################     ## Standard plots     ################################################################################     plot(fit)      xpdb <- xpose_data_nlmixr(fit) ## Convert to nlmixr object      print(dv_vs_pred(xpdb) +           ylab(\"Observed Mavoglurant Concentrations (ng/mL)\") +           xlab(\"Population Predicted Mavoglurant Concentrations (ng/mL)\"));      print(dv_vs_ipred(xpdb) +           ylab(\"Observed Mavoglurant Concentrations (ng/mL)\") +           xlab(\"Individual Predicted Mavoglurant Concentrations (ng/mL)\"));      print(res_vs_pred(xpdb) +           ylab(\"Conditional Weighted Residuals\") +           xlab(\"Population Predicted Mavoglurant Concentrations (ng/mL)\"));      print(res_vs_idv(xpdb) +           ylab(\"Conditional Weighted Residuals\") +           xlab(\"Time (h)\"));      if (!is.null(fit$saem)){         print(prm_vs_iteration(xpdb));     }      print(absval_res_vs_idv(xpdb, res = 'IWRES') +           ylab(\"Individual Weighted Residuals\") +           xlab(\"Time (h)\"))      print(absval_res_vs_pred(xpdb, res = 'IWRES') +           ylab(\"Individual Weighted Residuals\") +           xlab(\"Population Predicted Mavoglurant Concentrations (ng/mL)\"))      print(ind_plots(xpdb, nrow=3, ncol=4) +           ylab(\"Predicted and Observed Mavoglurant Concentrations (ng/mL)\") +           xlab(\"Time (h)\"))      print(res_distrib(xpdb) +           ylab(\"Density\") +           xlab(\"Conditional Weighted Residuals\"));     # Visual Predictive Checks     f1 <- vpcPlot(fit,n=500,stratify=\"DOSE\", show=list(obs_dv=T), log_y=TRUE,            bins = c(0, 2, 4, 6, 8, 10, 20, 30, 40, 50),            ylab = \"Mavoglurant Concentrations (ng/mL)\",            xlab = \"Time (hours)\")     f2 <- vpcPlot(fit,n=500, show=list(obs_dv=T), bins = c(0, 2, 4, 6, 8, 10, 20, 30, 40, 50), log_y=TRUE,                  ylab = \"Mavoglurant Concentrations (ng/mL)\", xlab = \"Time (hours)\")     plot(f1)     plot(f2) }"},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"fit-addprop-saem","dir":"Articles","previous_headings":"SAEM","what":"Fit add+prop SAEM","title":"mavoglurant -- physiologically-based PK","text":"","code":"fit.addProp.S <- nlmixr(pbpk, dat, est=\"saem\", control=list(print=0),                         table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:01 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  gofs(fit.addProp.S)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"change-error-to-lognormal","dir":"Articles","previous_headings":"SAEM","what":"Change error to lognormal","title":"mavoglurant -- physiologically-based PK","text":"NOTE: lognormal distribution AIC/loglik/etc normal scale. Therefore, can compare AICs fit.lnorm fit.addProp since calculated scale. case can see AIC log-normal model better AIC addProp model.","code":"fit.lnorm.S <- pbpk %>%     model({C15 ~ lnorm(lnorm.err)}) %>% # Change C15 to be log-normally distributed     ## Requires data since piping from pbpk model     nlmixr(dat,est=\"saem\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:01 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 gofs(fit.lnorm.S)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"piping-to-focei","dir":"Articles","previous_headings":"","what":"Piping to FOCEi","title":"mavoglurant -- physiologically-based PK","text":"can pipe models different estimation methods new estimation methods.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"additive-proportional","dir":"Articles","previous_headings":"Piping to FOCEi","what":"Additive + Proportional","title":"mavoglurant -- physiologically-based PK","text":"","code":"fit.addProp.F <- fit.addProp.S %>%     nlmixr(est=\"focei\",            control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:15  #> done ## Since this was a model pipline, the data ## remains the same as the last fit.  gofs(fit.addProp.F)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"log-normal","dir":"Articles","previous_headings":"Piping to FOCEi","what":"Log-normal","title":"mavoglurant -- physiologically-based PK","text":"# Traditional lognormal estimates identical NOTE: estimates AIC different since calculated log scale.","code":"fit.lnorm.F <- fit.addProp.F %>%     model({C15 ~ lnorm(lnorm.err)}) %>%     nlmixr(est=\"focei\",            control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)); #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:15  #> done ## In this model pipline we are changing the fit method to focei.  gofs(fit.lnorm.F); datL  <- dat datL$DV <- log(datL$DV);  pbpkL <- function() {   ini({     ##theta=exp(c(1.1, .3, 2, 7.6, .003, .3))     lKbBR = 1.1     lKbMU = 0.3     lKbAD = 2     lCLint = 7.6     lKbBO = 0.03     lKbRB = 0.3     eta.LClint ~ 4     add.err <- 1   })   model({     KbBR = exp(lKbBR)     KbMU = exp(lKbMU)     KbAD = exp(lKbAD)     CLint= exp(lCLint + eta.LClint)     KbBO = exp(lKbBO)     KbRB = exp(lKbRB)      ## Regional blood flows     CO  = (187.00*WT^0.81)*60/1000;         # Cardiac output (L/h) from White et al (1968)     QHT = 4.0 *CO/100;     QBR = 12.0*CO/100;     QMU = 17.0*CO/100;     QAD = 5.0 *CO/100;     QSK = 5.0 *CO/100;     QSP = 3.0 *CO/100;     QPA = 1.0 *CO/100;     QLI = 25.5*CO/100;     QST = 1.0 *CO/100;     QGU = 14.0*CO/100;     QHA = QLI - (QSP + QPA + QST + QGU); # Hepatic artery blood flow     QBO = 5.0 *CO/100;     QKI = 19.0*CO/100;     QRB = CO - (QHT + QBR + QMU + QAD + QSK + QLI + QBO + QKI);     QLU = QHT + QBR + QMU + QAD + QSK + QLI + QBO + QKI + QRB;      ## Organs' volumes = organs' weights / organs' density     VLU = (0.76 *WT/100)/1.051;     VHT = (0.47 *WT/100)/1.030;     VBR = (2.00 *WT/100)/1.036;     VMU = (40.00*WT/100)/1.041;     VAD = (21.42*WT/100)/0.916;     VSK = (3.71 *WT/100)/1.116;     VSP = (0.26 *WT/100)/1.054;     VPA = (0.14 *WT/100)/1.045;     VLI = (2.57 *WT/100)/1.040;     VST = (0.21 *WT/100)/1.050;     VGU = (1.44 *WT/100)/1.043;     VBO = (14.29*WT/100)/1.990;     VKI = (0.44 *WT/100)/1.050;     VAB = (2.81 *WT/100)/1.040;     VVB = (5.62 *WT/100)/1.040;     VRB = (3.86 *WT/100)/1.040;      ## Fixed parameters     BP = 0.61;      # Blood:plasma partition coefficient     fup = 0.028;    # Fraction unbound in plasma     fub = fup/BP;   # Fraction unbound in blood      KbLU = exp(0.8334);     KbHT = exp(1.1205);     KbSK = exp(-.5238);     KbSP = exp(0.3224);     KbPA = exp(0.3224);     KbLI = exp(1.7604);     KbST = exp(0.3224);     KbGU = exp(1.2026);     KbKI = exp(1.3171);      ##-----------------------------------------     S15 = VVB*BP/1000;     C15 = Venous_Blood/S15     lnC15 = log(C15);      ##-----------------------------------------     d/dt(Lungs) = QLU*(Venous_Blood/VVB - Lungs/KbLU/VLU);     d/dt(Heart) = QHT*(Arterial_Blood/VAB - Heart/KbHT/VHT);     d/dt(Brain) = QBR*(Arterial_Blood/VAB - Brain/KbBR/VBR);     d/dt(Muscles) = QMU*(Arterial_Blood/VAB - Muscles/KbMU/VMU);     d/dt(Adipose) = QAD*(Arterial_Blood/VAB - Adipose/KbAD/VAD);     d/dt(Skin) = QSK*(Arterial_Blood/VAB - Skin/KbSK/VSK);     d/dt(Spleen) = QSP*(Arterial_Blood/VAB - Spleen/KbSP/VSP);     d/dt(Pancreas) = QPA*(Arterial_Blood/VAB - Pancreas/KbPA/VPA);     d/dt(Liver) = QHA*Arterial_Blood/VAB + QSP*Spleen/KbSP/VSP + QPA*Pancreas/KbPA/VPA + QST*Stomach/KbST/VST + QGU*Gut/KbGU/VGU - CLint*fub*Liver/KbLI/VLI - QLI*Liver/KbLI/VLI;     d/dt(Stomach) = QST*(Arterial_Blood/VAB - Stomach/KbST/VST);     d/dt(Gut) = QGU*(Arterial_Blood/VAB - Gut/KbGU/VGU);     d/dt(Bones) = QBO*(Arterial_Blood/VAB - Bones/KbBO/VBO);     d/dt(Kidneys) = QKI*(Arterial_Blood/VAB - Kidneys/KbKI/VKI);     d/dt(Arterial_Blood) = QLU*(Lungs/KbLU/VLU - Arterial_Blood/VAB);     d/dt(Venous_Blood) = QHT*Heart/KbHT/VHT + QBR*Brain/KbBR/VBR +       QMU*Muscles/KbMU/VMU + QAD*Adipose/KbAD/VAD +       QSK*Skin/KbSK/VSK + QLI*Liver/KbLI/VLI + QBO*Bones/KbBO/VBO +       QKI*Kidneys/KbKI/VKI + QRB*Rest_of_Body/KbRB/VRB - QLU*Venous_Blood/VVB;     d/dt(Rest_of_Body) = QRB*(Arterial_Blood/VAB - Rest_of_Body/KbRB/VRB);      lnC15 ~ add(add.err)   }) }  fit.lnorm.trans <- pbpkL %>%     nlmixr(datL,est=\"saem\",            control=list(print=0),            table=list(npde=TRUE, cwres=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:01 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"changing-models-via-piping","dir":"Articles","previous_headings":"","what":"Changing models via piping","title":"Modifying nlmixr2 models by piping","text":"running nlmixr vignette, Let’s start simple PK example, using single-dose theophylline dataset generously provided Dr. Robert . Upton University California, San Francisco: can try First-Order Conditional Estimation Interaction (FOCEi) method find good solution:","code":"library(nlmixr2)  one.compartment <- function() {   ini({     tka <- 0.45; label(\"Ka\")     tcl <- 1; label(\"Cl\")     tv <- 3.45; label(\"V\")     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     d/dt(depot) = -ka * depot     d/dt(center) = ka * depot - cl / v * center     cp = center / v     cp ~ add(add.sd)   }) } fit <- nlmixr(one.compartment, theo_sd, est=\"focei\",               control=list(print=0),               table=list(npde=TRUE, cwres=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(fit) #> ── nlmixr² FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC     BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 116.8346 373.4344 393.614      -179.7172        214.0002        4.968035 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.001991 0.538576   0.538577 0.832    0.011 6.185856 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE  %RSE Back-transformed(95%CI) BSV(CV%) #> tka           Ka 0.476  0.204  42.8        1.61 (1.08, 2.4)     69.8 #> tcl           Cl  1.01  0.177  17.5       2.75 (1.94, 3.89)     26.4 #> tv             V  3.46 0.0188 0.542         31.8 (30.7, 33)     14.6 #> add.sd           0.695                                0.695          #>        Shrink(SD)% #> tka         1.14%  #> tcl         3.91%  #> tv          12.1%  #> add.sd             #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Information about run found ($runInfo): #>    • gradient problems with initial estimate and covariance; see $scaleInfo  #>    • last objective function was not at minimum, possible problems in optimization  #>    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))  #>    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  #>   Censoring ($censInformation): No censoring #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 28 #>   ID     TIME    DV EPRED   ERES   NPDE    NPD    PDE    PD  PRED    RES   WRES #>   <fct> <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl>  <dbl>  <dbl> #> 1 1      0     0.74 0.109  0.631  0.449  0.878 0.673  0.81   0     0.74   1.06  #> 2 1      0.25  2.84 3.64  -0.804 -0.496 -0.394 0.31   0.347  3.29 -0.452 -0.240 #> 3 1      0.57  6.57 5.95   0.617 -1.79   0.323 0.0367 0.627  5.87  0.703  0.282 #> # ℹ 129 more rows #> # ℹ 16 more variables: IPRED <dbl>, IRES <dbl>, IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"changing-and-fixing-parameter-values-in-models","dir":"Articles","previous_headings":"","what":"Changing and fixing parameter values in models","title":"Modifying nlmixr2 models by piping","text":"Something may want change initial estimates model. simple modify model definition change , may also want change specific way; example try range starting values see system behaves (either full estimation posthoc estimation). situations can come tedious modify models hand. nlmixr provides ability : Change parameter estimates running model. (ie ini(tka=0.5)) Fix parameters arbitrary values, estimated values (ie ini(tka=fix(0.5)) ini(tka=fix)) easiest way illustrate showing examples piping changes model:","code":"## Example 1 -- Set inital estimate to 0.5 (shown w/posthoc) one.ka.0.5 <- fit %>%     ini(tka=0.5) %>%     nlmixr(est=\"posthoc\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE))  print(one.ka.0.5) ## Example 2 -- Fix tka to 0.5 and re-estimate. one.ka.0.5 <- fit %>%     ini(tka=fix(0.5)) %>%     nlmixr(est=\"focei\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(one.ka.0.5) #> ── nlmixr² FOCEi (outer: nlminb) ── #>  #>           OBJF     AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 116.8652 371.465 388.7618      -179.7325        14.86323        7.504417 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002185 0.279111   0.279113 0.836    0.011 4.001591 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE  %RSE Back-transformed(95%CI) BSV(CV%) #> tka           Ka   0.5  FIXED FIXED                     0.5     69.8 #> tcl           Cl  1.01 0.0825  8.15       2.75 (2.34, 3.23)     26.4 #> tv             V  3.46 0.0376  1.09       31.8 (29.6, 34.3)     14.6 #> add.sd           0.695                                0.695          #>        Shrink(SD)% #> tka         1.07%  #> tcl         3.93%  #> tv          12.0%  #> add.sd             #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Information about run found ($runInfo): #>    • gradient problems with initial estimate and covariance; see $scaleInfo  #>    • last objective function was not at minimum, possible problems in optimization  #>    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))  #>    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  #>   Censoring ($censInformation): No censoring #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 28 #>   ID     TIME    DV EPRED   ERES   NPDE    NPD    PDE    PD  PRED    RES   WRES #>   <fct> <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl>  <dbl>  <dbl> #> 1 1      0     0.74 0.109  0.631  0.440  0.878 0.67   0.81   0     0.74   1.06  #> 2 1      0.25  2.84 3.71  -0.866 -0.477 -0.412 0.317  0.34   3.36 -0.515 -0.270 #> 3 1      0.57  6.57 6.02   0.546 -1.79   0.271 0.0367 0.607  5.95  0.619  0.248 #> # ℹ 129 more rows #> # ℹ 16 more variables: IPRED <dbl>, IRES <dbl>, IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl> ## Example 3 -- Fix tka to model estimated value and re-estimate. one.ka.0.5 <- fit %>%     ini(tka=fix) %>%     nlmixr(est=\"focei\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(one.ka.0.5) #> ── nlmixr² FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC     BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 116.8354 371.4352 388.732      -179.7176        15.81358        11.88774 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress   other #> elapsed 0.002221 0.280134   0.280135 0.857    0.011 3.62851 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.    SE  %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka           Ka 0.476 FIXED FIXED                   0.476     69.9      1.21%  #> tcl           Cl  1.01 0.304  30.1       2.75 (1.51, 4.99)     26.4      3.89%  #> tv             V  3.46 0.183   5.3       31.8 (22.2, 45.6)     14.6      12.1%  #> add.sd           0.695                               0.695                      #>   #>   Covariance Type ($covMethod): s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Information about run found ($runInfo): #>    • gradient problems with initial estimate and covariance; see $scaleInfo  #>    • using S matrix to calculate covariance, can check sandwich or R matrix with $covRS and $covR  #>    • last objective function was not at minimum, possible problems in optimization  #>    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))  #>    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  #>   Censoring ($censInformation): No censoring #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 28 #>   ID     TIME    DV EPRED   ERES   NPDE    NPD    PDE    PD  PRED    RES   WRES #>   <fct> <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl>  <dbl>  <dbl> #> 1 1      0     0.74 0.109  0.631  0.449  0.878 0.673  0.81   0     0.74   1.06  #> 2 1      0.25  2.84 3.65  -0.808 -0.496 -0.394 0.31   0.347  3.29 -0.455 -0.241 #> 3 1      0.57  6.57 5.96   0.611 -1.79   0.314 0.0367 0.623  5.87  0.697  0.280 #> # ℹ 129 more rows #> # ℹ 16 more variables: IPRED <dbl>, IRES <dbl>, IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl> ## Example 4 -- Change tka to 0.7 in orginal model function and then estimate one.ka.0.7 <- one.compartment %>%     ini(tka=0.7) %>%     nlmixr(theo_sd, est=\"focei\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(one.ka.0.7) #> ── nlmixr² FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 116.9169 373.5166 393.6963      -179.7583        123.6119        26.02286 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.001863 0.473696   0.473697 0.372    0.009 2.013744 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.    SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka           Ka 0.491 0.498  101      1.63 (0.616, 4.33)     70.4      1.65%  #> tcl           Cl  1.01 0.163 16.2       2.75 (1.99, 3.78)     25.8      3.06%  #> tv             V  3.46 0.632 18.2        31.9 (9.26, 110)     15.1      13.3%  #> add.sd           0.698                              0.698                      #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Information about run found ($runInfo): #>    • gradient problems with initial estimate and covariance; see $scaleInfo  #>    • last objective function was not at minimum, possible problems in optimization  #>    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))  #>    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  #>   Censoring ($censInformation): No censoring #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 28 #>   ID     TIME    DV EPRED   ERES   NPDE    NPD    PDE    PD  PRED    RES   WRES #>   <fct> <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl>  <dbl>  <dbl> #> 1 1      0     0.74 0.109  0.631  0.458  0.878 0.677  0.81   0     0.74   1.06  #> 2 1      0.25  2.84 3.68  -0.836 -0.477 -0.394 0.317  0.347  3.32 -0.481 -0.252 #> 3 1      0.57  6.57 5.98   0.588 -1.79   0.297 0.0367 0.617  5.90  0.668  0.266 #> # ℹ 129 more rows #> # ℹ 16 more variables: IPRED <dbl>, IRES <dbl>, IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"changing-parameter-labels-and-order","dir":"Articles","previous_headings":"","what":"Changing parameter labels and order","title":"Modifying nlmixr2 models by piping","text":"aesthetic reasons, sometimes preferred update parameter labels order parameters. changes affect estimation parameters. affect output tables order parameters. using , can modify model model piping still desired output table format ready use report. example, can change label \"Ka\" \"Absorption rate\" follows: ka=exp(tka+eta.ka)cl=exp(tcl+eta.cl)v=exp(tv+eta.v)ddepotdt=−ka×depotdcenterdt=ka×depot−clv×centercp=centervcp∼add(add.sd)\\begin{align*} {ka} & = \\exp\\left({tka}+{eta.ka}\\right) \\\\ {cl} & = \\exp\\left({tcl}+{eta.cl}\\right) \\\\ {v} & = \\exp\\left({tv}+{eta.v}\\right) \\\\ \\frac{d \\: depot}{dt} & = -{ka} {\\times} {depot} \\\\ \\frac{d \\: center}{dt} & = {ka} {\\times} {depot}-\\frac{{cl}}{{v}} {\\times} {center} \\\\ {cp} & = \\frac{{center}}{{v}} \\\\ {cp} & \\sim add({add.sd}) \\end{align*} , ’d prefer volume come clearance parameter table (fit$parFixed), can change , . ka=exp(tka+eta.ka)cl=exp(tcl+eta.cl)v=exp(tv+eta.v)ddepotdt=−ka×depotdcenterdt=ka×depot−clv×centercp=centervcp∼add(add.sd)\\begin{align*} {ka} & = \\exp\\left({tka}+{eta.ka}\\right) \\\\ {cl} & = \\exp\\left({tcl}+{eta.cl}\\right) \\\\ {v} & = \\exp\\left({tv}+{eta.v}\\right) \\\\ \\frac{d \\: depot}{dt} & = -{ka} {\\times} {depot} \\\\ \\frac{d \\: center}{dt} & = {ka} {\\times} {depot}-\\frac{{cl}}{{v}} {\\times} {center} \\\\ {cp} & = \\frac{{center}}{{v}} \\\\ {cp} & \\sim add({add.sd}) \\end{align*} See documentation ini can modify parameters model piping.","code":"fit %>%   ini(     tka <- label(\"Absorption rate\")   ) fit %>%   ini(     tv <- label(\"Central volume\"),     append = \"tcl\"   )"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"changing-model-features","dir":"Articles","previous_headings":"","what":"Changing model features","title":"Modifying nlmixr2 models by piping","text":"developing models, often add remove subject variability parameters, add covariates effects, /change residual errors. can change lines model piping fit nlmixr model specification function model","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"adding-or-removing-between-subject-variability","dir":"Articles","previous_headings":"Changing model features","what":"Adding or Removing between subject variability","title":"Modifying nlmixr2 models by piping","text":"Often developing model add remove subject variability certain model parameters. example, remove subject variability ka parameter changing line model; example remove eta prior fit prior model specification function, simply pipe model function. can re-estimate piping nlmixr function . course also add eta parameter way; can see name change examining omega matrix: Note new subject variability parameters distinguished types parameters (ie population parameters, individual covariates) name. Parameters starting ending following names assumed subject variability parameters: eta (NONMEM convention) ppv (per patient variability) psv (per subject variability) iiv (inter-individual variability) bsv (subject variability) bpv (patient variability)","code":"## Remove eta.ka on ka noEta <- fit %>%     model(ka <- exp(tka)) %>%     nlmixr(est=\"focei\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(noEta) #> ── nlmixr² FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 176.5806 431.1804 448.4772      -209.5902        34.62689        7.136017 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002238 0.309299     0.3093  0.84     0.01 4.240163 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka           Ka 0.432  0.169   39       1.54 (1.11, 2.14)                      #> tcl           Cl 0.988  0.076 7.69       2.69 (2.32, 3.12)     30.8      8.66%  #> tv             V  3.48 0.0475 1.36       32.5 (29.6, 35.6)     15.3      6.89%  #> add.sd            1.02                                1.02                      #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Information about run found ($runInfo): #>    • gradient problems with initial estimate and covariance; see $scaleInfo  #>    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))  #>    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  #>   Censoring ($censInformation): No censoring #>   Minimization message ($message):   #>     relative convergence (4)  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 27 #>   ID     TIME    DV EPRED   ERES    NPDE    NPD    PDE    PD  PRED    RES   WRES #>   <fct> <dbl> <dbl> <dbl>  <dbl>   <dbl>  <dbl>  <dbl> <dbl> <dbl>  <dbl>  <dbl> #> 1 1      0     0.74 0.160  0.580  0.0753  0.486 0.53   0.687  0     0.74   0.725 #> 2 1      0.25  2.84 3.17  -0.331 -1.38   -0.245 0.0833 0.403  3.12 -0.275 -0.245 #> 3 1      0.57  6.57 5.67   0.904 -0.515   0.685 0.303  0.753  5.61  0.964  0.733 #> # ℹ 129 more rows #> # ℹ 15 more variables: IPRED <dbl>, IRES <dbl>, IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.cl <dbl>, eta.v <dbl>, depot <dbl>, #> #   center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, dosenum <dbl> addBackKa <- noEta %>%     model({ka <- exp(tka + bsv.ka)}) %>%     ini(bsv.ka=0.1) %>%     nlmixr(est=\"focei\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(addBackKa) #> ── nlmixr² FOCEi (outer: nlminb) ── #>  #>           OBJF     AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 116.9593 373.559 393.7387      -179.7795        55.36797        6.117935 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002167 0.480979    0.48098 0.852    0.011 6.542874 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka           Ka 0.488  0.231 47.3       1.63 (1.04, 2.56)     65.8     -2.82%  #> tcl           Cl  1.02  0.281 27.5        2.77 (1.6, 4.81)     27.4      6.24%  #> tv             V  3.46 0.0553  1.6       31.8 (28.5, 35.4)     14.8      13.4%  #> add.sd           0.695                               0.695                      #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Information about run found ($runInfo): #>    • gradient problems with initial estimate and covariance; see $scaleInfo  #>    • last objective function was not at minimum, possible problems in optimization  #>    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))  #>    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  #>   Censoring ($censInformation): No censoring #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 28 #>   ID     TIME    DV EPRED   ERES   NPDE    NPD   PDE    PD  PRED    RES   WRES #>   <fct> <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl>  <dbl>  <dbl> #> 1 1      0     0.74 0.109  0.631  0.431  0.878 0.667 0.81   0     0.74   1.06  #> 2 1      0.25  2.84 3.72  -0.882 -0.915 -0.314 0.18  0.377  3.33 -0.489 -0.268 #> 3 1      0.57  6.57 6.05   0.516 -1.28   0.279 0.1   0.61   5.92  0.653  0.272 #> # ℹ 129 more rows #> # ℹ 16 more variables: IPRED <dbl>, IRES <dbl>, IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.cl <dbl>, eta.v <dbl>, bsv.ka <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl> addBackKa$omega #>            eta.cl      eta.v    bsv.ka #> eta.cl 0.07247903 0.00000000 0.0000000 #> eta.v  0.00000000 0.02155343 0.0000000 #> bsv.ka 0.00000000 0.00000000 0.3599338"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"adding-covariate-effects","dir":"Articles","previous_headings":"Changing model features","what":"Adding Covariate effects","title":"Modifying nlmixr2 models by piping","text":"","code":"## Note currently cov is needed as a prefix so nlmixr knows this is an ## estimated parameter not a parameter wt70 <- fit %>%   model({cl <- exp(tcl + eta.cl)*(WT/70)^covWtPow}) %>%   ini(covWtPow=fix(0.75)) %>%   ini(tka=fix(0.5)) %>%   nlmixr(est=\"focei\", control=list(print=0),          table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(wt70) #> ── nlmixr² FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 116.2568 370.8565 388.1534      -179.4283         2.74697        2.743088 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002079 0.298057   0.298058 0.865    0.011 4.117806 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>          Parameter  Est.     SE  %RSE Back-transformed(95%CI) BSV(CV%) #> tka             Ka   0.5  FIXED FIXED                     0.5     70.5 #> tcl             Cl  1.03 0.0689  6.72       2.79 (2.44, 3.19)     26.4 #> tv               V  3.46 0.0707  2.04       31.7 (27.6, 36.4)     14.5 #> add.sd             0.693                                0.693          #> covWtPow            0.75  FIXED FIXED                    0.75          #>          Shrink(SD)% #> tka           2.11%  #> tcl           6.23%  #> tv            14.1%  #> add.sd               #> covWtPow             #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Information about run found ($runInfo): #>    • gradient problems with initial estimate and covariance; see $scaleInfo  #>    • last objective function was not at minimum, possible problems in optimization  #>    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))  #>    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  #>   Censoring ($censInformation): No censoring #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 29 #>   ID     TIME    DV EPRED   ERES   NPDE    NPD    PDE    PD  PRED    RES   WRES #>   <fct> <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl>  <dbl>  <dbl> #> 1 1      0     0.74 0.109  0.631  0.394  0.890 0.653  0.813  0     0.74   1.07  #> 2 1      0.25  2.84 3.72  -0.884 -0.332 -0.431 0.37   0.333  3.37 -0.529 -0.275 #> 3 1      0.57  6.57 6.03   0.537 -1.79   0.262 0.0367 0.603  5.96  0.608  0.242 #> # ℹ 129 more rows #> # ℹ 17 more variables: IPRED <dbl>, IRES <dbl>, IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>, WT <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"changing-residual-errors","dir":"Articles","previous_headings":"Changing model features","what":"Changing residual errors","title":"Modifying nlmixr2 models by piping","text":"Changing residual errors also just easy, simply specifying error wish change: much can piping. complete discussion see see rxode2 piping documentation. Since rxode2 nlmixr2 models can share functional form piping applies fits well model definitions.","code":"## Since there are 0 predictions in the data, these are changed to ## 0.0150 to show proportional error change. d <- theo_sd d$DV[d$EVID == 0 & d$DV == 0] <- 0.0150  addPropModel <- fit %>%     model({cp ~ add(add.err)+prop(prop.err)}) %>%     ini(prop.err=0.1) %>%     nlmixr(d,est=\"focei\",            control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(addPropModel) #> ── nlmixr² FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 104.4951 363.0949 386.1573      -173.5474        61.98699        8.664907 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002098 0.483998   0.483999 0.834     0.01 6.369905 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>          Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) #> tka             Ka 0.407  0.233 57.4       1.5 (0.951, 2.37)     69.5 #> tcl             Cl  1.02 0.0472 4.61       2.78 (2.54, 3.05)     26.5 #> tv               V  3.46 0.0737 2.13         32 (27.7, 36.9)     13.9 #> add.err            0.287                               0.287          #> prop.err           0.129                               0.129          #>          Shrink(SD)% #> tka           1.88%  #> tcl           3.17%  #> tv            17.3%  #> add.err              #> prop.err             #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Information about run found ($runInfo): #>    • gradient problems with initial estimate and covariance; see $scaleInfo  #>    • last objective function was not at minimum, possible problems in optimization  #>    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))  #>    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  #>   Censoring ($censInformation): No censoring #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 28 #>   ID     TIME    DV  EPRED   ERES   NPDE    NPD   PDE    PD  PRED    RES   WRES #>   <fct> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl>  <dbl>  <dbl> #> 1 1      0     0.74 0.0451  0.695  0.866  2.33  0.807 0.99   0     0.74   2.58  #> 2 1      0.25  2.84 3.42   -0.582 -0.654 -0.271 0.257 0.393  3.10 -0.258 -0.149 #> 3 1      0.57  6.57 5.73    0.844 -0.341  0.385 0.367 0.65   5.60  0.973  0.395 #> # ℹ 129 more rows #> # ℹ 16 more variables: IPRED <dbl>, IRES <dbl>, IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"multiple-endpoints","dir":"Articles","previous_headings":"","what":"Multiple endpoints","title":"Working with multiple endpoints","text":"Joint PK/PD models, PK/PD models fix certain components common pharmacometrics. classic example, (provided Tomoo Funaki Nick Holford) Warfarin. example, transit-compartment (depot gut central volume) PK model effect compartment PCA measurement. illustrated example model can applied data: Notice two endpoints model cp effect. modeled nlmixr using ~ “modeled ” specification. see nlmixr handle multiple compartment model, quite informative parse model print information model. case initial parsing give: ktr=exp(tktr+eta.ktr)ka=exp(tka+eta.ka)cl=exp(tcl+eta.cl)v=exp(tv+eta.v)emax=expit(temax+eta.emax,0,1)ec50=exp(tec50+eta.ec50)kout=exp(tkout+eta.kout)e0=exp(te0+eta.e0)DCP=centervPD=1−emax×DCP(ec50+DCP)effect(0)=e0kin=e0×koutddepotdt=−ktr×depotdgutdt=ktr×depot−ka×gutdcenterdt=ka×gut−clv×centerdeffectdt=kin×PD−kout×effectcp=centervcp∼prop(prop.err)+add(pkadd.err)effect∼add(pdadd.err)\\begin{align*} {ktr} & = \\exp\\left({tktr}+{eta.ktr}\\right) \\\\ {ka} & = \\exp\\left({tka}+{eta.ka}\\right) \\\\ {cl} & = \\exp\\left({tcl}+{eta.cl}\\right) \\\\ {v} & = \\exp\\left({tv}+{eta.v}\\right) \\\\ {emax} & = expit({temax}+{eta.emax}, {0}, {1}) \\\\ {ec50} & = \\exp\\left({tec50}+{eta.ec50}\\right) \\\\ {kout} & = \\exp\\left({tkout}+{eta.kout}\\right) \\\\ {e0} & = \\exp\\left({te0}+{eta.e0}\\right) \\\\ {DCP} & = \\frac{{center}}{{v}} \\\\ {PD} & = {1}-\\frac{{emax} {\\times} {DCP}}{\\left({ec50}+{DCP}\\right)} \\\\ effect({0}) & = {e0} \\\\ {kin} & = {e0} {\\times} {kout} \\\\ \\frac{d \\: depot}{dt} & = -{ktr} {\\times} {depot} \\\\ \\frac{d \\: gut}{dt} & = {ktr} {\\times} {depot}-{ka} {\\times} {gut} \\\\ \\frac{d \\: center}{dt} & = {ka} {\\times} {gut}-\\frac{{cl}}{{v}} {\\times} {center} \\\\ \\frac{d \\: effect}{dt} & = {kin} {\\times} {PD}-{kout} {\\times} {effect} \\\\ {cp} & = \\frac{{center}}{{v}} \\\\ {cp} & \\sim prop({prop.err})+add({pkadd.err}) \\\\ {effect} & \\sim add({pdadd.err}) \\end{align*} middle printout, shows data must formatted (using cmt dvid data items) allow nlmixr model multiple endpoint appropriately. course, interested can directly access information ui$multipleEndpoint. Notice cmt dvid items can use named variables directly either cmt dvid specification. flexible notation makes rename compartments run nlmixr model functions. thing note cp specified ODE compartment number compartments defined rxode2 part nlmixr model. cp defined compartment, related variable cp. last thing notice cmt items numbered cmt=5 cp cmt=4 effect even though specified model first cp cmt. ordering effect compartment rxode2 system. course cp related compartment center, may make sense pair cp center compartment. something want can specify compartment relate effect | operator. case change change, model updated : Notice case cmt variables numbered sequentially cp variable matches center compartment.","code":"library(nlmixr2) library(ggplot2) pk.turnover.emax <- function() {   ini({     tktr <- log(1)     tka <- log(1)     tcl <- log(0.1)     tv <- log(10)     ##     eta.ktr ~ 1     eta.ka ~ 1     eta.cl ~ 2     eta.v ~ 1     prop.err <- 0.1     pkadd.err <- 0.1     ##     temax <- logit(0.8)     #temax <- 7.5     tec50 <- log(0.5)     tkout <- log(0.05)     te0 <- log(100)     ##     eta.emax ~ .5     eta.ec50  ~ .5     eta.kout ~ .5     eta.e0 ~ .5     ##     pdadd.err <- 10   })   model({     ktr <- exp(tktr + eta.ktr)     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     ##     #poplogit = log(temax/(1-temax))     emax=expit(temax+eta.emax)     #logit=temax+eta.emax     ec50 =  exp(tec50 + eta.ec50)     kout = exp(tkout + eta.kout)     e0 = exp(te0 + eta.e0)     ##     DCP = center/v     PD=1-emax*DCP/(ec50+DCP)     ##     effect(0) = e0     kin = e0*kout     ##     d/dt(depot) = -ktr * depot     d/dt(gut) =  ktr * depot -ka * gut     d/dt(center) =  ka * gut - cl / v * center     d/dt(effect) = kin*PD -kout*effect     ##     cp = center / v     cp ~ prop(prop.err) + add(pkadd.err)     effect ~ add(pdadd.err)   }) } ui <- nlmixr(pk.turnover.emax) ui ui$multipleEndpoint #>     variable                   cmt                   dvid* #> 1     cp ~ …     cmt='cp' or cmt=5     dvid='cp' or dvid=1 #> 2 effect ~ … cmt='effect' or cmt=4 dvid='effect' or dvid=2 cp ~ prop(prop.err) + add(pkadd.err) cp ~ prop(prop.err) + add(pkadd.err) | center pk.turnover.emax2 <- function() {   ini({     tktr <- log(1)     tka <- log(1)     tcl <- log(0.1)     tv <- log(10)     ##     eta.ktr ~ 1     eta.ka ~ 1     eta.cl ~ 2     eta.v ~ 1     prop.err <- 0.1     pkadd.err <- 0.1     ##     temax <- logit(0.8)     tec50 <- log(0.5)     tkout <- log(0.05)     te0 <- log(100)     ##     eta.emax ~ .5     eta.ec50  ~ .5     eta.kout ~ .5     eta.e0 ~ .5     ##     pdadd.err <- 10   })   model({     ktr <- exp(tktr + eta.ktr)     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     ##     emax=expit(temax+eta.emax)     ec50 =  exp(tec50 + eta.ec50)     kout = exp(tkout + eta.kout)     e0 = exp(te0 + eta.e0)     ##     DCP = center/v     PD=1-emax*DCP/(ec50+DCP)     ##     effect(0) = e0     kin = e0*kout     ##     d/dt(depot) = -ktr * depot     d/dt(gut) =  ktr * depot -ka * gut     d/dt(center) =  ka * gut - cl / v * center     d/dt(effect) = kin*PD -kout*effect     ##     cp = center / v     cp ~ prop(prop.err) + add(pkadd.err) | center     effect ~ add(pdadd.err)   }) } ui2 <- nlmixr(pk.turnover.emax2) ui2$multipleEndpoint #>     variable                   cmt                   dvid* #> 1     cp ~ … cmt='center' or cmt=3 dvid='center' or dvid=1 #> 2 effect ~ … cmt='effect' or cmt=4 dvid='effect' or dvid=2"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"dvid-vs-cmt-which-one-is-used","dir":"Articles","previous_headings":"Multiple endpoints","what":"DVID vs CMT, which one is used","title":"Working with multiple endpoints","text":"dvid cmt combined dataset, cmt data item always used event information dvid used observations. nlmixr expects cmt data item match dvid item observations either zero one dvid replace cmt information. wish use dvid items define multiple endpoints nlmixr, can set following option: cmt items used multiple endpoint models. course can turn different models wish:","code":"options(rxode2.combine.dvid=FALSE) ui2$multipleEndpoint #>     variable                   cmt #> 1     cp ~ … cmt='center' or cmt=3 #> 2 effect ~ … cmt='effect' or cmt=4 options(rxode2.combine.dvid=TRUE) ui2$multipleEndpoint #>     variable                   cmt                   dvid* #> 1     cp ~ … cmt='center' or cmt=3 dvid='center' or dvid=1 #> 2 effect ~ … cmt='effect' or cmt=4 dvid='effect' or dvid=2"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"running-a-multiple-endpoint-model","dir":"Articles","previous_headings":"Multiple endpoints","what":"Running a multiple endpoint model","title":"Working with multiple endpoints","text":"information, can use built-warfarin dataset nlmixr2: Since dvid specifies pca effect endpoint, can update model explicit making one last change: ","code":"summary(warfarin) #>        id             time             amt                dv          dvid     #>  Min.   : 1.00   Min.   :  0.00   Min.   :  0.000   Min.   :  0.00   cp :283   #>  1st Qu.: 8.00   1st Qu.: 24.00   1st Qu.:  0.000   1st Qu.:  4.50   pca:232   #>  Median :15.00   Median : 48.00   Median :  0.000   Median : 11.40             #>  Mean   :16.08   Mean   : 52.08   Mean   :  6.524   Mean   : 20.02             #>  3rd Qu.:24.00   3rd Qu.: 96.00   3rd Qu.:  0.000   3rd Qu.: 26.00             #>  Max.   :33.00   Max.   :144.00   Max.   :153.000   Max.   :100.00             #>       evid               wt              age            sex      #>  Min.   :0.00000   Min.   : 40.00   Min.   :21.00   female:101   #>  1st Qu.:0.00000   1st Qu.: 60.00   1st Qu.:23.00   male  :414   #>  Median :0.00000   Median : 70.00   Median :28.00                #>  Mean   :0.06214   Mean   : 69.27   Mean   :31.85                #>  3rd Qu.:0.00000   3rd Qu.: 78.00   3rd Qu.:36.00                #>  Max.   :1.00000   Max.   :102.00   Max.   :63.00 cp ~ prop(prop.err) + add(pkadd.err) effect ~ add(pdadd.err) cp ~ prop(prop.err) + add(pkadd.err) effect ~ add(pdadd.err)  | pca pk.turnover.emax3 <- function() {   ini({     tktr <- log(1)     tka <- log(1)     tcl <- log(0.1)     tv <- log(10)     ##     eta.ktr ~ 1     eta.ka ~ 1     eta.cl ~ 2     eta.v ~ 1     prop.err <- 0.1     pkadd.err <- 0.1     ##     temax <- logit(0.8)     tec50 <- log(0.5)     tkout <- log(0.05)     te0 <- log(100)     ##     eta.emax ~ .5     eta.ec50  ~ .5     eta.kout ~ .5     eta.e0 ~ .5     ##     pdadd.err <- 10   })   model({     ktr <- exp(tktr + eta.ktr)     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     emax = expit(temax+eta.emax)     ec50 =  exp(tec50 + eta.ec50)     kout = exp(tkout + eta.kout)     e0 = exp(te0 + eta.e0)     ##     DCP = center/v     PD=1-emax*DCP/(ec50+DCP)     ##     effect(0) = e0     kin = e0*kout     ##     d/dt(depot) = -ktr * depot     d/dt(gut) =  ktr * depot -ka * gut     d/dt(center) =  ka * gut - cl / v * center     d/dt(effect) = kin*PD -kout*effect     ##     cp = center / v     cp ~ prop(prop.err) + add(pkadd.err)     effect ~ add(pdadd.err) | pca   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"run-the-models-with-saem","dir":"Articles","previous_headings":"Multiple endpoints","what":"Run the models with SAEM","title":"Working with multiple endpoints","text":"","code":"fit.TOS <- nlmixr(pk.turnover.emax3, warfarin, \"saem\", control=list(print=0),                   table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  print(fit.TOS) #> ── nlmixr² SAEM OBJF by FOCEi approximation ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 1384.332 2310.026 2389.447      -1136.013        3858.333        21.90437 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance    saem  table compress #> elapsed 0.002528    7e-06   0.046018 105.996 15.559    0.023 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>              Est.     SE  %RSE Back-transformed(95%CI) BSV(CV% or SD) #> tktr        0.439  0.557   127      1.55 (0.521, 4.62)           110. #> tka        -0.262  0.279   107      0.77 (0.445, 1.33)           13.4 #> tcl         -1.97 0.0515  2.62     0.14 (0.126, 0.155)           26.8 #> tv           2.01 0.0483  2.41       7.43 (6.76, 8.17)           21.7 #> prop.err     0.12                                 0.12                #> pkadd.err   0.805                                0.805                #> temax        3.44  0.694  20.2    0.969 (0.889, 0.992)          0.251 #> tec50     -0.0938  0.146   155      0.91 (0.684, 1.21)           45.9 #> tkout       -2.94 0.0384  1.31 0.0531 (0.0492, 0.0572)           5.97 #> te0          4.57 0.0116 0.253       96.6 (94.4, 98.8)           5.29 #> pdadd.err     3.6                                  3.6                #>           Shrink(SD)% #> tktr           44.2%  #> tka            81.7%  #> tcl            6.72%  #> tv             15.9%  #> prop.err              #> pkadd.err             #> temax          81.3%  #> tec50          9.87%  #> tkout          45.6%  #> te0            17.1%  #> pdadd.err             #>   #>   Covariance Type ($covMethod): linFim #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Censoring ($censInformation): No censoring #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 483 × 44 #>   ID     TIME CMT      DV EPRED  ERES  NPDE    NPD    PDE     PD  PRED   RES #>   <fct> <dbl> <fct> <dbl> <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl> #> 1 1       0.5 cp      0    1.76 -1.76 -1.79 -1.50  0.0367 0.0667  1.38 -1.38 #> 2 1       1   cp      1.9  4.06 -2.16  1.75 -0.954 0.96   0.17    3.87 -1.97 #> 3 1       2   cp      3.3  7.93 -4.63 -1.99 -1.71  0.0233 0.0433  8.18 -4.88 #> # ℹ 480 more rows #> # ℹ 32 more variables: WRES <dbl>, IPRED <dbl>, IRES <dbl>, IWRES <dbl>, #> #   CPRED <dbl>, CRES <dbl>, CWRES <dbl>, eta.ktr <dbl>, eta.ka <dbl>, #> #   eta.cl <dbl>, eta.v <dbl>, eta.emax <dbl>, eta.ec50 <dbl>, eta.kout <dbl>, #> #   eta.e0 <dbl>, depot <dbl>, gut <dbl>, center <dbl>, effect <dbl>, #> #   ktr <dbl>, ka <dbl>, cl <dbl>, v <dbl>, emax <dbl>, ec50 <dbl>, kout <dbl>, #> #   e0 <dbl>, DCP <dbl>, PD.1 <dbl>, kin <dbl>, tad <dbl>, dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"saem-diagnostic-plots","dir":"Articles","previous_headings":"Multiple endpoints > Run the models with SAEM","what":"SAEM Diagnostic plots","title":"Working with multiple endpoints","text":"","code":"plot(fit.TOS) v1s <- vpcPlot(fit.TOS, show=list(obs_dv=TRUE), scales=\"free_y\") +   ylab(\"Warfarin Cp [mg/L] or PCA\") +   xlab(\"Time [h]\")  v2s <- vpcPlot(fit.TOS, show=list(obs_dv=TRUE), pred_corr = TRUE) +   ylab(\"Prediction Corrected Warfarin Cp [mg/L] or PCA\") +   xlab(\"Time [h]\")  v1s v2s"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"focei-fits","dir":"Articles","previous_headings":"Multiple endpoints","what":"FOCEi fits","title":"Working with multiple endpoints","text":"","code":"## FOCEi fit/vpcs fit.TOF <- nlmixr(pk.turnover.emax3, warfarin, \"focei\", control=list(print=0),                   table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:01:18  #> done"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"focei-diagnostic-plots","dir":"Articles","previous_headings":"Multiple endpoints > FOCEi fits","what":"FOCEi Diagnostic Plots","title":"Working with multiple endpoints","text":"","code":"print(fit.TOF) #> ── nlmixr² FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 1409.421 2335.116 2414.536      -1148.558        32318.05        93.02754 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002741 78.19015   78.19016 1.687     0.01 38.82195 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>            Est.     SE     %RSE Back-transformed(95%CI) BSV(CV% or SD) #> tktr      0.104    2.2 2.11e+03      1.11 (0.015, 82.2)           101. #> tka       0.302   2.18      723       1.35 (0.0188, 97)           120. #> tcl       -2.04  0.109     5.36     0.13 (0.105, 0.162)           27.3 #> tv         2.06 0.0916     4.44       7.87 (6.57, 9.42)           22.4 #> prop.err  0.148                                   0.148                #> pkadd.err 0.172                                   0.172                #> temax      4.75    6.2      130     0.991 (0.000614, 1)          0.590 #> tec50     0.157  0.229      146      1.17 (0.747, 1.83)           47.7 #> tkout     -2.93  0.128     4.36 0.0534 (0.0416, 0.0686)           15.4 #> te0        4.57 0.0399    0.874          96.3 (89, 104)           10.3 #> pdadd.err  3.76                                    3.76                #>           Shrink(SD)% #> tktr           62.3%  #> tka            60.6%  #> tcl         -0.0757%  #> tv             10.3%  #> prop.err              #> pkadd.err             #> temax          95.1%  #> tec50          5.19%  #> tkout          32.3%  #> te0            39.6%  #> pdadd.err             #>   #>   Covariance Type ($covMethod): s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Information about run found ($runInfo): #>    • gradient problems with initial estimate and covariance; see $scaleInfo  #>    • using S matrix to calculate covariance, can check sandwich or R matrix with $covRS and $covR  #>    • last objective function was not at minimum, possible problems in optimization  #>    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))  #>    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  #>   Censoring ($censInformation): No censoring #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 483 × 44 #>   ID     TIME CMT      DV EPRED  ERES  NPDE    NPD    PDE    PD  PRED   RES #>   <fct> <dbl> <fct> <dbl> <dbl> <dbl> <dbl>  <dbl>  <dbl> <dbl> <dbl> <dbl> #> 1 1       0.5 cp      0    2.22 -2.22 -1.48 -2.33  0.07   0.01   1.59 -1.59 #> 2 1       1   cp      1.9  4.67 -2.77  1.88 -0.795 0.97   0.213  4.36 -2.46 #> 3 1       2   cp      3.3  7.92 -4.62 -2.13 -1.19  0.0167 0.117  8.76 -5.46 #> # ℹ 480 more rows #> # ℹ 32 more variables: WRES <dbl>, IPRED <dbl>, IRES <dbl>, IWRES <dbl>, #> #   CPRED <dbl>, CRES <dbl>, CWRES <dbl>, eta.ktr <dbl>, eta.ka <dbl>, #> #   eta.cl <dbl>, eta.v <dbl>, eta.emax <dbl>, eta.ec50 <dbl>, eta.kout <dbl>, #> #   eta.e0 <dbl>, depot <dbl>, gut <dbl>, center <dbl>, effect <dbl>, #> #   ktr <dbl>, ka <dbl>, cl <dbl>, v <dbl>, emax <dbl>, ec50 <dbl>, kout <dbl>, #> #   e0 <dbl>, DCP <dbl>, PD.1 <dbl>, kin <dbl>, tad <dbl>, dosenum <dbl> plot(fit.TOF) v1f <- vpcPlot(fit.TOF, show=list(obs_dv=TRUE), scales=\"free_y\") +   ylab(\"Warfarin Cp [mg/L] or PCA\") +   xlab(\"Time [h]\")  v2f <- vpcPlot(fit.TOF, show=list(obs_dv=TRUE), pred_corr = TRUE) +   ylab(\"Prediction Corrected Warfarin Cp [mg/L] or PCA\") +   xlab(\"Time [h]\")  v1f v2f"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/nimo.html","id":"nlmixr-model","dir":"Articles","previous_headings":"","what":"nlmixr model","title":"Nimotuzumab","text":"","code":"library(nlmixr2) library(xpose) library(xpose.nlmixr2) library(ggplot2)  nimo <- function() {   ini({     ## Note that the UI can take expressions     ## Also note that these initial estimates should be provided on the log-scale     tcl <- log(0.001)     tv1 <- log(1.45)     tQ <- log(0.004)     tv2 <- log(44)     tkss <- log(12)     tkint <- log(0.3)     tksyn <- log(1)     tkdeg <- log(7)     ## Initial estimates should be high for SAEM ETAs     eta.cl  ~ 2     eta.v1  ~ 2     eta.kss ~ 2     ##  Also true for additive error (also ignored in SAEM)     add.err <- 10   })   model({     cl <- exp(tcl + eta.cl)     v1 <- exp(tv1 + eta.v1)     Q  <- exp(tQ)     v2 <- exp(tv2)     kss <- exp(tkss + eta.kss)     kint <- exp(tkint)     ksyn <- exp(tksyn)     kdeg <- exp(tkdeg)      k <- cl/v1     k12 <- Q/v1     k21 <- Q/v2      eff(0) <- ksyn/kdeg ##initializing compartment      ## Concentration is calculated     conc = 0.5*(central/v1-eff-kss)+0.5*sqrt((central/v1-eff-kss)**2+4*kss*central/v1)      d/dt(central)  = -(k+k12)*conc*v1+k21*peripheral-kint*eff*conc*v1/(kss+conc)     d/dt(peripheral) = k12*conc*v1-k21*peripheral  ##Free Drug second compartment amount     d/dt(eff) = ksyn - kdeg*eff - (kint-kdeg)*conc*eff/(kss+conc)      IPRED=log(conc)      IPRED ~ add(add.err)   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/nimo.html","id":"fit","dir":"Articles","previous_headings":"","what":"Fit","title":"Nimotuzumab","text":"","code":"fit <- nlmixr(nimo, nimoData, est=\"saem\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> 001: -6.914482   0.016474    -5.493299   3.953329    2.781526    -1.308564   -0.246181   2.169817    1.900000    1.900000    2.449522    1.484619     #> 002: -6.819436   0.343715    -5.470699   3.814344    3.002895    -1.190431   -0.374498   2.301739    1.805000    1.805000    2.327046    0.802331     #> 003: -6.582867   0.353952    -5.512010   3.801872    2.952968    -1.306888   -0.245627   2.338586    1.714750    1.714750    2.210693    0.705040     #> 004: -6.728009   0.289825    -5.339309   3.975293    2.845173    -1.626509   -0.332403   2.301086    1.629012    1.629012    2.100159    0.680643     #> 005: -6.618628   0.356340    -5.324386   4.103812    2.871893    -1.504798   -0.291670   2.145594    1.547562    1.547562    1.995151    0.664037     #> 006: -6.837136   0.348125    -5.241727   4.200836    2.748498    -1.585960   -0.238234   2.176533    1.470184    1.470184    1.896834    0.667170     #> 007: -6.741281   0.250508    -5.291013   4.178116    2.849688    -1.532423   -0.410910   2.207508    1.396675    1.396675    1.801992    0.666620     #> 008: -6.855104   0.287385    -5.320877   4.114158    2.710457    -1.625941   -0.286789   2.223673    1.395116    1.326841    2.001486    0.660569     #> 009: -6.530282   0.273822    -5.378142   3.913521    2.831565    -1.567159   -0.132779   2.117732    1.325360    1.260499    1.901411    0.656455     #> 010: -6.661594   0.384447    -5.403747   3.816714    2.854113    -1.538320   -0.103166   2.217243    1.259092    1.197474    1.806341    0.657697     #> 011: -6.684598   0.329975    -5.399798   3.828264    2.940350    -1.545483   -0.010219   2.314174    1.234165    1.137600    1.716024    0.667492     #> 012: -6.588625   0.359245    -5.300847   3.793875    3.044952    -1.562746   0.085883    2.391274    1.330653    1.080720    1.933127    0.662020     #> 013: -6.704110   0.345852    -5.394675   3.804468    3.060335    -1.523339   0.102024    2.370731    1.264121    1.026684    1.861993    0.661558     #> 014: -6.729996   0.284292    -5.364095   3.860207    3.111585    -1.396802   0.073807    2.215396    1.412781    0.975350    1.768893    0.661614     #> 015: -6.818633   0.240150    -5.369279   4.035203    2.996029    -1.467952   0.132409    2.283729    1.463639    0.926582    1.680449    0.655655     #> 016: -6.918713   0.299213    -5.383584   4.082332    3.067859    -1.324230   0.040918    2.200035    1.487904    0.880253    1.596426    0.669805     #> 017: -6.809761   0.295317    -5.401558   3.844066    3.095869    -1.344422   0.145221    2.127343    1.413509    0.836241    1.516605    0.673400     #> 018: -6.865311   0.313463    -5.334817   3.819778    3.101805    -1.390841   0.141473    2.149978    1.342833    0.794429    1.440775    0.671659     #> 019: -6.846406   0.281306    -5.340926   3.669133    3.084536    -1.300504   0.133551    2.168557    1.275691    0.754707    1.368736    0.667459     #> 020: -6.849124   0.279594    -5.308830   3.736926    2.957913    -1.358374   0.232499    2.182700    1.211907    0.716972    1.300299    0.668514     #> 021: -7.061192   0.267195    -5.320240   3.698222    2.790875    -1.370177   0.266964    2.322090    1.151312    0.681123    1.235284    0.662466     #> 022: -7.224031   0.321864    -5.240993   3.794683    2.804530    -1.469822   0.278856    2.373900    1.475546    0.647067    1.173520    0.668582     #> 023: -7.233900   0.270104    -5.218276   3.744525    2.791887    -1.434262   0.254848    2.335459    1.401768    0.614714    1.114844    0.663759     #> 024: -7.229964   0.250526    -5.269407   3.706237    2.799937    -1.386859   0.185029    2.287496    1.433516    0.583978    1.113109    0.664701     #> 025: -7.105193   0.275289    -5.160335   3.861715    2.756977    -1.501375   0.174402    2.288972    1.361840    0.554779    1.057454    0.664838     #> 026: -7.191734   0.289017    -5.213754   3.837710    2.768048    -1.482197   0.143706    2.250098    1.293748    0.527040    1.004581    0.663593     #> 027: -7.111995   0.247283    -5.234289   3.863042    2.690533    -1.534585   0.189780    2.255539    1.229061    0.500688    0.954352    0.660438     #> 028: -7.137182   0.317031    -5.326907   3.936494    2.643802    -1.498281   0.162903    2.221112    1.287245    0.475654    0.906634    0.664100     #> 029: -7.065910   0.298181    -5.301461   4.129367    2.651502    -1.496702   0.176391    2.258657    1.531178    0.451871    1.142894    0.671430     #> 030: -7.081589   0.279400    -5.288630   4.041575    2.540978    -1.538153   0.189543    2.301692    1.454619    0.429278    1.085750    0.664394     #> 031: -7.345401   0.280522    -5.285089   3.856727    2.501656    -1.456653   0.123601    2.244742    1.582745    0.407814    1.031462    0.671167     #> 032: -7.330787   0.284799    -5.293881   3.732114    2.417886    -1.400980   0.205017    2.229669    1.503608    0.387423    0.979889    0.669425     #> 033: -7.224964   0.302803    -5.350354   3.672262    2.441714    -1.393232   0.313490    2.257816    1.601775    0.368052    0.930895    0.666949     #> 034: -7.175344   0.301502    -5.313417   3.580642    2.559157    -1.516492   0.285321    2.163593    1.755554    0.349649    0.884350    0.665502     #> 035: -7.150417   0.329565    -5.314110   3.578594    2.628034    -1.546253   0.243321    2.176913    1.667776    0.332167    0.908735    0.671639     #> 036: -6.918253   0.249159    -5.254137   3.631880    2.710284    -1.549101   0.187823    2.175748    1.584387    0.315558    0.863298    0.666407     #> 037: -7.091180   0.228291    -5.209337   3.554362    2.798050    -1.540088   0.209591    2.169958    1.634782    0.299781    0.820133    0.662823     #> 038: -7.095036   0.286148    -5.251850   3.586294    2.735655    -1.446276   0.232623    2.153432    2.053092    0.284791    0.779127    0.658274     #> 039: -7.113119   0.287339    -5.261290   3.558021    2.655369    -1.407257   0.179161    2.172111    1.950437    0.302287    0.740170    0.663073     #> 040: -7.162952   0.364008    -5.230255   3.576343    2.719708    -1.466499   0.182905    2.165589    2.269271    0.305775    0.703162    0.666826     #> 041: -7.263707   0.292009    -5.220779   3.531752    2.622960    -1.437846   0.181075    2.176548    2.348641    0.290487    0.668004    0.671097     #> 042: -7.226501   0.264484    -5.260884   3.476615    2.652070    -1.398807   0.179380    2.088141    2.231209    0.275962    0.634604    0.671719     #> 043: -7.087759   0.305624    -5.306365   3.514786    2.589153    -1.334986   0.134143    1.989949    2.119648    0.262164    0.602873    0.658616     #> 044: -7.231224   0.289672    -5.357232   3.461051    2.533159    -1.312052   0.158429    1.982562    2.013666    0.249056    0.572730    0.656291     #> 045: -7.163111   0.315924    -5.325022   3.542982    2.582322    -1.294601   0.104496    1.906099    1.912982    0.236603    0.643810    0.666197     #> 046: -7.313343   0.268235    -5.292604   3.483319    2.565969    -1.161746   0.059350    1.872730    1.817333    0.227179    0.766983    0.662443     #> 047: -7.071555   0.286481    -5.319568   3.441684    2.789278    -1.148521   0.052185    1.815530    1.726467    0.215820    0.959460    0.661594     #> 048: -7.047720   0.310923    -5.363941   3.501217    2.836546    -1.044215   -0.000468   1.805442    1.640143    0.205029    1.013723    0.666942     #> 049: -7.044512   0.377444    -5.325346   3.480065    2.918906    -1.071962   0.049540    1.814141    1.826520    0.213857    0.963037    0.666954     #> 050: -6.997297   0.340865    -5.245277   3.542043    3.078940    -1.216829   0.022206    1.830944    1.854632    0.251955    1.011387    0.663225     #> 051: -7.043409   0.305549    -5.211207   3.557447    3.007410    -1.268743   0.040444    1.803441    1.761900    0.239358    0.960818    0.667913     #> 052: -7.073907   0.360382    -5.306185   3.688925    3.090221    -1.319321   0.083892    1.758843    1.864628    0.227390    0.960415    0.674531     #> 053: -7.240278   0.299172    -5.321606   3.731697    2.993008    -1.428530   0.124909    1.801623    2.038873    0.237377    0.947057    0.672320     #> 054: -7.172902   0.356635    -5.317032   3.715849    3.064195    -1.367736   0.113503    1.749145    1.936930    0.283826    0.899704    0.662308     #> 055: -7.172379   0.359853    -5.341980   3.784723    3.012051    -1.438815   0.149270    1.758675    1.840083    0.300613    0.854719    0.660637     #> 056: -7.219676   0.382484    -5.307379   3.856501    2.987322    -1.424209   0.114850    1.725127    1.796002    0.285583    0.811983    0.662091     #> 057: -7.588019   0.382999    -5.380854   3.879877    2.942696    -1.423378   0.117995    1.712175    2.008233    0.271303    0.771384    0.662284     #> 058: -7.639869   0.414939    -5.299922   3.810096    2.966009    -1.439728   0.101300    1.685914    2.088644    0.271681    0.732815    0.663788     #> 059: -7.839156   0.381269    -5.459183   3.773137    2.834983    -1.381692   0.119364    1.644283    2.152469    0.280777    0.696174    0.657387     #> 060: -7.655245   0.345142    -5.601210   3.727992    2.873847    -1.254458   0.131665    1.596283    2.044846    0.266738    0.661365    0.667663     #> 061: -7.707903   0.406734    -5.624838   3.773104    2.937255    -1.271140   0.117227    1.606912    2.000826    0.253648    0.643277    0.672645     #> 062: -7.675870   0.346736    -5.500956   3.814468    2.895095    -1.250650   0.132157    1.670900    2.132835    0.240966    0.634200    0.669149     #> 063: -7.670482   0.318380    -5.440615   3.818260    2.866578    -1.296139   0.138641    1.699365    2.026193    0.228917    0.607845    0.665058     #> 064: -7.431745   0.337815    -5.453761   3.865966    2.897381    -1.360831   0.124382    1.651176    1.924884    0.233984    0.577453    0.663534     #> 065: -7.529399   0.323797    -5.471688   3.798697    2.843363    -1.428387   0.116370    1.643224    2.041775    0.222285    0.548580    0.654007     #> 066: -7.325511   0.344051    -5.386737   3.778785    2.789880    -1.460946   0.096865    1.679771    2.006639    0.233688    0.521151    0.660227     #> 067: -7.330396   0.387743    -5.378663   3.769411    2.868637    -1.481350   0.083651    1.654957    1.906307    0.231272    0.510413    0.660347     #> 068: -7.339606   0.278427    -5.283691   3.753403    2.838913    -1.543627   0.084818    1.639113    1.810992    0.219708    0.484892    0.659440     #> 069: -7.285998   0.325719    -5.328522   3.748840    2.835668    -1.557553   0.092835    1.609421    1.720442    0.235109    0.499206    0.662063     #> 070: -7.232980   0.208826    -5.433208   3.663195    2.783737    -1.543189   0.085950    1.547160    1.634420    0.231917    0.474246    0.660770     #> 071: -7.381829   0.257745    -5.397206   3.643190    2.659883    -1.498516   0.069657    1.533203    1.552699    0.232615    0.450534    0.661169     #> 072: -7.266482   0.244138    -5.375615   3.676924    2.712292    -1.517724   0.042189    1.522265    1.695883    0.220984    0.428007    0.667300     #> 073: -7.145767   0.288511    -5.284307   3.658542    2.744943    -1.525432   0.095375    1.516115    1.842879    0.220219    0.406607    0.661996     #> 074: -7.188289   0.299592    -5.319425   3.681416    2.834873    -1.519843   0.137359    1.530411    1.907210    0.209208    0.400598    0.666512     #> 075: -7.243984   0.311252    -5.368692   3.691760    2.917381    -1.481587   0.149748    1.544855    1.856001    0.231087    0.416226    0.667799     #> 076: -7.103642   0.339213    -5.362342   3.635621    2.887099    -1.462164   0.122680    1.518757    1.763201    0.248580    0.395415    0.658367     #> 077: -7.112888   0.314604    -5.350759   3.688364    2.854637    -1.459558   0.154870    1.554377    1.675041    0.236151    0.380255    0.670290     #> 078: -7.209884   0.305611    -5.477977   3.704058    2.907212    -1.499042   0.165185    1.517499    1.962122    0.258664    0.361243    0.665738     #> 079: -7.093237   0.353882    -5.426122   3.657542    2.915020    -1.506303   0.159974    1.553805    1.864016    0.267238    0.386769    0.660540     #> 080: -6.912129   0.327524    -5.510560   3.691050    2.931850    -1.474556   0.135650    1.570071    1.770815    0.253876    0.373227    0.665780     #> 081: -7.011220   0.303175    -5.423123   3.804970    2.858132    -1.509481   0.145057    1.575275    1.682274    0.247051    0.444266    0.663041     #> 082: -7.207427   0.343244    -5.526908   3.750491    2.801898    -1.550669   0.182372    1.527566    1.598161    0.234698    0.422053    0.668174     #> 083: -7.120697   0.355271    -5.609807   3.825232    2.778279    -1.510526   0.133588    1.552264    1.518253    0.222963    0.478913    0.668248     #> 084: -7.183620   0.330008    -5.556814   3.883674    2.645653    -1.520276   0.133748    1.566389    1.442340    0.215284    0.454967    0.672353     #> 085: -7.574003   0.354428    -5.486883   3.912608    2.566221    -1.548326   0.177366    1.591621    1.370223    0.221744    0.432219    0.663256     #> 086: -7.613886   0.283195    -5.450051   3.792734    2.523406    -1.573365   0.212699    1.645456    1.301712    0.210657    0.528409    0.659078     #> 087: -7.580677   0.265828    -5.484501   3.909558    2.472463    -1.589409   0.200232    1.617358    1.236626    0.200124    0.501988    0.669928     #> 088: -7.658087   0.265950    -5.563201   3.922337    2.549615    -1.590849   0.227490    1.584981    1.376016    0.202271    0.509928    0.675766     #> 089: -7.615280   0.336141    -5.577240   4.002995    2.644322    -1.600905   0.219738    1.585023    1.307216    0.210631    0.593184    0.660534     #> 090: -7.556934   0.334487    -5.543477   4.068602    2.615642    -1.624460   0.218679    1.581273    1.241855    0.276291    0.563525    0.663667     #> 091: -7.544171   0.396360    -5.526697   4.013822    2.618521    -1.656577   0.224565    1.561843    1.179762    0.311947    0.569798    0.666616     #> 092: -7.577851   0.386912    -5.481723   3.992882    2.631167    -1.651791   0.169301    1.552511    1.120774    0.360128    0.742735    0.663697     #> 093: -7.635376   0.340918    -5.465015   3.903458    2.671358    -1.619445   0.125568    1.543128    1.064735    0.342122    0.948491    0.669139     #> 094: -7.753070   0.377136    -5.467659   3.770711    2.587448    -1.625564   0.130815    1.548841    1.011499    0.335252    0.901067    0.663105     #> 095: -7.864931   0.360429    -5.433170   3.760934    2.509518    -1.657168   0.095246    1.550648    1.030129    0.318489    0.856014    0.665222     #> 096: -7.780223   0.314070    -5.417875   3.725360    2.446114    -1.666749   0.103289    1.572967    1.033704    0.302565    0.813213    0.666981     #> 097: -7.621180   0.313678    -5.511474   3.738421    2.461147    -1.671815   0.071346    1.530011    0.982019    0.304409    0.772552    0.651483     #> 098: -7.753332   0.402724    -5.496057   3.773790    2.406169    -1.686588   0.063194    1.552017    0.932918    0.302956    0.733925    0.662169     #> 099: -7.730195   0.420811    -5.309360   3.803750    2.523807    -1.709883   0.047775    1.572759    0.886272    0.303144    0.697228    0.668703     #> 100: -7.673505   0.347550    -5.297369   3.804835    2.594129    -1.687138   0.069714    1.543184    0.841958    0.296905    0.685734    0.668012     #> 101: -7.590033   0.336415    -5.340594   3.843439    2.595867    -1.732812   0.070029    1.510660    0.799860    0.282059    0.729189    0.666109     #> 102: -7.536486   0.324112    -5.350863   3.857390    2.561865    -1.748387   0.084014    1.487371    0.759867    0.267957    0.847870    0.661980     #> 103: -7.519646   0.269210    -5.300323   3.883000    2.544636    -1.733365   0.069103    1.536515    0.721874    0.254559    1.126673    0.667395     #> 104: -7.715542   0.261755    -5.264686   3.810420    2.517687    -1.715137   0.090898    1.499392    0.685780    0.241831    1.070339    0.666428     #> 105: -7.561154   0.307131    -5.250161   3.820197    2.700990    -1.753600   0.079310    1.507287    0.651491    0.245273    1.155401    0.672682     #> 106: -7.605518   0.269108    -5.233835   3.775668    2.800074    -1.664324   0.043972    1.502847    0.618917    0.271829    1.310986    0.669825     #> 107: -7.518702   0.254964    -5.292088   3.905229    2.664754    -1.666309   0.030991    1.499479    0.619284    0.258238    1.245436    0.672548     #> 108: -7.493037   0.327960    -5.309814   3.927044    2.640432    -1.668852   0.009886    1.483506    0.588320    0.245326    1.292697    0.668058     #> 109: -7.361666   0.299332    -5.246063   3.928822    2.838836    -1.665274   -0.015314   1.497702    0.558904    0.233060    1.742785    0.661541     #> 110: -7.295420   0.324685    -5.250351   3.891413    2.851265    -1.692870   0.000274    1.486403    0.530959    0.263463    1.655646    0.664391     #> 111: -7.388781   0.327422    -5.276343   3.876659    2.827125    -1.662853   -0.002417   1.451375    0.504411    0.266527    1.572864    0.660158     #> 112: -7.315082   0.287329    -5.329679   3.822851    2.796913    -1.621366   0.002984    1.450101    0.535833    0.283879    1.494220    0.652598     #> 113: -7.210165   0.325424    -5.250378   3.767372    2.797469    -1.646338   0.015555    1.483660    0.513687    0.269685    1.419509    0.658716     #> 114: -7.229060   0.311440    -5.283707   3.828202    2.701979    -1.638494   0.030416    1.496578    0.705375    0.256201    1.348534    0.660667     #> 115: -7.182975   0.278153    -5.209097   3.775709    2.774494    -1.642455   0.045452    1.501060    0.670106    0.254576    1.286011    0.667253     #> 116: -7.202891   0.198060    -5.190446   3.794787    2.846953    -1.666827   0.038917    1.495475    0.636601    0.243178    1.501925    0.666128     #> 117: -7.329950   0.242328    -5.235329   3.839577    2.723103    -1.670512   0.017016    1.499066    0.604771    0.297675    1.426829    0.672605     #> 118: -7.368418   0.292244    -5.219909   3.744965    2.557378    -1.618824   0.033437    1.502116    0.574532    0.282791    1.355487    0.663629     #> 119: -7.214748   0.319861    -5.259522   3.693077    2.567002    -1.654345   0.053655    1.520610    0.545806    0.268652    1.287713    0.667974     #> 120: -7.356994   0.350210    -5.309903   3.714522    2.674943    -1.668949   0.032518    1.520104    0.536936    0.255219    1.223327    0.674938     #> 121: -7.310281   0.325514    -5.336143   3.782335    2.730752    -1.681865   0.072384    1.521064    0.510090    0.242458    1.368272    0.675528     #> 122: -7.343814   0.299105    -5.464185   3.798791    2.580431    -1.638865   0.034002    1.513645    0.537844    0.230335    1.422966    0.673910     #> 123: -7.297533   0.309766    -5.395394   3.860489    2.618419    -1.626384   0.030686    1.514271    0.510952    0.233347    1.351817    0.671054     #> 124: -7.193157   0.364008    -5.390127   3.826152    2.522587    -1.648797   0.031153    1.519168    0.485404    0.251616    1.464952    0.665486     #> 125: -7.218728   0.314165    -5.297563   3.791521    2.509877    -1.683403   0.002274    1.563709    0.461134    0.239035    1.481559    0.676300     #> 126: -7.160883   0.315493    -5.263577   3.832437    2.672681    -1.673098   -0.012239   1.539009    0.568150    0.227083    1.407481    0.663111     #> 127: -7.163772   0.277754    -5.209825   3.873475    2.705128    -1.636695   -0.104885   1.533586    0.551445    0.218256    1.733728    0.671953     #> 128: -7.112813   0.239777    -5.211748   3.915861    2.608392    -1.662354   -0.130458   1.536360    0.523873    0.228442    1.647042    0.666048     #> 129: -7.180114   0.306451    -5.180583   3.881843    2.689900    -1.674028   -0.158249   1.526649    0.497679    0.270581    1.798513    0.662745     #> 130: -7.111239   0.366745    -5.187334   3.749547    2.804547    -1.691692   -0.155969   1.543169    0.549222    0.257052    1.814970    0.660076     #> 131: -7.017072   0.293180    -5.150603   3.854051    2.779081    -1.735148   -0.150071   1.549946    0.524854    0.244199    1.934384    0.659852     #> 132: -7.134799   0.329736    -5.153560   3.886799    2.648047    -1.775115   -0.145195   1.523241    0.498612    0.231989    1.845650    0.667284     #> 133: -6.995189   0.258434    -5.148432   3.816437    2.698910    -1.766222   -0.157406   1.519524    0.473681    0.220390    1.753367    0.663261     #> 134: -6.919090   0.253737    -5.284208   3.900886    2.684117    -1.652343   -0.149895   1.525732    0.449997    0.209370    1.665699    0.671709     #> 135: -6.986639   0.287619    -5.279714   3.878806    2.567078    -1.604463   -0.147210   1.536112    0.427497    0.229619    1.582414    0.662533     #> 136: -7.066493   0.325394    -5.293950   4.040700    2.614074    -1.625336   -0.167162   1.530326    0.406122    0.268301    1.503293    0.665947     #> 137: -6.951282   0.362174    -5.239351   3.973070    2.757953    -1.649086   -0.184241   1.498994    0.385816    0.254886    1.428129    0.660269     #> 138: -6.963707   0.354554    -5.209773   4.032075    2.818874    -1.588612   -0.186842   1.496276    0.366525    0.294496    1.356722    0.663401     #> 139: -6.921696   0.388580    -5.185394   3.955198    2.890466    -1.609874   -0.203804   1.504212    0.348199    0.312621    1.288886    0.666278     #> 140: -6.908138   0.380675    -5.266751   4.014870    2.953004    -1.583420   -0.189735   1.509598    0.330789    0.296990    1.243818    0.663811     #> 141: -6.754225   0.350511    -5.208675   4.051000    2.926469    -1.609166   -0.186481   1.517137    0.328475    0.282140    1.181627    0.657867     #> 142: -6.789293   0.307814    -5.297207   4.118640    2.932774    -1.635073   -0.188538   1.544762    0.312052    0.268033    1.185930    0.664649     #> 143: -6.823577   0.301436    -5.377798   4.018783    2.867539    -1.636593   -0.190189   1.517159    0.296449    0.321428    1.141547    0.658433     #> 144: -6.745211   0.387494    -5.313900   3.967272    2.824354    -1.610766   -0.185932   1.544770    0.281627    0.305356    1.105945    0.663428     #> 145: -6.528921   0.375596    -5.290895   4.080892    3.029239    -1.572953   -0.185804   1.535426    0.267545    0.311453    1.050648    0.667253     #> 146: -6.515166   0.342967    -5.354908   4.079100    3.063869    -1.573064   -0.197223   1.528802    0.303318    0.295881    1.095246    0.666587     #> 147: -6.482191   0.395980    -5.352293   4.144348    2.950902    -1.626264   -0.196328   1.555241    0.288152    0.305804    1.054109    0.667759     #> 148: -6.436935   0.348233    -5.322893   4.248489    2.843411    -1.626107   -0.200522   1.542432    0.273744    0.290514    1.001403    0.670078     #> 149: -6.464610   0.331942    -5.320880   3.911816    2.861399    -1.602902   -0.194779   1.546269    0.260057    0.275988    0.951333    0.665687     #> 150: -6.382175   0.298856    -5.367868   3.837603    2.938831    -1.610288   -0.204386   1.559655    0.271703    0.283664    0.903766    0.662113     #> 151: -6.471131   0.271042    -5.329659   3.788960    2.830587    -1.636315   -0.201760   1.585338    0.258118    0.297515    0.858578    0.659265     #> 152: -6.451226   0.273419    -5.268870   3.843862    2.761992    -1.644630   -0.194039   1.600684    0.208256    0.257844    0.716671    0.666523     #> 153: -6.486853   0.259362    -5.382011   3.904397    2.665264    -1.649768   -0.190338   1.597332    0.200105    0.232628    0.622717    0.665571     #> 154: -6.513257   0.217444    -5.289794   3.902728    2.585772    -1.669724   -0.196120   1.558978    0.203347    0.173057    0.401597    0.672208     #> 155: -6.463513   0.288071    -5.296245   3.853401    2.685523    -1.677810   -0.197416   1.578774    0.206721    0.191569    0.511092    0.658010     #> 156: -6.424735   0.289768    -5.227929   4.060901    2.595856    -1.691553   -0.195858   1.626379    0.212120    0.199707    0.437943    0.661257     #> 157: -6.437111   0.264291    -5.115213   4.084077    2.650002    -1.685681   -0.196643   1.615329    0.220888    0.202089    0.310153    0.654699     #> 158: -6.396430   0.298569    -5.230836   4.100050    2.767698    -1.677785   -0.190106   1.638621    0.139703    0.192802    0.333109    0.662221     #> 159: -6.394523   0.331959    -5.232099   4.274840    2.752179    -1.680634   -0.186828   1.638169    0.143472    0.215945    0.295831    0.662181     #> 160: -6.508765   0.310173    -5.344182   4.317062    2.748192    -1.660713   -0.176451   1.659913    0.146772    0.223736    0.317652    0.669867     #> 161: -6.451146   0.363151    -5.439934   4.379403    2.721551    -1.666758   -0.174653   1.677718    0.229344    0.219357    0.351610    0.663298     #> 162: -6.377784   0.372434    -5.432603   4.451006    2.549236    -1.654461   -0.183114   1.717399    0.157320    0.258113    0.238191    0.666623     #> 163: -6.399764   0.381543    -5.499056   4.303776    2.616415    -1.648346   -0.164355   1.701312    0.175666    0.304777    0.212564    0.660202     #> 164: -6.406619   0.357397    -5.495576   4.431315    2.579277    -1.620666   -0.156906   1.757044    0.118229    0.307628    0.203972    0.659701     #> 165: -6.484943   0.348162    -5.525846   4.416562    2.467224    -1.618712   -0.162456   1.756178    0.086671    0.267052    0.130309    0.661004     #> 166: -6.556071   0.331029    -5.448923   4.660439    2.467413    -1.643719   -0.152967   1.751351    0.055035    0.281619    0.122698    0.657432     #> 167: -6.510775   0.345007    -5.441888   4.452343    2.573625    -1.628949   -0.161399   1.733079    0.041860    0.293787    0.092062    0.656586     #> 168: -6.522450   0.340553    -5.354491   4.620076    2.613483    -1.631543   -0.161768   1.768930    0.048816    0.282325    0.072310    0.665195     #> 169: -6.527803   0.349010    -5.383653   4.475012    2.565853    -1.638452   -0.160631   1.759506    0.052307    0.261481    0.076797    0.657038     #> 170: -6.484452   0.394860    -5.470141   4.450725    2.585146    -1.644711   -0.160295   1.733670    0.051129    0.296564    0.099696    0.676826     #> 171: -6.486887   0.428320    -5.412454   4.452697    2.557947    -1.661730   -0.178167   1.717609    0.052950    0.258495    0.084811    0.672577     #> 172: -6.482485   0.375314    -5.364526   4.443782    2.585896    -1.652037   -0.177625   1.732403    0.055128    0.205859    0.063388    0.667217     #> 173: -6.484679   0.406833    -5.404183   4.364709    2.578668    -1.636775   -0.181969   1.709207    0.046732    0.250733    0.036453    0.662388     #> 174: -6.452953   0.327174    -5.351084   4.444720    2.562729    -1.641378   -0.183554   1.742271    0.033274    0.266571    0.031857    0.661032     #> 175: -6.456781   0.331127    -5.416462   4.426139    2.558285    -1.631932   -0.179660   1.723142    0.032631    0.208434    0.035224    0.674741     #> 176: -6.440788   0.327817    -5.394946   4.414572    2.530989    -1.631237   -0.186095   1.721659    0.023839    0.204685    0.028189    0.670957     #> 177: -6.430808   0.338601    -5.420462   4.207963    2.532735    -1.621996   -0.188031   1.708998    0.021225    0.204696    0.028626    0.668456     #> 178: -6.438010   0.392721    -5.409678   4.333538    2.530739    -1.641908   -0.186101   1.719044    0.026114    0.208537    0.034478    0.656813     #> 179: -6.453589   0.388826    -5.510601   4.389954    2.510959    -1.626200   -0.187146   1.725966    0.028723    0.267332    0.032805    0.667802     #> 180: -6.466918   0.387044    -5.556213   4.500530    2.521761    -1.625161   -0.186853   1.703181    0.019897    0.230582    0.027512    0.667226     #> 181: -6.447777   0.432952    -5.641951   4.590872    2.520678    -1.616208   -0.190165   1.720373    0.012911    0.250081    0.023688    0.675736     #> 182: -6.449494   0.353734    -5.556372   4.534662    2.520332    -1.622270   -0.192615   1.714721    0.011477    0.255926    0.024488    0.663313     #> 183: -6.447030   0.372219    -5.477240   4.439340    2.454365    -1.624966   -0.193174   1.736848    0.013578    0.218204    0.021151    0.662898     #> 184: -6.447970   0.357647    -5.553752   4.564937    2.425948    -1.623617   -0.190866   1.757958    0.014635    0.232893    0.019499    0.666803     #> 185: -6.421707   0.352109    -5.440262   4.628208    2.419503    -1.624096   -0.190055   1.768205    0.015169    0.209310    0.021165    0.672594     #> 186: -6.411722   0.373495    -5.516977   4.602970    2.435219    -1.623640   -0.186917   1.769615    0.016854    0.211137    0.023895    0.669643     #> 187: -6.382424   0.377623    -5.603715   4.517060    2.440059    -1.625806   -0.188581   1.793693    0.007631    0.230118    0.024120    0.669154     #> 188: -6.425327   0.381864    -5.568906   4.678167    2.434221    -1.624738   -0.191030   1.815674    0.006623    0.192654    0.020066    0.666758     #> 189: -6.415336   0.368200    -5.605956   4.713606    2.422571    -1.622508   -0.189720   1.832749    0.004812    0.230723    0.023667    0.668348     #> 190: -6.396817   0.362504    -5.537480   4.669190    2.431311    -1.623135   -0.191433   1.833470    0.002958    0.254784    0.014230    0.667469     #> 191: -6.392082   0.360784    -5.554519   4.612908    2.440379    -1.613707   -0.195155   1.843577    0.003646    0.258025    0.012162    0.668102     #> 192: -6.394138   0.331545    -5.566815   4.767379    2.445511    -1.617182   -0.193432   1.852190    0.003773    0.271631    0.009098    0.664063     #> 193: -6.394095   0.380558    -5.510989   4.681286    2.451408    -1.618481   -0.186117   1.852263    0.003635    0.238607    0.007789    0.667804     #> 194: -6.413286   0.378481    -5.553507   4.798061    2.456020    -1.622644   -0.190219   1.860607    0.001972    0.283666    0.005986    0.662935     #> 195: -6.408714   0.370885    -5.465010   4.716866    2.476702    -1.618193   -0.188990   1.876120    0.002388    0.264024    0.007393    0.664851     #> 196: -6.423714   0.393251    -5.521993   4.740352    2.465591    -1.617569   -0.185371   1.877090    0.002907    0.228429    0.009479    0.675504     #> 197: -6.428140   0.364629    -5.496569   4.839591    2.460793    -1.614526   -0.182789   1.880679    0.001835    0.203282    0.006397    0.679509     #> 198: -6.429530   0.399840    -5.474581   4.822805    2.471945    -1.620334   -0.183558   1.881942    0.002253    0.244028    0.007222    0.676522     #> 199: -6.434473   0.350557    -5.469797   4.801316    2.472902    -1.623762   -0.187629   1.885130    0.002879    0.258548    0.005416    0.670653     #> 200: -6.430604   0.383082    -5.532717   4.796004    2.448012    -1.626301   -0.187943   1.893647    0.003400    0.230326    0.006026    0.672637     #> 201: -6.437248   0.370433    -5.578354   4.825441    2.451251    -1.623698   -0.186235   1.894971    0.003367    0.258401    0.006226    0.671164     #> 202: -6.440638   0.367162    -5.603284   4.857679    2.447033    -1.623645   -0.186648   1.895682    0.003294    0.252550    0.006011    0.670439     #> 203: -6.442864   0.376035    -5.601505   4.867229    2.447171    -1.627403   -0.188145   1.896640    0.003061    0.253329    0.006240    0.669135     #> 204: -6.443855   0.377156    -5.573857   4.854268    2.443600    -1.629239   -0.188987   1.896997    0.003091    0.260229    0.005946    0.669497     #> 205: -6.445700   0.377342    -5.570745   4.846937    2.444662    -1.629125   -0.189146   1.896682    0.003182    0.260635    0.006085    0.669587     #> 206: -6.446937   0.379911    -5.552381   4.834881    2.445045    -1.630331   -0.189313   1.897175    0.003198    0.261490    0.006247    0.668911     #> 207: -6.448153   0.384517    -5.527544   4.820058    2.445899    -1.630802   -0.189180   1.897682    0.003277    0.250903    0.006447    0.670167     #> 208: -6.448576   0.381601    -5.516072   4.805597    2.445238    -1.629017   -0.188457   1.898870    0.003289    0.246816    0.006290    0.670216     #> 209: -6.449902   0.384456    -5.509970   4.794579    2.445166    -1.628770   -0.188026   1.900673    0.003323    0.250423    0.006371    0.669894     #> 210: -6.449155   0.381199    -5.504265   4.787916    2.444586    -1.629680   -0.187735   1.901594    0.003325    0.253049    0.006679    0.670548     #> 211: -6.449966   0.382057    -5.503259   4.789742    2.445405    -1.629791   -0.187227   1.902833    0.003243    0.257804    0.006651    0.670964     #> 212: -6.450701   0.384759    -5.501680   4.798528    2.446681    -1.629566   -0.186936   1.902108    0.003217    0.261061    0.006704    0.671259     #> 213: -6.450748   0.386138    -5.496285   4.806357    2.445858    -1.629122   -0.186967   1.901056    0.003272    0.260095    0.006593    0.671373     #> 214: -6.450525   0.391422    -5.491664   4.812621    2.445991    -1.628782   -0.187464   1.900955    0.003260    0.259614    0.006562    0.671353     #> 215: -6.450908   0.389878    -5.485967   4.819706    2.446525    -1.628838   -0.187963   1.901136    0.003257    0.257340    0.006504    0.671694     #> 216: -6.451822   0.390530    -5.487023   4.812164    2.447790    -1.628442   -0.187925   1.901294    0.003252    0.253989    0.006394    0.671644     #> 217: -6.452763   0.393541    -5.487311   4.810227    2.448452    -1.628358   -0.187873   1.901151    0.003244    0.255292    0.006331    0.671935     #> 218: -6.452877   0.391806    -5.487362   4.811635    2.448756    -1.627842   -0.187902   1.900824    0.003249    0.254091    0.006223    0.672036     #> 219: -6.453165   0.392890    -5.489532   4.811403    2.449214    -1.627629   -0.187985   1.900918    0.003175    0.252036    0.006236    0.671850     #> 220: -6.453727   0.393533    -5.488085   4.814387    2.449073    -1.627302   -0.188197   1.900877    0.003137    0.252414    0.006212    0.671476     #> 221: -6.453694   0.392868    -5.486000   4.812279    2.448642    -1.626700   -0.188470   1.900984    0.003108    0.251692    0.006140    0.671634     #> 222: -6.452772   0.391386    -5.486313   4.814275    2.448341    -1.626421   -0.188661   1.900731    0.003083    0.252614    0.006157    0.671781     #> 223: -6.452701   0.391194    -5.486190   4.819029    2.448409    -1.626492   -0.188757   1.901151    0.003057    0.252717    0.006085    0.671769     #> 224: -6.452647   0.391608    -5.487594   4.820839    2.448220    -1.626338   -0.188675   1.901453    0.003014    0.254276    0.006086    0.671609     #> 225: -6.452782   0.390821    -5.488479   4.819751    2.448573    -1.625988   -0.188610   1.901584    0.002968    0.255998    0.006051    0.671620     #> 226: -6.452747   0.389896    -5.487025   4.819909    2.449390    -1.626181   -0.188577   1.901426    0.002954    0.260275    0.006055    0.671619     #> 227: -6.452932   0.392810    -5.485441   4.818605    2.449450    -1.626274   -0.188686   1.900972    0.002943    0.261653    0.006157    0.671565     #> 228: -6.453100   0.393261    -5.487353   4.820800    2.449317    -1.626555   -0.188772   1.900898    0.002899    0.261927    0.006241    0.671828     #> 229: -6.453259   0.396232    -5.485634   4.827574    2.449449    -1.626655   -0.188857   1.900646    0.002932    0.265119    0.006376    0.671735     #> 230: -6.453119   0.395983    -5.485890   4.830931    2.450215    -1.627001   -0.188859   1.900169    0.002957    0.265726    0.006572    0.671679     #> 231: -6.453454   0.394412    -5.484085   4.827848    2.450491    -1.627125   -0.188892   1.899604    0.002973    0.266005    0.006677    0.671523     #> 232: -6.453868   0.392683    -5.482000   4.829034    2.451377    -1.627149   -0.188884   1.899139    0.002986    0.263513    0.006710    0.671616     #> 233: -6.454248   0.393429    -5.482783   4.823918    2.451914    -1.627317   -0.188848   1.898934    0.003033    0.262438    0.006651    0.671690     #> 234: -6.453962   0.393763    -5.483890   4.821519    2.452362    -1.627600   -0.188893   1.898869    0.003064    0.262477    0.006612    0.671696     #> 235: -6.454010   0.393547    -5.481329   4.822137    2.453060    -1.627767   -0.188819   1.899287    0.003066    0.263215    0.006569    0.671459     #> 236: -6.453765   0.392193    -5.477943   4.820405    2.453443    -1.627854   -0.188639   1.899333    0.003081    0.262647    0.006498    0.671072     #> 237: -6.453721   0.390605    -5.475597   4.817802    2.453754    -1.627699   -0.188633   1.899464    0.003099    0.262054    0.006448    0.671032     #> 238: -6.453407   0.390825    -5.474876   4.821414    2.453206    -1.627505   -0.188702   1.899328    0.003096    0.261497    0.006508    0.670864     #> 239: -6.453490   0.390120    -5.474312   4.824196    2.453070    -1.627129   -0.188904   1.899266    0.003103    0.260635    0.006496    0.670867     #> 240: -6.453465   0.389619    -5.474533   4.825847    2.453264    -1.627117   -0.189086   1.899168    0.003099    0.260548    0.006515    0.670894     #> 241: -6.453249   0.388650    -5.474882   4.822760    2.453123    -1.627493   -0.189148   1.899224    0.003099    0.259819    0.006521    0.670824     #> 242: -6.453054   0.386738    -5.474317   4.821373    2.453654    -1.627539   -0.189129   1.899228    0.003101    0.260590    0.006487    0.670613     #> 243: -6.453128   0.385403    -5.473848   4.824209    2.453706    -1.627700   -0.189207   1.899031    0.003112    0.261660    0.006459    0.670609     #> 244: -6.453271   0.385041    -5.472187   4.823493    2.454426    -1.627884   -0.189261   1.898883    0.003115    0.261422    0.006447    0.670482     #> 245: -6.453366   0.384071    -5.470518   4.820415    2.454450    -1.627996   -0.189196   1.898738    0.003109    0.260287    0.006465    0.670449     #> 246: -6.453457   0.383468    -5.469961   4.819863    2.454663    -1.628113   -0.189193   1.898551    0.003089    0.260094    0.006469    0.670473     #> 247: -6.453426   0.382754    -5.468958   4.818907    2.454954    -1.628251   -0.189181   1.898316    0.003069    0.260885    0.006454    0.670382     #> 248: -6.453324   0.382249    -5.468915   4.819875    2.455489    -1.628157   -0.189232   1.898247    0.003073    0.262072    0.006454    0.670291     #> 249: -6.453146   0.382290    -5.468248   4.821675    2.456018    -1.628027   -0.189273   1.898431    0.003083    0.261771    0.006454    0.670207     #> 250: -6.453123   0.381930    -5.466851   4.821143    2.456222    -1.627932   -0.189297   1.898342    0.003076    0.261892    0.006405    0.670107     #> 251: -6.453454   0.381818    -5.465774   4.820509    2.456557    -1.627962   -0.189393   1.898331    0.003069    0.261430    0.006428    0.670042     #> 252: -6.453459   0.380762    -5.465077   4.817491    2.456882    -1.627758   -0.189438   1.898657    0.003050    0.260794    0.006426    0.669993     #> 253: -6.453575   0.379697    -5.464628   4.816332    2.457320    -1.627443   -0.189434   1.898982    0.003031    0.260966    0.006419    0.670004     #> 254: -6.453531   0.379104    -5.463281   4.819653    2.457690    -1.627311   -0.189492   1.899214    0.003010    0.260941    0.006362    0.669887     #> 255: -6.453713   0.377789    -5.463365   4.821095    2.457972    -1.627065   -0.189526   1.899367    0.003001    0.260600    0.006325    0.669971     #> 256: -6.453813   0.378261    -5.463368   4.822094    2.458207    -1.626938   -0.189525   1.899498    0.003004    0.260164    0.006341    0.669948     #> 257: -6.453871   0.377576    -5.462824   4.821333    2.458531    -1.626844   -0.189575   1.899648    0.002992    0.259696    0.006344    0.669921     #> 258: -6.453960   0.376948    -5.462248   4.820660    2.458998    -1.626746   -0.189557   1.899767    0.002991    0.259270    0.006343    0.669990     #> 259: -6.453846   0.376655    -5.461804   4.819189    2.458864    -1.626668   -0.189517   1.899751    0.002974    0.259076    0.006318    0.669849     #> 260: -6.453866   0.376205    -5.461381   4.819075    2.459045    -1.626668   -0.189464   1.899833    0.002970    0.259003    0.006316    0.669919     #> 261: -6.453893   0.376614    -5.460523   4.818795    2.459217    -1.626778   -0.189423   1.899748    0.002961    0.258838    0.006328    0.669886     #> 262: -6.453926   0.376004    -5.460755   4.819219    2.459108    -1.626788   -0.189405   1.899708    0.002969    0.258389    0.006348    0.669887     #> 263: -6.453935   0.376521    -5.460458   4.820808    2.459221    -1.626832   -0.189348   1.899619    0.002958    0.258355    0.006367    0.669931     #> 264: -6.453984   0.375349    -5.459605   4.821178    2.459593    -1.626924   -0.189282   1.899668    0.002945    0.257307    0.006376    0.669950     #> 265: -6.453995   0.374518    -5.458437   4.822198    2.460027    -1.626967   -0.189186   1.899723    0.002941    0.257079    0.006372    0.669945     #> 266: -6.454124   0.374922    -5.457953   4.822108    2.460163    -1.626976   -0.189051   1.899763    0.002927    0.257437    0.006360    0.669873     #> 267: -6.454073   0.375063    -5.457043   4.821511    2.460384    -1.626799   -0.189075   1.899883    0.002918    0.257073    0.006371    0.669932     #> 268: -6.454113   0.374761    -5.456787   4.820866    2.460362    -1.626790   -0.189067   1.900032    0.002915    0.257515    0.006358    0.669949     #> 269: -6.454173   0.374155    -5.456190   4.820396    2.460256    -1.626855   -0.189063   1.900049    0.002918    0.257242    0.006356    0.670071     #> 270: -6.454211   0.373627    -5.455009   4.820025    2.460300    -1.626923   -0.189056   1.900146    0.002907    0.257175    0.006371    0.670312     #> 271: -6.454244   0.373780    -5.454841   4.818128    2.460576    -1.626980   -0.189013   1.900245    0.002912    0.257886    0.006391    0.670315     #> 272: -6.454146   0.374016    -5.454891   4.817692    2.460584    -1.626948   -0.189006   1.900180    0.002922    0.258388    0.006357    0.670391     #> 273: -6.454097   0.374814    -5.454903   4.817815    2.460625    -1.627017   -0.189021   1.900144    0.002931    0.259021    0.006330    0.670402     #> 274: -6.454262   0.374697    -5.454724   4.818051    2.460648    -1.627101   -0.189021   1.900135    0.002945    0.259302    0.006349    0.670456     #> 275: -6.454373   0.374750    -5.454803   4.817649    2.460630    -1.627248   -0.189024   1.900149    0.002933    0.258989    0.006339    0.670524     #> 276: -6.454648   0.374962    -5.453668   4.817980    2.460356    -1.627384   -0.189000   1.900094    0.002936    0.259205    0.006354    0.670678     #> 277: -6.454651   0.374692    -5.452400   4.818777    2.459884    -1.627463   -0.188980   1.900094    0.002940    0.259168    0.006371    0.670814     #> 278: -6.454614   0.374830    -5.451956   4.819357    2.459555    -1.627512   -0.188966   1.900145    0.002933    0.259283    0.006359    0.670880     #> 279: -6.454631   0.374966    -5.451348   4.818721    2.459413    -1.627472   -0.188944   1.900216    0.002940    0.259009    0.006337    0.670983     #> 280: -6.454483   0.375445    -5.451834   4.818339    2.459374    -1.627495   -0.188929   1.900269    0.002934    0.259209    0.006343    0.671080     #> 281: -6.454412   0.374933    -5.451106   4.819351    2.459361    -1.627487   -0.188903   1.900308    0.002932    0.259493    0.006322    0.671154     #> 282: -6.454392   0.374903    -5.450362   4.820802    2.459521    -1.627463   -0.188893   1.900328    0.002939    0.259923    0.006327    0.671139     #> 283: -6.454289   0.374695    -5.450296   4.821277    2.459660    -1.627529   -0.188904   1.900406    0.002925    0.260622    0.006313    0.671184     #> 284: -6.454195   0.373902    -5.449699   4.821848    2.459756    -1.627524   -0.188897   1.900417    0.002914    0.261228    0.006293    0.671282     #> 285: -6.454117   0.374033    -5.448660   4.822083    2.459689    -1.627532   -0.188913   1.900367    0.002907    0.261194    0.006304    0.671409     #> 286: -6.454031   0.374048    -5.448252   4.821554    2.459717    -1.627481   -0.188924   1.900362    0.002895    0.261210    0.006301    0.671549     #> 287: -6.454078   0.374049    -5.447192   4.820560    2.459887    -1.627460   -0.188907   1.900371    0.002880    0.261254    0.006270    0.671631     #> 288: -6.454033   0.374337    -5.446518   4.820010    2.460007    -1.627518   -0.188929   1.900449    0.002887    0.261136    0.006251    0.671640     #> 289: -6.454002   0.374025    -5.446149   4.820065    2.459983    -1.627551   -0.188940   1.900488    0.002904    0.261191    0.006219    0.671717     #> 290: -6.454025   0.374163    -5.445864   4.820447    2.460192    -1.627522   -0.188918   1.900479    0.002909    0.261396    0.006222    0.671759     #> 291: -6.453893   0.373890    -5.445471   4.819767    2.460435    -1.627524   -0.188914   1.900461    0.002914    0.261371    0.006221    0.671778     #> 292: -6.453826   0.374030    -5.445146   4.819693    2.460476    -1.627562   -0.188909   1.900535    0.002912    0.261212    0.006205    0.671845     #> 293: -6.453698   0.373561    -5.445096   4.819831    2.460517    -1.627522   -0.188900   1.900529    0.002910    0.260962    0.006191    0.671973     #> 294: -6.453628   0.373137    -5.445195   4.819994    2.460605    -1.627482   -0.188885   1.900499    0.002918    0.261377    0.006177    0.672120     #> 295: -6.453626   0.372624    -5.444964   4.820436    2.460486    -1.627487   -0.188889   1.900459    0.002922    0.261844    0.006174    0.672171     #> 296: -6.453586   0.372507    -5.444405   4.820567    2.460459    -1.627497   -0.188897   1.900420    0.002914    0.261827    0.006172    0.672217     #> 297: -6.453729   0.372526    -5.444571   4.820229    2.460251    -1.627508   -0.188915   1.900371    0.002909    0.262530    0.006190    0.672265     #> 298: -6.453774   0.372464    -5.444841   4.820105    2.460237    -1.627481   -0.188916   1.900318    0.002904    0.262903    0.006191    0.672413     #> 299: -6.453744   0.372588    -5.445109   4.820411    2.460174    -1.627484   -0.188928   1.900327    0.002893    0.262972    0.006178    0.672443     #> 300: -6.453719   0.372364    -5.444684   4.820420    2.460025    -1.627484   -0.188915   1.900294    0.002902    0.262751    0.006175    0.672633     #> 301: -6.453708   0.372212    -5.443329   4.820761    2.460126    -1.627529   -0.188905   1.900265    0.002898    0.262537    0.006163    0.672777     #> 302: -6.453619   0.371957    -5.442192   4.820849    2.460243    -1.627567   -0.188923   1.900288    0.002896    0.262281    0.006140    0.672966     #> 303: -6.453609   0.371601    -5.441533   4.821137    2.460244    -1.627599   -0.188941   1.900316    0.002893    0.262181    0.006110    0.673064     #> 304: -6.453675   0.371506    -5.441140   4.820675    2.460078    -1.627544   -0.188951   1.900329    0.002897    0.262270    0.006103    0.673139     #> 305: -6.453514   0.371620    -5.441057   4.820399    2.460073    -1.627566   -0.188968   1.900333    0.002888    0.262437    0.006117    0.673233     #> 306: -6.453404   0.371759    -5.440890   4.820808    2.460382    -1.627582   -0.188974   1.900343    0.002890    0.262787    0.006121    0.673339     #> 307: -6.453446   0.372048    -5.440703   4.821513    2.460527    -1.627563   -0.188965   1.900329    0.002888    0.262926    0.006117    0.673542     #> 308: -6.453591   0.371803    -5.440762   4.821594    2.460441    -1.627531   -0.188972   1.900343    0.002880    0.262855    0.006135    0.673709     #> 309: -6.453645   0.371437    -5.440495   4.821744    2.460405    -1.627539   -0.188972   1.900350    0.002878    0.263349    0.006151    0.673886     #> 310: -6.453788   0.371219    -5.440159   4.822121    2.460237    -1.627527   -0.188975   1.900332    0.002887    0.263622    0.006149    0.673924     #> 311: -6.453846   0.370806    -5.439689   4.822263    2.460097    -1.627506   -0.188968   1.900318    0.002885    0.263857    0.006146    0.674049     #> 312: -6.453807   0.370560    -5.438883   4.822480    2.460043    -1.627491   -0.188961   1.900291    0.002886    0.263962    0.006136    0.674185     #> 313: -6.453897   0.370443    -5.438516   4.822993    2.459990    -1.627485   -0.188958   1.900268    0.002887    0.264044    0.006121    0.674370     #> 314: -6.454035   0.370735    -5.438480   4.823194    2.460027    -1.627500   -0.188957   1.900240    0.002903    0.264209    0.006135    0.674497     #> 315: -6.454161   0.371162    -5.438325   4.823326    2.460017    -1.627507   -0.188958   1.900224    0.002907    0.264171    0.006149    0.674748     #> 316: -6.454148   0.370973    -5.437996   4.823757    2.459963    -1.627503   -0.188980   1.900232    0.002915    0.263913    0.006169    0.674982     #> 317: -6.454094   0.370805    -5.437838   4.823628    2.459990    -1.627510   -0.188992   1.900238    0.002911    0.263901    0.006171    0.675194     #> 318: -6.454057   0.370987    -5.437595   4.823649    2.460096    -1.627548   -0.188996   1.900267    0.002907    0.263657    0.006171    0.675400     #> 319: -6.454033   0.371173    -5.436826   4.823622    2.460081    -1.627554   -0.189000   1.900281    0.002919    0.263354    0.006164    0.675605     #> 320: -6.454041   0.371082    -5.436413   4.823999    2.460145    -1.627587   -0.188995   1.900282    0.002916    0.263276    0.006167    0.675721     #> 321: -6.454101   0.370982    -5.436109   4.824184    2.460003    -1.627598   -0.188995   1.900297    0.002917    0.263368    0.006158    0.675836     #> 322: -6.454296   0.370845    -5.435325   4.824529    2.460101    -1.627587   -0.188990   1.900307    0.002920    0.263237    0.006147    0.675930     #> 323: -6.454365   0.370550    -5.434561   4.824851    2.459935    -1.627602   -0.188999   1.900305    0.002922    0.262770    0.006162    0.676038     #> 324: -6.454444   0.370072    -5.434181   4.825143    2.459837    -1.627596   -0.189001   1.900323    0.002927    0.262541    0.006168    0.676188     #> 325: -6.454532   0.369658    -5.433911   4.825232    2.459788    -1.627613   -0.189003   1.900307    0.002926    0.262440    0.006152    0.676441     #> 326: -6.454580   0.369660    -5.433132   4.825334    2.459811    -1.627634   -0.189013   1.900286    0.002923    0.262587    0.006135    0.676727     #> 327: -6.454610   0.369471    -5.432617   4.825533    2.459896    -1.627635   -0.189015   1.900266    0.002928    0.262553    0.006131    0.677011     #> 328: -6.454625   0.369576    -5.432086   4.825236    2.459984    -1.627610   -0.189029   1.900249    0.002933    0.263180    0.006132    0.677252     #> 329: -6.454702   0.369111    -5.431560   4.824933    2.460045    -1.627584   -0.189040   1.900270    0.002941    0.264020    0.006130    0.677477     #> 330: -6.454813   0.368692    -5.431209   4.824655    2.459994    -1.627572   -0.189044   1.900278    0.002935    0.264028    0.006128    0.677665     #> 331: -6.454905   0.368476    -5.431129   4.824770    2.460004    -1.627561   -0.189055   1.900282    0.002929    0.264393    0.006125    0.677876     #> 332: -6.454940   0.368317    -5.430856   4.824854    2.460015    -1.627564   -0.189049   1.900299    0.002923    0.264581    0.006127    0.678100     #> 333: -6.454941   0.368233    -5.430662   4.824653    2.460218    -1.627560   -0.189050   1.900302    0.002917    0.265183    0.006141    0.678402     #> 334: -6.454858   0.368293    -5.430361   4.824638    2.460410    -1.627564   -0.189052   1.900300    0.002929    0.265979    0.006138    0.678728     #> 335: -6.454817   0.368498    -5.429841   4.825147    2.460580    -1.627571   -0.189054   1.900317    0.002933    0.266512    0.006162    0.679089     #> 336: -6.454803   0.368166    -5.429464   4.825337    2.460694    -1.627575   -0.189056   1.900310    0.002930    0.266667    0.006192    0.679453     #> 337: -6.454810   0.368147    -5.429169   4.825355    2.460772    -1.627584   -0.189064   1.900306    0.002929    0.266970    0.006202    0.679712     #> 338: -6.454880   0.368053    -5.429126   4.825295    2.460586    -1.627584   -0.189072   1.900305    0.002936    0.267414    0.006205    0.680013     #> 339: -6.454817   0.367873    -5.428806   4.825461    2.460631    -1.627575   -0.189073   1.900305    0.002942    0.267815    0.006223    0.680331     #> 340: -6.454796   0.367790    -5.428382   4.825400    2.460535    -1.627560   -0.189066   1.900307    0.002944    0.268215    0.006232    0.680719     #> 341: -6.454921   0.367611    -5.427949   4.825662    2.460564    -1.627552   -0.189058   1.900301    0.002960    0.268332    0.006228    0.681086     #> 342: -6.454959   0.367276    -5.427664   4.825694    2.460540    -1.627541   -0.189052   1.900295    0.002964    0.268480    0.006241    0.681431     #> 343: -6.455010   0.367138    -5.427372   4.825842    2.460522    -1.627529   -0.189048   1.900280    0.002966    0.269049    0.006255    0.681730     #> 344: -6.455099   0.367383    -5.427025   4.825975    2.460562    -1.627539   -0.189049   1.900281    0.002967    0.269326    0.006259    0.682073     #> 345: -6.455158   0.367278    -5.426737   4.826004    2.460626    -1.627550   -0.189048   1.900263    0.002964    0.269561    0.006277    0.682437     #> 346: -6.455166   0.367369    -5.426712   4.826073    2.460659    -1.627551   -0.189049   1.900251    0.002962    0.270266    0.006278    0.682814     #> 347: -6.455246   0.367425    -5.426678   4.826056    2.460553    -1.627561   -0.189052   1.900253    0.002955    0.270915    0.006291    0.683227     #> 348: -6.455348   0.367800    -5.426419   4.826059    2.460524    -1.627561   -0.189056   1.900241    0.002949    0.271788    0.006299    0.683579     #> 349: -6.455418   0.368103    -5.426331   4.826193    2.460459    -1.627557   -0.189061   1.900244    0.002940    0.272606    0.006309    0.683928     #> 350: -6.455396   0.368507    -5.426257   4.826189    2.460437    -1.627554   -0.189063   1.900250    0.002938    0.273378    0.006319    0.684299     #> 351: -6.455378   0.368907    -5.426091   4.826348    2.460502    -1.627563   -0.189065   1.900238    0.002935    0.273964    0.006334    0.684681     #> 352: -6.455399   0.369210    -5.426078   4.826405    2.460615    -1.627556   -0.189069   1.900236    0.002930    0.274451    0.006360    0.685110     #> 353: -6.455488   0.369116    -5.425984   4.826308    2.460522    -1.627565   -0.189069   1.900232    0.002928    0.275419    0.006382    0.685514     #> 354: -6.455459   0.369105    -5.426022   4.826283    2.460427    -1.627570   -0.189072   1.900233    0.002921    0.275933    0.006386    0.685976     #> 355: -6.455537   0.369442    -5.425977   4.826074    2.460326    -1.627575   -0.189067   1.900233    0.002920    0.276769    0.006412    0.686411     #> 356: -6.455517   0.369666    -5.426102   4.825913    2.460279    -1.627562   -0.189070   1.900237    0.002913    0.277400    0.006426    0.686848     #> 357: -6.455505   0.369749    -5.425900   4.825760    2.460175    -1.627558   -0.189070   1.900233    0.002910    0.278289    0.006445    0.687321     #> 358: -6.455444   0.369942    -5.425705   4.825718    2.460183    -1.627564   -0.189067   1.900227    0.002909    0.278879    0.006460    0.687767     #> 359: -6.455465   0.370093    -5.425762   4.825665    2.460160    -1.627564   -0.189065   1.900227    0.002909    0.279903    0.006477    0.688197     #> 360: -6.455521   0.370045    -5.426011   4.825467    2.460206    -1.627565   -0.189065   1.900222    0.002911    0.280318    0.006486    0.688709     #> 361: -6.455508   0.369982    -5.426092   4.825345    2.460260    -1.627565   -0.189068   1.900219    0.002911    0.281228    0.006493    0.689184     #> 362: -6.455489   0.369727    -5.426074   4.825399    2.460329    -1.627572   -0.189069   1.900215    0.002914    0.282202    0.006496    0.689670     #> 363: -6.455486   0.369961    -5.426003   4.825451    2.460327    -1.627574   -0.189074   1.900218    0.002916    0.282929    0.006502    0.690109     #> 364: -6.455466   0.370037    -5.426151   4.825563    2.460319    -1.627571   -0.189074   1.900220    0.002914    0.283826    0.006527    0.690574     #> 365: -6.455449   0.370220    -5.426068   4.825549    2.460363    -1.627578   -0.189080   1.900219    0.002915    0.284345    0.006550    0.690982     #> 366: -6.455419   0.370745    -5.425872   4.825549    2.460429    -1.627574   -0.189079   1.900223    0.002916    0.285284    0.006560    0.691409     #> 367: -6.455353   0.371128    -5.425744   4.825639    2.460265    -1.627577   -0.189082   1.900228    0.002915    0.286158    0.006565    0.691827     #> 368: -6.455296   0.371416    -5.425679   4.825658    2.460124    -1.627574   -0.189081   1.900228    0.002916    0.287194    0.006565    0.692235     #> 369: -6.455271   0.371737    -5.425622   4.825739    2.459990    -1.627582   -0.189080   1.900228    0.002918    0.288199    0.006582    0.692629     #> 370: -6.455304   0.371862    -5.425614   4.825839    2.459876    -1.627588   -0.189083   1.900229    0.002915    0.289186    0.006596    0.693033     #> 371: -6.455306   0.372186    -5.425592   4.826001    2.459834    -1.627591   -0.189082   1.900232    0.002916    0.290155    0.006617    0.693437     #> 372: -6.455296   0.372540    -5.425648   4.826123    2.459834    -1.627584   -0.189083   1.900230    0.002925    0.290785    0.006622    0.693828     #> 373: -6.455335   0.372927    -5.425489   4.826169    2.459880    -1.627589   -0.189086   1.900228    0.002926    0.291830    0.006630    0.694222     #> 374: -6.455413   0.373214    -5.425445   4.826133    2.459921    -1.627584   -0.189088   1.900227    0.002928    0.292620    0.006629    0.694655     #> 375: -6.455460   0.373587    -5.425446   4.826196    2.460005    -1.627584   -0.189088   1.900231    0.002929    0.293386    0.006629    0.695124     #> 376: -6.455508   0.373716    -5.425383   4.826127    2.460074    -1.627585   -0.189088   1.900233    0.002934    0.294056    0.006622    0.695666     #> 377: -6.455519   0.373882    -5.425255   4.826018    2.460123    -1.627577   -0.189089   1.900234    0.002940    0.294898    0.006632    0.696176     #> 378: -6.455513   0.373714    -5.425232   4.826041    2.460193    -1.627569   -0.189090   1.900233    0.002937    0.295543    0.006636    0.696701     #> 379: -6.455508   0.373726    -5.425381   4.825966    2.460161    -1.627569   -0.189091   1.900239    0.002934    0.296362    0.006636    0.697262     #> 380: -6.455542   0.373454    -5.425396   4.825987    2.460120    -1.627566   -0.189090   1.900241    0.002935    0.297041    0.006638    0.697830     #> 381: -6.455526   0.373323    -5.425341   4.826053    2.460135    -1.627568   -0.189094   1.900239    0.002933    0.297804    0.006647    0.698367     #> 382: -6.455518   0.373245    -5.425248   4.826144    2.459987    -1.627569   -0.189093   1.900236    0.002932    0.298701    0.006661    0.698889     #> 383: -6.455554   0.373239    -5.425358   4.826152    2.459870    -1.627574   -0.189095   1.900232    0.002931    0.299575    0.006674    0.699407     #> 384: -6.455597   0.373275    -5.425348   4.826187    2.459918    -1.627575   -0.189099   1.900228    0.002933    0.300542    0.006685    0.699908     #> 385: -6.455617   0.373361    -5.425303   4.826240    2.459960    -1.627575   -0.189099   1.900225    0.002935    0.301869    0.006676    0.700431     #> 386: -6.455649   0.373320    -5.425369   4.826303    2.460003    -1.627580   -0.189098   1.900232    0.002931    0.303042    0.006662    0.700921     #> 387: -6.455654   0.373487    -5.425413   4.826324    2.459945    -1.627579   -0.189098   1.900229    0.002928    0.304074    0.006650    0.701401     #> 388: -6.455759   0.373532    -5.425535   4.826262    2.459951    -1.627579   -0.189099   1.900228    0.002931    0.305078    0.006649    0.701906     #> 389: -6.455745   0.373710    -5.425573   4.826292    2.459927    -1.627580   -0.189097   1.900229    0.002932    0.306581    0.006648    0.702400     #> 390: -6.455845   0.373744    -5.425565   4.826249    2.459823    -1.627582   -0.189097   1.900230    0.002932    0.308039    0.006657    0.702865     #> 391: -6.455950   0.373495    -5.425550   4.826185    2.459727    -1.627587   -0.189096   1.900230    0.002933    0.309070    0.006654    0.703348     #> 392: -6.456020   0.373734    -5.425613   4.826155    2.459687    -1.627585   -0.189096   1.900228    0.002931    0.310421    0.006656    0.703825     #> 393: -6.456050   0.373693    -5.425584   4.826121    2.459656    -1.627582   -0.189095   1.900231    0.002929    0.311610    0.006654    0.704316     #> 394: -6.456052   0.373604    -5.425540   4.826096    2.459514    -1.627584   -0.189095   1.900227    0.002933    0.312736    0.006675    0.704783     #> 395: -6.456098   0.373792    -5.425517   4.826167    2.459432    -1.627585   -0.189094   1.900221    0.002925    0.313766    0.006673    0.705283     #> 396: -6.456171   0.373871    -5.425561   4.826194    2.459330    -1.627586   -0.189090   1.900224    0.002927    0.314845    0.006678    0.705715     #> 397: -6.456150   0.373963    -5.425492   4.826161    2.459296    -1.627592   -0.189090   1.900227    0.002927    0.315836    0.006693    0.706184     #> 398: -6.456165   0.374076    -5.425526   4.826186    2.459264    -1.627588   -0.189091   1.900222    0.002930    0.316870    0.006699    0.706627     #> 399: -6.456154   0.374251    -5.425554   4.826210    2.459271    -1.627586   -0.189092   1.900224    0.002937    0.318087    0.006704    0.707070     #> 400: -6.456247   0.374233    -5.425556   4.826204    2.459255    -1.627586   -0.189091   1.900227    0.002935    0.319043    0.006706    0.707543     #> 401: -6.456301   0.374073    -5.425531   4.826238    2.459367    -1.627586   -0.189091   1.900231    0.002935    0.319828    0.006708    0.707998     #> 402: -6.456359   0.373963    -5.425574   4.826232    2.459417    -1.627588   -0.189091   1.900232    0.002944    0.320626    0.006704    0.708464     #> 403: -6.456419   0.374021    -5.425506   4.826239    2.459494    -1.627587   -0.189089   1.900234    0.002952    0.321493    0.006698    0.708951     #> 404: -6.456486   0.374130    -5.425518   4.826244    2.459550    -1.627588   -0.189088   1.900235    0.002948    0.322628    0.006694    0.709423     #> 405: -6.456476   0.373852    -5.425506   4.826239    2.459548    -1.627587   -0.189088   1.900236    0.002945    0.323629    0.006693    0.709915     #> 406: -6.456438   0.374091    -5.425518   4.826241    2.459578    -1.627590   -0.189088   1.900235    0.002947    0.324582    0.006697    0.710376     #> 407: -6.456424   0.374340    -5.425495   4.826221    2.459548    -1.627593   -0.189089   1.900236    0.002947    0.325660    0.006695    0.710852     #> 408: -6.456415   0.374410    -5.425518   4.826221    2.459574    -1.627593   -0.189090   1.900237    0.002948    0.326674    0.006703    0.711356     #> 409: -6.456444   0.374173    -5.425545   4.826260    2.459615    -1.627597   -0.189091   1.900233    0.002948    0.327462    0.006705    0.711846     #> 410: -6.456461   0.374151    -5.425589   4.826291    2.459631    -1.627599   -0.189091   1.900232    0.002949    0.328703    0.006703    0.712304     #> 411: -6.456502   0.374097    -5.425567   4.826283    2.459707    -1.627597   -0.189090   1.900232    0.002948    0.329411    0.006718    0.712742     #> 412: -6.456585   0.374018    -5.425627   4.826272    2.459746    -1.627597   -0.189089   1.900234    0.002951    0.330691    0.006724    0.713175     #> 413: -6.456633   0.374405    -5.425645   4.826295    2.459737    -1.627596   -0.189091   1.900236    0.002951    0.331780    0.006737    0.713616     #> 414: -6.456703   0.374604    -5.425666   4.826265    2.459833    -1.627596   -0.189091   1.900235    0.002955    0.332865    0.006762    0.714030     #> 415: -6.456814   0.374641    -5.425672   4.826266    2.459846    -1.627597   -0.189090   1.900237    0.002954    0.334128    0.006792    0.714461     #> 416: -6.456802   0.374767    -5.425673   4.826214    2.459856    -1.627600   -0.189090   1.900237    0.002951    0.335294    0.006808    0.714849     #> 417: -6.456760   0.375136    -5.425714   4.826255    2.459839    -1.627603   -0.189089   1.900236    0.002954    0.336458    0.006812    0.715268     #> 418: -6.456733   0.374941    -5.425704   4.826302    2.459920    -1.627603   -0.189089   1.900237    0.002953    0.337322    0.006814    0.715684     #> 419: -6.456717   0.375075    -5.425727   4.826316    2.459987    -1.627605   -0.189088   1.900241    0.002952    0.338301    0.006815    0.716097     #> 420: -6.456763   0.374758    -5.425701   4.826293    2.459999    -1.627607   -0.189087   1.900240    0.002952    0.339477    0.006818    0.716477     #> 421: -6.456793   0.374787    -5.425666   4.826301    2.460010    -1.627606   -0.189087   1.900241    0.002952    0.340374    0.006826    0.716903     #> 422: -6.456816   0.374765    -5.425651   4.826305    2.460015    -1.627609   -0.189087   1.900241    0.002955    0.341133    0.006820    0.717308     #> 423: -6.456840   0.374818    -5.425657   4.826305    2.460115    -1.627608   -0.189086   1.900240    0.002957    0.341834    0.006816    0.717724     #> 424: -6.456824   0.374690    -5.425654   4.826321    2.460227    -1.627609   -0.189086   1.900240    0.002964    0.342838    0.006825    0.718118     #> 425: -6.456863   0.374777    -5.425691   4.826310    2.460296    -1.627613   -0.189086   1.900240    0.002968    0.343383    0.006840    0.718560     #> 426: -6.456930   0.374850    -5.425690   4.826337    2.460277    -1.627613   -0.189088   1.900239    0.002969    0.344115    0.006834    0.718956     #> 427: -6.456993   0.374771    -5.425722   4.826354    2.460249    -1.627614   -0.189087   1.900240    0.002970    0.345215    0.006844    0.719330     #> 428: -6.456991   0.374628    -5.425765   4.826366    2.460228    -1.627614   -0.189087   1.900239    0.002972    0.346099    0.006852    0.719699     #> 429: -6.456998   0.374575    -5.425762   4.826351    2.460278    -1.627614   -0.189088   1.900241    0.002973    0.347003    0.006850    0.720060     #> 430: -6.457038   0.374759    -5.425735   4.826348    2.460333    -1.627613   -0.189088   1.900239    0.002976    0.347725    0.006847    0.720435     #> 431: -6.457083   0.374586    -5.425756   4.826369    2.460385    -1.627614   -0.189087   1.900239    0.002975    0.348466    0.006852    0.720803     #> 432: -6.457100   0.374682    -5.425765   4.826390    2.460366    -1.627615   -0.189088   1.900239    0.002975    0.349439    0.006870    0.721160     #> 433: -6.457153   0.374640    -5.425776   4.826355    2.460286    -1.627615   -0.189087   1.900238    0.002975    0.350401    0.006876    0.721523     #> 434: -6.457120   0.374515    -5.425797   4.826358    2.460236    -1.627616   -0.189087   1.900238    0.002974    0.351188    0.006883    0.721889     #> 435: -6.457105   0.374629    -5.425809   4.826340    2.460267    -1.627616   -0.189087   1.900237    0.002972    0.352173    0.006881    0.722253     #> 436: -6.457048   0.374579    -5.425816   4.826340    2.460223    -1.627615   -0.189088   1.900236    0.002974    0.352827    0.006880    0.722611     #> 437: -6.457042   0.374731    -5.425800   4.826352    2.460195    -1.627617   -0.189088   1.900237    0.002975    0.353845    0.006882    0.722971     #> 438: -6.457056   0.374684    -5.425805   4.826344    2.460171    -1.627616   -0.189089   1.900237    0.002975    0.354744    0.006891    0.723352     #> 439: -6.457067   0.374596    -5.425835   4.826348    2.460198    -1.627616   -0.189088   1.900236    0.002978    0.355937    0.006892    0.723728     #> 440: -6.457091   0.374610    -5.425836   4.826364    2.460188    -1.627614   -0.189087   1.900237    0.002983    0.356725    0.006887    0.724092     #> 441: -6.457118   0.374779    -5.425836   4.826366    2.460170    -1.627614   -0.189087   1.900235    0.002987    0.357522    0.006887    0.724439     #> 442: -6.457150   0.374634    -5.425856   4.826359    2.460148    -1.627615   -0.189088   1.900235    0.002990    0.358132    0.006887    0.724787     #> 443: -6.457117   0.374762    -5.425840   4.826364    2.460169    -1.627614   -0.189089   1.900235    0.002990    0.358834    0.006892    0.725138     #> 444: -6.457091   0.374827    -5.425849   4.826377    2.460208    -1.627616   -0.189089   1.900235    0.002992    0.359644    0.006904    0.725477     #> 445: -6.457068   0.375004    -5.425863   4.826377    2.460246    -1.627615   -0.189088   1.900237    0.002999    0.360393    0.006908    0.725802     #> 446: -6.457054   0.374966    -5.425887   4.826368    2.460237    -1.627614   -0.189088   1.900238    0.003004    0.361349    0.006906    0.726145     #> 447: -6.457078   0.375102    -5.425902   4.826361    2.460159    -1.627613   -0.189087   1.900239    0.003004    0.362229    0.006903    0.726484     #> 448: -6.457056   0.374932    -5.425923   4.826348    2.460041    -1.627612   -0.189088   1.900238    0.003006    0.363076    0.006914    0.726823     #> 449: -6.457072   0.374770    -5.425940   4.826349    2.459955    -1.627613   -0.189088   1.900240    0.003004    0.363979    0.006925    0.727168     #> 450: -6.457037   0.375014    -5.425942   4.826369    2.459841    -1.627614   -0.189088   1.900239    0.003007    0.364652    0.006930    0.727540     #> 451: -6.457031   0.375386    -5.425939   4.826376    2.459797    -1.627614   -0.189087   1.900239    0.003008    0.365409    0.006937    0.727922     #> 452: -6.457035   0.375748    -5.425946   4.826369    2.459825    -1.627614   -0.189087   1.900239    0.003005    0.366122    0.006936    0.728282     #> 453: -6.457054   0.376025    -5.425942   4.826360    2.459778    -1.627614   -0.189087   1.900239    0.003004    0.366831    0.006938    0.728642     #> 454: -6.457066   0.376233    -5.425954   4.826371    2.459834    -1.627615   -0.189087   1.900239    0.003005    0.367433    0.006941    0.728999     #> 455: -6.457067   0.376797    -5.425963   4.826367    2.459882    -1.627615   -0.189087   1.900239    0.003011    0.368242    0.006941    0.729353     #> 456: -6.457081   0.376992    -5.425953   4.826362    2.459820    -1.627614   -0.189087   1.900238    0.003013    0.368595    0.006950    0.729669     #> 457: -6.457112   0.377080    -5.425943   4.826334    2.459793    -1.627615   -0.189087   1.900238    0.003012    0.369188    0.006948    0.730019     #> 458: -6.457119   0.377428    -5.425926   4.826335    2.459789    -1.627616   -0.189087   1.900237    0.003008    0.369810    0.006945    0.730359     #> 459: -6.457159   0.377944    -5.425922   4.826353    2.459765    -1.627617   -0.189087   1.900237    0.003009    0.370529    0.006940    0.730688     #> 460: -6.457121   0.378541    -5.425919   4.826362    2.459806    -1.627617   -0.189087   1.900237    0.003005    0.371227    0.006942    0.731040     #> 461: -6.457114   0.378790    -5.425930   4.826349    2.459853    -1.627618   -0.189087   1.900238    0.003002    0.371980    0.006949    0.731365     #> 462: -6.457117   0.379238    -5.425933   4.826345    2.459880    -1.627618   -0.189087   1.900239    0.003003    0.372842    0.006951    0.731675     #> 463: -6.457105   0.379646    -5.425921   4.826347    2.459898    -1.627619   -0.189087   1.900240    0.003004    0.373379    0.006959    0.731994     #> 464: -6.457074   0.379857    -5.425935   4.826360    2.459940    -1.627619   -0.189087   1.900240    0.003004    0.374330    0.006965    0.732317     #> 465: -6.457074   0.380175    -5.425944   4.826376    2.460027    -1.627619   -0.189088   1.900239    0.003005    0.375014    0.006968    0.732639     #> 466: -6.457069   0.380628    -5.425930   4.826369    2.460028    -1.627618   -0.189088   1.900240    0.003008    0.375572    0.006976    0.732956     #> 467: -6.457078   0.381052    -5.425925   4.826373    2.460038    -1.627618   -0.189088   1.900240    0.003006    0.376312    0.006982    0.733262     #> 468: -6.457074   0.381350    -5.425939   4.826387    2.459992    -1.627618   -0.189088   1.900240    0.003003    0.376891    0.006995    0.733558     #> 469: -6.457075   0.381655    -5.425943   4.826389    2.459975    -1.627618   -0.189088   1.900241    0.002999    0.377341    0.007016    0.733871     #> 470: -6.457071   0.381922    -5.425947   4.826394    2.459991    -1.627618   -0.189088   1.900240    0.003000    0.378069    0.007022    0.734169     #> 471: -6.457076   0.382277    -5.425943   4.826398    2.459992    -1.627617   -0.189088   1.900241    0.003002    0.378685    0.007023    0.734464     #> 472: -6.457091   0.382305    -5.425940   4.826402    2.459952    -1.627617   -0.189088   1.900241    0.003004    0.379340    0.007027    0.734770     #> 473: -6.457146   0.382282    -5.425945   4.826406    2.459952    -1.627618   -0.189087   1.900241    0.003007    0.380362    0.007023    0.735106     #> 474: -6.457138   0.382250    -5.425935   4.826398    2.459968    -1.627618   -0.189087   1.900240    0.003005    0.381073    0.007029    0.735394     #> 475: -6.457129   0.382405    -5.425942   4.826405    2.460070    -1.627618   -0.189087   1.900241    0.003006    0.381689    0.007040    0.735667     #> 476: -6.457105   0.382441    -5.425950   4.826412    2.460127    -1.627618   -0.189087   1.900241    0.003005    0.382523    0.007050    0.735943     #> 477: -6.457084   0.382635    -5.425956   4.826420    2.460179    -1.627618   -0.189087   1.900241    0.003009    0.383076    0.007053    0.736209     #> 478: -6.457070   0.382655    -5.425959   4.826414    2.460299    -1.627618   -0.189087   1.900241    0.003012    0.383899    0.007068    0.736495     #> 479: -6.457057   0.382621    -5.425965   4.826417    2.460280    -1.627618   -0.189087   1.900241    0.003012    0.384429    0.007083    0.736772     #> 480: -6.457019   0.382540    -5.425969   4.826416    2.460197    -1.627619   -0.189086   1.900240    0.003014    0.384924    0.007090    0.737021     #> 481: -6.456942   0.382330    -5.425966   4.826424    2.460137    -1.627619   -0.189087   1.900240    0.003018    0.385381    0.007099    0.737271     #> 482: -6.456869   0.382137    -5.425963   4.826432    2.460125    -1.627619   -0.189087   1.900240    0.003022    0.385870    0.007114    0.737545     #> 483: -6.456812   0.382198    -5.425959   4.826435    2.460163    -1.627619   -0.189087   1.900240    0.003025    0.386609    0.007113    0.737807     #> 484: -6.456753   0.382143    -5.425956   4.826447    2.460126    -1.627619   -0.189087   1.900240    0.003026    0.387297    0.007115    0.738082     #> 485: -6.456733   0.382269    -5.425958   4.826448    2.460152    -1.627619   -0.189087   1.900240    0.003024    0.387864    0.007119    0.738326     #> 486: -6.456714   0.382357    -5.425961   4.826456    2.460197    -1.627619   -0.189087   1.900241    0.003023    0.388465    0.007117    0.738589     #> 487: -6.456704   0.382377    -5.425964   4.826453    2.460207    -1.627619   -0.189087   1.900241    0.003019    0.388944    0.007132    0.738853     #> 488: -6.456661   0.382147    -5.425961   4.826463    2.460209    -1.627619   -0.189087   1.900241    0.003019    0.389434    0.007133    0.739117     #> 489: -6.456724   0.381833    -5.425960   4.826469    2.460159    -1.627619   -0.189086   1.900241    0.003021    0.390031    0.007148    0.739359     #> 490: -6.456708   0.381878    -5.425966   4.826474    2.460160    -1.627619   -0.189086   1.900241    0.003024    0.390670    0.007147    0.739636     #> 491: -6.456702   0.381831    -5.425962   4.826479    2.460132    -1.627620   -0.189086   1.900241    0.003025    0.391154    0.007151    0.739869     #> 492: -6.456706   0.381853    -5.425959   4.826480    2.460078    -1.627620   -0.189087   1.900241    0.003029    0.391731    0.007161    0.740110     #> 493: -6.456689   0.381802    -5.425949   4.826488    2.460073    -1.627619   -0.189087   1.900241    0.003030    0.392218    0.007168    0.740354     #> 494: -6.456660   0.381838    -5.425945   4.826488    2.460048    -1.627619   -0.189086   1.900241    0.003030    0.392761    0.007177    0.740592     #> 495: -6.456607   0.381818    -5.425946   4.826483    2.460063    -1.627619   -0.189086   1.900242    0.003028    0.393506    0.007188    0.740817     #> 496: -6.456579   0.381877    -5.425946   4.826488    2.460026    -1.627619   -0.189086   1.900242    0.003030    0.394137    0.007194    0.741047     #> 497: -6.456601   0.381936    -5.425946   4.826491    2.460012    -1.627619   -0.189086   1.900242    0.003030    0.394665    0.007203    0.741292     #> 498: -6.456583   0.381874    -5.425948   4.826491    2.459960    -1.627619   -0.189086   1.900242    0.003030    0.395317    0.007202    0.741535     #> 499: -6.456536   0.381987    -5.425953   4.826490    2.459901    -1.627619   -0.189086   1.900242    0.003030    0.396084    0.007207    0.741780     #> 500: -6.456511   0.382125    -5.425956   4.826490    2.459841    -1.627620   -0.189086   1.900243    0.003029    0.396818    0.007208    0.742012     #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/nimo.html","id":"goodness-of-fit-plots","dir":"Articles","previous_headings":"","what":"Goodness of fit Plots","title":"Nimotuzumab","text":"","code":"## Add cwres/npde after fit fit  <- fit %>% addCwres() %>% addNpde() #> [====|====|====|====|====|====|====|====|====|====] 0:00:02 #> [====|====|====|====|====|====|====|====|====|====] 0:00:03 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:01 #> [====|====|====|====|====|====|====|====|====|====] 0:00:01  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:01  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:01 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  plot(fit) ## Standard nlmixr plots ################################################################################ ## Xpose plots; Need to print otherwise running a script won't ## show xpose plots ################################################################################ xpdb <- xpose_data_nlmixr(fit) ## first convert to nlmixr object  print(dv_vs_pred(xpdb) +       ylab(\"Observed Nimotuzumab Concentrations (ug/mL)\") +       xlab(\"Population Predicted Nimotuzumab Concentrations (ug/mL)\")) print(dv_vs_ipred(xpdb) +       ylab(\"Observed Nimotuzumab Concentrations (ug/mL)\") +       xlab(\"Individual Predicted Nimotuzumab Concentrations (ug/mL)\")) print(res_vs_pred(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Population Predicted Nimotuzumab Concentrations (ug/mL)\")) print(res_vs_idv(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Time (h)\")) print(prm_vs_iteration(xpdb)) print(absval_res_vs_idv(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Time (h)\")) print(absval_res_vs_pred(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Population Predicted Nimotuzumab Concentrations (ug/mL)\")) print(ind_plots(xpdb, nrow=3, ncol=4) +       ylab(\"Predicted and Observed Nimotuzumab concentrations (ug/mL)\") +       xlab(\"Time (h)\")) print(res_distrib(xpdb) +      ylab(\"Density\") +      xlab(\"Conditional Weighted Residuals\")) ################################################################################ ##Visual Predictive Checks ################################################################################ vpcPlot(fit,n=500,stratify=c(\"DOS\"), show=list(obs_dv=T),        bins = c(-0.5,0,25,75,100,200,400,600,750,900,1100,1200,1400,1600,1900,2150,2300),        ylab = \"Nimotuzumab Concentrations (ug/mL)\", xlab = \"Time (h)\") vpcPlot(fit,n=500, show=list(obs_dv=T),        bins = c(-0.5,0,25,75,100,200,400,600,750,900,1100,1200,1400,1600,1900,2150,2300),        ylab = \"Nimotuzumab Concentrations (ug/mL)\", xlab = \"Time (h)\")"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/nlmixr2-team-and-advisory-committee.html","id":"the-nlmixr2-team","dir":"Articles","previous_headings":"","what":"The nlmixr2 team","title":"nlmixr2 team and advisory committee","text":"nlmixr2 team currently following members: Matt Fidler (Lead developer) Bill Denney John Harrold Richard Hooijmaijers Anne Keunecke Theodoros Papathanasiou Rik Schoemaker Mirjam Trame Justin Wilkins also following emeritus members: Wenping Wang (founder nlmixr) Teun Post Yuan Xiong Huijuan Xu","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/nlmixr2-team-and-advisory-committee.html","id":"the-nlmixr2-scientific-advisors","dir":"Articles","previous_headings":"","what":"The nlmixr2 Scientific Advisors","title":"nlmixr2 team and advisory committee","text":"Paolo Denti Stephen Duffull Jeffry Florian Marc Gastonguay Lisa Hendricks Manuel Ibarra Mats Karlsson Joseph Standing","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"running-pk-models-with-nlmixr","dir":"Articles","previous_headings":"","what":"Running PK models with nlmixr","title":"Running PK models with nlmixr","text":"nlmixr uses unified interface specifying running models. Let’s start simple PK example, using single-dose theophylline dataset generously provided Dr. Robert . Upton University California, San Francisco: can try fitting simple one-compartment PK model small dataset. write model follows: can now run model… can alternatively express model ordinary differential equations (ODEs): can try Stochastic Approximation EM (SAEM) method model: wanted , even apply traditional R method nlme method model: example delivers complete model fit fit object, including parameter history, set fixed effect estimates, random effects included subjects.","code":"## Load libraries library(nlmixr2) str(theo_sd) #> 'data.frame':    144 obs. of  7 variables: #>  $ ID  : int  1 1 1 1 1 1 1 1 1 1 ... #>  $ TIME: num  0 0 0.25 0.57 1.12 2.02 3.82 5.1 7.03 9.05 ... #>  $ DV  : num  0 0.74 2.84 6.57 10.5 9.66 8.58 8.36 7.47 6.89 ... #>  $ AMT : num  320 0 0 0 0 ... #>  $ EVID: int  101 0 0 0 0 0 0 0 0 0 ... #>  $ CMT : int  1 2 2 2 2 2 2 2 2 2 ... #>  $ WT  : num  79.6 79.6 79.6 79.6 79.6 79.6 79.6 79.6 79.6 79.6 ... one.cmt <- function() {   ini({     ## You may label each parameter with a comment     tka <- 0.45 # Log Ka     tcl <- log(c(0, 2.7, 100)) # Log Cl     ## This works with interactive models     ## You may also label the preceding line with label(\"label text\")     tv <- 3.45; label(\"log V\")     ## the label(\"Label name\") works with all models     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     linCmt() ~ add(add.sd)   }) }  f <- nlmixr(one.cmt) fit <- nlmixr(one.cmt, theo_sd, est=\"focei\",               control=list(print=0)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(fit) #> ── nlmixr² FOCEi (outer: nlminb) ── #>  #>          OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> FOCEi 116.812 373.4118 393.5914      -179.7059        68.29718        9.353349 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002003  0.34125   0.341252 0.067    0.009 5.776495 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka              0.461  0.195 42.4       1.59 (1.08, 2.32)     70.3      1.59%  #> tcl               1.01 0.0751 7.42       2.75 (2.37, 3.19)     26.7      4.03%  #> tv         log V  3.46 0.0436 1.26       31.8 (29.2, 34.6)     14.2      11.0%  #> add.sd           0.692                               0.692                      #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Information about run found ($runInfo): #>    • gradient problems with initial estimate and covariance; see $scaleInfo  #>    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.))  #>    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  #>   Censoring ($censInformation): No censoring #>   Minimization message ($message):   #>     relative convergence (4)  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 22 #>   ID     TIME    DV  PRED    RES   WRES IPRED   IRES  IWRES CPRED   CRES  CWRES #>   <fct> <dbl> <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> #> 1 1      0     0.74  0     0.74   1.07   0     0.74   1.07   0     0.74   1.07  #> 2 1      0.25  2.84  3.26 -0.417 -0.502  3.84 -1.00  -1.45   3.50 -0.656 -0.746 #> 3 1      0.57  6.57  5.82  0.746  0.695  6.78 -0.215 -0.311  6.17  0.401  0.340 #> # ℹ 129 more rows #> # ℹ 10 more variables: eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, depot <dbl>, #> #   central <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, dosenum <dbl> one.compartment <- function() {   ini({     tka <- 0.45 # Log Ka     tcl <- 1 # Log Cl     tv <- 3.45    # Log V     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     d/dt(depot) = -ka * depot     d/dt(center) = ka * depot - cl / v * center     cp = center / v     cp ~ add(add.sd)   }) } fit2 <- nlmixr(one.compartment, theo_sd,  est=\"saem\",                control=list(print=0)) #> [====|====|====|====|====|====|====|====|====|==== #> ==|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 print(fit2) #> ── nlmixr² SAEM OBJF by FOCEi approximation ── #>  #>  Gaussian/Laplacian Likelihoods: AIC() or $objf etc.  #>  FOCEi CWRES & Likelihoods: addCwres()  #>  #> ── Time (sec $time): ── #>  #>            setup covariance  saem table compress   other #> elapsed 0.002029   0.009011 4.876 0.099    0.015 1.92796 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>         Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka    0.464  0.195   42       1.59 (1.09, 2.33)     71.1   -0.0900%  #> tcl     1.01  0.085 8.43       2.74 (2.32, 3.24)     27.4      4.80%  #> tv      3.46 0.0447 1.29         31.7 (29, 34.6)     13.1      8.77%  #> add.sd 0.696                               0.696                      #>   #>   Covariance Type ($covMethod): linFim #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Censoring ($censInformation): No censoring #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 19 #>   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    cp #>   <fct> <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl>   <dbl> <dbl> #> 1 1      0     0.74  0     0.74   0     0.74   1.06  0.0839 -0.477 -0.0849  0    #> 2 1      0.25  2.84  3.28 -0.437  3.83 -0.991 -1.42  0.0839 -0.477 -0.0849  3.83 #> 3 1      0.57  6.57  5.86  0.715  6.76 -0.194 -0.278 0.0839 -0.477 -0.0849  6.76 #> # ℹ 129 more rows #> # ℹ 7 more variables: depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, #> #   tad <dbl>, dosenum <dbl> fitN <- nlmixr(one.compartment, theo_sd, list(pnlsTol=0.5), est=\"nlme\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #>  #> **Iteration 1 #> LME step: Loglik: -183.2083, nlminb iterations: 1 #> reStruct  parameters: #>       ID1       ID2       ID3  #> 0.2195819 0.9924330 1.6502972  #>  Beginning PNLS step: ..  completed fit_nlme() step. #> PNLS step: RSS =  64.59841  #>  fixed effects: 0.4443024  1.038584  3.449959   #>  iterations: 3  #> Convergence crit. (must all become <= tolerance = 1e-05): #>      fixed   reStruct  #> 0.03715048 0.91006943  #>  #> **Iteration 2 #> LME step: Loglik: -182.0743, nlminb iterations: 1 #> reStruct  parameters: #>       ID1       ID2       ID3  #> 0.1149602 0.9686071 1.6508466  #>  Beginning PNLS step: ..  completed fit_nlme() step. #> PNLS step: RSS =  64.59843  #>  fixed effects: 0.4443024  1.038584  3.449959   #>  iterations: 1  #> Convergence crit. (must all become <= tolerance = 1e-05): #>        fixed     reStruct  #> 0.000000e+00 5.047516e-06 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 print(fitN) #> ── nlmixr² nlme by maximum likelihood ── #>  #>          OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor) #> nlme 121.5489 378.1487 398.3283      -182.0743        18.17386               1 #>  #> ── Time (sec $time): ── #>  #>            setup table compress    other #> elapsed 0.001772  0.09    0.005 3.164228 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>          Est.      SE  %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka    0.4443  0.1916 43.12     1.559 (1.071, 2.27)     68.7     -3.49%  #> tcl     1.039 0.08335 8.026    2.825 (2.399, 3.327)     27.0      7.85%  #> tv       3.45 0.04494 1.303      31.5 (28.84, 34.4)     13.5      7.29%  #> add.sd 0.6979                                0.6979                      #>   #>   Covariance Type ($covMethod): nlme #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Censoring ($censInformation): No censoring #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 19 #>   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    cp #>   <fct> <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl>   <dbl> <dbl> #> 1 1      0     0.74  0     0.74   0     0.74   1.06  0.0756 -0.483 -0.0896  0    #> 2 1      0.25  2.84  3.24 -0.401  3.78 -0.943 -1.35  0.0756 -0.483 -0.0896  3.78 #> 3 1      0.57  6.57  5.81  0.760  6.72 -0.146 -0.210 0.0756 -0.483 -0.0896  6.72 #> # ℹ 129 more rows #> # ℹ 7 more variables: depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, #> #   tad <dbl>, dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"the-ui","dir":"Articles","previous_headings":"","what":"The UI","title":"Running PK models with nlmixr","text":"nlmixr modeling dialect, inspired R NONMEM, can used fit models using current future estimation algorithms within nlmixr. Using widely-used tools inspiration advantage delivering model specification syntax instantly familiar majority analysts working pharmacometrics related fields.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"overall-model-structure","dir":"Articles","previous_headings":"The UI","what":"Overall model structure","title":"Running PK models with nlmixr","text":"Model specifications nlmixr written using functions containing ini model blocks. functions can called anything, often contain two components. Let’s look simple one-compartment model covariates.","code":"f <- function() {   ini({   # Initial conditions/variables     # are specified here   })   model({ # The model is specified     # here   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"the-ini-block","dir":"Articles","previous_headings":"The UI > Overall model structure","what":"The ini block","title":"Running PK models with nlmixr","text":"ini block specifies initial conditions, including initial estimates boundaries algorithms support (currently, built-nlme saem methods ). Nomenclature similar used NONMEM, Monolix similar packages. NONMEM world, ini block analogous $THETA, $OMEGA $SIGMA blocks. shown example: Simple parameter values specified using R-compatible assignment Boundaries may specified c(lower, est, upper). Like NONMEM, c(lower,est) equivalent c(lower,est,Inf) Also like NONMEM, c(est) specify lower bound, equivalent specifying parameter without using R’s c() function. parameters can named using almost R-compatible name. Please note : Residual error estimates coded population estimates (.e. using = <-, ~). Variable names start _ supported. Note R allow variable starting _ assigned without quoting . Naming variables start rx nlmixr suggested, since rxode2() nlmixr use prefixes internally certain estimation routines calculating residuals. Variable names case-sensitive, just like R. CL Cl. mixture models, multivariate normal individual deviations normal population parameters estimated (NONMEM called “ETA” parameters). Additionally, variance/covariance matrix deviations also estimated (NONMEM “OMEGA” matrix). also take initial estimates. nlmixr, specified ~ operator. typically used statistics R “modeled ”, chosen distinguish estimates population residual error parameters. Continuing prior example, can annotate estimates -subject error distribution… shown example: Simple variances specified variable name estimate separated ~ Correlated parameters specified sum variable labels lower triangular matrix covariance specified left handed side equation. also separated ~. initial estimates specified variance scale, analogy NONMEM, square roots diagonal elements correspond coefficients variation used exponential IIV implementation.","code":"f <- function() { # Note that arguments to the function are currently   # ignored by nlmixr   ini({     # Initial conditions for population parameters (sometimes     # called THETA parameters) are defined by either '<-' or '='     lCl <- 1.6      # log Cl (L/hr)          # Note that simple expressions that evaluate to a number are     # OK for defining initial conditions (like in R)     lVc = log(90)  # log V (L)          ## Also, note that a comment on a parameter is captured as a parameter label     lKa <- 1       # log Ka (1/hr)          # Bounds may be specified by c(lower, est, upper), like NONMEM:     # Residuals errors are assumed to be population parameters     prop.err <- c(0, 0.2, 1)          # IIV terms will be discussed in the next example   })      # The model block will be discussed later   model({}) } f <- function() {   ini({     lCl <- 1.6      ; label(\"log Cl (L/hr)\")     lVc = log(90)   ; label(\"log V (L)\")     lKa <- 1        ; label(\"log Ka (1/hr)\")     prop.err <- c(0, 0.2, 1)          # Initial estimate for ka IIV variance     # Labels work for single parameters     eta.ka ~ 0.1    ## BSV Ka      # For correlated parameters, you specify the names of each     # correlated parameter separated by a addition operator `+`     # and the left handed side specifies the lower triangular     # matrix initial of the covariance matrix.     eta.cl + eta.vc ~ c(0.1,                         0.005, 0.1)          # Note that labels do not currently work for correlated     # parameters.  Also, do not put comments inside the lower     # triangular matrix as this will currently break the model.   })      # The model block will be discussed later   model({}) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"the-model-block","dir":"Articles","previous_headings":"The UI > Overall model structure","what":"The model block","title":"Running PK models with nlmixr","text":"model block specifies model, analogous $PK, $PRED $ERROR blocks NONMEM. initialization block defined, can define model terms variables defined ini block. can also mix rxode2() blocks model needed. current method defining nlmixr model specify parameters, required rxode2() lines. Continuing annotated example: points note: Parameters defined differential equations. Currently directly defining differential equations terms population parameters supported. differential equations, parameters error terms single block, instead multiple sections. Additionally state names, calculated variables, also start either rx_ nlmixr_ since used internally estimation routines. Errors specified using tilde, ~. Currently can use either add(parameter) additive error, prop(parameter) proportional error add(parameter1) + prop(parameter2) combined additive proportional error. can also specify norm(parameter) additive error, since follows normal distribution. routines, like saem, require parameters expressed terms Pop.Parameter + Individual.Deviation.Parameter +   Covariate*Covariate.Parameter. order parameters matter. similar NONMEM’s mu-referencing, though restrictive. means saem, parameterization form Cl <- Cl*exp(eta.Cl) allowed. type parameter model determined ini block; covariates used model included ini block. variables need present modeling dataset model run.","code":"f <- function() {   ini({     lCl <- 1.6       # log Cl (L/hr)     lVc <- log(90)   # log Vc (L)     lKA <- 0.1       # log Ka (1/hr)     prop.err <- c(0, 0.2, 1)          eta.Cl ~ 0.1     # BSV Cl     eta.Vc ~ 0.1     # BSV Vc     eta.KA ~ 0.1     # BSV Ka   })   model({     # Parameters are defined in terms of the previously-defined     # parameter names:     Cl <- exp(lCl + eta.Cl)     Vc =  exp(lVc + eta.Vc)     KA <- exp(lKA + eta.KA)          # Next, the differential equations are defined:     kel <- Cl / Vc;          d/dt(depot)  = -KA*depot;     d/dt(centr)  =  KA*depot-kel*centr;          # And the concentration is then calculated     cp = centr / Vc;     # Finally, we specify that the plasma concentration follows     # a proportional error distribution (estimated by the parameter      # prop.err)     cp ~ prop(prop.err)   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"running-models","dir":"Articles","previous_headings":"The UI","what":"Running models","title":"Running PK models with nlmixr","text":"Models can fitted several ways, including via [magrittr] forward-pipe operator. Options estimation routines can specified using nlmeControl nlme estimation: options specified nlme documentation. Options saem can specified using saemControl: example specifies 250 burn-iterations, 350 em iterations print progress every 50 runs.","code":"fit <- nlmixr(one.compartment) %>% nlmixr(data = theo_sd, est = \"saem\") fit2 <- nlmixr(one.compartment, data = theo_sd, est = \"saem\") fit3 <- one.compartment %>% nlmixr(data = theo_sd, est = \"saem\") fit4 <- nlmixr(one.compartment, theo_sd, est = \"nlme\", control = nlmeControl(pnlsTol = .5)) fit5 <- nlmixr(one.compartment,theo_sd,est=\"saem\",control=saemControl(n.burn=250,n.em=350,print=50))"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"model-syntax-for-solved-pk-systems","dir":"Articles","previous_headings":"The UI","what":"Model Syntax for solved PK systems","title":"Running PK models with nlmixr","text":"Solved PK systems also currently supported nlmixr ‘linCmt()’ pseudo-function. annotated example solved system : things keep mind: solved systems implemented one, two three compartment models without first-order absorption. models support lag time tlag parameter. general linear compartment model figures model parameter names. nlmixr2 currently knows numbered volumes, Vc/Vp, Clearances terms Cl Q/CLD. Additionally nlmixr knows elimination micro-constants (ie K12). Mixing parameters models currently supported. --date information linCmt() models see rxode2 documentation.","code":"f <- function(){   ini({     lCl <- 1.6      ; label(\"log Cl (L/hr)\")     lVc <- log(90)  ; label(\"log Vc (L)\")     lKA <- 0.1      ; label(\"log Ka (1/hr)\")     prop.err <- c(0, 0.2, 1)     eta.Cl ~ 0.1   # BSV Cl     eta.Vc ~ 0.1   # BSV Vc     eta.KA ~ 0.1   # BSV Ka   })   model({     Cl <- exp(lCl + eta.Cl)     Vc = exp(lVc + eta.Vc)     KA <- exp(lKA + eta.KA)     ## Instead of specifying the ODEs, you can use     ## the linCmt() function to use the solved system.     ##     ## This function determines the type of PK solved system     ## to use by the parameters that are defined.  In this case     ## it knows that this is a one-compartment model with first-order     ## absorption.     linCmt() ~ prop(prop.err)   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"checking-model-syntax","dir":"Articles","previous_headings":"The UI","what":"Checking model syntax","title":"Running PK models with nlmixr","text":"specifying model syntax can check nlmixr interpreting correctly using nlmixr function . Using function can get: Cl=exp(lCl+eta.Cl)Vc=exp(lVc+eta.Vc)KA=exp(lKA+eta.KA)linCmt()∼prop(prop.err)\\begin{align*} {Cl} & = \\exp\\left({lCl}+{eta.Cl}\\right) \\\\ {Vc} & = \\exp\\left({lVc}+{eta.Vc}\\right) \\\\ {KA} & = \\exp\\left({lKA}+{eta.KA}\\right) \\\\ linCmt() & \\sim prop({prop.err}) \\end{align*} general gives information model (type solved system/rxode2()), initial estimates well code model block.","code":"nlmixr(f)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/wbc.html","id":"fit-model-using-saem","dir":"Articles","previous_headings":"","what":"Fit model using saem","title":"Friberg myelosuppression model","text":"","code":"d3 <- read.csv(\"Simulated_WBC_pacl_ddmore_samePK_nlmixr.csv\", na.strings = \".\")  fit.S <- nlmixr(wbc, d3, est=\"saem\", list(print=0), table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:02 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  library(xpose.nlmixr2)  xpdb <- xpose_data_nlmixr(fit.S)  plot(fit.S) print(dv_vs_pred(xpdb) +       ylab(\"Observed Neutrophil Count (10^9/L)\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(dv_vs_ipred(xpdb) +       ylab(\"Observed Neutrophil Count (10^9/L)\") +       xlab(\"Individual Predicted Neutrophil Count (10^9/L)\")) print(res_vs_pred(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(res_vs_idv(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Time (h)\")) print(prm_vs_iteration(xpdb)) print(absval_res_vs_idv(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Time (h)\")) print(absval_res_vs_pred(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(ind_plots(xpdb, nrow=3, ncol=4) +       ylab(\"Predicted and Observed Neutrophil Count (10^9/L)\") +       xlab(\"Time (h)\")) print(res_distrib(xpdb) +       ylab(\"Density\") +       xlab(\"Conditional Weighted Residuals\")) vpcPlot(fit.S, n=500, n_bins = 10, show=list(obs_dv=TRUE),         ylab = \"Neutrophil Count (10^9/L)\", xlab = \"Time (h)\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:04 vpcPlot(fit.S, n=500, bins = c(0,170,300,350,500,600,900,3000,4580),         show=list(obs_dv=TRUE), ylab = \"Neutrophil Count (10^9/L)\", xlab = \"Time (h)\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:04"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/wbc.html","id":"fit-model-using-focei","dir":"Articles","previous_headings":"","what":"Fit model using FOCEi","title":"Friberg myelosuppression model","text":"","code":"fit.F <- nlmixr(wbc, d3, est=\"focei\", list(print=0), table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:28  #> done #> [====|====|====|====|====|====|====|====|====|====] 0:00:02"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/wbc.html","id":"focei-goodness-of-fit-plots","dir":"Articles","previous_headings":"Fit model using FOCEi","what":"FOCEi goodness of fit plots","title":"Friberg myelosuppression model","text":"","code":"xpdb <- xpose_data_nlmixr(fit.F) plot(fit.F) print(dv_vs_pred(xpdb) +       ylab(\"Observed Neutrophil Count (10^9/L)\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(dv_vs_ipred(xpdb) +       ylab(\"Observed Neutrophil Count (10^9/L)\") +       xlab(\"Individual Predicted Neutrophil Count (10^9/L)\")) print(res_vs_pred(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(res_vs_idv(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Time (h)\")) print(absval_res_vs_idv(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Time (h)\")) print(absval_res_vs_pred(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(ind_plots(xpdb, nrow=3, ncol=4) +       ylab(\"Predicted and Observed Neutrophil Count (10^9/L)\") +       xlab(\"Time (h)\")) print(res_distrib(xpdb) +       ylab(\"Density\") +       xlab(\"Conditional Weighted Residuals\")) # 10 bins is slightly better than auto bin vpcPlot(fit.F, n=500, n_bins = 10, show=list(obs_dv=TRUE),         ylab = \"Neutrophil Count (10^9/L)\", xlab = \"Time (h)\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:04 # specify bins vpcPlot(fit.F, n=500, bins = c(0, 170, 300, 350, 500, 600, 900, 3000, 4580),         show=list(obs_dv=TRUE),         ylab = \"Neutrophil Count (10^9/L)\", xlab = \"Time (h)\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:04"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"load-the-data","dir":"Articles","previous_headings":"","what":"Load the data","title":"xgxr and ggPMX integration with nlmixr2","text":"","code":"pkpd_data <-   case1_pkpd %>%   arrange(DOSE) %>%   select(-IPRED) %>%   mutate(TRTACT_low2high = factor(TRTACT, levels = unique(TRTACT)),          TRTACT_high2low = factor(TRTACT, levels = rev(unique(TRTACT))),          DAY_label = paste(\"Day\", PROFDAY),          DAY_label = ifelse(DAY_label == \"Day 0\",\"Baseline\",DAY_label))   pk_data <- pkpd_data %>%   filter(CMT == 2)  pk_data_cycle1 <- pk_data %>%   filter(CYCLE == 1)"},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"use-xgxr-for-simplified-concentration-over-time-colored-by-dose-mean---95-ci","dir":"Articles","previous_headings":"Exploratory analysis using ggplot and xgx helper functions","what":"Use xgxr for simplified concentration over time, colored by Dose, mean +/- 95% CI","title":"xgxr and ggPMX integration with nlmixr2","text":"Often exploring data worthwhile plot dose nominal time add 95% confidence interval. typical plot can cumbersome lack nice features xgxr can help . Note following helper functions: xgx_theme_set() sets theme black white color theme best practices xgxr. xgx_geom_ci() creates Confidence Interval mean plots simple interface. xgx_scale_y_log10() creates log-scale includes minor grids immediately show viewer plot semi-log plot without carefully examining y axis. xgx_scale_x_time_units() creates appropriate scale based times observed units use. also allows convert units easily right display. xgx_annote_status() adds DRAFT annotation often considered best practice data plots draft.  plot see mean concentrations confidence intervals stratified dose","code":"xgx_theme_set() # This uses black and white theme based on xgxr best                 # practices  # flag for labeling figures as draft status <- \"DRAFT\"  time_units_dataset <- \"hours\" time_units_plot    <- \"days\" trtact_label       <- \"Dose\" dose_label         <- \"Dose (mg)\" conc_label         <- \"Concentration (ng/ml)\"  auc_label          <- \"AUCtau (h.(ng/ml))\" concnorm_label     <- \"Normalized Concentration (ng/ml)/mg\" sex_label          <- \"Sex\" w100_label         <- \"WEIGHTB>100\" pd_label           <- \"FEV1 (mL)\" cens_label         <- \"Censored\"   ggplot(data = pk_data_cycle1, aes(x     = NOMTIME,                                   y     = LIDV,                                   group = DOSE,                                   color = TRTACT_high2low)) +     xgx_geom_ci(conf_level = 0.95) + # Easy CI with xgxr     xgx_scale_y_log10() + # semi-log plots with semi-log grid minor lines     xgx_scale_x_time_units(units_dataset = time_units_dataset,                            units_plot = time_units_plot) +     # The last line creates an appropriate x scale based on time-units     # and time unit scale     labs(y = conc_label, color = trtact_label) +     xgx_annotate_status(status) #  Adds draft status to plot"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"concentration-over-time-faceted-by-dose-mean---95-ci-overlaid-on-gray-spaghetti-plots","dir":"Articles","previous_headings":"Exploratory analysis using ggplot and xgx helper functions","what":"Concentration over time, faceted by Dose, mean +/- 95% CI, overlaid on gray spaghetti plots","title":"xgxr and ggPMX integration with nlmixr2","text":"useful look mean concentrations, often useful look mean concentrations relationship actual individual profiles. Using ggplot coupled xgxr helper functions used , can easily create plots well:  appears variability seems higher higher doses higher later times.","code":"ggplot(data = pk_data_cycle1, aes(x = TIME, y = LIDV)) +   geom_line(aes(group = ID), color = \"grey50\", linewidth = 1, alpha = 0.3) +   geom_cens(aes(cens=CENS)) +    xgx_geom_ci(aes(x = NOMTIME, color = NULL, group = NULL, shape = NULL), conf_level = 0.95) +   xgx_scale_y_log10() +   xgx_scale_x_time_units(units_dataset = time_units_dataset, units_plot = time_units_plot) +   labs(y = conc_label, color = trtact_label) +   theme(legend.position = \"none\") +   facet_grid(.~TRTACT_low2high) +   xgx_annotate_status(status)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"exploring-the-dose-linearity","dir":"Articles","previous_headings":"Exploratory analysis using ggplot and xgx helper functions","what":"Exploring the dose linearity","title":"xgxr and ggPMX integration with nlmixr2","text":"common way explore dose linearity normalize dose. confidence intervals overlap, often dose linear example.  example seems dose-linear, exception censored data. can made even clear removing censored data plot:  lowest dose, censoring, one seems outlier. likely artifact censoring. ways explore data include looking normalized Cmax AUC values (skip vignette).","code":"ggplot(data = pk_data_cycle1,        aes(x = NOMTIME,            y = LIDV / as.numeric(as.character(DOSE)),            group = DOSE,            color = TRTACT_high2low)) +   xgx_geom_ci(conf_level = 0.95, alpha = 0.5, position = position_dodge(1)) +   xgx_scale_y_log10() +   xgx_scale_x_time_units(units_dataset = time_units_dataset, units_plot = time_units_plot) +   labs(y = concnorm_label, color = trtact_label) +   xgx_annotate_status(status) ggplot(data = pk_data_cycle1 %>% filter(CENS == 0),        aes(x = NOMTIME,            y = LIDV / as.numeric(as.character(DOSE)),            group = DOSE,            color = TRTACT_high2low)) +   xgx_geom_ci(conf_level = 0.95, alpha = 0.5, position = position_dodge(1)) +   xgx_scale_y_log10() +   xgx_scale_x_time_units(units_dataset = time_units_dataset, units_plot = time_units_plot) +   labs(y = concnorm_label, color = trtact_label) +   xgx_annotate_status(status)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"exploring-covariates-in-the-dataset","dir":"Articles","previous_headings":"","what":"Exploring Covariates in the dataset","title":"xgxr and ggPMX integration with nlmixr2","text":"Using xgx helper functions ggplot can explore effect high baseline weight. particular plot shown :  seems weight effect extreme either dose group","code":"ggplot(data = pk_data_cycle1, aes(x = NOMTIME,                                   y = LIDV,                                   group = WEIGHTB > 100,                                   color = WEIGHTB > 100)) +      xgx_geom_ci(conf_level = 0.95) +     xgx_scale_y_log10() +     xgx_scale_x_time_units(units_dataset = time_units_dataset, units_plot = time_units_plot) +     facet_grid(.~DOSE) +     labs(y = conc_label, color = w100_label) +     xgx_annotate_status(status)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"summary-of-exploratory-analysis-findings","dir":"Articles","previous_headings":"Exploring Covariates in the dataset","what":"Summary of exploratory analysis findings","title":"xgxr and ggPMX integration with nlmixr2","text":"exploratory analysis see: - doses seem proportional - PK seems 2-compartment model - Censoring large effect PK data.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"fitting-the-data-with-nlmixr","dir":"Articles","previous_headings":"","what":"Fitting the data with nlmixr","title":"xgxr and ggPMX integration with nlmixr2","text":"First need subset PK data rename LIDV DV Next, purpose demonstration subset 7 patients per dose group): approach good demonstration, allows variety structural models applied quickly developing base model. full dataset can applied selected model make sure makes sense data. Next create 2 compartment model: Now parsing nlmixr model complete start compare models: Now run 3 different estimation methods, can compare results side--side Note additive proportional model additive component approach zero. comparing objective functions log-normal proportional models, proportional model lowest objective function value. (Since modeled log-normal without data transformation appropriate compare AIC/Objective function values)","code":"dat <-   case1_pkpd %>%   rename(DV=LIDV) %>%   filter(CMT %in% 1:2) %>%   filter(TRTACT != \"Placebo\") doses <- unique(dat$DOSE) nid <- 20 # 7 ids per dose group dat2 <-   dat %>%   group_by(DOSE) %>%   filter(ID %in% sort(unique(ID))[1:nid]) %>%   ungroup() ## Use 2 compartment model cmt2 <- function() {   ini({     lka <- log(0.1); label(\"Ka\")     lv <- log(10); label(\"Vc\")     lcl <- log(4); label(\"Cl\")     lq <- log(10); label(\"Q\")     lvp <- log(20); label(\"Vp\")      eta.ka ~ 0.01     eta.v ~ 0.1     eta.cl ~ 0.1     logn.sd = 10   })   model({     ka <- exp(lka + eta.ka)     cl <- exp(lcl + eta.cl)     v <- exp(lv + eta.v)     q <- exp(lq)     vp <- exp(lvp)     linCmt() ~ lnorm(logn.sd)   }) }  ## Check parsing cmt2m <- nlmixr(cmt2) print(cmt2m) #>  ── rxode2-based solved PK 2-compartment model ──────────────────────────────────  #>  ── Initalization: ──   #> Fixed Effects ($theta):  #>       lka        lv       lcl        lq       lvp   logn.sd  #> -2.302585  2.302585  1.386294  2.302585  2.995732 10.000000  #>  #> Omega ($omega):  #>        eta.ka eta.v eta.cl #> eta.ka   0.01   0.0    0.0 #> eta.v    0.00   0.1    0.0 #> eta.cl   0.00   0.0    0.1 #>  #> States ($state or $stateDf):  #>   Compartment Number Compartment Name Rate   Off Internal # #> 1                  1            depot TRUE FALSE          1 #> 2                  2          central TRUE FALSE          2 #>  ── μ-referencing ($muRefTable): ──   #>   theta    eta level #> 1   lka eta.ka    id #> 2   lcl eta.cl    id #> 3    lv  eta.v    id #>  #>  ── Model (Normalized Syntax): ──  #> function() { #>     ini({ #>         lka <- -2.30258509299405 #>         label(\"Ka\") #>         lv <- 2.30258509299405 #>         label(\"Vc\") #>         lcl <- 1.38629436111989 #>         label(\"Cl\") #>         lq <- 2.30258509299405 #>         label(\"Q\") #>         lvp <- 2.99573227355399 #>         label(\"Vp\") #>         logn.sd <- c(0, 10) #>         eta.ka ~ 0.01 #>         eta.v ~ 0.1 #>         eta.cl ~ 0.1 #>     }) #>     model({ #>         ka <- exp(lka + eta.ka) #>         cl <- exp(lcl + eta.cl) #>         v <- exp(lv + eta.v) #>         q <- exp(lq) #>         vp <- exp(lvp) #>         linCmt() ~ lnorm(logn.sd) #>     }) #> } ## First try log-normal (since the variability seemed proportional to concentration) cmt2fit.logn <-   nlmixr(     cmt2m, data = dat2,     est = \"saem\",     control=list(print=0),      table=tableControl(cwres=TRUE, npde=TRUE)   ) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:02 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  ## Now try proportional cmt2fit.prop <-   cmt2fit.logn %>%   update(linCmt() ~ prop(prop.sd)) %>%   nlmixr(     est=\"saem\", control=list(print=0),     table=tableControl(npde=TRUE, cwres=TRUE)   ) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:02 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  ## now try add+prop cmt2fit.add.prop <-   cmt2fit.prop %>%   update(linCmt() ~ prop(prop.sd) + add(add.sd)) %>%   nlmixr(     est=\"saem\", control=list(print=0),      table=tableControl(npde=TRUE, cwres=TRUE)   ) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:02 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 library(huxtable)  huxreg(   \"lognormal\"=cmt2fit.logn,   \"proportional\"=cmt2fit.prop,   \"add+prop\"=cmt2fit.add.prop,   statistics=c(N=\"nobs\", \"logLik\", \"AIC\"),   stars = NULL )"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"model-diagnostics-with-ggpmx","dir":"Articles","previous_headings":"","what":"Model Diagnostics with ggPMX","title":"xgxr and ggPMX integration with nlmixr2","text":"creates two reports default settings, pdf word document. report can customized editing default template include project specificities (change labels, stratifications, filtering, etc.).    creates two reports default settings, pdf word document. report can customized editing default template include project specifics (change labels, stratification, filtering, etc.).","code":"## The controller then can be piped into a specific plot ctr <- pmx_nlmixr(cmt2fit.logn, conts = \"WEIGHTB\", cats=\"TRTACT\", vpc=TRUE) #> [====|====|====|====|====|====|====|====|====|====] 0:00:02 ctr %>% pmx_plot_npde_pred() ## Modify graphical options and remove DRAFT label: ctr %>%   pmx_plot_npde_time(     smooth = list(color=\"blue\"), point = list(shape=4), is.draft=FALSE,      labels = list(x = \"Time after first dose (days)\", y = \"Normalized PDE\")   ) ctr %>% pmx_plot_dv_ipred(scale_x_log10=TRUE, scale_y_log10=TRUE, filter=IPRED>0.001) ctr %>% pmx_plot_dv_pred(scale_x_log10=TRUE, scale_y_log10=TRUE, filter=IPRED>0.001) ctr %>% pmx_plot_abs_iwres_ipred() ctr %>%   pmx_plot_individual(     1,     filter= TIME > 0 & TIME < 48,     facets = list(nrow = 2, ncol = 2)   ) ctr %>% pmx_plot_iwres_dens() ctr %>% pmx_plot_eta_qq() ctr %>% pmx_plot_eta_box() ctr %>% pmx_plot_eta_hist() ctr %>% pmx_plot_eta_matrix()"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"simulation-of-a-new-scenario-with-rxode2","dir":"Articles","previous_headings":"","what":"Simulation of a new scenario with rxode2","title":"xgxr and ggPMX integration with nlmixr2","text":"creating events can simply simulate new scenario. Perhaps drug development team wants explore 100 mg dose 3 times day dosing see happens PK. can simply simulate nlmixr model using new event table created rxode2(). case wish simulate variability see happens steady state: nlmixr model already includes information parameter estimates can simulate without uncertainty population parameters covariances, like done VPC. wish simulate 100 patients repeated 100 different theoretical studies simulate uncertainty fixed parameter estimates covariances can easily nlmixr2/rxode2: may examine simulated study information easily, show rxode2() printout: can also see covariance matricies simulated (note come inverse Wishart distribution): also easy enough create plot see going simulation:   complex simulations variability can also simulate dosing windows sampling windows use tool want summarize way wish.","code":"# Start a new simulation ev <- et(amt=100, ii=8, ss=1) ev$add.sampling(seq(0, 8, length.out=50)) print(ev) #> ── EventTable with 51 records ── #> 1 dosing records (see $get.dosing(); add with add.dosing or et) #> 50 observation times (see $get.sampling(); add with add.sampling or et) #> ── First part of : ── #> # A tibble: 51 × 5 #>     time   amt    ii evid             ss #>    <dbl> <dbl> <dbl> <evid>        <int> #>  1 0        NA    NA 0:Observation    NA #>  2 0       100     8 1:Dose (Add)      1 #>  3 0.163    NA    NA 0:Observation    NA #>  4 0.327    NA    NA 0:Observation    NA #>  5 0.490    NA    NA 0:Observation    NA #>  6 0.653    NA    NA 0:Observation    NA #>  7 0.816    NA    NA 0:Observation    NA #>  8 0.980    NA    NA 0:Observation    NA #>  9 1.14     NA    NA 0:Observation    NA #> 10 1.31     NA    NA 0:Observation    NA #> # ℹ 41 more rows set.seed(100) sim1 <- rxSolve(cmt2fit.logn, ev, nSub=100, nStud=100) #> [====|====|====|====|====|====|====|====|====|==== print(sim1) #> ── Solved rxode2 object ── #> ── Parameters ($params): ── #> # A tibble: 10,000 × 10 #>    sim.id   lka    lv   lcl    lq   lvp logn.sd  eta.ka   eta.v   eta.cl #>     <int> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>   <dbl>   <dbl>    <dbl> #>  1      1 -2.26  2.25  1.90  2.10  3.11    1.04  0.0114 -0.0174 -0.752   #>  2      2 -2.26  2.25  1.90  2.10  3.11    1.04  0.193  -0.167  -0.716   #>  3      3 -2.26  2.25  1.90  2.10  3.11    1.04  0.155   0.377  -0.00240 #>  4      4 -2.26  2.25  1.90  2.10  3.11    1.04 -0.0459  0.0259  0.373   #>  5      5 -2.26  2.25  1.90  2.10  3.11    1.04  0.250  -0.416  -0.0179  #>  6      6 -2.26  2.25  1.90  2.10  3.11    1.04  0.164   0.216  -0.328   #>  7      7 -2.26  2.25  1.90  2.10  3.11    1.04 -0.0476 -0.109  -0.936   #>  8      8 -2.26  2.25  1.90  2.10  3.11    1.04 -0.0652 -0.911  -0.228   #>  9      9 -2.26  2.25  1.90  2.10  3.11    1.04 -0.0116  0.335   0.281   #> 10     10 -2.26  2.25  1.90  2.10  3.11    1.04  0.167  -0.195  -0.0404  #> # ℹ 9,990 more rows #> ── Initial Conditions ($inits): ── #>       depot     central peripheral1  #>           0           0           0  #>  #> Simulation with uncertainty in: #> • parameters ($thetaMat for changes) #> • omega matrix ($omegaList) #> • sigma matrix ($sigmaList) #>  #> ── First part of data (object): ── #> # A tibble: 500,000 × 12 #>   sim.id  time    ka    cl     v     q    vp ipredSim   sim depot central #>    <int> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl> <dbl> <dbl>   <dbl> #> 1      1 0     0.106  3.14  9.36  8.21  22.4     3.60  5.49  175.    33.8 #> 2      1 0.163 0.106  3.14  9.36  8.21  22.4     3.75  1.77  172.    35.1 #> 3      1 0.327 0.106  3.14  9.36  8.21  22.4     3.86 12.5   169.    36.2 #> 4      1 0.490 0.106  3.14  9.36  8.21  22.4     3.95 32.7   166.    37.0 #> 5      1 0.653 0.106  3.14  9.36  8.21  22.4     4.02  1.13  163.    37.6 #> 6      1 0.816 0.106  3.14  9.36  8.21  22.4     4.07  2.21  160.    38.1 #> # ℹ 499,994 more rows #> # ℹ 1 more variable: peripheral1 <dbl> head(sim1$thetaMat) #>              lka           lv         lcl          lq         lvp #> [1,]  0.02947905  0.089896667  0.04984078 -0.06706706  0.06520861 #> [2,]  0.06197460 -0.170342222 -0.05373612  0.68716441  0.09226292 #> [3,] -0.06697635 -0.217177252 -0.10981408 -0.20229225 -0.14341128 #> [4,] -0.06332902 -0.184020593  0.16697188  0.30978833 -0.03255698 #> [5,] -0.17713830 -0.148149267  0.07439355 -0.69996458 -0.51233627 #> [6,] -0.05815461  0.008916266 -0.05256217 -0.23281914 -0.24435683 head(sim1$omegaList) #> [[1]] #>              eta.ka        eta.v       eta.cl #> eta.ka  0.012623191 -0.004464206 -0.003035283 #> eta.v  -0.004464206  0.150338686  0.016213674 #> eta.cl -0.003035283  0.016213674  0.511307406 #>  #> [[2]] #>              eta.ka        eta.v       eta.cl #> eta.ka  0.010590789 -0.002237411 -0.005009739 #> eta.v  -0.002237411  0.134165266  0.023422769 #> eta.cl -0.005009739  0.023422769  0.480798833 #>  #> [[3]] #>              eta.ka         eta.v       eta.cl #> eta.ka 0.0099509533  0.0008136218  0.005543711 #> eta.v  0.0008136218  0.1349640454 -0.056394136 #> eta.cl 0.0055437113 -0.0563941356  0.483792201 #>  #> [[4]] #>              eta.ka        eta.v      eta.cl #> eta.ka 0.0123884759 0.0002081887 0.003492112 #> eta.v  0.0002081887 0.1040441775 0.016897162 #> eta.cl 0.0034921121 0.0168971618 0.440930357 #>  #> [[5]] #>              eta.ka       eta.v       eta.cl #> eta.ka  0.012777103 0.003651706 -0.003321946 #> eta.v   0.003651706 0.140182692  0.009462842 #> eta.cl -0.003321946 0.009462842  0.492853429 #>  #> [[6]] #>              eta.ka        eta.v       eta.cl #> eta.ka  0.012372109 -0.007659249 -0.007657738 #> eta.v  -0.007659249  0.123751802  0.032497415 #> eta.cl -0.007657738  0.032497415  0.496990248 head(sim1$sigmaList) #> [[1]] #>                rxerr.rxLinCmt #> rxerr.rxLinCmt      0.9911237 #>  #> [[2]] #>                rxerr.rxLinCmt #> rxerr.rxLinCmt       1.028955 #>  #> [[3]] #>                rxerr.rxLinCmt #> rxerr.rxLinCmt       1.016967 #>  #> [[4]] #>                rxerr.rxLinCmt #> rxerr.rxLinCmt       1.024366 #>  #> [[5]] #>                rxerr.rxLinCmt #> rxerr.rxLinCmt      0.9737614 #>  #> [[6]] #>                rxerr.rxLinCmt #> rxerr.rxLinCmt       1.025798 conf <- confint(sim1, \"sim\")  p1 <- plot(conf) ## This returns a ggplot2 object  ## you can tweak the plot by the standard ggplot commands p1 +   xlab(\"Time (hr)\") +    ylab(\"Simulated Concentrations of TID steady state\") # And put the same plot on a semi-log plot p1 +   xlab(\"Time (hr)\") +    ylab(\"Simulated Concentrations of TID steady state\") +   xgx_scale_y_log10()"},{"path":"https://nlmixr2.github.io/nlmixr2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matthew Fidler. Author, maintainer. Anne Keunecke. Contributor. Rik Schoemaker. Contributor. Justin Wilkins. Contributor. Wenping Wang. Contributor. Mirjam Trame. Contributor. John Harrold. Contributor. Bill Denney. Contributor. Theodoros Papathanasiou. Contributor. Richard Hooijmaijers. Contributor. Michael Wayne Kearney. Contributor.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Fidler M (????). nlmixr2: Nonlinear Mixed Effects Models Population PK/PD. R package version 4.0.1, https://nlmixr2.org/. Fidler M, Wilkins J, Hooijmaijers R, Post T, Schoemaker R, Trame M, Xiong Y, Wang W (2019). “Nonlinear Mixed-Effects Model Development Simulation Using nlmixr Related R Open-Source Packages.” CPT: Pharmacometrics & Systems Pharmacology, 8(9), 621–633. https://doi.org/10.1002/psp4.12445. Schoemaker R, Fidler M, Laveille C, Wilkins J, Hooijmaijers R, Post T, Trame M, Xiong Y, Wang W (2019). “Performance SAEM FOCEI Algorithms Open-Source, Nonlinear Mixed Effect Modeling Tool nlmixr.” CPT: Pharmacometrics & Systems Pharmacology, 8(12), 923–930. https://doi.org/10.1002/psp4.12471.","code":"@Manual{,   title = {nlmixr2: Nonlinear Mixed Effects Models in Population PK/PD},   author = {Matthew Fidler},   note = {R package version 4.0.1},   url = {https://nlmixr2.org/}, } @Article{,   title = {Nonlinear Mixed-Effects Model Development and Simulation Using nlmixr and Related R Open-Source Packages},   author = {Matthew Fidler and Justin Wilkins and Richard Hooijmaijers and Teun Post and Rik Schoemaker and Mirjam Trame and Yuan Xiong and Wenping Wang},   journal = {CPT: Pharmacometrics \\& Systems Pharmacology},   year = {2019},   volume = {8},   pages = {621--633},   number = {9},   month = {sep},   abstract = {nlmixr is a free and open-source R package for fitting nonlinear pharmacokinetic (PK), pharmacodynamic (PD), joint PK-PD, and quantitative systems pharmacology mixed-effects models. Currently, nlmixr is capable of fitting both traditional compartmental PK models as well as more complex models implemented using ordinary differential equations. We believe that, over time, it will become a capable, credible alternative to commercial software tools, such as NONMEM, Monolix, and Phoenix NLME.},   address = {Hoboken},   publisher = {John Wiley and Sons Inc.},   url = {https://doi.org/10.1002/psp4.12445}, } @Article{,   title = {Performance of the SAEM and FOCEI Algorithms in the Open-Source, Nonlinear Mixed Effect Modeling Tool nlmixr},   author = {Rik Schoemaker and Matthew Fidler and Christian Laveille and Justin Wilkins and Richard Hooijmaijers and Teun Post and Mirjam Trame and Yuan Xiong and Wenping Wang},   journal = {CPT: Pharmacometrics \\& Systems Pharmacology},   year = {2019},   volume = {8},   pages = {923--930},   number = {12},   month = {dec},   abstract = {The free and open-source package nlmixr implements pharmacometric nonlinear mixed effects model parameter estimation in R. It provides a uniform language to define pharmacometric models using ordinary differential equations. Performances of the stochastic approximation expectation-maximization (SAEM) and first order-conditional estimation with interaction (FOCEI) algorithms in nlmixr were compared with those found in the industry standards, Monolix and NONMEM, using the following two scenarios: a simple model fit to 500 sparsely sampled data sets and a range of more complex compartmental models with linear and nonlinear clearance fit to data sets with rich sampling. Estimation results obtained from nlmixr for FOCEI and SAEM matched the corresponding output from NONMEM/FOCEI and Monolix/SAEM closely both in terms of parameter estimates and associated standard errors. These results indicate that nlmixr may provide a viable alternative to existing tools for pharmacometric parameter estimation.},   url = {https://doi.org/10.1002/psp4.12471}, }"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"nlmixr2","dir":"","previous_headings":"","what":"Nonlinear Mixed Effects Models in Population PK/PD","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"vision nlmixr2 develop R-based open-source nonlinear mixed-effects modeling software package can compete commercial pharmacometric tools suitable regulatory submissions. short, goal nlmixr2 support easy robust nonlinear mixed effects models R. supported team advisory committee","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"blog-for-more-information","dir":"","previous_headings":"","what":"Blog for more information","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"information ongoing development, best practices, news nlmixr2, please see nlmixr2 blog.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"versions R, need compiler setup run nlmixr2 rxode2","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"windows-compilation-tools-setup","dir":"","previous_headings":"Installation","what":"Windows compilation tools setup","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"Windows compilers come RTools. Download install version RTools version R https://cran.r-project.org/bin/windows/Rtools/","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"mac-compilation-tools-setup","dir":"","previous_headings":"Installation","what":"Mac compilation tools setup","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"setup mac compilers, simply Install Xcode app store Install gfortran: Download install https://mac.r-project.org/tools/ Add gfortran directory path : export     PATH=$PATH:/usr/local/gfortran/bin","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"r-package-installation","dir":"","previous_headings":"","what":"R package installation","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"Installation nlmixr2 easiest latest version R compilation required supporting packages available. R, run: R-4.0.x R-4.1.x, symengine package need downgraded run earlier R versions. can done : followed :","code":"install.packages(\"nlmixr2\",dependencies = TRUE) # install.packages(\"remotes\") remotes::install_version(\"symengine\", version = \"0.1.6\") install.packages(\"nlmixr2\",dependencies = TRUE)"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"checking-installation","dir":"","previous_headings":"","what":"Checking installation","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"can check installation likely setup correctly following command installing nlmixr2 package:","code":"nlmixr2::nlmixr2CheckInstall()"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"development-version-installation","dir":"","previous_headings":"","what":"Development version installation","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"compilers setup compatible version symengine installed, can install development version nlmixr2 nlmixr2-family dependencies either using r-universe installing manually.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"install-using-the-r-universe","dir":"","previous_headings":"Development version installation","what":"Install using the R universe","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"many people fastest way install development version nlmixr2 since provides binaries mac, windows latest last version R (need wait compile). using Ubuntu latest flavor (time writing jammy) can also use binaries (though use bspm install dependencies first reduce computation time) Support packages R universe can also installed packages nlmixr2 domain: Ubuntu latest similar","code":"install.packages(c(\"dparser\", \"nlmixr2data\", \"lotri\", \"rxode2ll\",                    \"rxode2\", \"nlmixr2est\", \"nlmixr2extra\", \"nlmixr2plot\",                    \"nlmixr2\"),                  repos = c('https://nlmixr2.r-universe.dev',                            'https://cloud.r-project.org')) # bspm::disable() # if you are using r2u or other ubuntu binary for CRAN oldOptions <- options()  options(repos=c(   linux = 'https://nlmixr2.r-universe.dev/bin/linux/jammy/4.2/',   sources = 'https://nlmixr2.r-universe.dev',   cran = 'https://cloud.r-project.org' )) install.packages(c(\"dparser\", \"nlmixr2data\", \"lotri\", \"rxode2ll\",                    \"rxode2\", \"nlmixr2est\", \"nlmixr2extra\", \"nlmixr2plot\",                    \"nlmixr2\"))  options(oldOptions) #bspm::enable() install.packages(c(\"xpose.nlmixr2\", # Additional goodness of fit plots                                     # baesd on xpose                    \"nlmixr2targets\", # Simplify work with the                                      # `targets` package                    \"babelmixr2\", # Convert/run from nlmixr2-based                                  # models to NONMEM, Monolix, and                                  # initialize models with PKNCA                    \"nonmem2rx\", # Convert from NONMEM to                                 # rxode2/nlmixr2-based models                    \"nlmixr2lib\", # a model library and model                                  # modification functions that                                  # complement model piping                    \"nlmixr2rpt\" # Automated Microsoft Word and                                 # PowerPoint reporting for nlmixr2                    ),                  repos = c('https://nlmixr2.r-universe.dev',                            'https://cloud.r-project.org'))  # Some additional packages outside of the `nlmixr2.r-univers.dev` # install.packages(\"remotes\") remotes::install_github(\"ggPMXdevelopment/ggPMX\") # Goodness of fit plots remotes::install_github(\"RichardHooijmaijers/shinyMixR\") # Shiny run manager (like Piranha) # bspm::disable() # if you are using r2u or other ubuntu binary for CRAN oldOptions <- options()  options(repos=c(   linux = 'https://nlmixr2.r-universe.dev/bin/linux/jammy/4.2/',   sources = 'https://nlmixr2.r-universe.dev',   cran = 'https://cloud.r-project.org' )) install.packages(c(\"xpose.nlmixr2\", \"nlmixr2targets\", \"babelmixr2\", \"nonmem2rx\", \"nlmixr2lib\", \"nlmixr2rpt\"))  options(oldOptions) #bspm::enable() # install.packages(\"remotes\") remotes::install_github(\"ggPMXdevelopment/ggPMX\") # Goodness of fit plots remotes::install_github(\"RichardHooijmaijers/shinyMixR\") # Shiny run manager (like Piranha)"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"install-using-remotes","dir":"","previous_headings":"Development version installation","what":"Install using remotes","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"sure give latest development version Optional supporting packages can installed like :","code":"# install.packages(\"remotes\") remotes::install_github(\"nlmixr2/dparser-R\") remotes::install_github(\"nlmixr2/nlmixr2data\") remotes::install_github(\"nlmixr2/lotri\") remotes::install_github(\"nlmixr2/rxode2ll\") remotes::install_github(\"nlmixr2/rxode2\") remotes::install_github(\"nlmixr2/nlmixr2est\") remotes::install_github(\"nlmixr2/nlmixr2extra\") remotes::install_github(\"nlmixr2/nlmixr2plot\") remotes::install_github(\"nlmixr2/nlmixr2\") # install.packages(\"remotes\") # Goodness of fit plots remotes::install_github(\"ggPMXdevelopment/ggPMX\") # Additional goodness of fit plots remotes::install_github(\"nlmixr2/xpose.nlmixr2\") # Shiny run manager (like Piranha) remotes::install_github(\"RichardHooijmaijers/shinyMixR\") # Simplify work with the `targets` package remotes::install_github(\"nlmixr2/nlmixr2targets\") # Convert/run from nlmixr2-based models to NONMEM, Monolix, and initialize # models with PKNCA remotes::install_github(\"nlmixr2/babelmixr2\") # Convert from NONMEM to rxode2/nlmixr2-based models remotes::install_github(\"nlmixr2/nonmem2rx\") # A library of models and model modification functions remotes::install_github(\"nlmixr2/nlmixr2lib\") # Automated Microsoft Word and PowerPoint reporting for nlmixr2 remotes::install_github(\"nlmixr2/nlmixr2rpt\")"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"refreshing-the-installation-with-the-latest-cran-version","dir":"","previous_headings":"Development version installation","what":"Refreshing the installation with the latest CRAN version","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"difficulties due errors compiling models, may useful re-install nlmixr2 dependencies. development versions, please use remotes::install_github() install.package() r-universe . stable version, please use following command:","code":"install.packages(c(\"dparser\", \"lotri\", \"rxode2ll\", \"rxode2parse\",                    \"rxode2random\", \"rxode2et\", \"rxode2\",                    \"nlmixr2data\", \"nlmixr2est\", \"nlmixr2extra\",                    \"nlmixr2plot\", \"nlmixr2\"))"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"basic example shows solve common problem:","code":"library(nlmixr2)  ## The basic model consists of an ini block that has initial estimates one.compartment <- function() {   ini({     tka <- log(1.57); label(\"Ka\")     tcl <- log(2.72); label(\"Cl\")     tv <- log(31.5); label(\"V\")     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   # and a model block with the error specification and model specification   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     d/dt(depot) <- -ka * depot     d/dt(center) <- ka * depot - cl / v * center     cp <- center / v     cp ~ add(add.sd)   }) }  ## The fit is performed by the function nlmixr/nlmixr2 specifying the model, data and estimate fit <- nlmixr2(one.compartment, theo_sd,  est=\"saem\", saemControl(print=0)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 print(fit) #> ── nlmixr² SAEM OBJF by FOCEi approximation ── #>  #>  Gaussian/Laplacian Likelihoods: AIC() or $objf etc.  #>  FOCEi CWRES & Likelihoods: addCwres()  #>  #> ── Time (sec $time): ── #>  #>           setup covariance  saem table compress    other #> elapsed 0.00089   0.007004 4.546  0.05    0.018 1.785106 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka           Ka  0.46  0.196 42.7       1.58 (1.08, 2.33)     71.9    -0.291%  #> tcl           Cl  1.01 0.0839 8.29       2.75 (2.34, 3.25)     27.0      3.42%  #> tv             V  3.45 0.0469 1.36       31.6 (28.8, 34.7)     14.0      10.7%  #> add.sd           0.694                               0.694                      #>   #>   Covariance Type ($covMethod): linFim #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Censoring ($censInformation): No censoring #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 19 #>   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    cp #>   <fct> <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl>   <dbl> <dbl> #> 1 1      0     0.74  0     0.74   0     0.74   1.07  0.0988 -0.484 -0.0843  0    #> 2 1      0.25  2.84  3.27 -0.433  3.87 -1.03  -1.49  0.0988 -0.484 -0.0843  3.87 #> 3 1      0.57  6.57  5.85  0.718  6.82 -0.247 -0.356 0.0988 -0.484 -0.0843  6.82 #> # ℹ 129 more rows #> # ℹ 7 more variables: depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, #> #   tad <dbl>, dosenum <dbl>"},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"base-r-graphics","dir":"","previous_headings":"","what":"Base R Graphics","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"can use built-plot fit produce standard set goodness fit plots:","code":"pdf(file=\"myplots.pdf\") plot(fit) dev.off()"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"xposenlmixr2","dir":"","previous_headings":"","what":"xpose.nlmixr2","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"{xpose.nlmixr2} package extends xpose support nlmixr2. simply need convert fit results xpose database: can use xpose functions generating goodness fit plots:","code":"library(xpose.nlmixr2) xpdb = xpose_data_nlmixr(fit) library(xpose) plt <- dv_vs_ipred(xpdb)"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"ggpmx","dir":"","previous_headings":"","what":"ggPMX","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"Another option use ggPMX package. first create ggPMX controller object nlmixr fit object. controller object can used generate figures:","code":"library(ggPMX) ctr = pmx_nlmixr(fit) pmx_plot_dv_ipred(ctr)"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/dot-nlmixr2attach.html","id":null,"dir":"Reference","previous_headings":"","what":"Load nlmixr2 stack — .nlmixr2attach","title":"Load nlmixr2 stack — .nlmixr2attach","text":"Load nlmixr2 stack","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/dot-nlmixr2attach.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load nlmixr2 stack — .nlmixr2attach","text":"","code":".nlmixr2attach(exclude = character())"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/dot-nlmixr2attach.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load nlmixr2 stack — .nlmixr2attach","text":"exclude exclude certain packages loading.  allows package like babelmixr2 recursively load ","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/dot-nlmixr2attach.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load nlmixr2 stack — .nlmixr2attach","text":"nothing, called side effects","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/dot-nlmixr2attach.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Load nlmixr2 stack — .nlmixr2attach","text":"Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2CheckInstall.html","id":null,"dir":"Reference","previous_headings":"","what":"Check your nlmixr2 installation for potential issues — nlmixr2CheckInstall","title":"Check your nlmixr2 installation for potential issues — nlmixr2CheckInstall","text":"Check nlmixr2 installation potential issues","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2CheckInstall.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check your nlmixr2 installation for potential issues — nlmixr2CheckInstall","text":"","code":"nlmixr2CheckInstall()"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2CheckInstall.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check your nlmixr2 installation for potential issues — nlmixr2CheckInstall","text":"","code":"nlmixr2CheckInstall() #> ℹ Operating system: Linux 6.11.0-1018-azure #18~24.04.1-Ubuntu SMP Sat Jun 28 04:46:03 UTC 2025 #> Loading required namespace: devtools #> ✔ The 'make' command was found:  /usr/bin/make #> ℹ GNU Make 4.3 #> Built for x86_64-pc-linux-gnu #> Copyright (C) 1988-2020 Free Software Foundation, Inc. #> License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html> #> This is free software: you are free to change and redistribute it. #> There is NO WARRANTY, to the extent permitted by law. #> ✔ The package 'rxode2' is installed and seems to be up to date, version 4.1.0.9000 #> ✔ The package 'rxode2ll' is installed and seems to be up to date, version 2.0.13 #> ✔ The package 'lotri' is installed and seems to be up to date, version 1.0.2 #> ✔ The package 'nlmixr2' is installed and seems to be up to date, version 4.0.1 #> ✔ The package 'nlmixr2est' is installed and seems to be up to date, version 4.1.0.9000 #> ✔ The package 'nlmixr2data' is installed and seems to be up to date, version 2.0.9 #> ✔ The package 'nlmixr2extra' is installed and seems to be up to date, version 3.0.3 #> ✔ The package 'nlmixr2plot' is installed and seems to be up to date, version 3.0.3 #> ✖ The package 'babelmixr2' is not installed (it is optional for all rxode2/nlmixr2 work) #> ✔ The package 'ggPMX' is installed and seems to be up to date, version 1.3.2 #> ✖ The package 'monolix2rx' is not installed (it is optional for all rxode2/nlmixr2 work) #> ✖ The package 'nlmixr2lib' is not installed (it is optional for all rxode2/nlmixr2 work) #> ✖ The package 'nlmixr2rpt' is not installed (it is optional for all rxode2/nlmixr2 work) #> ✖ The package 'nonmem2rx' is not installed (it is optional for all rxode2/nlmixr2 work) #> ✖ The package 'posologyr' is not installed (it is optional for all rxode2/nlmixr2 work) #> ✖ The package 'shinyMixR' is not installed (it is optional for all rxode2/nlmixr2 work) #> ✔ The package 'xpose.nlmixr2' is installed and seems to be up to date, version 0.4.1 #> ℹ To install missing packages, run the following command: #> install.packages(c('babelmixr2', 'monolix2rx', 'nlmixr2lib', 'nlmixr2rpt', 'nonmem2rx', 'posologyr', 'shinyMixR'))"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2conflicts.html","id":null,"dir":"Reference","previous_headings":"","what":"Conflicts between the nlmixr2 and other packages — nlmixr2conflicts","title":"Conflicts between the nlmixr2 and other packages — nlmixr2conflicts","text":"function lists conflicts packages nlmixr2 packages loaded.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2conflicts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conflicts between the nlmixr2 and other packages — nlmixr2conflicts","text":"","code":"nlmixr2conflicts()"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2conflicts.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Conflicts between the nlmixr2 and other packages — nlmixr2conflicts","text":"dplyr one select packages, following four conflicts deliberately ignored: intersect, union, setequal, setdiff dplyr. functions make base equivalents generic, negatively affect existing code.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2conflicts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Conflicts between the nlmixr2 and other packages — nlmixr2conflicts","text":"","code":"nlmixr2conflicts() #> ── Conflicts ───────────────────────────────────────────── nlmixr2conflicts() ── #> ✖ rxode2::boxCox()     masks nlmixr2est::boxCox() #> ✖ rxode2::yeoJohnson() masks nlmixr2est::yeoJohnson()"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2deps.html","id":null,"dir":"Reference","previous_headings":"","what":"List all nlmixr2 dependencies — nlmixr2deps","title":"List all nlmixr2 dependencies — nlmixr2deps","text":"List nlmixr2 dependencies","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2deps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List all nlmixr2 dependencies — nlmixr2deps","text":"","code":"nlmixr2deps(recursive = FALSE)"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2deps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List all nlmixr2 dependencies — nlmixr2deps","text":"recursive TRUE, also list dependencies nlmixr2 packages.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2packages.html","id":null,"dir":"Reference","previous_headings":"","what":"List all packages in the nlmixr2 — nlmixr2packages","title":"List all packages in the nlmixr2 — nlmixr2packages","text":"List packages nlmixr2","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2packages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List all packages in the nlmixr2 — nlmixr2packages","text":"","code":"nlmixr2packages(include_self = TRUE)"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2packages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List all packages in the nlmixr2 — nlmixr2packages","text":"include_self Include nlmixr2 list?","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2packages.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List all packages in the nlmixr2 — nlmixr2packages","text":"","code":"nlmixr2packages() #>  [1] \"cli\"          \"crayon\"       \"dplyr\"        \"purrr\"        \"rstudioapi\"   #>  [6] \"nlmixr2est\"   \"nlmixr2extra\" \"rxode2\"       \"lotri\"        \"nlmixr2plot\"  #> [11] \"tibble\"       \"magrittr\"     \"nlmixr2\""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2update.html","id":null,"dir":"Reference","previous_headings":"","what":"Update nlmixr2 packages — nlmixr2update","title":"Update nlmixr2 packages — nlmixr2update","text":"check see nlmixr2 packages (optionally, dependencies) --date, install interactive confirmation.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2update.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update nlmixr2 packages — nlmixr2update","text":"","code":"nlmixr2update(recursive = FALSE)"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2update.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update nlmixr2 packages — nlmixr2update","text":"recursive TRUE, also check dependencies nlmixr2 packages.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2update.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update nlmixr2 packages — nlmixr2update","text":"","code":"if (FALSE) { # \\dontrun{ nlmixr2update() } # }"},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-401","dir":"Changelog","previous_headings":"","what":"nlmixr2 4.0.1","title":"nlmixr2 4.0.1","text":"CRAN release: 2025-08-29 Added posologyr optional packages","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-40","dir":"Changelog","previous_headings":"","what":"nlmixr2 4.0","title":"nlmixr2 4.0","text":"Change verse style package.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-302","dir":"Changelog","previous_headings":"","what":"nlmixr2 3.0.2","title":"nlmixr2 3.0.2","text":"CRAN release: 2025-02-20 Change saemControl() options reflect nlmixr2est default options Update authors reflect current team. Export rxSetSeed()","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-301","dir":"Changelog","previous_headings":"","what":"nlmixr2 3.0.1","title":"nlmixr2 3.0.1","text":"CRAN release: 2024-10-28 Remove backwardSearch, covarSearchAuto forwardSearch re-exports since longer exist nlmixr2extra Remove rxode2parse suggested dependency","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-300","dir":"Changelog","previous_headings":"","what":"nlmixr2 3.0.0","title":"nlmixr2 3.0.0","text":"CRAN release: 2024-09-18 Re-export new profiling nlmixr2extra","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-212","dir":"Changelog","previous_headings":"","what":"nlmixr2 2.1.2","title":"nlmixr2 2.1.2","text":"CRAN release: 2024-05-30 Re-export population estimation control methods.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-211","dir":"Changelog","previous_headings":"","what":"nlmixr2 2.1.1","title":"nlmixr2 2.1.1","text":"CRAN release: 2024-02-01 Work systems (like intel c++) linCmt() linear compartmental models gradients.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-210","dir":"Changelog","previous_headings":"","what":"nlmixr2 2.1.0","title":"nlmixr2 2.1.0","text":"CRAN release: 2024-01-09 Reexports etExpand(), model()<- ini()<-","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-209","dir":"Changelog","previous_headings":"","what":"nlmixr2 2.0.9","title":"nlmixr2 2.0.9","text":"CRAN release: 2023-02-21 new function nlmixr2CheckInstall() helps check installation setup correctly required compilers packages. version adds crayon imported dependency","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-208","dir":"Changelog","previous_headings":"","what":"nlmixr2 2.0.8","title":"nlmixr2 2.0.8","text":"CRAN release: 2022-10-23 release bug fix captures model name correctly called directly nlmixr::nlmixr2 instead nlmixr2est::nlmixr2 also exports new vpc functions, ie vpcTad() etc","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-207","dir":"Changelog","previous_headings":"","what":"nlmixr2 2.0.7","title":"nlmixr2 2.0.7","text":"CRAN release: 2022-06-27 nlmixr2 now re-exports logit certain models work simple library(nlmixr2) instead library(rxode2);library(nlmixr2) vpcSim() now exports new nretry option robust control vpcSim() Update documentation mention package names work nlmixr2, like xpose.nlmixr2 instead xpose.nlmixr Manual hard re-export nlmixr2est::nlmixr2 allow pkgdown document function.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/news/index.html","id":"nlmixr2-206","dir":"Changelog","previous_headings":"","what":"nlmixr2 2.0.6","title":"nlmixr2 2.0.6","text":"CRAN release: 2022-05-24 nlmixr2 umbrella package include lower level packages rxode2, nlmixr2est, nlmixr2extra, nlmixr2plot Added NEWS.md file track changes package.","code":""}]
