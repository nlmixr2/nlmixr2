[{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://nlmixr2.github.io/nlmixr2/articles/addingCovariances.html","id":"adding-covariances-between-random-effects","dir":"Articles","previous_headings":"","what":"Adding Covariances between random effects","title":"Random Effect Covariances","text":"can simply add co-variances two random effects adding effects together model specification block, eta.cl+eta.v ~. statement, specify lower triangular matrix fit c(). example phenobarbitol data:","code":"## Load phenobarbitol data library(nlmixr2)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/addingCovariances.html","id":"model-specification","dir":"Articles","previous_headings":"Adding Covariances between random effects","what":"Model Specification","title":"Random Effect Covariances","text":"","code":"pheno <- function() {   ini({     tcl <- log(0.008) # typical value of clearance     tv <-  log(0.6)   # typical value of volume     ## var(eta.cl)     eta.cl + eta.v ~ c(1,                         0.01, 1) ## cov(eta.cl, eta.v), var(eta.v)                       # interindividual variability on clearance and volume     add.err <- 0.1    # residual variability   })   model({     cl <- exp(tcl + eta.cl) # individual value of clearance     v <- exp(tv + eta.v)    # individual value of volume     ke <- cl / v            # elimination rate constant     d/dt(A1) = - ke * A1    # model differential equation     cp = A1 / v             # concentration in plasma     cp ~ add(add.err)       # define error model   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/addingCovariances.html","id":"fit-with-saem","dir":"Articles","previous_headings":"Adding Covariances between random effects","what":"Fit with SAEM","title":"Random Effect Covariances","text":"","code":"fit <- nlmixr(pheno, pheno_sd, \"saem\",               control=list(print=0),                table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  print(fit) #> ── nlmixr SAEM OBJF by FOCEi approximation ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 688.6792 985.5502 1003.811      -486.7751         7.570439 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance   saem table compress #> elapsed 0.003772    6e-06   0.021008 15.185 4.375    0.026 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>                          Parameter  Est.     SE %RSE    Back-transformed(95%CI) #> tcl     typical value of clearance -4.99 0.0743 1.49 0.00677 (0.00586, 0.00784) #> tv         typical value of volume 0.346 0.0538 15.5          1.41 (1.27, 1.57) #> add.err       residual variability  2.83                                   2.83 #>         BSV(CV%) Shrink(SD)% #> tcl         52.4      1.50%  #> tv          41.0      1.09%  #> add.err                      #>   #>   Covariance Type ($covMethod): linFim #>   Correlations in between subject variability (BSV) matrix: #>     cor:eta.v,eta.cl  #>           0.989   #>   #>  #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 155 × 24 #>   ID     TIME    DV EPRED  ERES   NPDE    NPD  PRED    RES    WRES IPRED  IRES #>   <fct> <dbl> <dbl> <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl>   <dbl> <dbl> <dbl> #> 1 1        2   17.3  18.9 -1.56 -0.422 -0.422  17.5 -0.222 -0.0297  18.5 -1.18 #> 2 1      112.  31    29.9  1.13  0.394  0.394  27.9  3.11   0.254   29.6  1.37 #> 3 2        2    9.7  10.9 -1.19 -1.01  -1.01   10.5 -0.813 -0.162   12.5 -2.77 #> # … with 152 more rows, and 12 more variables: IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.cl <dbl>, eta.v <dbl>, A1 <dbl>, cl <dbl>, #> #   v <dbl>, ke <dbl>, tad <dbl>, dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/addingCovariances.html","id":"basic-goodness-of-fit-plots","dir":"Articles","previous_headings":"Adding Covariances between random effects","what":"Basic Goodness of Fit Plots","title":"Random Effect Covariances","text":"individual plots great, better see actual curves; can augPred","code":"plot(fit) plot(augPred(fit))"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/addingCovariances.html","id":"two-types-of-vpcs","dir":"Articles","previous_headings":"Adding Covariances between random effects","what":"Two types of VPCs","title":"Random Effect Covariances","text":"","code":"library(ggplot2) p1 <- vpcPlot(fit, show=list(obs_dv=TRUE)); #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 p1 <- p1 + ylab(\"Concentrations\")  ## A prediction-corrected VPC p2 <- vpcPlot(fit, pred_corr = TRUE, show=list(obs_dv=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 p2 <- p2 + ylab(\"Prediction-Corrected Concentrations\")  p1 p2"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"the-broom-and-broom-mixed-packages","dir":"Articles","previous_headings":"","what":"The broom and broom.mixed packages","title":"Using broom with nlmixr2","text":"broom broom.mixed packages attempt put standard model outputs data frames. nlmixr supports tidy glance methods support augment time. Using model covariance term, Phenobarbital model, can explore different types output used tidy functions. explore , first run model:","code":"library(nlmixr2) library(broom.mixed)  pheno <- function() {   # Pheno with covariance   ini({     tcl <- log(0.008) # typical value of clearance     tv <-  log(0.6)   # typical value of volume     ## var(eta.cl)     eta.cl + eta.v ~ c(1,                         0.01, 1) ## cov(eta.cl, eta.v), var(eta.v)     # interindividual variability on clearance and volume     add.err <- 0.1    # residual variability   })   model({     cl <- exp(tcl + eta.cl) # individual value of clearance     v <- exp(tv + eta.v)    # individual value of volume     ke <- cl / v            # elimination rate constant     d/dt(A1) = - ke * A1    # model differential equation     cp = A1 / v             # concentration in plasma     cp ~ add(add.err)       # define error model   }) }  ## We will run it two ways to allow comparisons fit.s <- nlmixr(pheno, pheno_sd, \"saem\", control=list(logLik=TRUE, print=0),                 table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  fit.f <- nlmixr(pheno, pheno_sd, \"focei\",                 control=list(print=0),                  table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done #> [====|====|====|====|====|====|====|====|====|====] 0:00:00"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"glancing-at-the-goodness-of-fit-metrics","dir":"Articles","previous_headings":"","what":"Glancing at the goodness of fit metrics","title":"Using broom with nlmixr2","text":"Often fitting data, want glance fit see well fits. broom, glance give summary fit metrics goodness fit: Note nlmixr possible one fit metric (based different quadratures, FOCEi approximation etc). However, glance returns fit metrics current. wish can set objective function focei objective function (already calculated CWRES). Now glance gives gauss3_1.6 values. course can always change type objective function nlmixr uses: setting back SAEM default objective function FOCEi, glance(fit.s) values : convenience, can glance objects:","code":"glance(fit.s) setOfv(fit.s,\"gauss3_1.6\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 glance(fit.s) setOfv(fit.s,\"FOCEi\") # Setting objective function to focei glance(fit.s) glance(fit.s, type=\"FOCEi\")"},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"tidying-of-overall-fit-parameters","dir":"Articles","previous_headings":"Tidying the model parameters","what":"Tidying of overall fit parameters","title":"Using broom with nlmixr2","text":"can also tidy model estimates data frame broom processing. can useful integrating 3rd parting modeling packages. consistent parameter format, tasks multiple types models can automated applied. default function tidy, applied fit object provides overall parameter information tidy dataset: Note default parameters actually estimated nlmixr, back-transformed values table printout. course, mu-referenced models, may want exponentiate terms. broom package allows apply exponentiation parameters, : Note:, accordance rest broom package, parameters exponentiated, standard errors transformed approximate standard error formula: \\(\\textrm{se}(\\exp(x)) \\approx \\exp(\\textrm{model estimate}_x)\\times \\textrm{se}_x\\). can confusing confidence intervals (described later) using actual standard error back-transforming exponentiated scale. reason default nlmixr’s broom interface exponentiate=FALSE, : want, can also use parsed back-transformation used nlmixr tables (ie fit$parFixedDf). Please note uses approximate back-transformation standard errors log-scaled back-transformed values. done : Also note, time writing default separator variables ., doesn’t work well model giving cor__eta.v.eta.cl. can easily change : gives easier way parse value: cor__eta.v..eta.cl","code":"tidy(fit.s) ## Transformation applied on every parameter tidy(fit.s, exponentiate=TRUE) tidy(fit.s, exponentiate=FALSE) ## No transformation applied ## Transformation applied to log-scaled population parameters tidy(fit.s, exponentiate=NA) options(broom.mixed.sep2=\"..\") tidy(fit.s)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"adding-a-confidence-interval-to-the-parameters","dir":"Articles","previous_headings":"Tidying the model parameters","what":"Adding a confidence interval to the parameters","title":"Using broom with nlmixr2","text":"default R method confint works nlmixr fit objects: transforms variables described . can still use exponentiate parameter control display confidence interval: However, broom also implemented way make data tidy dataset. easiest way get values nlmixr dataset use:  want confidence adaptive back-transformed scale, simply use following:","code":"confint(fit.s) confint(fit.s, exponentiate=FALSE) tidy(fit.s, conf.level=0.9) tidy(fit.s, conf.level=0.9, exponentiate=NA)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"extracting-other-model-information-with-tidy","dir":"Articles","previous_headings":"","what":"Extracting other model information with tidy","title":"Using broom with nlmixr2","text":"type information extracted can controlled effects argument.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"extracting-only-fixed-effect-parameters","dir":"Articles","previous_headings":"Extracting other model information with tidy","what":"Extracting only fixed effect parameters","title":"Using broom with nlmixr2","text":"fixed effect parameters can extracted effects=\"fixed\"","code":"tidy(fit.s, effects=\"fixed\")"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"extracting-only-random-parameters","dir":"Articles","previous_headings":"Extracting other model information with tidy","what":"Extracting only random parameters","title":"Using broom with nlmixr2","text":"random standard deviations can extracted effects=\"ran_pars\":","code":"tidy(fit.s, effects=\"ran_pars\")"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"extracting-random-values-also-called-etas","dir":"Articles","previous_headings":"Extracting other model information with tidy","what":"Extracting random values (also called ETAs)","title":"Using broom with nlmixr2","text":"random values, NONMEM ETAs, can extracted effects=\"ran_vals\" effects=\"random\" duplicate method running effects broom package supports effects=\"random\" broom.mixed package supports effects=\"ran_vals\".","code":"head(tidy(fit.s, effects=\"ran_vals\"))"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"extracting-random-coefficients","dir":"Articles","previous_headings":"Extracting other model information with tidy","what":"Extracting random coefficients","title":"Using broom with nlmixr2","text":"Random coefficients population fixed effect parameter + random effect parameter, possibly transformed correct scale. case can extract information nlmixr fit object :","code":"head(tidy(fit.s, effects=\"ran_coef\")) head(tidy(fit.s, effects=\"ran_coef\", exponentiate=NA)) head(tidy(fit.s, effects=\"ran_coef\", exponentiate=TRUE))"},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"dotwhisker","dir":"Articles","previous_headings":"Example of using a tidy model estimates for other packages","what":"Dotwhisker","title":"Using broom with nlmixr2","text":"explained , standard format makes easier tidyverse packages interact model information. example piping tidy information dplyr filter effects dotwhisker package plot model parameter confidence intervals.","code":"options(broom.mixed.sep2=\": \", broom.mixed.sep2=\", \") library(ggplot2) library(dotwhisker) library(dplyr) fit.s %>%     tidy(exponentiate=NA) %>%     filter(effect==\"fixed\") %>%     dwplot()"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/broom.html","id":"huxtable","dir":"Articles","previous_headings":"Example of using a tidy model estimates for other packages","what":"Huxtable","title":"Using broom with nlmixr2","text":"allows easy creation report ready tables many formats including word. Huxtable relies broom implementation can also use huxtable compare runs: word-based table can also easily created tool: produces following word document. Happy tidying!","code":"library(huxtable) tbl <- huxreg('Phenobarbitol'=fit.s)  tbl huxreg('SAEM'=fit.s, 'FOCEi'=fit.f) library(officer) library(flextable)  ft  <- huxtable::as_flextable(tbl);      read_docx() %>%     flextable::body_add_flextable(ft)  %>%     print(target=\"pheno.docx\")"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/censoring.html","id":"censoring-support-in-nlmixr","dir":"Articles","previous_headings":"","what":"Censoring support in nlmixr","title":"Censoring in nlmixr","text":"general, censoring observation measured researcher knows something certain number. 2001, Beal introduced censoring pharmacometric community described common ways deal missing data. methods , data structure used nlmixr support : Estimate Likelihood observation censored limit. concentrations limit quantitation (left censored), can specify nlmixr two columns: DV, CENS. value censored, DV limit quantification, CENS 1. rest non-censored values, DV keeps normal value CENS 0. censored value limit quantitation (right censored), DV remains limit quantification CENS -1. expansion M3 method. cases, like PK, can also assume observations actually positive. Therefore, may want adjust likelihood take consideration fact. can accomplished nlmixr well adding LIMIT column. case left censored problem, can specify concentration LIMIT DV. works right left censored values. data columns LIMIT CENS, based Monolix method handling censored data.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/censoring.html","id":"data-output-for-censored-data-in-nlmixr","dir":"Articles","previous_headings":"","what":"Data output for censored data in nlmixr","title":"Censoring in nlmixr","text":"censored data output, often useful see predictions perform censored area. accomplish , simulated value used show prediction noise. used calculate standard residual values nlmixr. default, value simulated truncated normal distribution model assumptions censoring information specified data (though can use CDF method used npde package instead calculating npdes well). simulated value replaces original DV used calculate residuals requested. original limit information output lowerLim upperLim.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"nlmixr-model","dir":"Articles","previous_headings":"","what":"nlmixr model","title":"mavoglurant -- physiologically-based PK","text":"","code":"library(nlmixr2) library(xpose) library(xpose.nlmixr) library(ggplot2)  pbpk <- function(){   ini({     ##theta=exp(c(1.1, .3, 2, 7.6, .003, .3))     lKbBR = 1.1     lKbMU = 0.3     lKbAD = 2     lCLint = 7.6     lKbBO = 0.03     lKbRB = 0.3     eta.LClint ~ 4     add.err <- 1     prop.err <- 10   })   model({     KbBR = exp(lKbBR)     KbMU = exp(lKbMU)     KbAD = exp(lKbAD)     CLint= exp(lCLint + eta.LClint)     KbBO = exp(lKbBO)     KbRB = exp(lKbRB)      ## Regional blood flows     CO  = (187.00*WT^0.81)*60/1000;         # Cardiac output (L/h) from White et al (1968)     QHT = 4.0 *CO/100;     QBR = 12.0*CO/100;     QMU = 17.0*CO/100;     QAD = 5.0 *CO/100;     QSK = 5.0 *CO/100;     QSP = 3.0 *CO/100;     QPA = 1.0 *CO/100;     QLI = 25.5*CO/100;     QST = 1.0 *CO/100;     QGU = 14.0*CO/100;     QHA = QLI - (QSP + QPA + QST + QGU); # Hepatic artery blood flow     QBO = 5.0 *CO/100;     QKI = 19.0*CO/100;     QRB = CO - (QHT + QBR + QMU + QAD + QSK + QLI + QBO + QKI);     QLU = QHT + QBR + QMU + QAD + QSK + QLI + QBO + QKI + QRB;      ## Organs' volumes = organs' weights / organs' density     VLU = (0.76 *WT/100)/1.051;     VHT = (0.47 *WT/100)/1.030;     VBR = (2.00 *WT/100)/1.036;     VMU = (40.00*WT/100)/1.041;     VAD = (21.42*WT/100)/0.916;     VSK = (3.71 *WT/100)/1.116;     VSP = (0.26 *WT/100)/1.054;     VPA = (0.14 *WT/100)/1.045;     VLI = (2.57 *WT/100)/1.040;     VST = (0.21 *WT/100)/1.050;     VGU = (1.44 *WT/100)/1.043;     VBO = (14.29*WT/100)/1.990;     VKI = (0.44 *WT/100)/1.050;     VAB = (2.81 *WT/100)/1.040;     VVB = (5.62 *WT/100)/1.040;     VRB = (3.86 *WT/100)/1.040;      ## Fixed parameters     BP = 0.61;      # Blood:plasma partition coefficient     fup = 0.028;    # Fraction unbound in plasma     fub = fup/BP;   # Fraction unbound in blood      KbLU = exp(0.8334);     KbHT = exp(1.1205);     KbSK = exp(-.5238);     KbSP = exp(0.3224);     KbPA = exp(0.3224);     KbLI = exp(1.7604);     KbST = exp(0.3224);     KbGU = exp(1.2026);     KbKI = exp(1.3171);      ##-----------------------------------------     S15 = VVB*BP/1000;     C15 = Venous_Blood/S15      ##-----------------------------------------     d/dt(Lungs) = QLU*(Venous_Blood/VVB - Lungs/KbLU/VLU);     d/dt(Heart) = QHT*(Arterial_Blood/VAB - Heart/KbHT/VHT);     d/dt(Brain) = QBR*(Arterial_Blood/VAB - Brain/KbBR/VBR);     d/dt(Muscles) = QMU*(Arterial_Blood/VAB - Muscles/KbMU/VMU);     d/dt(Adipose) = QAD*(Arterial_Blood/VAB - Adipose/KbAD/VAD);     d/dt(Skin) = QSK*(Arterial_Blood/VAB - Skin/KbSK/VSK);     d/dt(Spleen) = QSP*(Arterial_Blood/VAB - Spleen/KbSP/VSP);     d/dt(Pancreas) = QPA*(Arterial_Blood/VAB - Pancreas/KbPA/VPA);     d/dt(Liver) = QHA*Arterial_Blood/VAB + QSP*Spleen/KbSP/VSP + QPA*Pancreas/KbPA/VPA + QST*Stomach/KbST/VST + QGU*Gut/KbGU/VGU - CLint*fub*Liver/KbLI/VLI - QLI*Liver/KbLI/VLI;     d/dt(Stomach) = QST*(Arterial_Blood/VAB - Stomach/KbST/VST);     d/dt(Gut) = QGU*(Arterial_Blood/VAB - Gut/KbGU/VGU);     d/dt(Bones) = QBO*(Arterial_Blood/VAB - Bones/KbBO/VBO);     d/dt(Kidneys) = QKI*(Arterial_Blood/VAB - Kidneys/KbKI/VKI);     d/dt(Arterial_Blood) = QLU*(Lungs/KbLU/VLU - Arterial_Blood/VAB);     d/dt(Venous_Blood) = QHT*Heart/KbHT/VHT + QBR*Brain/KbBR/VBR + QMU*Muscles/KbMU/VMU + QAD*Adipose/KbAD/VAD + QSK*Skin/KbSK/VSK + QLI*Liver/KbLI/VLI + QBO*Bones/KbBO/VBO + QKI*Kidneys/KbKI/VKI + QRB*Rest_of_Body/KbRB/VRB - QLU*Venous_Blood/VVB;     d/dt(Rest_of_Body) = QRB*(Arterial_Blood/VAB - Rest_of_Body/KbRB/VRB);      C15 ~ add(add.err) + prop(prop.err)   }) }  dat <- read.csv(\"Mavoglurant_A2121_nmpk.csv\") dat$occ = unlist(with(dat, tapply(EVID, ID, function(x) cumsum(x>0)))) dat = subset(dat, occ==1) dat = subset(dat, ID<812) ## First 20 dat = subset(dat, EVID>0 | DV>0) dat$CMT[dat$CMT == 0]  <- 1; dat$CMT[dat$EVID == 1]  <- \"Venous_Blood\" ## Compartment dosed to is Venous Blood dat$CMT[dat$EVID != 1]  <- \"C15\" ## Observing C15  gofs <- function(fit){     ################################################################################     ## Standard plots     ################################################################################     plot(fit)      xpdb <- xpose_data_nlmixr(fit) ## Convert to nlmixr object      print(dv_vs_pred(xpdb) +           ylab(\"Observed Mavoglurant Concentrations (ng/mL)\") +           xlab(\"Population Predicted Mavoglurant Concentrations (ng/mL)\"));      print(dv_vs_ipred(xpdb) +           ylab(\"Observed Mavoglurant Concentrations (ng/mL)\") +           xlab(\"Individual Predicted Mavoglurant Concentrations (ng/mL)\"));      print(res_vs_pred(xpdb) +           ylab(\"Conditional Weighted Residuals\") +           xlab(\"Population Predicted Mavoglurant Concentrations (ng/mL)\"));      print(res_vs_idv(xpdb) +           ylab(\"Conditional Weighted Residuals\") +           xlab(\"Time (h)\"));      if (!is.null(fit$saem)){         print(prm_vs_iteration(xpdb));     }      print(absval_res_vs_idv(xpdb, res = 'IWRES') +           ylab(\"Individual Weighted Residuals\") +           xlab(\"Time (h)\"))      print(absval_res_vs_pred(xpdb, res = 'IWRES') +           ylab(\"Individual Weighted Residuals\") +           xlab(\"Population Predicted Mavoglurant Concentrations (ng/mL)\"))      print(ind_plots(xpdb, nrow=3, ncol=4) +           ylab(\"Predicted and Observed Mavoglurant Concentrations (ng/mL)\") +           xlab(\"Time (h)\"))      print(res_distrib(xpdb) +           ylab(\"Density\") +           xlab(\"Conditional Weighted Residuals\"));     # Visual Predictive Checks     f1 <- vpcPlot(fit,n=500,stratify=\"DOSE\", show=list(obs_dv=T), log_y=TRUE,            bins = c(0, 2, 4, 6, 8, 10, 20, 30, 40, 50),            ylab = \"Mavoglurant Concentrations (ng/mL)\",            xlab = \"Time (hours)\")     f2 <- vpcPlot(fit,n=500, show=list(obs_dv=T), bins = c(0, 2, 4, 6, 8, 10, 20, 30, 40, 50), log_y=TRUE,                  ylab = \"Mavoglurant Concentrations (ng/mL)\", xlab = \"Time (hours)\")     plot(f1)     plot(f2) }"},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"fit-addprop-saem","dir":"Articles","previous_headings":"SAEM","what":"Fit add+prop SAEM","title":"mavoglurant -- physiologically-based PK","text":"","code":"fit.addProp.S <- nlmixr(pbpk, dat, est=\"saem\", control=list(print=0),                          table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  gofs(fit.addProp.S) #>        ID          CMT                 EVID        EVI2        MDV    #>  793    : 15   Length:256         Min.   :0   Min.   :0   Min.   :0   #>  796    : 15   Class :character   1st Qu.:0   1st Qu.:0   1st Qu.:0   #>  797    : 14   Mode  :character   Median :0   Median :0   Median :0   #>  799    : 14                      Mean   :0   Mean   :0   Mean   :0   #>  803    : 14                      3rd Qu.:0   3rd Qu.:0   3rd Qu.:0   #>  806    : 14                      Max.   :0   Max.   :0   Max.   :0   #>  (Other):170                                                          #>        DV              LNDV             AMT         TIME             DOSE       #>  Min.   :  2.01   Min.   :0.6981   Min.   :0   Min.   : 0.200   Min.   :25.00   #>  1st Qu.: 29.30   1st Qu.:3.3780   1st Qu.:0   1st Qu.: 0.533   1st Qu.:25.00   #>  Median : 88.10   Median :4.4775   Median :0   Median : 2.200   Median :25.00   #>  Mean   :184.95   Mean   :4.4056   Mean   :0   Mean   : 6.471   Mean   :29.59   #>  3rd Qu.:327.50   3rd Qu.:5.7915   3rd Qu.:0   3rd Qu.: 8.200   3rd Qu.:37.50   #>  Max.   :985.00   Max.   :6.8930   Max.   :0   Max.   :48.167   Max.   :37.50   #>                                                                                 #>       OCC         RATE        AGE             SEX             RACE        #>  Min.   :1   Min.   :0   Min.   :19.00   Min.   :1.000   Min.   : 1.000   #>  1st Qu.:1   1st Qu.:0   1st Qu.:23.75   1st Qu.:1.000   1st Qu.: 1.000   #>  Median :1   Median :0   Median :31.00   Median :1.000   Median : 1.000   #>  Mean   :1   Mean   :0   Mean   :33.92   Mean   :1.219   Mean   : 5.445   #>  3rd Qu.:1   3rd Qu.:0   3rd Qu.:43.00   3rd Qu.:1.000   3rd Qu.: 2.000   #>  Max.   :1   Max.   :0   Max.   :50.00   Max.   :2.000   Max.   :88.000   #>                                                                           #>        WT               HT            EPRED               ERES           #>  Min.   : 61.90   Min.   :1.560   Min.   :  0.5143   Min.   :-523.8847   #>  1st Qu.: 68.70   1st Qu.:1.650   1st Qu.: 30.9813   1st Qu.: -24.4194   #>  Median : 77.40   Median :1.770   Median : 99.2949   Median :   0.0526   #>  Mean   : 78.67   Mean   :1.742   Mean   :198.0135   Mean   : -13.0631   #>  3rd Qu.: 86.10   3rd Qu.:1.830   3rd Qu.:335.1844   3rd Qu.:  14.1390   #>  Max.   :103.50   Max.   :1.910   Max.   :883.8847   Max.   : 347.6242   #>                                                                          #>       NPDE                NPD                 PRED               RES            #>  Min.   :-2.935199   Min.   :-2.935199   Min.   :  0.5117   Min.   :-532.1409   #>  1st Qu.:-0.717066   1st Qu.:-0.717066   1st Qu.: 30.1771   1st Qu.: -21.8163   #>  Median : 0.008356   Median : 0.008356   Median : 95.7582   Median :   0.9355   #>  Mean   : 0.001308   Mean   : 0.001308   Mean   :196.9020   Mean   : -11.9516   #>  3rd Qu.: 0.679772   3rd Qu.: 0.679772   3rd Qu.:335.7669   3rd Qu.:  14.2728   #>  Max.   : 2.474740   Max.   : 2.474740   Max.   :892.1409   Max.   : 356.1652   #>                                                                                 #>       WRES              IPRED               IRES               IWRES         #>  Min.   :-2.43491   Min.   :  0.3217   Min.   :-513.3152   Min.   :-2.4132   #>  1st Qu.:-0.67384   1st Qu.: 27.1350   1st Qu.: -15.1977   1st Qu.:-0.6303   #>  Median : 0.06236   Median : 97.0370   Median :  -0.3605   Median :-0.0285   #>  Mean   : 0.09261   Mean   :194.9558   Mean   : -10.0054   Mean   : 0.0532   #>  3rd Qu.: 0.72509   3rd Qu.:332.7572   3rd Qu.:  11.4958   3rd Qu.: 0.6855   #>  Max.   : 4.38369   Max.   :873.3152   Max.   : 338.5404   Max.   : 2.8964   #>                                                                              #>      CPRED               CRES              CWRES            ETA.LCLINT        #>  Min.   : -0.7037   Min.   :-533.258   Min.   :-2.48793   Min.   :-0.636333   #>  1st Qu.: 28.2785   1st Qu.: -21.689   1st Qu.:-0.72941   1st Qu.:-0.333454   #>  Median : 94.5632   Median :   1.583   Median : 0.08715   Median : 0.137383   #>  Mean   :196.2686   Mean   : -11.318   Mean   : 0.03609   Mean   : 0.005812   #>  3rd Qu.:336.0810   3rd Qu.:  15.221   3rd Qu.: 0.73238   3rd Qu.: 0.257907   #>  Max.   :893.2583   Max.   : 354.215   Max.   : 2.66161   Max.   : 0.451128   #>                                                                               #>      LUNGS               HEART               BRAIN             MUSCLES         #>  Min.   :0.0002528   Min.   :0.0002142   Min.   :0.002248   Min.   :0.003731   #>  1st Qu.:0.0216588   1st Qu.:0.0184007   1st Qu.:0.194603   1st Qu.:0.323622   #>  Median :0.0759579   Median :0.0658837   Median :0.738473   Median :1.248829   #>  Mean   :0.1542607   Mean   :0.1624718   Mean   :1.497554   Mean   :2.383302   #>  3rd Qu.:0.2641742   3rd Qu.:0.2490483   3rd Qu.:2.954854   3rd Qu.:4.677097   #>  Max.   :0.6738089   Max.   :0.8433921   Max.   :4.806670   Max.   :7.220636   #>                                                                                #>     ADIPOSE             SKIN               SPLEEN             PANCREAS         #>  Min.   :0.07558   Min.   :0.0003016   Min.   :5.188e-05   Min.   :2.821e-05   #>  1st Qu.:2.63980   1st Qu.:0.0259241   1st Qu.:4.449e-03   1st Qu.:2.421e-03   #>  Median :3.99597   Median :0.0930605   Median :1.572e-02   Median :8.588e-03   #>  Mean   :4.00018   Mean   :0.2291940   Mean   :3.618e-02   Mean   :2.057e-02   #>  3rd Qu.:5.35314   3rd Qu.:0.3550839   3rd Qu.:5.650e-02   3rd Qu.:3.143e-02   #>  Max.   :7.91034   Max.   :1.1496034   Max.   :2.122e-01   Max.   :1.196e-01   #>                                                                                #>      LIVER             STOMACH               GUT                BONES          #>  Min.   :0.001167   Min.   :4.219e-05   Min.   :0.0007031   Min.   :0.005892   #>  1st Qu.:0.119514   1st Qu.:3.623e-03   1st Qu.:0.0604017   1st Qu.:0.608290   #>  Median :0.427493   Median :1.292e-02   Median :0.2159981   Median :1.957449   #>  Mean   :0.998056   Mean   :3.170e-02   Mean   :0.5324453   Mean   :1.853818   #>  3rd Qu.:1.626811   3rd Qu.:4.819e-02   3rd Qu.:0.8130848   3rd Qu.:2.782872   #>  Max.   :4.272264   Max.   :1.741e-01   Max.   :2.8106661   Max.   :4.354734   #>                                                                                #>     KIDNEYS          ARTERIAL_BLOOD       VENOUS_BLOOD        REST_OF_BODY      #>  Min.   :0.0002381   Min.   :0.0004107   Min.   :0.0008207   Min.   :0.002153   #>  1st Qu.:0.0204191   1st Qu.:0.0351942   1st Qu.:0.0703057   1st Qu.:0.187551   #>  Median :0.0720261   Median :0.1236023   Median :0.2463491   Median :0.754165   #>  Mean   :0.1616563   Mean   :0.2556180   Mean   :0.4962671   Mean   :1.264640   #>  3rd Qu.:0.2570456   3rd Qu.:0.4324578   3rd Qu.:0.8536919   3rd Qu.:2.317678   #>  Max.   :0.9284196   Max.   :1.1893297   Max.   :2.1118947   Max.   :3.582505   #>                                                                                 #>       KBBR           KBMU             KBAD           CLINT           KBBO       #>  Min.   :7.48   Min.   :0.6212   Min.   :7.199   Min.   : 769   Min.   :4.684   #>  1st Qu.:7.48   1st Qu.:0.6212   1st Qu.:7.199   1st Qu.:1041   1st Qu.:4.684   #>  Median :7.48   Median :0.6212   Median :7.199   Median :1667   Median :4.684   #>  Mean   :7.48   Mean   :0.6212   Mean   :7.199   Mean   :1533   Mean   :4.684   #>  3rd Qu.:7.48   3rd Qu.:0.6212   3rd Qu.:7.199   3rd Qu.:1881   3rd Qu.:4.684   #>  Max.   :7.48   Max.   :0.6212   Max.   :7.199   Max.   :2281   Max.   :4.684   #>                                                                                 #>       KBRB             CO             QHT             QBR        #>  Min.   :3.679   Min.   :317.1   Min.   :12.69   Min.   :38.06   #>  1st Qu.:3.679   1st Qu.:345.1   1st Qu.:13.80   1st Qu.:41.41   #>  Median :3.679   Median :380.1   Median :15.20   Median :45.61   #>  Mean   :3.679   Mean   :384.5   Mean   :15.38   Mean   :46.14   #>  3rd Qu.:3.679   3rd Qu.:414.3   3rd Qu.:16.57   3rd Qu.:49.72   #>  Max.   :3.679   Max.   :480.9   Max.   :19.24   Max.   :57.71   #>                                                                  #>       QMU             QAD             QSK             QSP         #>  Min.   :53.92   Min.   :15.86   Min.   :15.86   Min.   : 9.514   #>  1st Qu.:58.66   1st Qu.:17.25   1st Qu.:17.25   1st Qu.:10.353   #>  Median :64.61   Median :19.00   Median :19.00   Median :11.402   #>  Mean   :65.36   Mean   :19.22   Mean   :19.22   Mean   :11.534   #>  3rd Qu.:70.44   3rd Qu.:20.72   3rd Qu.:20.72   3rd Qu.:12.430   #>  Max.   :81.76   Max.   :24.05   Max.   :24.05   Max.   :14.428   #>                                                                   #>       QPA             QLI              QST             QGU        #>  Min.   :3.171   Min.   : 80.87   Min.   :3.171   Min.   :44.40   #>  1st Qu.:3.451   1st Qu.: 88.00   1st Qu.:3.451   1st Qu.:48.31   #>  Median :3.801   Median : 96.92   Median :3.801   Median :53.21   #>  Mean   :3.845   Mean   : 98.04   Mean   :3.845   Mean   :53.83   #>  3rd Qu.:4.143   3rd Qu.:105.65   3rd Qu.:4.143   3rd Qu.:58.01   #>  Max.   :4.809   Max.   :122.64   Max.   :4.809   Max.   :67.33   #>                                                                   #>       QHA             QBO             QKI             QRB        #>  Min.   :20.61   Min.   :15.86   Min.   :60.26   Min.   :23.79   #>  1st Qu.:22.43   1st Qu.:17.25   1st Qu.:65.57   1st Qu.:25.88   #>  Median :24.71   Median :19.00   Median :72.21   Median :28.51   #>  Mean   :24.99   Mean   :19.22   Mean   :73.05   Mean   :28.84   #>  3rd Qu.:26.93   3rd Qu.:20.72   3rd Qu.:78.72   3rd Qu.:31.07   #>  Max.   :31.26   Max.   :24.05   Max.   :91.38   Max.   :36.07   #>                                                                  #>       QLU             VLU              VHT              VBR        #>  Min.   :317.1   Min.   :0.4476   Min.   :0.2825   Min.   :1.195   #>  1st Qu.:345.1   1st Qu.:0.4968   1st Qu.:0.3135   1st Qu.:1.326   #>  Median :380.1   Median :0.5597   Median :0.3532   Median :1.494   #>  Mean   :384.5   Mean   :0.5689   Mean   :0.3590   Mean   :1.519   #>  3rd Qu.:414.3   3rd Qu.:0.6226   3rd Qu.:0.3929   3rd Qu.:1.662   #>  Max.   :480.9   Max.   :0.7484   Max.   :0.4723   Max.   :1.998   #>                                                                    #>       VMU             VAD             VSK             VSP         #>  Min.   :23.78   Min.   :14.47   Min.   :2.058   Min.   :0.1527   #>  1st Qu.:26.40   1st Qu.:16.07   1st Qu.:2.284   1st Qu.:0.1695   #>  Median :29.74   Median :18.10   Median :2.573   Median :0.1909   #>  Mean   :30.23   Mean   :18.40   Mean   :2.615   Mean   :0.1941   #>  3rd Qu.:33.08   3rd Qu.:20.13   3rd Qu.:2.862   3rd Qu.:0.2124   #>  Max.   :39.77   Max.   :24.20   Max.   :3.441   Max.   :0.2553   #>                                                                   #>       VPA               VLI             VST              VGU         #>  Min.   :0.08293   Min.   :1.530   Min.   :0.1238   Min.   :0.8546   #>  1st Qu.:0.09204   1st Qu.:1.698   1st Qu.:0.1374   1st Qu.:0.9485   #>  Median :0.10369   Median :1.913   Median :0.1548   Median :1.0686   #>  Mean   :0.10540   Mean   :1.944   Mean   :0.1573   Mean   :1.0862   #>  3rd Qu.:0.11535   3rd Qu.:2.128   3rd Qu.:0.1722   3rd Qu.:1.1887   #>  Max.   :0.13866   Max.   :2.558   Max.   :0.2070   Max.   :1.4290   #>                                                                      #>       VBO             VKI              VAB             VVB        #>  Min.   :4.445   Min.   :0.2594   Min.   :1.672   Min.   :3.345   #>  1st Qu.:4.933   1st Qu.:0.2879   1st Qu.:1.856   1st Qu.:3.712   #>  Median :5.558   Median :0.3243   Median :2.091   Median :4.183   #>  Mean   :5.649   Mean   :0.3297   Mean   :2.126   Mean   :4.251   #>  3rd Qu.:6.183   3rd Qu.:0.3608   3rd Qu.:2.326   3rd Qu.:4.653   #>  Max.   :7.432   Max.   :0.4337   Max.   :2.796   Max.   :5.593   #>                                                                   #>       VRB             S15                TAD            DOSENUM  #>  Min.   :2.297   Min.   :0.002040   Min.   : 0.200   Min.   :1   #>  1st Qu.:2.550   1st Qu.:0.002265   1st Qu.: 0.533   1st Qu.:1   #>  Median :2.873   Median :0.002551   Median : 2.200   Median :1   #>  Mean   :2.920   Mean   :0.002593   Mean   : 6.471   Mean   :1   #>  3rd Qu.:3.196   3rd Qu.:0.002838   3rd Qu.: 8.200   3rd Qu.:1   #>  Max.   :3.841   Max.   :0.003412   Max.   :48.167   Max.   :1   #>                                                                  #>    eta.LClint        #>  Min.   :-0.636333   #>  1st Qu.:-0.333454   #>  Median : 0.137383   #>  Mean   : 0.005812   #>  3rd Qu.: 0.257907   #>  Max.   : 0.451128   #>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"change-error-to-lognormal","dir":"Articles","previous_headings":"SAEM","what":"Change error to lognormal","title":"mavoglurant -- physiologically-based PK","text":"NOTE: lognormal distribution AIC/loglik/etc normal scale. Therefore, can compare AICs fit.lnorm fit.addProp since calculated scale. case can see AIC log-normal model better AIC addProp model.","code":"fit.lnorm.S <- pbpk %>%     model({C15 ~ lnorm(lnorm.err)}) %>% # Change C15 to be log-normally distributed     ## Requires data since piping from pbpk model     nlmixr(dat,est=\"saem\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 gofs(fit.lnorm.S) #>        ID          CMT                 EVID        EVI2        MDV    #>  793    : 15   Length:256         Min.   :0   Min.   :0   Min.   :0   #>  796    : 15   Class :character   1st Qu.:0   1st Qu.:0   1st Qu.:0   #>  797    : 14   Mode  :character   Median :0   Median :0   Median :0   #>  799    : 14                      Mean   :0   Mean   :0   Mean   :0   #>  803    : 14                      3rd Qu.:0   3rd Qu.:0   3rd Qu.:0   #>  806    : 14                      Max.   :0   Max.   :0   Max.   :0   #>  (Other):170                                                          #>        DV              LNDV             AMT         TIME             DOSE       #>  Min.   :  2.01   Min.   :0.6981   Min.   :0   Min.   : 0.200   Min.   :25.00   #>  1st Qu.: 29.30   1st Qu.:3.3780   1st Qu.:0   1st Qu.: 0.533   1st Qu.:25.00   #>  Median : 88.10   Median :4.4775   Median :0   Median : 2.200   Median :25.00   #>  Mean   :184.95   Mean   :4.4056   Mean   :0   Mean   : 6.471   Mean   :29.59   #>  3rd Qu.:327.50   3rd Qu.:5.7915   3rd Qu.:0   3rd Qu.: 8.200   3rd Qu.:37.50   #>  Max.   :985.00   Max.   :6.8930   Max.   :0   Max.   :48.167   Max.   :37.50   #>                                                                                 #>       OCC         RATE        AGE             SEX             RACE        #>  Min.   :1   Min.   :0   Min.   :19.00   Min.   :1.000   Min.   : 1.000   #>  1st Qu.:1   1st Qu.:0   1st Qu.:23.75   1st Qu.:1.000   1st Qu.: 1.000   #>  Median :1   Median :0   Median :31.00   Median :1.000   Median : 1.000   #>  Mean   :1   Mean   :0   Mean   :33.92   Mean   :1.219   Mean   : 5.445   #>  3rd Qu.:1   3rd Qu.:0   3rd Qu.:43.00   3rd Qu.:1.000   3rd Qu.: 2.000   #>  Max.   :1   Max.   :0   Max.   :50.00   Max.   :2.000   Max.   :88.000   #>                                                                           #>        WT               HT            EPRED               ERES           #>  Min.   : 61.90   Min.   :1.560   Min.   :  0.6331   Min.   :-492.9075   #>  1st Qu.: 68.70   1st Qu.:1.650   1st Qu.: 30.9454   1st Qu.: -23.4824   #>  Median : 77.40   Median :1.770   Median :104.2367   Median :  -0.2906   #>  Mean   : 78.67   Mean   :1.742   Mean   :191.1033   Mean   :  -6.1529   #>  3rd Qu.: 86.10   3rd Qu.:1.830   3rd Qu.:316.2809   3rd Qu.:  16.1991   #>  Max.   :103.50   Max.   :1.910   Max.   :852.9075   Max.   : 367.0875   #>                                                                          #>       NPDE               NPD                PRED               RES            #>  Min.   :-2.93520   Min.   :-2.93520   Min.   :  0.6325   Min.   :-502.2661   #>  1st Qu.:-0.79779   1st Qu.:-0.79779   1st Qu.: 31.7104   1st Qu.: -23.3620   #>  Median : 0.01671   Median : 0.01671   Median :102.9339   Median :  -0.2013   #>  Mean   :-0.13118   Mean   :-0.13118   Mean   :191.1633   Mean   :  -6.2129   #>  3rd Qu.: 0.60276   3rd Qu.: 0.60276   3rd Qu.:317.2256   3rd Qu.:  16.5768   #>  Max.   : 2.05375   Max.   : 2.05375   Max.   :862.2661   Max.   : 377.4247   #>                                                                               #>       WRES               IPRED               IRES              IWRES          #>  Min.   :-3.052314   Min.   :  0.8702   Min.   :-493.592   Min.   :-3.02874   #>  1st Qu.:-0.717736   1st Qu.: 29.4336   1st Qu.: -21.019   1st Qu.:-0.81794   #>  Median :-0.008093   Median :110.8090   Median :  -1.010   Median :-0.07477   #>  Mean   :-0.072453   Mean   :190.0317   Mean   :  -5.081   Mean   :-0.09384   #>  3rd Qu.: 0.656429   3rd Qu.:316.2691   3rd Qu.:  12.329   3rd Qu.: 0.67939   #>  Max.   : 2.418322   Max.   :853.5924   Max.   : 363.889   Max.   : 3.34199   #>                                                                               #>      CPRED               CRES               CWRES            ETA.LCLINT      #>  Min.   :  0.6272   Min.   :-502.5950   Min.   :-3.05172   Min.   :-0.6315   #>  1st Qu.: 31.7441   1st Qu.: -23.1552   1st Qu.:-0.71823   1st Qu.:-0.2990   #>  Median :102.9636   Median :  -0.2752   Median :-0.01603   Median : 0.1066   #>  Mean   :191.6890   Mean   :  -6.7386   Mean   :-0.08126   Mean   :-0.0200   #>  3rd Qu.:317.9609   3rd Qu.:  15.8504   3rd Qu.: 0.65374   3rd Qu.: 0.2464   #>  Max.   :862.5950   Max.   : 376.1411   Max.   : 2.34353   Max.   : 0.4329   #>                                                                              #>      LUNGS               HEART               BRAIN             MUSCLES         #>  Min.   :0.0006838   Min.   :0.0005787   Min.   :0.008757   Min.   :0.009226   #>  1st Qu.:0.0233558   1st Qu.:0.0198613   1st Qu.:0.307061   1st Qu.:0.321108   #>  Median :0.0850527   Median :0.0739511   Median :1.274784   Median :1.289504   #>  Mean   :0.1506973   Mean   :0.1597971   Mean   :1.928454   Mean   :2.213161   #>  3rd Qu.:0.2566820   3rd Qu.:0.2379271   3rd Qu.:3.461631   3rd Qu.:4.343395   #>  Max.   :0.6650013   Max.   :0.8380577   Max.   :5.521798   Max.   :6.913628   #>                                                                                #>     ADIPOSE            SKIN               SPLEEN             PANCREAS         #>  Min.   :0.1759   Min.   :0.0008149   Min.   :0.0001403   Min.   :7.627e-05   #>  1st Qu.:2.5907   1st Qu.:0.0279852   1st Qu.:0.0047995   1st Qu.:2.612e-03   #>  Median :4.0840   Median :0.1045123   Median :0.0176175   Median :9.628e-03   #>  Mean   :4.0830   Mean   :0.2255123   Mean   :0.0354591   Mean   :2.019e-02   #>  3rd Qu.:5.5408   3rd Qu.:0.3390837   3rd Qu.:0.0545023   3rd Qu.:3.001e-02   #>  Max.   :8.3623   Max.   :1.1424994   Max.   :0.2104963   Max.   :1.187e-01   #>                                                                               #>      LIVER             STOMACH              GUT              BONES          #>  Min.   :0.003823   Min.   :0.000114   Min.   :0.00190   Min.   :0.004534   #>  1st Qu.:0.121450   1st Qu.:0.003910   1st Qu.:0.06519   1st Qu.:0.160199   #>  Median :0.475210   Median :0.014491   Median :0.24238   Median :0.688594   #>  Mean   :1.008375   Mean   :0.031155   Mean   :0.52357   Mean   :0.927186   #>  3rd Qu.:1.581715   3rd Qu.:0.046077   3rd Qu.:0.77697   3rd Qu.:1.612842   #>  Max.   :4.647168   Max.   :0.172947   Max.   :2.79266   Max.   :2.502575   #>                                                                             #>     KIDNEYS         ARTERIAL_BLOOD      VENOUS_BLOOD      REST_OF_BODY     #>  Min.   :0.000644   Min.   :0.001111   Min.   :0.00222   Min.   :0.01647   #>  1st Qu.:0.022025   1st Qu.:0.037954   1st Qu.:0.07581   1st Qu.:0.63290   #>  Median :0.080703   Median :0.138424   Median :0.27582   Median :2.51086   #>  Mean   :0.158330   Mean   :0.249826   Mean   :0.48471   Mean   :2.31805   #>  3rd Qu.:0.248906   3rd Qu.:0.420919   3rd Qu.:0.83107   3rd Qu.:3.62933   #>  Max.   :0.920234   Max.   :1.174850   Max.   :2.08368   Max.   :5.51603   #>                                                                            #>       KBBR            KBMU             KBAD           CLINT        #>  Min.   :10.71   Min.   :0.5713   Min.   :7.519   Min.   : 741.8   #>  1st Qu.:10.71   1st Qu.:0.5713   1st Qu.:7.519   1st Qu.:1034.6   #>  Median :10.71   Median :0.5713   Median :7.519   Median :1552.0   #>  Mean   :10.71   Mean   :0.5713   Mean   :7.519   Mean   :1430.6   #>  3rd Qu.:10.71   3rd Qu.:0.5713   3rd Qu.:7.519   3rd Qu.:1784.8   #>  Max.   :10.71   Max.   :0.5713   Max.   :7.519   Max.   :2150.8   #>                                                                    #>       KBBO            KBRB             CO             QHT        #>  Min.   :1.481   Min.   :9.906   Min.   :317.1   Min.   :12.69   #>  1st Qu.:1.481   1st Qu.:9.906   1st Qu.:345.1   1st Qu.:13.80   #>  Median :1.481   Median :9.906   Median :380.1   Median :15.20   #>  Mean   :1.481   Mean   :9.906   Mean   :384.5   Mean   :15.38   #>  3rd Qu.:1.481   3rd Qu.:9.906   3rd Qu.:414.3   3rd Qu.:16.57   #>  Max.   :1.481   Max.   :9.906   Max.   :480.9   Max.   :19.24   #>                                                                  #>       QBR             QMU             QAD             QSK        #>  Min.   :38.06   Min.   :53.92   Min.   :15.86   Min.   :15.86   #>  1st Qu.:41.41   1st Qu.:58.66   1st Qu.:17.25   1st Qu.:17.25   #>  Median :45.61   Median :64.61   Median :19.00   Median :19.00   #>  Mean   :46.14   Mean   :65.36   Mean   :19.22   Mean   :19.22   #>  3rd Qu.:49.72   3rd Qu.:70.44   3rd Qu.:20.72   3rd Qu.:20.72   #>  Max.   :57.71   Max.   :81.76   Max.   :24.05   Max.   :24.05   #>                                                                  #>       QSP              QPA             QLI              QST        #>  Min.   : 9.514   Min.   :3.171   Min.   : 80.87   Min.   :3.171   #>  1st Qu.:10.353   1st Qu.:3.451   1st Qu.: 88.00   1st Qu.:3.451   #>  Median :11.402   Median :3.801   Median : 96.92   Median :3.801   #>  Mean   :11.534   Mean   :3.845   Mean   : 98.04   Mean   :3.845   #>  3rd Qu.:12.430   3rd Qu.:4.143   3rd Qu.:105.65   3rd Qu.:4.143   #>  Max.   :14.428   Max.   :4.809   Max.   :122.64   Max.   :4.809   #>                                                                    #>       QGU             QHA             QBO             QKI        #>  Min.   :44.40   Min.   :20.61   Min.   :15.86   Min.   :60.26   #>  1st Qu.:48.31   1st Qu.:22.43   1st Qu.:17.25   1st Qu.:65.57   #>  Median :53.21   Median :24.71   Median :19.00   Median :72.21   #>  Mean   :53.83   Mean   :24.99   Mean   :19.22   Mean   :73.05   #>  3rd Qu.:58.01   3rd Qu.:26.93   3rd Qu.:20.72   3rd Qu.:78.72   #>  Max.   :67.33   Max.   :31.26   Max.   :24.05   Max.   :91.38   #>                                                                  #>       QRB             QLU             VLU              VHT         #>  Min.   :23.79   Min.   :317.1   Min.   :0.4476   Min.   :0.2825   #>  1st Qu.:25.88   1st Qu.:345.1   1st Qu.:0.4968   1st Qu.:0.3135   #>  Median :28.51   Median :380.1   Median :0.5597   Median :0.3532   #>  Mean   :28.84   Mean   :384.5   Mean   :0.5689   Mean   :0.3590   #>  3rd Qu.:31.07   3rd Qu.:414.3   3rd Qu.:0.6226   3rd Qu.:0.3929   #>  Max.   :36.07   Max.   :480.9   Max.   :0.7484   Max.   :0.4723   #>                                                                    #>       VBR             VMU             VAD             VSK        #>  Min.   :1.195   Min.   :23.78   Min.   :14.47   Min.   :2.058   #>  1st Qu.:1.326   1st Qu.:26.40   1st Qu.:16.07   1st Qu.:2.284   #>  Median :1.494   Median :29.74   Median :18.10   Median :2.573   #>  Mean   :1.519   Mean   :30.23   Mean   :18.40   Mean   :2.615   #>  3rd Qu.:1.662   3rd Qu.:33.08   3rd Qu.:20.13   3rd Qu.:2.862   #>  Max.   :1.998   Max.   :39.77   Max.   :24.20   Max.   :3.441   #>                                                                  #>       VSP              VPA               VLI             VST         #>  Min.   :0.1527   Min.   :0.08293   Min.   :1.530   Min.   :0.1238   #>  1st Qu.:0.1695   1st Qu.:0.09204   1st Qu.:1.698   1st Qu.:0.1374   #>  Median :0.1909   Median :0.10369   Median :1.913   Median :0.1548   #>  Mean   :0.1941   Mean   :0.10540   Mean   :1.944   Mean   :0.1573   #>  3rd Qu.:0.2124   3rd Qu.:0.11535   3rd Qu.:2.128   3rd Qu.:0.1722   #>  Max.   :0.2553   Max.   :0.13866   Max.   :2.558   Max.   :0.2070   #>                                                                      #>       VGU              VBO             VKI              VAB        #>  Min.   :0.8546   Min.   :4.445   Min.   :0.2594   Min.   :1.672   #>  1st Qu.:0.9485   1st Qu.:4.933   1st Qu.:0.2879   1st Qu.:1.856   #>  Median :1.0686   Median :5.558   Median :0.3243   Median :2.091   #>  Mean   :1.0862   Mean   :5.649   Mean   :0.3297   Mean   :2.126   #>  3rd Qu.:1.1887   3rd Qu.:6.183   3rd Qu.:0.3608   3rd Qu.:2.326   #>  Max.   :1.4290   Max.   :7.432   Max.   :0.4337   Max.   :2.796   #>                                                                    #>       VVB             VRB             S15                TAD         #>  Min.   :3.345   Min.   :2.297   Min.   :0.002040   Min.   : 0.200   #>  1st Qu.:3.712   1st Qu.:2.550   1st Qu.:0.002265   1st Qu.: 0.533   #>  Median :4.183   Median :2.873   Median :0.002551   Median : 2.200   #>  Mean   :4.251   Mean   :2.920   Mean   :0.002593   Mean   : 6.471   #>  3rd Qu.:4.653   3rd Qu.:3.196   3rd Qu.:0.002838   3rd Qu.: 8.200   #>  Max.   :5.593   Max.   :3.841   Max.   :0.003412   Max.   :48.167   #>                                                                      #>     DOSENUM    eta.LClint      #>  Min.   :1   Min.   :-0.6315   #>  1st Qu.:1   1st Qu.:-0.2990   #>  Median :1   Median : 0.1066   #>  Mean   :1   Mean   :-0.0200   #>  3rd Qu.:1   3rd Qu.: 0.2464   #>  Max.   :1   Max.   : 0.4329   #>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"piping-to-focei","dir":"Articles","previous_headings":"","what":"Piping to FOCEi","title":"mavoglurant -- physiologically-based PK","text":"can pipe models different estimation methods new estimation methods.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"additive-proportional","dir":"Articles","previous_headings":"Piping to FOCEi","what":"Additive + Proportional","title":"mavoglurant -- physiologically-based PK","text":"","code":"fit.addProp.F <- fit.addProp.S %>%     nlmixr(est=\"focei\",            control=list(print=0),             table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:20  #> done ## Since this was a model pipline, the data ## remains the same as the last fit.  gofs(fit.addProp.F) #>        ID          CMT                 EVID        EVI2        MDV    #>  793    : 15   Length:256         Min.   :0   Min.   :0   Min.   :0   #>  796    : 15   Class :character   1st Qu.:0   1st Qu.:0   1st Qu.:0   #>  797    : 14   Mode  :character   Median :0   Median :0   Median :0   #>  799    : 14                      Mean   :0   Mean   :0   Mean   :0   #>  803    : 14                      3rd Qu.:0   3rd Qu.:0   3rd Qu.:0   #>  806    : 14                      Max.   :0   Max.   :0   Max.   :0   #>  (Other):170                                                          #>        DV              LNDV             AMT         TIME             DOSE       #>  Min.   :  2.01   Min.   :0.6981   Min.   :0   Min.   : 0.200   Min.   :25.00   #>  1st Qu.: 29.30   1st Qu.:3.3780   1st Qu.:0   1st Qu.: 0.533   1st Qu.:25.00   #>  Median : 88.10   Median :4.4775   Median :0   Median : 2.200   Median :25.00   #>  Mean   :184.95   Mean   :4.4056   Mean   :0   Mean   : 6.471   Mean   :29.59   #>  3rd Qu.:327.50   3rd Qu.:5.7915   3rd Qu.:0   3rd Qu.: 8.200   3rd Qu.:37.50   #>  Max.   :985.00   Max.   :6.8930   Max.   :0   Max.   :48.167   Max.   :37.50   #>                                                                                 #>       OCC         RATE        AGE             SEX             RACE        #>  Min.   :1   Min.   :0   Min.   :19.00   Min.   :1.000   Min.   : 1.000   #>  1st Qu.:1   1st Qu.:0   1st Qu.:23.75   1st Qu.:1.000   1st Qu.: 1.000   #>  Median :1   Median :0   Median :31.00   Median :1.000   Median : 1.000   #>  Mean   :1   Mean   :0   Mean   :33.92   Mean   :1.219   Mean   : 5.445   #>  3rd Qu.:1   3rd Qu.:0   3rd Qu.:43.00   3rd Qu.:1.000   3rd Qu.: 2.000   #>  Max.   :1   Max.   :0   Max.   :50.00   Max.   :2.000   Max.   :88.000   #>                                                                           #>        WT               HT            EPRED              ERES           #>  Min.   : 61.90   Min.   :1.560   Min.   :  1.489   Min.   :-532.5794   #>  1st Qu.: 68.70   1st Qu.:1.650   1st Qu.: 29.771   1st Qu.: -19.7594   #>  Median : 77.40   Median :1.770   Median : 89.073   Median :  -0.7489   #>  Mean   : 78.67   Mean   :1.742   Mean   :198.065   Mean   : -13.1147   #>  3rd Qu.: 86.10   3rd Qu.:1.830   3rd Qu.:340.338   3rd Qu.:  15.3204   #>  Max.   :103.50   Max.   :1.910   Max.   :892.579   Max.   : 338.9830   #>                                                                         #>       NPDE                NPD                 PRED              RES            #>  Min.   :-2.935199   Min.   :-2.935199   Min.   :  1.392   Min.   :-541.5251   #>  1st Qu.:-0.722511   1st Qu.:-0.722511   1st Qu.: 29.402   1st Qu.: -18.2325   #>  Median : 0.041789   Median : 0.041789   Median : 87.038   Median :  -0.1431   #>  Mean   : 0.004365   Mean   : 0.004365   Mean   :197.210   Mean   : -12.2601   #>  3rd Qu.: 0.612813   3rd Qu.: 0.612813   3rd Qu.:341.337   3rd Qu.:  15.6288   #>  Max.   : 2.713052   Max.   : 2.713052   Max.   :901.525   Max.   : 349.3258   #>                                                                                #>       WRES              IPRED              IRES               IWRES           #>  Min.   :-2.19102   Min.   :  1.205   Min.   :-533.7807   Min.   :-2.185337   #>  1st Qu.:-0.68689   1st Qu.: 27.883   1st Qu.: -13.9744   1st Qu.:-0.639223   #>  Median :-0.01821   Median : 87.475   Median :  -0.0126   Median :-0.009932   #>  Mean   : 0.07768   Mean   :195.998   Mean   : -11.0474   Mean   : 0.011870   #>  3rd Qu.: 0.72365   3rd Qu.:335.116   3rd Qu.:  11.5959   3rd Qu.: 0.658331   #>  Max.   : 4.30965   Max.   :893.781   Max.   : 334.7323   Max.   : 2.559917   #>                                                                               #>      CPRED               CRES               CWRES            ETA.LCLINT        #>  Min.   :  0.4319   Min.   :-541.7612   Min.   :-2.20991   Min.   :-0.608642   #>  1st Qu.: 28.2033   1st Qu.: -17.5360   1st Qu.:-0.76559   1st Qu.:-0.288330   #>  Median : 86.3193   Median :   0.3433   Median : 0.01883   Median : 0.114270   #>  Mean   :196.8603   Mean   : -11.9099   Mean   : 0.01267   Mean   :-0.007901   #>  3rd Qu.:341.4566   3rd Qu.:  16.8438   3rd Qu.: 0.70321   3rd Qu.: 0.227756   #>  Max.   :901.7612   Max.   : 347.9082   Max.   : 2.93064   Max.   : 0.368509   #>                                                                                #>      LUNGS               HEART             BRAIN             MUSCLES        #>  Min.   :0.0009467   Min.   :0.00080   Min.   :0.008901   Min.   :0.01346   #>  1st Qu.:0.0221628   1st Qu.:0.01886   1st Qu.:0.213499   1st Qu.:0.32338   #>  Median :0.0690150   Median :0.05999   Median :0.733717   Median :1.12400   #>  Mean   :0.1550357   Mean   :0.16297   Mean   :1.572570   Mean   :2.33749   #>  3rd Qu.:0.2730784   3rd Qu.:0.25463   3rd Qu.:3.142835   3rd Qu.:4.65369   #>  Max.   :0.6818635   Max.   :0.84673   Max.   :4.946001   Max.   :7.19210   #>                                                                             #>     ADIPOSE            SKIN              SPLEEN             PANCREAS         #>  Min.   :0.3729   Min.   :0.001126   Min.   :0.0001941   Min.   :0.0001055   #>  1st Qu.:2.7391   1st Qu.:0.026580   1st Qu.:0.0045557   1st Qu.:0.0024799   #>  Median :4.6912   Median :0.084760   Median :0.0142936   Median :0.0078116   #>  Mean   :4.5100   Mean   :0.229870   Mean   :0.0363282   Mean   :0.0206468   #>  3rd Qu.:6.0315   3rd Qu.:0.363129   3rd Qu.:0.0575290   3rd Qu.:0.0320656   #>  Max.   :8.4651   Max.   :1.153985   Max.   :0.2134889   Max.   :0.1201504   #>                                                                              #>      LIVER             STOMACH               GUT               BONES         #>  Min.   :0.004854   Min.   :0.0001577   Min.   :0.002627   Min.   :0.03628   #>  1st Qu.:0.122183   1st Qu.:0.0037130   1st Qu.:0.061911   1st Qu.:1.27184   #>  Median :0.389564   Median :0.0117571   Median :0.196645   Median :2.50350   #>  Mean   :1.038448   Mean   :0.0318079   Mean   :0.534130   Mean   :2.38796   #>  3rd Qu.:1.731292   3rd Qu.:0.0492383   3rd Qu.:0.831174   3rd Qu.:3.37429   #>  Max.   :4.438733   Max.   :0.1748488   Max.   :2.822001   Max.   :5.30557   #>                                                                              #>     KIDNEYS          ARTERIAL_BLOOD      VENOUS_BLOOD       REST_OF_BODY      #>  Min.   :0.0008911   Min.   :0.001538   Min.   :0.003074   Min.   :0.006307   #>  1st Qu.:0.0209049   1st Qu.:0.036018   1st Qu.:0.071936   1st Qu.:0.151741   #>  Median :0.0654781   Median :0.112319   Median :0.223814   Median :0.533427   #>  Mean   :0.1623603   Mean   :0.256871   Mean   :0.498787   Mean   :1.076948   #>  3rd Qu.:0.2625001   3rd Qu.:0.445837   3rd Qu.:0.883869   3rd Qu.:2.091592   #>  Max.   :0.9345757   Max.   :1.201820   Max.   :2.138754   Max.   :3.248250   #>                                                                               #>       KBBR            KBMU             KBAD           CLINT      #>  Min.   :7.964   Min.   :0.6045   Min.   :10.26   Min.   : 730   #>  1st Qu.:7.964   1st Qu.:0.6045   1st Qu.:10.26   1st Qu.:1006   #>  Median :7.964   Median :0.6045   Median :10.26   Median :1504   #>  Mean   :7.964   Mean   :0.6045   Mean   :10.26   Mean   :1383   #>  3rd Qu.:7.964   3rd Qu.:0.6045   3rd Qu.:10.26   3rd Qu.:1685   #>  Max.   :7.964   Max.   :0.6045   Max.   :10.26   Max.   :1939   #>                                                                  #>       KBBO            KBRB             CO             QHT        #>  Min.   :7.597   Min.   :2.929   Min.   :317.1   Min.   :12.69   #>  1st Qu.:7.597   1st Qu.:2.929   1st Qu.:345.1   1st Qu.:13.80   #>  Median :7.597   Median :2.929   Median :380.1   Median :15.20   #>  Mean   :7.597   Mean   :2.929   Mean   :384.5   Mean   :15.38   #>  3rd Qu.:7.597   3rd Qu.:2.929   3rd Qu.:414.3   3rd Qu.:16.57   #>  Max.   :7.597   Max.   :2.929   Max.   :480.9   Max.   :19.24   #>                                                                  #>       QBR             QMU             QAD             QSK        #>  Min.   :38.06   Min.   :53.92   Min.   :15.86   Min.   :15.86   #>  1st Qu.:41.41   1st Qu.:58.66   1st Qu.:17.25   1st Qu.:17.25   #>  Median :45.61   Median :64.61   Median :19.00   Median :19.00   #>  Mean   :46.14   Mean   :65.36   Mean   :19.22   Mean   :19.22   #>  3rd Qu.:49.72   3rd Qu.:70.44   3rd Qu.:20.72   3rd Qu.:20.72   #>  Max.   :57.71   Max.   :81.76   Max.   :24.05   Max.   :24.05   #>                                                                  #>       QSP              QPA             QLI              QST        #>  Min.   : 9.514   Min.   :3.171   Min.   : 80.87   Min.   :3.171   #>  1st Qu.:10.353   1st Qu.:3.451   1st Qu.: 88.00   1st Qu.:3.451   #>  Median :11.402   Median :3.801   Median : 96.92   Median :3.801   #>  Mean   :11.534   Mean   :3.845   Mean   : 98.04   Mean   :3.845   #>  3rd Qu.:12.430   3rd Qu.:4.143   3rd Qu.:105.65   3rd Qu.:4.143   #>  Max.   :14.428   Max.   :4.809   Max.   :122.64   Max.   :4.809   #>                                                                    #>       QGU             QHA             QBO             QKI        #>  Min.   :44.40   Min.   :20.61   Min.   :15.86   Min.   :60.26   #>  1st Qu.:48.31   1st Qu.:22.43   1st Qu.:17.25   1st Qu.:65.57   #>  Median :53.21   Median :24.71   Median :19.00   Median :72.21   #>  Mean   :53.83   Mean   :24.99   Mean   :19.22   Mean   :73.05   #>  3rd Qu.:58.01   3rd Qu.:26.93   3rd Qu.:20.72   3rd Qu.:78.72   #>  Max.   :67.33   Max.   :31.26   Max.   :24.05   Max.   :91.38   #>                                                                  #>       QRB             QLU             VLU              VHT         #>  Min.   :23.79   Min.   :317.1   Min.   :0.4476   Min.   :0.2825   #>  1st Qu.:25.88   1st Qu.:345.1   1st Qu.:0.4968   1st Qu.:0.3135   #>  Median :28.51   Median :380.1   Median :0.5597   Median :0.3532   #>  Mean   :28.84   Mean   :384.5   Mean   :0.5689   Mean   :0.3590   #>  3rd Qu.:31.07   3rd Qu.:414.3   3rd Qu.:0.6226   3rd Qu.:0.3929   #>  Max.   :36.07   Max.   :480.9   Max.   :0.7484   Max.   :0.4723   #>                                                                    #>       VBR             VMU             VAD             VSK        #>  Min.   :1.195   Min.   :23.78   Min.   :14.47   Min.   :2.058   #>  1st Qu.:1.326   1st Qu.:26.40   1st Qu.:16.07   1st Qu.:2.284   #>  Median :1.494   Median :29.74   Median :18.10   Median :2.573   #>  Mean   :1.519   Mean   :30.23   Mean   :18.40   Mean   :2.615   #>  3rd Qu.:1.662   3rd Qu.:33.08   3rd Qu.:20.13   3rd Qu.:2.862   #>  Max.   :1.998   Max.   :39.77   Max.   :24.20   Max.   :3.441   #>                                                                  #>       VSP              VPA               VLI             VST         #>  Min.   :0.1527   Min.   :0.08293   Min.   :1.530   Min.   :0.1238   #>  1st Qu.:0.1695   1st Qu.:0.09204   1st Qu.:1.698   1st Qu.:0.1374   #>  Median :0.1909   Median :0.10369   Median :1.913   Median :0.1548   #>  Mean   :0.1941   Mean   :0.10540   Mean   :1.944   Mean   :0.1573   #>  3rd Qu.:0.2124   3rd Qu.:0.11535   3rd Qu.:2.128   3rd Qu.:0.1722   #>  Max.   :0.2553   Max.   :0.13866   Max.   :2.558   Max.   :0.2070   #>                                                                      #>       VGU              VBO             VKI              VAB        #>  Min.   :0.8546   Min.   :4.445   Min.   :0.2594   Min.   :1.672   #>  1st Qu.:0.9485   1st Qu.:4.933   1st Qu.:0.2879   1st Qu.:1.856   #>  Median :1.0686   Median :5.558   Median :0.3243   Median :2.091   #>  Mean   :1.0862   Mean   :5.649   Mean   :0.3297   Mean   :2.126   #>  3rd Qu.:1.1887   3rd Qu.:6.183   3rd Qu.:0.3608   3rd Qu.:2.326   #>  Max.   :1.4290   Max.   :7.432   Max.   :0.4337   Max.   :2.796   #>                                                                    #>       VVB             VRB             S15                TAD         #>  Min.   :3.345   Min.   :2.297   Min.   :0.002040   Min.   : 0.200   #>  1st Qu.:3.712   1st Qu.:2.550   1st Qu.:0.002265   1st Qu.: 0.533   #>  Median :4.183   Median :2.873   Median :0.002551   Median : 2.200   #>  Mean   :4.251   Mean   :2.920   Mean   :0.002593   Mean   : 6.471   #>  3rd Qu.:4.653   3rd Qu.:3.196   3rd Qu.:0.002838   3rd Qu.: 8.200   #>  Max.   :5.593   Max.   :3.841   Max.   :0.003412   Max.   :48.167   #>                                                                      #>     DOSENUM    eta.LClint        #>  Min.   :1   Min.   :-0.608642   #>  1st Qu.:1   1st Qu.:-0.288330   #>  Median :1   Median : 0.114270   #>  Mean   :1   Mean   :-0.007901   #>  3rd Qu.:1   3rd Qu.: 0.227756   #>  Max.   :1   Max.   : 0.368509   #>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/mavoglurant.html","id":"log-normal","dir":"Articles","previous_headings":"Piping to FOCEi","what":"Log-normal","title":"mavoglurant -- physiologically-based PK","text":"# Traditional lognormal estimates identical NOTE: estimates AIC different since calculated log scale.","code":"fit.lnorm.F <- fit.addProp.F %>%     model({C15 ~ lnorm(lnorm.err)}) %>%     nlmixr(est=\"focei\",            control=list(print=0),             table=list(cwres=TRUE, npde=TRUE)); #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:21  #> done ## In this model pipline we are changing the fit method to focei.  gofs(fit.lnorm.F); #>        ID          CMT                 EVID        EVI2        MDV    #>  793    : 15   Length:256         Min.   :0   Min.   :0   Min.   :0   #>  796    : 15   Class :character   1st Qu.:0   1st Qu.:0   1st Qu.:0   #>  797    : 14   Mode  :character   Median :0   Median :0   Median :0   #>  799    : 14                      Mean   :0   Mean   :0   Mean   :0   #>  803    : 14                      3rd Qu.:0   3rd Qu.:0   3rd Qu.:0   #>  806    : 14                      Max.   :0   Max.   :0   Max.   :0   #>  (Other):170                                                          #>        DV              LNDV             AMT         TIME             DOSE       #>  Min.   :  2.01   Min.   :0.6981   Min.   :0   Min.   : 0.200   Min.   :25.00   #>  1st Qu.: 29.30   1st Qu.:3.3780   1st Qu.:0   1st Qu.: 0.533   1st Qu.:25.00   #>  Median : 88.10   Median :4.4775   Median :0   Median : 2.200   Median :25.00   #>  Mean   :184.95   Mean   :4.4056   Mean   :0   Mean   : 6.471   Mean   :29.59   #>  3rd Qu.:327.50   3rd Qu.:5.7915   3rd Qu.:0   3rd Qu.: 8.200   3rd Qu.:37.50   #>  Max.   :985.00   Max.   :6.8930   Max.   :0   Max.   :48.167   Max.   :37.50   #>                                                                                 #>       OCC         RATE        AGE             SEX             RACE        #>  Min.   :1   Min.   :0   Min.   :19.00   Min.   :1.000   Min.   : 1.000   #>  1st Qu.:1   1st Qu.:0   1st Qu.:23.75   1st Qu.:1.000   1st Qu.: 1.000   #>  Median :1   Median :0   Median :31.00   Median :1.000   Median : 1.000   #>  Mean   :1   Mean   :0   Mean   :33.92   Mean   :1.219   Mean   : 5.445   #>  3rd Qu.:1   3rd Qu.:0   3rd Qu.:43.00   3rd Qu.:1.000   3rd Qu.: 2.000   #>  Max.   :1   Max.   :0   Max.   :50.00   Max.   :2.000   Max.   :88.000   #>                                                                           #>        WT               HT            EPRED              ERES           #>  Min.   : 61.90   Min.   :1.560   Min.   :  1.384   Min.   :-495.9996   #>  1st Qu.: 68.70   1st Qu.:1.650   1st Qu.: 28.343   1st Qu.: -16.9544   #>  Median : 77.40   Median :1.770   Median : 88.239   Median :   0.6545   #>  Mean   : 78.67   Mean   :1.742   Mean   :187.942   Mean   :  -2.9920   #>  3rd Qu.: 86.10   3rd Qu.:1.830   3rd Qu.:317.888   3rd Qu.:  22.4077   #>  Max.   :103.50   Max.   :1.910   Max.   :856.000   Max.   : 363.4580   #>                                                                         #>       NPDE               NPD                PRED              RES            #>  Min.   :-2.93520   Min.   :-2.93520   Min.   :  1.395   Min.   :-505.7560   #>  1st Qu.:-0.63582   1st Qu.:-0.63582   1st Qu.: 28.842   1st Qu.: -14.9512   #>  Median : 0.08365   Median : 0.08365   Median : 87.623   Median :   0.5988   #>  Mean   :-0.02358   Mean   :-0.02358   Mean   :187.901   Mean   :  -2.9508   #>  3rd Qu.: 0.70899   3rd Qu.: 0.70899   3rd Qu.:319.303   3rd Qu.:  21.0645   #>  Max.   : 2.21636   Max.   : 2.21636   Max.   :865.756   Max.   : 374.9286   #>                                                                              #>       WRES               IPRED              IRES               IWRES         #>  Min.   :-2.867294   Min.   :  1.532   Min.   :-493.7385   Min.   :-2.8300   #>  1st Qu.:-0.649761   1st Qu.: 26.810   1st Qu.: -10.3538   1st Qu.:-0.6106   #>  Median : 0.054529   Median : 90.884   Median :   0.9186   Median : 0.1283   #>  Mean   :-0.005792   Mean   :186.415   Mean   :  -1.4647   Mean   :-0.0192   #>  3rd Qu.: 0.710212   3rd Qu.:312.879   3rd Qu.:  16.5443   3rd Qu.: 0.6520   #>  Max.   : 2.498981   Max.   :853.739   Max.   : 360.8283   Max.   : 1.9438   #>                                                                              #>      CPRED              CRES               CWRES            ETA.LCLINT        #>  Min.   :  1.394   Min.   :-506.3691   Min.   :-2.86770   Min.   :-0.576934   #>  1st Qu.: 28.979   1st Qu.: -15.4483   1st Qu.:-0.64906   1st Qu.:-0.265299   #>  Median : 87.851   Median :   0.5639   Median : 0.06177   Median : 0.173208   #>  Mean   :188.359   Mean   :  -3.4089   Mean   :-0.01102   Mean   :-0.008434   #>  3rd Qu.:319.824   3rd Qu.:  21.0061   3rd Qu.: 0.70520   3rd Qu.: 0.241792   #>  Max.   :866.369   Max.   : 373.5313   Max.   : 2.44698   Max.   : 0.370694   #>                                                                               #>      LUNGS              HEART              BRAIN            MUSCLES        #>  Min.   :0.001204   Min.   :0.001017   Min.   :0.01336   Min.   :0.01937   #>  1st Qu.:0.021886   1st Qu.:0.018594   1st Qu.:0.25083   1st Qu.:0.36384   #>  Median :0.072523   Median :0.062959   Median :0.93279   Median :1.35901   #>  Mean   :0.147702   Mean   :0.157333   Mean   :1.72317   Mean   :2.48129   #>  3rd Qu.:0.257236   3rd Qu.:0.237247   3rd Qu.:3.34110   3rd Qu.:4.76106   #>  Max.   :0.662580   Max.   :0.837339   Max.   :5.17725   Max.   :7.41135   #>                                                                            #>     ADIPOSE            SKIN              SPLEEN             PANCREAS         #>  Min.   :0.4658   Min.   :0.001432   Min.   :0.0002468   Min.   :0.0001341   #>  1st Qu.:2.7045   1st Qu.:0.026204   1st Qu.:0.0044922   1st Qu.:0.0024450   #>  Median :4.5581   Median :0.088939   Median :0.0150139   Median :0.0082032   #>  Mean   :4.4345   Mean   :0.222047   Mean   :0.0348545   Mean   :0.0198613   #>  3rd Qu.:5.9427   3rd Qu.:0.338302   3rd Qu.:0.0540794   3rd Qu.:0.0299590   #>  Max.   :8.4011   Max.   :1.141569   Max.   :0.2101807   Max.   :0.1185490   #>                                                                              #>      LIVER             STOMACH               GUT               BONES         #>  Min.   :0.006451   Min.   :0.0002005   Min.   :0.003339   Min.   :0.04499   #>  1st Qu.:0.119347   1st Qu.:0.0036602   1st Qu.:0.061029   1st Qu.:1.19134   #>  Median :0.397975   Median :0.0123426   Median :0.206396   Median :2.44337   #>  Mean   :0.988815   Mean   :0.0306677   Mean   :0.515469   Mean   :2.30752   #>  3rd Qu.:1.600101   3rd Qu.:0.0459012   3rd Qu.:0.774527   3rd Qu.:3.26561   #>  Max.   :4.501058   Max.   :0.1727813   Max.   :2.790190   Max.   :5.07574   #>                                                                              #>     KIDNEYS         ARTERIAL_BLOOD      VENOUS_BLOOD       REST_OF_BODY      #>  Min.   :0.001133   Min.   :0.001955   Min.   :0.003908   Min.   :0.008534   #>  1st Qu.:0.020619   1st Qu.:0.035558   1st Qu.:0.071052   1st Qu.:0.160240   #>  Median :0.068784   Median :0.118019   Median :0.235202   Median :0.598338   #>  Mean   :0.155546   Mean   :0.244978   Mean   :0.474962   Mean   :1.093395   #>  3rd Qu.:0.246872   3rd Qu.:0.419803   3rd Qu.:0.832799   3rd Qu.:2.099581   #>  Max.   :0.918635   Max.   :1.171242   Max.   :2.075415   Max.   :3.267103   #>                                                                              #>       KBBR            KBMU             KBAD           CLINT        #>  Min.   :9.387   Min.   :0.6835   Min.   :10.58   Min.   : 784.5   #>  1st Qu.:9.387   1st Qu.:0.6835   1st Qu.:10.58   1st Qu.:1071.4   #>  Median :9.387   Median :0.6835   Median :10.58   Median :1661.1   #>  Mean   :9.387   Mean   :0.6835   Mean   :10.58   Mean   :1440.3   #>  3rd Qu.:9.387   3rd Qu.:0.6835   3rd Qu.:10.58   3rd Qu.:1779.0   #>  Max.   :9.387   Max.   :0.6835   Max.   :10.58   Max.   :2023.8   #>                                                                    #>       KBBO            KBRB             CO             QHT        #>  Min.   :7.498   Min.   :3.116   Min.   :317.1   Min.   :12.69   #>  1st Qu.:7.498   1st Qu.:3.116   1st Qu.:345.1   1st Qu.:13.80   #>  Median :7.498   Median :3.116   Median :380.1   Median :15.20   #>  Mean   :7.498   Mean   :3.116   Mean   :384.5   Mean   :15.38   #>  3rd Qu.:7.498   3rd Qu.:3.116   3rd Qu.:414.3   3rd Qu.:16.57   #>  Max.   :7.498   Max.   :3.116   Max.   :480.9   Max.   :19.24   #>                                                                  #>       QBR             QMU             QAD             QSK        #>  Min.   :38.06   Min.   :53.92   Min.   :15.86   Min.   :15.86   #>  1st Qu.:41.41   1st Qu.:58.66   1st Qu.:17.25   1st Qu.:17.25   #>  Median :45.61   Median :64.61   Median :19.00   Median :19.00   #>  Mean   :46.14   Mean   :65.36   Mean   :19.22   Mean   :19.22   #>  3rd Qu.:49.72   3rd Qu.:70.44   3rd Qu.:20.72   3rd Qu.:20.72   #>  Max.   :57.71   Max.   :81.76   Max.   :24.05   Max.   :24.05   #>                                                                  #>       QSP              QPA             QLI              QST        #>  Min.   : 9.514   Min.   :3.171   Min.   : 80.87   Min.   :3.171   #>  1st Qu.:10.353   1st Qu.:3.451   1st Qu.: 88.00   1st Qu.:3.451   #>  Median :11.402   Median :3.801   Median : 96.92   Median :3.801   #>  Mean   :11.534   Mean   :3.845   Mean   : 98.04   Mean   :3.845   #>  3rd Qu.:12.430   3rd Qu.:4.143   3rd Qu.:105.65   3rd Qu.:4.143   #>  Max.   :14.428   Max.   :4.809   Max.   :122.64   Max.   :4.809   #>                                                                    #>       QGU             QHA             QBO             QKI        #>  Min.   :44.40   Min.   :20.61   Min.   :15.86   Min.   :60.26   #>  1st Qu.:48.31   1st Qu.:22.43   1st Qu.:17.25   1st Qu.:65.57   #>  Median :53.21   Median :24.71   Median :19.00   Median :72.21   #>  Mean   :53.83   Mean   :24.99   Mean   :19.22   Mean   :73.05   #>  3rd Qu.:58.01   3rd Qu.:26.93   3rd Qu.:20.72   3rd Qu.:78.72   #>  Max.   :67.33   Max.   :31.26   Max.   :24.05   Max.   :91.38   #>                                                                  #>       QRB             QLU             VLU              VHT         #>  Min.   :23.79   Min.   :317.1   Min.   :0.4476   Min.   :0.2825   #>  1st Qu.:25.88   1st Qu.:345.1   1st Qu.:0.4968   1st Qu.:0.3135   #>  Median :28.51   Median :380.1   Median :0.5597   Median :0.3532   #>  Mean   :28.84   Mean   :384.5   Mean   :0.5689   Mean   :0.3590   #>  3rd Qu.:31.07   3rd Qu.:414.3   3rd Qu.:0.6226   3rd Qu.:0.3929   #>  Max.   :36.07   Max.   :480.9   Max.   :0.7484   Max.   :0.4723   #>                                                                    #>       VBR             VMU             VAD             VSK        #>  Min.   :1.195   Min.   :23.78   Min.   :14.47   Min.   :2.058   #>  1st Qu.:1.326   1st Qu.:26.40   1st Qu.:16.07   1st Qu.:2.284   #>  Median :1.494   Median :29.74   Median :18.10   Median :2.573   #>  Mean   :1.519   Mean   :30.23   Mean   :18.40   Mean   :2.615   #>  3rd Qu.:1.662   3rd Qu.:33.08   3rd Qu.:20.13   3rd Qu.:2.862   #>  Max.   :1.998   Max.   :39.77   Max.   :24.20   Max.   :3.441   #>                                                                  #>       VSP              VPA               VLI             VST         #>  Min.   :0.1527   Min.   :0.08293   Min.   :1.530   Min.   :0.1238   #>  1st Qu.:0.1695   1st Qu.:0.09204   1st Qu.:1.698   1st Qu.:0.1374   #>  Median :0.1909   Median :0.10369   Median :1.913   Median :0.1548   #>  Mean   :0.1941   Mean   :0.10540   Mean   :1.944   Mean   :0.1573   #>  3rd Qu.:0.2124   3rd Qu.:0.11535   3rd Qu.:2.128   3rd Qu.:0.1722   #>  Max.   :0.2553   Max.   :0.13866   Max.   :2.558   Max.   :0.2070   #>                                                                      #>       VGU              VBO             VKI              VAB        #>  Min.   :0.8546   Min.   :4.445   Min.   :0.2594   Min.   :1.672   #>  1st Qu.:0.9485   1st Qu.:4.933   1st Qu.:0.2879   1st Qu.:1.856   #>  Median :1.0686   Median :5.558   Median :0.3243   Median :2.091   #>  Mean   :1.0862   Mean   :5.649   Mean   :0.3297   Mean   :2.126   #>  3rd Qu.:1.1887   3rd Qu.:6.183   3rd Qu.:0.3608   3rd Qu.:2.326   #>  Max.   :1.4290   Max.   :7.432   Max.   :0.4337   Max.   :2.796   #>                                                                    #>       VVB             VRB             S15                TAD         #>  Min.   :3.345   Min.   :2.297   Min.   :0.002040   Min.   : 0.200   #>  1st Qu.:3.712   1st Qu.:2.550   1st Qu.:0.002265   1st Qu.: 0.533   #>  Median :4.183   Median :2.873   Median :0.002551   Median : 2.200   #>  Mean   :4.251   Mean   :2.920   Mean   :0.002593   Mean   : 6.471   #>  3rd Qu.:4.653   3rd Qu.:3.196   3rd Qu.:0.002838   3rd Qu.: 8.200   #>  Max.   :5.593   Max.   :3.841   Max.   :0.003412   Max.   :48.167   #>                                                                      #>     DOSENUM    eta.LClint        #>  Min.   :1   Min.   :-0.576934   #>  1st Qu.:1   1st Qu.:-0.265299   #>  Median :1   Median : 0.173208   #>  Mean   :1   Mean   :-0.008434   #>  3rd Qu.:1   3rd Qu.: 0.241792   #>  Max.   :1   Max.   : 0.370694   #> datL  <- dat datL$DV <- log(datL$DV);  pbpkL <- function() {   ini({     ##theta=exp(c(1.1, .3, 2, 7.6, .003, .3))     lKbBR = 1.1     lKbMU = 0.3     lKbAD = 2     lCLint = 7.6     lKbBO = 0.03     lKbRB = 0.3     eta.LClint ~ 4     add.err <- 1   })   model({     KbBR = exp(lKbBR)     KbMU = exp(lKbMU)     KbAD = exp(lKbAD)     CLint= exp(lCLint + eta.LClint)     KbBO = exp(lKbBO)     KbRB = exp(lKbRB)      ## Regional blood flows     CO  = (187.00*WT^0.81)*60/1000;         # Cardiac output (L/h) from White et al (1968)     QHT = 4.0 *CO/100;     QBR = 12.0*CO/100;     QMU = 17.0*CO/100;     QAD = 5.0 *CO/100;     QSK = 5.0 *CO/100;     QSP = 3.0 *CO/100;     QPA = 1.0 *CO/100;     QLI = 25.5*CO/100;     QST = 1.0 *CO/100;     QGU = 14.0*CO/100;     QHA = QLI - (QSP + QPA + QST + QGU); # Hepatic artery blood flow     QBO = 5.0 *CO/100;     QKI = 19.0*CO/100;     QRB = CO - (QHT + QBR + QMU + QAD + QSK + QLI + QBO + QKI);     QLU = QHT + QBR + QMU + QAD + QSK + QLI + QBO + QKI + QRB;      ## Organs' volumes = organs' weights / organs' density     VLU = (0.76 *WT/100)/1.051;     VHT = (0.47 *WT/100)/1.030;     VBR = (2.00 *WT/100)/1.036;     VMU = (40.00*WT/100)/1.041;     VAD = (21.42*WT/100)/0.916;     VSK = (3.71 *WT/100)/1.116;     VSP = (0.26 *WT/100)/1.054;     VPA = (0.14 *WT/100)/1.045;     VLI = (2.57 *WT/100)/1.040;     VST = (0.21 *WT/100)/1.050;     VGU = (1.44 *WT/100)/1.043;     VBO = (14.29*WT/100)/1.990;     VKI = (0.44 *WT/100)/1.050;     VAB = (2.81 *WT/100)/1.040;     VVB = (5.62 *WT/100)/1.040;     VRB = (3.86 *WT/100)/1.040;      ## Fixed parameters     BP = 0.61;      # Blood:plasma partition coefficient     fup = 0.028;    # Fraction unbound in plasma     fub = fup/BP;   # Fraction unbound in blood      KbLU = exp(0.8334);     KbHT = exp(1.1205);     KbSK = exp(-.5238);     KbSP = exp(0.3224);     KbPA = exp(0.3224);     KbLI = exp(1.7604);     KbST = exp(0.3224);     KbGU = exp(1.2026);     KbKI = exp(1.3171);      ##-----------------------------------------     S15 = VVB*BP/1000;     C15 = Venous_Blood/S15     lnC15 = log(C15);      ##-----------------------------------------     d/dt(Lungs) = QLU*(Venous_Blood/VVB - Lungs/KbLU/VLU);     d/dt(Heart) = QHT*(Arterial_Blood/VAB - Heart/KbHT/VHT);     d/dt(Brain) = QBR*(Arterial_Blood/VAB - Brain/KbBR/VBR);     d/dt(Muscles) = QMU*(Arterial_Blood/VAB - Muscles/KbMU/VMU);     d/dt(Adipose) = QAD*(Arterial_Blood/VAB - Adipose/KbAD/VAD);     d/dt(Skin) = QSK*(Arterial_Blood/VAB - Skin/KbSK/VSK);     d/dt(Spleen) = QSP*(Arterial_Blood/VAB - Spleen/KbSP/VSP);     d/dt(Pancreas) = QPA*(Arterial_Blood/VAB - Pancreas/KbPA/VPA);     d/dt(Liver) = QHA*Arterial_Blood/VAB + QSP*Spleen/KbSP/VSP + QPA*Pancreas/KbPA/VPA + QST*Stomach/KbST/VST + QGU*Gut/KbGU/VGU - CLint*fub*Liver/KbLI/VLI - QLI*Liver/KbLI/VLI;     d/dt(Stomach) = QST*(Arterial_Blood/VAB - Stomach/KbST/VST);     d/dt(Gut) = QGU*(Arterial_Blood/VAB - Gut/KbGU/VGU);     d/dt(Bones) = QBO*(Arterial_Blood/VAB - Bones/KbBO/VBO);     d/dt(Kidneys) = QKI*(Arterial_Blood/VAB - Kidneys/KbKI/VKI);     d/dt(Arterial_Blood) = QLU*(Lungs/KbLU/VLU - Arterial_Blood/VAB);     d/dt(Venous_Blood) = QHT*Heart/KbHT/VHT + QBR*Brain/KbBR/VBR +       QMU*Muscles/KbMU/VMU + QAD*Adipose/KbAD/VAD +       QSK*Skin/KbSK/VSK + QLI*Liver/KbLI/VLI + QBO*Bones/KbBO/VBO +       QKI*Kidneys/KbKI/VKI + QRB*Rest_of_Body/KbRB/VRB - QLU*Venous_Blood/VVB;     d/dt(Rest_of_Body) = QRB*(Arterial_Blood/VAB - Rest_of_Body/KbRB/VRB);      lnC15 ~ add(add.err)   }) }  fit.lnorm.trans <- pbpkL %>%     nlmixr(datL,est=\"saem\",            control=list(print=0),             table=list(npde=TRUE, cwres=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"changing-models-via-piping","dir":"Articles","previous_headings":"","what":"Changing models via piping","title":"Modifying nlmixr2 models by piping","text":"running nlmixr vignette, Let’s start simple PK example, using single-dose theophylline dataset generously provided Dr. Robert . Upton University California, San Francisco: can try First-Order Conditional Estimation Interaction (FOCEi) method find good solution:","code":"library(nlmixr2)  one.compartment <- function() {   ini({     tka <- 0.45 # Log Ka     tcl <- 1 # Log Cl     ## This works with interactive models     ## You may also label the preceding line with label(\"label text\")     tv <- 3.45; # log V     ## the label(\"Label name\") works with all models     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     d/dt(depot) = -ka * depot     d/dt(center) = ka * depot - cl / v * center     cp = center / v      cp ~ add(add.sd)   }) } fit <- nlmixr(one.compartment, theo_sd, est=\"focei\",               control=list(print=0),                table=list(npde=TRUE, cwres=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(fit) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 116.8139 373.4137 393.5933      -179.7068         73.85496 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.017084 0.496306   0.496308 1.523    0.012 6.117302 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka       Log Ka 0.474  0.209 44.1       1.61 (1.07, 2.42)     68.9     0.384%  #> tcl       Log Cl  1.01 0.0943 9.32       2.75 (2.29, 3.31)     26.8      3.87%  #> tv         log V  3.46 0.0403 1.16       31.8 (29.4, 34.4)     13.9      10.3%  #> add.sd           0.696                               0.696                      #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 26 #>   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES #>   <fct> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl> #> 1 1      0     0.74 0.0967  0.643  1.24   1.24   0     0.74   1.06   0     0.74  #> 2 1      0.25  2.84 3.83   -0.986 -0.486 -0.486  3.29 -0.449 -0.242  3.85 -1.01  #> 3 1      0.57  6.57 6.15    0.422 -1.71  -1.71   5.87  0.705  0.287  6.79 -0.216 #> # … with 129 more rows, and 14 more variables: IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"changing-and-fixing-parameter-values-in-models","dir":"Articles","previous_headings":"","what":"Changing and fixing parameter values in models","title":"Modifying nlmixr2 models by piping","text":"Something may want change initial estimates model. simple modify model definition change , may also want change specific way; example try range starting values see system behaves (either full estimation posthoc estimation). situations can come tedious modify models hand. nlmixr provides ability : Change parameter estimates running model. (ie ini(tka=0.5)) Fix parameters arbitrary values, estimated values (ie ini(tka=fix(0.5)) ini(tka=fix)) easiest way illustrate showing examples piping changes model:","code":"## Example 1 -- Set inital estimate to 0.5 (shown w/posthoc) one.ka.0.5 <- fit %>%     ini(tka=0.5) %>%      nlmixr(est=\"posthoc\", control=list(print=0),             table=list(cwres=TRUE, npde=TRUE))  print(one.ka.0.5) ## Example 2 -- Fix tka to 0.5 and re-estimate. one.ka.0.5 <- fit %>%     ini(tka=fix(0.5)) %>%     nlmixr(est=\"focei\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(one.ka.0.5) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 116.8498 371.4495 388.7463      -179.7248         11.40363 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002129 0.275918    0.27592 1.058    0.011 0.299033 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE  %RSE Back-transformed(95%CI) BSV(CV%) #> tka       Log Ka   0.5  FIXED FIXED                    1.65     68.9 #> tcl       Log Cl  1.01  0.113  11.1       2.75 (2.21, 3.43)     26.8 #> tv         log V  3.46 0.0539  1.56       31.8 (28.6, 35.3)     13.9 #> add.sd           0.696                                0.696          #>        Shrink(SD)% #> tka        0.309%  #> tcl         3.89%  #> tv          10.2%  #> add.sd             #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 26 #>   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES #>   <fct> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl> #> 1 1      0     0.74 0.0967  0.643  1.24   1.24   0     0.74   1.06   0     0.74  #> 2 1      0.25  2.84 3.90   -1.06  -0.440 -0.440  3.36 -0.520 -0.276  3.85 -1.01  #> 3 1      0.57  6.57 6.23    0.342 -1.75  -1.75   5.96  0.611  0.248  6.79 -0.219 #> # … with 129 more rows, and 14 more variables: IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl> ## Example 3 -- Fix tka to model estimated value and re-estimate. one.ka.0.5 <- fit %>%     ini(tka=fix) %>%     nlmixr(est=\"focei\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(one.ka.0.5) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>          OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 116.814 371.4137 388.7106      -179.7069         13.60513 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002002 0.277946   0.277948 1.027     0.01 0.270104 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE  %RSE Back-transformed(95%CI) BSV(CV%) #> tka       Log Ka 0.474  FIXED FIXED                    1.61     68.9 #> tcl       Log Cl  1.01  0.101  9.93       2.75 (2.26, 3.35)     26.8 #> tv         log V  3.46 0.0457  1.32       31.8 (29.1, 34.8)     13.9 #> add.sd           0.696                                0.696          #>        Shrink(SD)% #> tka        0.386%  #> tcl         3.87%  #> tv          10.3%  #> add.sd             #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 26 #>   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES #>   <fct> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl> #> 1 1      0     0.74 0.0967  0.643  1.24   1.24   0     0.74   1.06   0     0.74  #> 2 1      0.25  2.84 3.83   -0.986 -0.486 -0.486  3.29 -0.449 -0.242  3.85 -1.01  #> 3 1      0.57  6.57 6.15    0.422 -1.71  -1.71   5.87  0.705  0.287  6.79 -0.216 #> # … with 129 more rows, and 14 more variables: IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl> ## Example 4 -- Change tka to 0.7 in orginal model function and then estimate one.ka.0.7 <- one.compartment %>%     ini(tka=0.7) %>%      nlmixr(theo_sd, est=\"focei\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(one.ka.0.7) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 116.8133 373.4131 393.5927      -179.7065          49.0338 #>  #> ── Time (sec $time): ── #>  #>           setup optimize covariance table compress   other #> elapsed 0.00189 0.493224   0.493226  1.02    0.011 1.62666 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka       Log Ka 0.471  0.202 42.8        1.6 (1.08, 2.38)     69.5     0.996%  #> tcl       Log Cl  1.01 0.0757 7.49       2.75 (2.37, 3.19)     26.4      3.12%  #> tv         log V  3.46 0.0543 1.57       31.9 (28.6, 35.4)     13.8      9.93%  #> add.sd           0.697                               0.697                      #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 26 #>   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES #>   <fct> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl> #> 1 1      0     0.74 0.0968  0.643  1.24   1.24   0     0.74   1.06   0     0.74  #> 2 1      0.25  2.84 3.82   -0.979 -0.468 -0.468  3.28 -0.438 -0.235  3.85 -1.01  #> 3 1      0.57  6.57 6.13    0.437 -1.75  -1.75   5.85  0.722  0.293  6.79 -0.215 #> # … with 129 more rows, and 14 more variables: IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"changing-model-features","dir":"Articles","previous_headings":"","what":"Changing model features","title":"Modifying nlmixr2 models by piping","text":"developing models, often add remove subject variability parameters, add covariates effects, /change residual errors. can change lines model piping fit nlmixr model specification function model","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"adding-or-removing-between-subject-variability","dir":"Articles","previous_headings":"Changing model features","what":"Adding or Removing between subject variability","title":"Modifying nlmixr2 models by piping","text":"Often developing model add remove subject variability certain model parameters. example, remove subject variability ka parameter changing line model; example remove eta prior fit prior model specification function, simply pipe model function. can re-estimate piping nlmixr function . course also add eta parameter way; can see name change examining omega matrix: Note new subject variability parameters distinguished types parameters (ie population parameters, individual covariates) name. Parameters starting ending following names assumed subject variability parameters: eta (NONMEM convention) ppv (per patient variability) psv (per subject variability) iiv (inter-individual variability) bsv (subject variability) bpv (patient variability)","code":"## Remove eta.ka on ka noEta <- fit %>%     model(ka <- exp(tka)) %>%     nlmixr(est=\"focei\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(noEta) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>           OBJF     AIC      BIC Log-likelihood Condition Number #> FOCEi 176.5812 431.181 448.4778      -209.5905         34.87439 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002356 0.311905   0.311907 1.751    0.011 3.491832 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka       Log Ka 0.431   0.17 39.5        1.54 (1.1, 2.15)                      #> tcl       Log Cl 0.991 0.0745 7.51        2.7 (2.33, 3.12)     30.3      7.76%  #> tv         log V  3.48 0.0485 1.39       32.4 (29.5, 35.7)     15.6      7.93%  #> add.sd            1.02                                1.02                      #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 25 #>   ID     TIME    DV EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES #>   <fct> <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl> #> 1 1      0     0.74 0.142  0.598  0.915  0.915  0     0.74   0.726  0     0.74  #> 2 1      0.25  2.84 3.24  -0.397 -0.593 -0.593  3.12 -0.277 -0.246  3.57 -0.730 #> 3 1      0.57  6.57 5.70   0.872 -0.449 -0.449  5.61  0.959  0.723  6.45  0.121 #> # … with 129 more rows, and 13 more variables: IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.cl <dbl>, eta.v <dbl>, depot <dbl>, #> #   center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, dosenum <dbl> addBackKa <- noEta %>%     model({ka <- exp(tka + bsv.ka)}) %>%     ini(bsv.ka=0.1) %>%     nlmixr(est=\"focei\", control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(addBackKa) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC     BIC Log-likelihood Condition Number #> FOCEi 116.8217 373.4214 393.601      -179.7107         159.1738 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002168 0.484999   0.485001 1.481    0.011 4.542832 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka       Log Ka 0.484  0.196 40.4       1.62 (1.11, 2.38)     69.6     0.891%  #> tcl       Log Cl  1.01   0.62 61.1       2.76 (0.819, 9.3)     26.8      4.10%  #> tv         log V  3.46 0.0872 2.52       31.8 (26.8, 37.7)     14.1      10.9%  #> add.sd           0.694                               0.694                      #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 26 #>   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES #>   <fct> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl> #> 1 1      0     0.74 0.0964  0.644  1.50   1.50   0     0.74   1.07   0     0.74  #> 2 1      0.25  2.84 3.67   -0.826 -0.706 -0.706  3.32 -0.480 -0.255  3.85 -1.01  #> 3 1      0.57  6.57 5.95    0.621 -1.88  -1.88   5.91  0.663  0.267  6.79 -0.217 #> # … with 129 more rows, and 14 more variables: IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.cl <dbl>, eta.v <dbl>, bsv.ka <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl> addBackKa$omega #>            eta.cl      eta.v    bsv.ka #> eta.cl 0.06918013 0.00000000 0.0000000 #> eta.v  0.00000000 0.01968171 0.0000000 #> bsv.ka 0.00000000 0.00000000 0.3946166"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"adding-covariate-effects","dir":"Articles","previous_headings":"Changing model features","what":"Adding Covariate effects","title":"Modifying nlmixr2 models by piping","text":"","code":"## Note currently cov is needed as a prefix so nlmixr knows this is an ## estimated parameter not a parameter wt70 <- fit %>%    model({cl <- exp(tcl + eta.cl)*(WT/70)^covWtPow}) %>%   ini(covWtPow=fix(0.75)) %>%   ini(tka=fix(0.5)) %>%   nlmixr(est=\"focei\", control=list(print=0),          table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(wt70) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 116.2107 370.8105 388.1073      -179.4053         10.72451 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.002561 0.292781   0.292783 1.583    0.011 4.264875 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>          Parameter  Est.     SE  %RSE Back-transformed(95%CI) BSV(CV%) #> tka         Log Ka   0.5  FIXED FIXED                    1.65     68.9 #> tcl         Log Cl  1.01 0.0761   7.5        2.76 (2.38, 3.2)     26.7 #> tv           log V  3.46 0.0293 0.846         31.7 (30, 33.6)     13.8 #> add.sd             0.696                                0.696          #> covWtPow            0.75  FIXED FIXED                    0.75          #>          Shrink(SD)% #> tka          0.822%  #> tcl           6.36%  #> tv            12.1%  #> add.sd               #> covWtPow             #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 27 #>   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES #>   <fct> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl> #> 1 1      0     0.74 0.0967  0.643  1.23   1.23   0     0.74   1.06   0     0.74  #> 2 1      0.25  2.84 3.90   -1.06  -0.468 -0.468  3.36 -0.522 -0.277  3.84 -1.00  #> 3 1      0.57  6.57 6.22    0.351 -1.64  -1.64   5.95  0.617  0.251  6.79 -0.216 #> # … with 129 more rows, and 15 more variables: IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>, WT <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html","id":"changing-residual-errors","dir":"Articles","previous_headings":"Changing model features","what":"Changing residual errors","title":"Modifying nlmixr2 models by piping","text":"Changing residual errors also just easy, simply specifying error wish change:","code":"## Since there are 0 predictions in the data, these are changed to ## 0.0150 to show proportional error change. d <- theo_sd d$DV[d$EVID == 0 & d$DV == 0] <- 0.0150  addPropModel <- fit %>%     model({cp ~ add(add.err)+prop(prop.err)}) %>%     ini(prop.err=0.1) %>%     nlmixr(d,est=\"focei\",            control=list(print=0),            table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(addPropModel) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 104.3506 362.9504 386.0128      -173.4752         58.88045 #>  #> ── Time (sec $time): ── #>  #>           setup optimize covariance table compress    other #> elapsed 0.00233  0.48913   0.489132 1.532    0.011 5.330408 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>          Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) #> tka         Log Ka 0.391  0.196 50.2       1.48 (1.01, 2.17)     69.0 #> tcl         Log Cl  1.02  0.074 7.23       2.79 (2.41, 3.22)     25.8 #> tv           log V  3.47 0.0464 1.34         32 (29.2, 35.1)     12.6 #> add.err            0.273                               0.273          #> prop.err           0.134                               0.134          #>          Shrink(SD)% #> tka           2.00%  #> tcl           1.18%  #> tv            15.6%  #> add.err              #> prop.err             #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 26 #>   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES #>   <fct> <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl> #> 1 1      0     0.74 0.0380  0.702  2.13   2.13   0     0.74   2.71   0     0.74  #> 2 1      0.25  2.84 3.59   -0.748 -0.915 -0.915  3.05 -0.212 -0.126  3.46 -0.624 #> 3 1      0.57  6.57 5.86    0.712 -0.830 -0.830  5.53  1.04   0.428  6.23  0.338 #> # … with 129 more rows, and 14 more variables: IWRES <dbl>, CPRED <dbl>, #> #   CRES <dbl>, CWRES <dbl>, eta.ka <dbl>, eta.cl <dbl>, eta.v <dbl>, #> #   depot <dbl>, center <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"multiple-endpoints","dir":"Articles","previous_headings":"","what":"Multiple endpoints","title":"Working with multiple endpoints","text":"Joint PK/PD models, PK/PD models fix certain components common pharmacometrics. classic example, (provided Tomoo Funaki Nick Holford) Warfarin. example, transit-compartment (depot gut central volume) PK model effect compartment PCA measurement. illustrated example model can applied data: Notice two endpoints model cp effect. modeled nlmixr using ~ “modeled ” specification. see nlmixr handle multiple compartment model, quite informative parse model print information model. case initial parsing give: middle printout, shows data must formatted (using cmt dvid data items) allow nlmixr model multiple endpoint appropriately. course interested can directly access information ui$multipleEndpoint. Notice cmt dvid items can use named variables directly either cmt dvid specification. flexible notation makes rename compartments run nlmixr model functions. thing note cp specified ODE compartment number compartments defined rxode2 part nlmixr model. cp defined compartment, related variable cp. last thing notice cmt items numbered cmt=5 cp cmt=4 effect even though specified model first cp cmt. ordering effect compartment rxode2 system. course cp related compartment central, may make sense pair cp central compartment. something want can specify compartment relate effect | operator. case change change, model updated : Notice case cmt variables numbered sequentially cp variable matches center compartment.","code":"library(nlmixr2) library(ggplot2) pk.turnover.emax <- function() {   ini({     tktr <- log(1)     tka <- log(1)     tcl <- log(0.1)     tv <- log(10)     ##     eta.ktr ~ 1     eta.ka ~ 1     eta.cl ~ 2     eta.v ~ 1     prop.err <- 0.1     pkadd.err <- 0.1     ##     temax <- logit(0.8)     #temax <- 7.5     tec50 <- log(0.5)     tkout <- log(0.05)     te0 <- log(100)     ##     eta.emax ~ .5     eta.ec50  ~ .5     eta.kout ~ .5     eta.e0 ~ .5     ##     pdadd.err <- 10   })   model({     ktr <- exp(tktr + eta.ktr)     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     ##     #poplogit = log(temax/(1-temax))     emax=expit(temax+eta.emax)     #logit=temax+eta.emax     ec50 =  exp(tec50 + eta.ec50)     kout = exp(tkout + eta.kout)     e0 = exp(te0 + eta.e0)     ##     DCP = center/v     PD=1-emax*DCP/(ec50+DCP)     ##     effect(0) = e0     kin = e0*kout     ##     d/dt(depot) = -ktr * depot     d/dt(gut) =  ktr * depot -ka * gut     d/dt(center) =  ka * gut - cl / v * center     d/dt(effect) = kin*PD -kout*effect     ##     cp = center / v     cp ~ prop(prop.err) + add(pkadd.err)     effect ~ add(pdadd.err)   }) } ui <- nlmixr(pk.turnover.emax) ui #>  ── rxode2-based free-form 4-cmt ODE model ──────────────────────────────────────  #>  ── Initalization: ──   #> Fixed Effects ($theta):  #>       tktr        tka        tcl         tv   prop.err  pkadd.err      temax  #>  0.0000000  0.0000000 -2.3025851  2.3025851  0.1000000  0.1000000  1.3862944  #>      tec50      tkout        te0  pdadd.err  #> -0.6931472 -2.9957323  4.6051702 10.0000000  #>  #> Omega ($omega):  #>          eta.ktr eta.ka eta.cl eta.v eta.emax eta.ec50 eta.kout eta.e0 #> eta.ktr        1      0      0     0      0.0      0.0      0.0    0.0 #> eta.ka         0      1      0     0      0.0      0.0      0.0    0.0 #> eta.cl         0      0      2     0      0.0      0.0      0.0    0.0 #> eta.v          0      0      0     1      0.0      0.0      0.0    0.0 #> eta.emax       0      0      0     0      0.5      0.0      0.0    0.0 #> eta.ec50       0      0      0     0      0.0      0.5      0.0    0.0 #> eta.kout       0      0      0     0      0.0      0.0      0.5    0.0 #> eta.e0         0      0      0     0      0.0      0.0      0.0    0.5 #>  ── Multiple Endpoint Model ($multipleEndpoint): ──   #>     variable                   cmt                   dvid* #> 1     cp ~ …     cmt='cp' or cmt=5     dvid='cp' or dvid=1 #> 2 effect ~ … cmt='effect' or cmt=4 dvid='effect' or dvid=2 #>   * If dvids are outside this range, all dvids are re-numered sequentially, ie 1,7, 10 becomes 1,2,3 etc #>  #>  ── μ-referencing ($muRefTable): ──   #>   theta      eta level #> 1  tktr  eta.ktr    id #> 2   tka   eta.ka    id #> 3   tcl   eta.cl    id #> 4    tv    eta.v    id #> 5 temax eta.emax    id #> 6 tec50 eta.ec50    id #> 7 tkout eta.kout    id #> 8   te0   eta.e0    id #>  #>  ── Model (Normalized Syntax): ──  #> function() { #>     ini({ #>         tktr <- 0 #>         tka <- 0 #>         tcl <- -2.30258509299405 #>         tv <- 2.30258509299405 #>         prop.err <- c(0, 0.1) #>         pkadd.err <- c(0, 0.1) #>         temax <- 1.38629436111989 #>         tec50 <- -0.693147180559945 #>         tkout <- -2.99573227355399 #>         te0 <- 4.60517018598809 #>         pdadd.err <- c(0, 10) #>         eta.ktr ~ 1 #>         eta.ka ~ 1 #>         eta.cl ~ 2 #>         eta.v ~ 1 #>         eta.emax ~ 0.5 #>         eta.ec50 ~ 0.5 #>         eta.kout ~ 0.5 #>         eta.e0 ~ 0.5 #>     }) #>     model({ #>         ktr <- exp(tktr + eta.ktr) #>         ka <- exp(tka + eta.ka) #>         cl <- exp(tcl + eta.cl) #>         v <- exp(tv + eta.v) #>         emax = expit(temax + eta.emax) #>         ec50 = exp(tec50 + eta.ec50) #>         kout = exp(tkout + eta.kout) #>         e0 = exp(te0 + eta.e0) #>         DCP = center/v #>         PD = 1 - emax * DCP/(ec50 + DCP) #>         effect(0) = e0 #>         kin = e0 * kout #>         d/dt(depot) = -ktr * depot #>         d/dt(gut) = ktr * depot - ka * gut #>         d/dt(center) = ka * gut - cl/v * center #>         d/dt(effect) = kin * PD - kout * effect #>         cp = center/v #>         cp ~ prop(prop.err) + add(pkadd.err) #>         effect ~ add(pdadd.err) #>     }) #> } ui$multipleEndpoint #>     variable                   cmt                   dvid* #> 1     cp ~ …     cmt='cp' or cmt=5     dvid='cp' or dvid=1 #> 2 effect ~ … cmt='effect' or cmt=4 dvid='effect' or dvid=2 cp ~ prop(prop.err) + add(pkadd.err) cp ~ prop(prop.err) + add(pkadd.err) | central pk.turnover.emax2 <- function() {   ini({     tktr <- log(1)     tka <- log(1)     tcl <- log(0.1)     tv <- log(10)     ##     eta.ktr ~ 1     eta.ka ~ 1     eta.cl ~ 2     eta.v ~ 1     prop.err <- 0.1     pkadd.err <- 0.1     ##     temax <- logit(0.8)     tec50 <- log(0.5)     tkout <- log(0.05)     te0 <- log(100)     ##     eta.emax ~ .5     eta.ec50  ~ .5     eta.kout ~ .5     eta.e0 ~ .5     ##     pdadd.err <- 10   })   model({     ktr <- exp(tktr + eta.ktr)     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     ##     emax=expit(temax+eta.emax)     ec50 =  exp(tec50 + eta.ec50)     kout = exp(tkout + eta.kout)     e0 = exp(te0 + eta.e0)     ##     DCP = center/v     PD=1-emax*DCP/(ec50+DCP)     ##     effect(0) = e0     kin = e0*kout     ##     d/dt(depot) = -ktr * depot     d/dt(gut) =  ktr * depot -ka * gut     d/dt(center) =  ka * gut - cl / v * center     d/dt(effect) = kin*PD -kout*effect     ##     cp = center / v     cp ~ prop(prop.err) + add(pkadd.err) | center     effect ~ add(pdadd.err)   }) } ui2 <- nlmixr(pk.turnover.emax2) ui2$multipleEndpoint #>     variable                   cmt                   dvid* #> 1     cp ~ … cmt='center' or cmt=3 dvid='center' or dvid=1 #> 2 effect ~ … cmt='effect' or cmt=4 dvid='effect' or dvid=2"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"dvid-vs-cmt-which-one-is-used","dir":"Articles","previous_headings":"Multiple endpoints","what":"DVID vs CMT, which one is used","title":"Working with multiple endpoints","text":"dvid cmt combined dataset, cmt data item always used event information dvid used observations. nlmixr expects cmt data item match dvid item observations either zero one dvid replace cmt information. wish use dvid items define multiple endpoints nlmixr, can set following option: cmt items used multiple endpoint models. course can turn different models wish:","code":"options(rxode2.combine.dvid=FALSE) ui2$multipleEndpoint #>     variable                   cmt #> 1     cp ~ … cmt='center' or cmt=3 #> 2 effect ~ … cmt='effect' or cmt=4 options(rxode2.combine.dvid=TRUE) ui2$multipleEndpoint #>     variable                   cmt                   dvid* #> 1     cp ~ … cmt='center' or cmt=3 dvid='center' or dvid=1 #> 2 effect ~ … cmt='effect' or cmt=4 dvid='effect' or dvid=2"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"running-a-multiple-endpoint-model","dir":"Articles","previous_headings":"Multiple endpoints","what":"Running a multiple endpoint model","title":"Working with multiple endpoints","text":"information, can use built-warfarin dataset nlmixr2: Since dvid specifies pca effect endpoint, can update model explicit making one last change: ","code":"summary(warfarin) #>        id             time             amt                dv          dvid     #>  Min.   : 1.00   Min.   :  0.00   Min.   :  0.000   Min.   :  0.00   cp :283   #>  1st Qu.: 8.00   1st Qu.: 24.00   1st Qu.:  0.000   1st Qu.:  4.50   pca:232   #>  Median :15.00   Median : 48.00   Median :  0.000   Median : 11.40             #>  Mean   :16.08   Mean   : 52.08   Mean   :  6.524   Mean   : 20.02             #>  3rd Qu.:24.00   3rd Qu.: 96.00   3rd Qu.:  0.000   3rd Qu.: 26.00             #>  Max.   :33.00   Max.   :144.00   Max.   :153.000   Max.   :100.00             #>       evid               wt              age            sex      #>  Min.   :0.00000   Min.   : 40.00   Min.   :21.00   female:101   #>  1st Qu.:0.00000   1st Qu.: 60.00   1st Qu.:23.00   male  :414   #>  Median :0.00000   Median : 70.00   Median :28.00                #>  Mean   :0.06214   Mean   : 69.27   Mean   :31.85                #>  3rd Qu.:0.00000   3rd Qu.: 78.00   3rd Qu.:36.00                #>  Max.   :1.00000   Max.   :102.00   Max.   :63.00 cp ~ prop(prop.err) + add(pkadd.err) effect ~ add(pdadd.err) cp ~ prop(prop.err) + add(pkadd.err) effect ~ add(pdadd.err)  | pca pk.turnover.emax3 <- function() {   ini({     tktr <- log(1)     tka <- log(1)     tcl <- log(0.1)     tv <- log(10)     ##     eta.ktr ~ 1     eta.ka ~ 1     eta.cl ~ 2     eta.v ~ 1     prop.err <- 0.1     pkadd.err <- 0.1     ##     temax <- logit(0.8)     tec50 <- log(0.5)     tkout <- log(0.05)     te0 <- log(100)     ##     eta.emax ~ .5     eta.ec50  ~ .5     eta.kout ~ .5     eta.e0 ~ .5     ##     pdadd.err <- 10   })   model({     ktr <- exp(tktr + eta.ktr)     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     emax = expit(temax+eta.emax)     ec50 =  exp(tec50 + eta.ec50)     kout = exp(tkout + eta.kout)     e0 = exp(te0 + eta.e0)     ##     DCP = center/v     PD=1-emax*DCP/(ec50+DCP)     ##     effect(0) = e0     kin = e0*kout     ##     d/dt(depot) = -ktr * depot     d/dt(gut) =  ktr * depot -ka * gut     d/dt(center) =  ka * gut - cl / v * center     d/dt(effect) = kin*PD -kout*effect     ##     cp = center / v     cp ~ prop(prop.err) + add(pkadd.err)     effect ~ add(pdadd.err) | pca   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"run-the-models-with-saem","dir":"Articles","previous_headings":"Multiple endpoints","what":"Run the models with SAEM","title":"Working with multiple endpoints","text":"","code":"fit.TOS <- nlmixr(pk.turnover.emax3, warfarin, \"saem\", control=list(print=0),                   table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  print(fit.TOS) #> ── nlmixr SAEM OBJF by FOCEi approximation ── #>  #>          OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 1383.99 2309.684 2389.105      -1135.842          1688.39 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance    saem  table compress #> elapsed 0.003165    9e-06   0.077012 184.184 18.383    0.034 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>            Est.     SE  %RSE Back-transformed(95%CI) BSV(CV% or SD) Shrink(SD)% #> tktr      0.426   0.44   103      1.53 (0.646, 3.62)           103.      52.3%  #> tka       -0.19  0.223   117     0.827 (0.534, 1.28)           41.7      63.6%  #> tcl       -1.97  0.051  2.58    0.139 (0.126, 0.153)           26.6      5.33%  #> tv            2 0.0476  2.37       7.41 (6.75, 8.14)           21.4      17.9%  #> prop.err  0.124                                0.124                            #> pkadd.err 0.758                                0.758                            #> temax      2.93  0.403  13.7     0.95 (0.895, 0.976)           3.00      83.9%  #> tec50     -0.17  0.148  87.3     0.844 (0.631, 1.13)           49.2      8.67%  #> tkout      -2.9 0.0391  1.34 0.0548 (0.0507, 0.0591)           6.31      46.2%  #> te0        4.57 0.0115 0.252       96.5 (94.3, 98.7)           5.15      17.8%  #> pdadd.err  3.73                                 3.73                            #>   #>   Covariance Type ($covMethod): linFim #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 483 × 42 #>   ID     TIME CMT      DV EPRED  ERES   NPDE    NPD  PRED   RES   WRES IPRED #>   <fct> <dbl> <fct> <dbl> <dbl> <dbl>  <dbl>  <dbl> <dbl> <dbl>  <dbl> <dbl> #> 1 1       0.5 cp      0    1.94 -1.94  0.496  0.496  1.45 -1.45 -1.07  0.517 #> 2 1       1   cp      1.9  4.51 -2.61  0.728  0.728  4.06 -2.16 -0.816 1.66  #> 3 1       2   cp      3.3  8.23 -4.93 -2.94  -2.94   8.47 -5.17 -1.45  4.40  #> # … with 480 more rows, and 30 more variables: IRES <dbl>, IWRES <dbl>, #> #   CPRED <dbl>, CRES <dbl>, CWRES <dbl>, eta.ktr <dbl>, eta.ka <dbl>, #> #   eta.cl <dbl>, eta.v <dbl>, eta.emax <dbl>, eta.ec50 <dbl>, eta.kout <dbl>, #> #   eta.e0 <dbl>, depot <dbl>, gut <dbl>, center <dbl>, effect <dbl>, #> #   ktr <dbl>, ka <dbl>, cl <dbl>, v <dbl>, emax <dbl>, ec50 <dbl>, kout <dbl>, #> #   e0 <dbl>, DCP <dbl>, PD <dbl>, kin <dbl>, tad <dbl>, dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"saem-diagnostic-plots","dir":"Articles","previous_headings":"Multiple endpoints > Run the models with SAEM","what":"SAEM Diagnostic plots","title":"Working with multiple endpoints","text":"","code":"plot(fit.TOS) v1s <- vpcPlot(fit.TOS, show=list(obs_dv=TRUE), scales=\"free_y\") +   ylab(\"Warfarin Cp [mg/L] or PCA\") +   xlab(\"Time [h]\")  v2s <- vpcPlot(fit.TOS, show=list(obs_dv=TRUE), pred_corr = TRUE) +   ylab(\"Prediction Corrected Warfarin Cp [mg/L] or PCA\") +   xlab(\"Time [h]\")  v1s v2s"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"focei-fits","dir":"Articles","previous_headings":"Multiple endpoints","what":"FOCEi fits","title":"Working with multiple endpoints","text":"","code":"## FOCEi fit/vpcs fit.TOF <- nlmixr(pk.turnover.emax3, warfarin, \"focei\", control=list(print=0),                   table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:01:18  #> done"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/multiple-endpoints.html","id":"focei-diagnostic-plots","dir":"Articles","previous_headings":"Multiple endpoints > FOCEi fits","what":"FOCEi Diagnostic Plots","title":"Working with multiple endpoints","text":"","code":"print(fit.TOF) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 1394.134 2319.828 2399.249      -1140.914         43937.34 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.003478  78.4865    78.4865 4.598    0.011 143.7475 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>            Est.     SE     %RSE Back-transformed(95%CI) BSV(CV% or SD) #> tktr      0.125   2.22 1.77e+03     1.13 (0.0147, 87.2)           113. #> tka        0.12   2.32 1.93e+03       1.13 (0.012, 106)           116. #> tcl       -2.03  0.116     5.73    0.132 (0.105, 0.165)           28.1 #> tv         2.06  0.104     5.05       7.86 (6.41, 9.63)           22.4 #> prop.err  0.143                                   0.143                #> pkadd.err 0.179                                   0.179                #> temax      5.01   6.76      135     0.993 (0.000265, 1)           3.00 #> tec50      0.15  0.225      150       1.16 (0.747, 1.8)           50.3 #> tkout     -2.94 0.0861     2.93  0.053 (0.0448, 0.0627)           12.3 #> te0        4.57 0.0371    0.811        96.4 (89.6, 104)           7.08 #> pdadd.err  3.74                                    3.74                #>           Shrink(SD)% #> tktr           63.2%  #> tka            63.4%  #> tcl            1.96%  #> tv             8.85%  #> prop.err              #> pkadd.err             #> temax          96.8%  #> tec50          8.66%  #> tkout          27.9%  #> te0            24.0%  #> pdadd.err             #>   #>   Covariance Type ($covMethod): s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     false convergence (8)  #>   In an ODE system, false convergence may mean \"useless\" evaluations were performed. #>   See https://tinyurl.com/yyrrwkce #>   It could also mean the convergence is poor, check results before accepting fit #>   You may also try a good derivative free optimization: #>     nlmixr2(...,control=list(outerOpt=\"bobyqa\")) #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 483 × 42 #>   ID     TIME CMT      DV EPRED  ERES   NPDE    NPD  PRED   RES   WRES IPRED #>   <fct> <dbl> <fct> <dbl> <dbl> <dbl>  <dbl>  <dbl> <dbl> <dbl>  <dbl> <dbl> #> 1 1       0.5 cp      0    2.14 -2.14 -0.728 -0.728  1.40 -1.40 -0.908 0.444 #> 2 1       1   cp      1.9  4.61 -2.71  1.26   1.26   3.95 -2.05 -0.579 1.46  #> 3 1       2   cp      3.3  7.70 -4.40 -2.94  -2.94   8.27 -4.97 -1.03  3.99  #> # … with 480 more rows, and 30 more variables: IRES <dbl>, IWRES <dbl>, #> #   CPRED <dbl>, CRES <dbl>, CWRES <dbl>, eta.ktr <dbl>, eta.ka <dbl>, #> #   eta.cl <dbl>, eta.v <dbl>, eta.emax <dbl>, eta.ec50 <dbl>, eta.kout <dbl>, #> #   eta.e0 <dbl>, depot <dbl>, gut <dbl>, center <dbl>, effect <dbl>, #> #   ktr <dbl>, ka <dbl>, cl <dbl>, v <dbl>, emax <dbl>, ec50 <dbl>, kout <dbl>, #> #   e0 <dbl>, DCP <dbl>, PD <dbl>, kin <dbl>, tad <dbl>, dosenum <dbl> plot(fit.TOF) v1f <- vpcPlot(fit.TOF, show=list(obs_dv=TRUE), scales=\"free_y\") +   ylab(\"Warfarin Cp [mg/L] or PCA\") +   xlab(\"Time [h]\")  v2f <- vpcPlot(fit.TOF, show=list(obs_dv=TRUE), pred_corr = TRUE) +   ylab(\"Prediction Corrected Warfarin Cp [mg/L] or PCA\") +   xlab(\"Time [h]\")  v1f v2f"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/nimo.html","id":"nlmixr-model","dir":"Articles","previous_headings":"","what":"nlmixr model","title":"Nimotuzumab","text":"","code":"library(nlmixr2) library(xpose) library(xpose.nlmixr) library(ggplot2)  nimo <- function() {   ini({     ## Note that the UI can take expressions     ## Also note that these initial estimates should be provided on the log-scale     tcl <- log(0.001)     tv1 <- log(1.45)     tQ <- log(0.004)     tv2 <- log(44)     tkss <- log(12)     tkint <- log(0.3)     tksyn <- log(1)     tkdeg <- log(7)     ## Initial estimates should be high for SAEM ETAs     eta.cl  ~ 2     eta.v1  ~ 2     eta.kss ~ 2     ##  Also true for additive error (also ignored in SAEM)     add.err <- 10   })   model({     cl <- exp(tcl + eta.cl)     v1 <- exp(tv1 + eta.v1)     Q  <- exp(tQ)     v2 <- exp(tv2)     kss <- exp(tkss + eta.kss)     kint <- exp(tkint)     ksyn <- exp(tksyn)     kdeg <- exp(tkdeg)      k <- cl/v1     k12 <- Q/v1     k21 <- Q/v2      eff(0) <- ksyn/kdeg ##initializing compartment      ## Concentration is calculated     conc = 0.5*(central/v1-eff-kss)+0.5*sqrt((central/v1-eff-kss)**2+4*kss*central/v1)      d/dt(central)  = -(k+k12)*conc*v1+k21*peripheral-kint*eff*conc*v1/(kss+conc)     d/dt(peripheral) = k12*conc*v1-k21*peripheral  ##Free Drug second compartment amount     d/dt(eff) = ksyn - kdeg*eff - (kint-kdeg)*conc*eff/(kss+conc)      IPRED=log(conc)      IPRED ~ add(add.err)   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/nimo.html","id":"fit","dir":"Articles","previous_headings":"","what":"Fit","title":"Nimotuzumab","text":"","code":"fit <- nlmixr(nimo, nimoData, est=\"saem\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> 001: -7.082156   0.240380    -5.322648   3.706002    2.535890    -1.294407   -0.102901   1.975165    1.900000    1.900000    2.150501    1.391724     #> 002: -7.318608   0.337788    -5.472643   3.604174    2.671940    -1.381532   0.004361    1.965802    1.805000    1.805000    2.042976    0.830852     #> 003: -7.004796   0.329353    -5.552719   3.663648    2.576095    -1.342266   0.094213    2.169032    1.714750    1.714750    1.940827    0.704378     #> 004: -6.831052   0.337039    -5.509392   3.581316    2.619975    -1.473308   0.193564    2.039580    1.629012    1.629012    1.843786    0.673922     #> 005: -6.988888   0.327350    -5.438457   3.546217    2.611964    -1.375401   0.032029    2.028963    1.547562    1.547562    1.751597    0.664592     #> 006: -6.877438   0.309723    -5.508254   3.692787    2.673534    -1.385796   -0.048632   1.984854    1.470184    1.470184    1.664017    0.659652     #> 007: -6.898159   0.314886    -5.496362   3.638982    2.747608    -1.255406   -0.026410   1.947620    1.407505    1.396675    1.580816    0.663774     #> 008: -6.957871   0.319272    -5.352725   3.503540    2.776519    -1.197933   0.000427    1.968390    1.337130    1.326841    1.501775    0.670739     #> 009: -6.826759   0.315714    -5.227308   3.580258    2.922322    -1.203666   -0.010643   2.177228    1.270273    1.260499    1.483524    0.661929     #> 010: -7.082397   0.308379    -5.273932   3.611745    2.874421    -1.137025   0.115752    2.203563    1.305004    1.197474    1.517557    0.656455     #> 011: -7.083805   0.294951    -5.267117   3.697103    2.937389    -1.228824   0.136825    2.298366    1.239753    1.137600    1.522041    0.661686     #> 012: -7.229129   0.369998    -5.290768   3.737127    2.879780    -1.195137   0.181972    2.281019    1.177766    1.080720    1.445939    0.660513     #> 013: -7.118783   0.316777    -5.198435   3.808386    3.007388    -1.298448   0.173969    2.200194    1.118877    1.026684    1.545758    0.659895     #> 014: -7.107046   0.296195    -5.247466   3.826552    3.068812    -1.449512   0.198110    2.171824    1.062934    0.975350    1.468470    0.664804     #> 015: -7.101186   0.342107    -5.262732   3.789245    3.006193    -1.467174   0.209708    2.105610    1.173838    0.926582    1.395047    0.661338     #> 016: -7.054116   0.293809    -5.404022   3.710325    2.800496    -1.446669   0.248707    2.016275    1.115146    0.880253    1.325294    0.661297     #> 017: -6.900522   0.299893    -5.468624   3.730384    2.913575    -1.388838   0.287952    2.001241    1.059389    0.836241    1.259030    0.662951     #> 018: -6.847400   0.259424    -5.462242   3.782073    2.941709    -1.430433   0.325918    2.151714    1.006419    0.794429    1.196078    0.674475     #> 019: -6.753272   0.299121    -5.510133   3.743449    2.954801    -1.441600   0.390829    2.220912    0.956098    0.754707    1.136274    0.665982     #> 020: -6.837756   0.315087    -5.621735   3.778400    2.916021    -1.288673   0.366226    2.244962    1.106701    0.716972    1.079461    0.667779     #> 021: -6.893220   0.306474    -5.591735   3.473458    2.872476    -1.289627   0.381579    2.338688    1.255998    0.681123    1.025488    0.670320     #> 022: -7.005703   0.363949    -5.581785   3.500052    2.745047    -1.268654   0.294263    2.201461    1.193198    0.647067    0.974213    0.668004     #> 023: -6.939491   0.324638    -5.455178   3.494135    2.667590    -1.310115   0.298623    2.255601    1.133538    0.614714    0.925503    0.653433     #> 024: -6.885500   0.269202    -5.425549   3.477327    2.519646    -1.295313   0.341746    2.453918    1.201937    0.583978    0.879227    0.657180     #> 025: -7.003679   0.329172    -5.462586   3.450449    2.399445    -1.392637   0.407089    2.493273    1.141840    0.554779    0.835266    0.657478     #> 026: -6.998503   0.308081    -5.503414   3.378182    2.240570    -1.395307   0.507344    2.538508    1.084748    0.527040    0.793503    0.652995     #> 027: -6.983049   0.251959    -5.415440   3.357185    2.331519    -1.429724   0.469920    2.487613    1.053474    0.500688    0.753828    0.653142     #> 028: -7.064152   0.281134    -5.428507   3.340922    2.360536    -1.343881   0.489512    2.441413    1.031793    0.475654    0.744672    0.656158     #> 029: -7.153328   0.259568    -5.408880   3.332953    2.419550    -1.396986   0.552957    2.412138    1.038802    0.451871    0.755118    0.654489     #> 030: -7.137799   0.269775    -5.430981   3.324828    2.505459    -1.450748   0.544276    2.356400    0.986862    0.429278    0.717362    0.654892     #> 031: -7.278104   0.306992    -5.462212   3.347481    2.481115    -1.393738   0.510631    2.404250    0.937519    0.407814    0.681494    0.653134     #> 032: -7.366002   0.296299    -5.462750   3.354325    2.493465    -1.385500   0.511527    2.445562    0.890643    0.387423    0.647419    0.659970     #> 033: -7.126602   0.319700    -5.438877   3.445812    2.471803    -1.441491   0.498690    2.510886    0.846111    0.368052    0.615049    0.662377     #> 034: -7.011533   0.319809    -5.457466   3.448620    2.549336    -1.433274   0.440205    2.477871    0.803806    0.349649    0.601210    0.661287     #> 035: -7.030069   0.328177    -5.430406   3.521252    2.568902    -1.477423   0.431840    2.497634    0.777766    0.332167    0.571150    0.669576     #> 036: -6.790538   0.306774    -5.527834   3.622364    2.476747    -1.425994   0.382638    2.494380    0.738878    0.315558    0.542592    0.668018     #> 037: -6.800334   0.270544    -5.414146   3.402385    2.582889    -1.400895   0.474395    2.576823    0.818234    0.299781    0.560308    0.659367     #> 038: -6.779983   0.198230    -5.460225   3.326120    2.459665    -1.312269   0.425136    2.498573    0.777322    0.284791    0.532293    0.662861     #> 039: -6.671886   0.254019    -5.570037   3.257240    2.441459    -1.403449   0.505908    2.453239    0.738456    0.270552    0.552395    0.655443     #> 040: -6.801421   0.264928    -5.582054   3.187304    2.426505    -1.432948   0.510497    2.418150    0.701533    0.257024    0.524775    0.661263     #> 041: -6.867235   0.280701    -5.643455   3.254848    2.508290    -1.478873   0.516456    2.354902    0.719071    0.258599    0.498537    0.658930     #> 042: -6.780870   0.297515    -5.625829   3.229796    2.525800    -1.423885   0.545876    2.247574    0.704235    0.262364    0.473610    0.656337     #> 043: -7.000980   0.308498    -5.643916   3.368084    2.518038    -1.448837   0.571972    2.253661    0.838864    0.261131    0.449929    0.660254     #> 044: -6.881316   0.361812    -5.676801   3.302498    2.485286    -1.378273   0.610588    2.406006    0.796921    0.287254    0.427433    0.659041     #> 045: -6.992270   0.311070    -5.460939   3.297823    2.493164    -1.394428   0.574134    2.346399    0.987389    0.272891    0.406061    0.657335     #> 046: -6.937286   0.255586    -5.505305   3.189254    2.469744    -1.477122   0.595653    2.387849    0.938020    0.259247    0.385758    0.657275     #> 047: -6.910055   0.278884    -5.524470   3.291595    2.395307    -1.531927   0.560231    2.426453    0.891119    0.261829    0.366470    0.657160     #> 048: -7.067394   0.288722    -5.510406   3.356396    2.365454    -1.578588   0.642720    2.429590    0.846563    0.296891    0.348147    0.655746     #> 049: -6.923328   0.270119    -5.450789   3.414379    2.366448    -1.585423   0.629513    2.466967    0.893002    0.282046    0.330739    0.658189     #> 050: -6.975794   0.288132    -5.435516   3.347858    2.392924    -1.608769   0.643707    2.417948    0.932213    0.277081    0.314202    0.648781     #> 051: -6.875901   0.353712    -5.416865   3.611819    2.462963    -1.660868   0.661059    2.438330    0.970314    0.294981    0.298492    0.652593     #> 052: -6.765307   0.271983    -5.391472   3.626409    2.527210    -1.643741   0.684367    2.440789    0.921799    0.288411    0.283568    0.655201     #> 053: -6.620037   0.310457    -5.451163   3.854368    2.628403    -1.630681   0.646037    2.405277    0.875709    0.273990    0.269389    0.661798     #> 054: -6.541914   0.322377    -5.602161   3.918050    2.661677    -1.588618   0.619825    2.408575    0.831923    0.260291    0.255920    0.656715     #> 055: -6.373490   0.295359    -5.581440   3.790033    2.702007    -1.567283   0.614160    2.346308    0.843537    0.265659    0.284322    0.657369     #> 056: -6.361577   0.312322    -5.637698   3.785505    2.787302    -1.527121   0.574659    2.272041    0.801360    0.252376    0.270106    0.659265     #> 057: -6.297834   0.286892    -5.705691   3.762464    2.794607    -1.540606   0.548523    2.251223    0.761292    0.239758    0.276525    0.662021     #> 058: -6.402065   0.258021    -5.810660   3.777895    2.758826    -1.493502   0.544410    2.192527    0.862540    0.263461    0.262699    0.656945     #> 059: -6.488559   0.275667    -5.779645   3.824903    2.822481    -1.496432   0.516002    2.169180    0.941809    0.280023    0.249564    0.661064     #> 060: -6.537952   0.322100    -5.844695   4.198486    2.774870    -1.501122   0.532435    2.161901    0.894719    0.287462    0.237086    0.663263     #> 061: -6.416021   0.343720    -5.758680   3.940205    2.650611    -1.499860   0.520846    2.224032    0.849983    0.273089    0.225231    0.664169     #> 062: -6.310170   0.299830    -5.611265   3.839088    2.686540    -1.439855   0.487623    2.288302    0.807484    0.259434    0.213970    0.663122     #> 063: -6.294908   0.311997    -5.540899   3.862490    2.707261    -1.423113   0.494748    2.327657    0.767109    0.246462    0.203271    0.660175     #> 064: -6.366629   0.316682    -5.694336   3.936071    2.652013    -1.427522   0.492013    2.282279    0.835532    0.234139    0.193108    0.670102     #> 065: -6.180801   0.364973    -5.741631   3.493918    2.689585    -1.489510   0.476151    2.215031    0.793756    0.235573    0.183452    0.667527     #> 066: -6.179648   0.348374    -5.749013   3.402021    2.762067    -1.490865   0.520905    2.185092    0.929906    0.254211    0.174280    0.661183     #> 067: -6.263086   0.327637    -5.634331   3.234640    2.755069    -1.510695   0.550426    2.217312    0.979119    0.322320    0.176250    0.662333     #> 068: -6.292892   0.362669    -5.612425   3.180375    2.701803    -1.509967   0.559493    2.262292    0.930163    0.306204    0.209163    0.659376     #> 069: -6.406907   0.311112    -5.588864   2.947345    2.659620    -1.506976   0.586969    2.254385    1.083297    0.321730    0.198705    0.665014     #> 070: -6.314687   0.246440    -5.595287   2.908022    2.630289    -1.497341   0.549582    2.261500    1.029132    0.314350    0.206450    0.657920     #> 071: -6.217709   0.265446    -5.567675   2.798543    2.600281    -1.531825   0.566408    2.206204    0.977676    0.298633    0.196128    0.659110     #> 072: -6.157095   0.238023    -5.754847   2.756068    2.610835    -1.545311   0.590166    2.188482    0.928792    0.302674    0.215475    0.656766     #> 073: -6.287617   0.255763    -5.782974   2.668018    2.562220    -1.547860   0.620664    2.168260    0.961688    0.313501    0.204701    0.659373     #> 074: -6.509203   0.260687    -5.652472   2.846293    2.500960    -1.562527   0.515292    2.121736    1.267267    0.297826    0.194466    0.668704     #> 075: -6.416412   0.278495    -5.663658   2.889233    2.531158    -1.575245   0.563700    2.156104    1.203903    0.282935    0.184743    0.660703     #> 076: -6.372197   0.258099    -5.726064   2.809855    2.497007    -1.585770   0.554655    2.130951    1.143708    0.268788    0.175506    0.656914     #> 077: -6.345672   0.278881    -5.670182   2.647593    2.595867    -1.575106   0.604909    2.152797    1.189868    0.296868    0.166730    0.657233     #> 078: -6.348930   0.262330    -5.658917   2.462042    2.552281    -1.543080   0.649866    2.176722    1.130374    0.282025    0.158394    0.658202     #> 079: -6.182329   0.305910    -5.622486   2.681155    2.576799    -1.530473   0.609340    2.235116    1.073856    0.267924    0.151881    0.666624     #> 080: -6.278351   0.247696    -5.611191   2.640099    2.540012    -1.529954   0.613512    2.216091    1.020163    0.254528    0.152491    0.665660     #> 081: -6.161229   0.308140    -5.648894   2.746375    2.584527    -1.542349   0.612081    2.185029    0.969155    0.251895    0.144867    0.658389     #> 082: -6.134250   0.290519    -5.697368   2.861817    2.573103    -1.554697   0.594581    2.126595    0.920697    0.239300    0.137623    0.654481     #> 083: -6.157780   0.293400    -5.674551   2.596083    2.552749    -1.554927   0.613874    2.102997    0.874662    0.227335    0.130742    0.649084     #> 084: -6.043718   0.270041    -5.524905   2.548757    2.544325    -1.547110   0.572517    2.204878    0.830929    0.215968    0.132570    0.649058     #> 085: -6.035218   0.203893    -5.464928   2.517038    2.519986    -1.562535   0.583354    2.289152    0.809167    0.205170    0.125942    0.659515     #> 086: -6.155169   0.188440    -5.358699   2.760529    2.498737    -1.578073   0.580119    2.283462    0.904021    0.194911    0.120566    0.652513     #> 087: -6.115400   0.156386    -5.284803   2.778030    2.502999    -1.590966   0.603655    2.235995    0.858820    0.185166    0.114538    0.654176     #> 088: -6.158905   0.168182    -5.450443   2.449863    2.516668    -1.578885   0.565575    2.174054    0.887651    0.235742    0.113189    0.672454     #> 089: -6.264660   0.164214    -5.592644   2.405672    2.533449    -1.562987   0.581745    2.165362    1.141834    0.228379    0.107530    0.663633     #> 090: -6.279971   0.227163    -5.563073   2.419175    2.545061    -1.556209   0.595420    2.181293    1.239181    0.235747    0.102153    0.659207     #> 091: -6.211909   0.182332    -5.561700   2.445815    2.572867    -1.544233   0.596836    2.182525    1.177222    0.223959    0.128134    0.653343     #> 092: -6.054699   0.227844    -5.661706   2.325238    2.516278    -1.536466   0.568745    2.156513    1.118361    0.212761    0.122333    0.654642     #> 093: -6.060565   0.272713    -5.729856   2.462729    2.511964    -1.535758   0.574684    2.156639    1.062443    0.212576    0.116217    0.657862     #> 094: -6.246009   0.287082    -5.862449   2.551871    2.478441    -1.539652   0.606569    2.199354    1.234343    0.247500    0.110406    0.654755     #> 095: -6.430293   0.274664    -5.696054   2.580877    2.460005    -1.534625   0.608098    2.271460    1.691609    0.236875    0.104886    0.658308     #> 096: -6.235785   0.261008    -5.573622   2.627211    2.484236    -1.537258   0.653057    2.253702    1.607029    0.225031    0.099641    0.659037     #> 097: -6.424872   0.273861    -5.622372   2.356470    2.528754    -1.536887   0.689467    2.268328    1.556114    0.213780    0.094659    0.654865     #> 098: -6.292736   0.285177    -5.715682   2.226018    2.579253    -1.531399   0.684539    2.272246    1.600298    0.203091    0.089926    0.662134     #> 099: -6.272271   0.291946    -5.757178   2.435993    2.512930    -1.534143   0.677665    2.285231    1.520283    0.224477    0.095242    0.661522     #> 100: -6.212044   0.249385    -5.898241   2.320787    2.509986    -1.546925   0.700892    2.320300    1.444269    0.213253    0.123807    0.664829     #> 101: -6.145608   0.204983    -5.761245   2.475931    2.517424    -1.559297   0.720140    2.349080    1.372055    0.202590    0.117616    0.663993     #> 102: -6.088134   0.202131    -5.798948   2.318193    2.482019    -1.557104   0.714314    2.330478    1.303453    0.192461    0.111736    0.656278     #> 103: -6.155875   0.197593    -5.842397   2.162408    2.429311    -1.566786   0.730617    2.305273    1.238280    0.182838    0.106149    0.656881     #> 104: -6.087011   0.207827    -5.953135   2.118611    2.511587    -1.562439   0.767974    2.280894    1.176366    0.188620    0.100841    0.666994     #> 105: -6.039989   0.251439    -5.966304   2.123777    2.549131    -1.557299   0.757149    2.254959    1.117548    0.253200    0.095799    0.666102     #> 106: -6.290345   0.268955    -5.975043   2.145418    2.573836    -1.550764   0.743828    2.239197    1.151869    0.245265    0.091009    0.659745     #> 107: -6.286730   0.287510    -5.955899   2.111745    2.594305    -1.561735   0.747215    2.250038    1.094275    0.248733    0.086459    0.659499     #> 108: -6.273823   0.297585    -6.016208   2.113022    2.595285    -1.566934   0.734420    2.258948    1.039562    0.277755    0.082136    0.660153     #> 109: -6.267443   0.316282    -6.038765   2.197108    2.609124    -1.577313   0.734572    2.255037    1.005796    0.315716    0.078029    0.661130     #> 110: -6.157332   0.269255    -6.051623   2.140537    2.550621    -1.569779   0.731601    2.273520    0.955506    0.299930    0.074935    0.659734     #> 111: -6.076713   0.269728    -5.953031   2.187567    2.523093    -1.573527   0.738749    2.270180    0.907731    0.284934    0.078932    0.655210     #> 112: -5.964195   0.169871    -5.815473   2.113463    2.501764    -1.570052   0.722121    2.274298    0.931897    0.270687    0.079653    0.658917     #> 113: -6.037903   0.193654    -5.686140   2.183916    2.521836    -1.569770   0.686944    2.272125    0.885302    0.257152    0.075670    0.656216     #> 114: -6.212603   0.207454    -5.578621   2.227185    2.468546    -1.572799   0.704449    2.289144    0.852730    0.244295    0.071886    0.659052     #> 115: -6.087506   0.159465    -5.562266   2.362240    2.467027    -1.569250   0.703103    2.295304    0.810094    0.232080    0.068292    0.659037     #> 116: -6.271836   0.207026    -5.771661   2.317987    2.466562    -1.567764   0.735192    2.279674    1.040933    0.220476    0.074169    0.661909     #> 117: -6.181938   0.247848    -5.916636   2.197798    2.461699    -1.577292   0.724590    2.285703    0.988886    0.221815    0.073582    0.656724     #> 118: -6.105514   0.259773    -6.031286   2.199732    2.433550    -1.573767   0.713413    2.310808    0.939442    0.227781    0.077772    0.662981     #> 119: -6.139682   0.230993    -5.775459   2.245673    2.475944    -1.576630   0.720349    2.319870    1.079576    0.255713    0.092191    0.660103     #> 120: -6.222458   0.265085    -5.780395   2.238269    2.407321    -1.563498   0.717967    2.312104    1.343394    0.242927    0.087581    0.662831     #> 121: -6.205576   0.292690    -5.818731   2.215492    2.353619    -1.568312   0.708781    2.332225    1.276224    0.237629    0.083202    0.658801     #> 122: -6.340574   0.248690    -5.792620   2.186040    2.336950    -1.568947   0.751458    2.336919    1.327683    0.225748    0.079042    0.664029     #> 123: -6.240619   0.286918    -5.922783   2.151440    2.385952    -1.578815   0.739304    2.315010    1.261299    0.239872    0.075090    0.665589     #> 124: -6.062197   0.188491    -5.671910   2.065987    2.407938    -1.575661   0.754348    2.354000    1.198234    0.258650    0.071335    0.655621     #> 125: -5.938171   0.133588    -5.669819   2.098894    2.394591    -1.567429   0.766950    2.346589    1.138322    0.245718    0.067769    0.647558     #> 126: -6.050836   0.159536    -5.575193   2.028379    2.321413    -1.567408   0.759598    2.356169    1.081406    0.233432    0.064380    0.646938     #> 127: -6.043550   0.162555    -5.630182   2.028261    2.279293    -1.565329   0.757574    2.375814    1.027336    0.221760    0.063550    0.652070     #> 128: -6.163815   0.156006    -5.713401   2.082449    2.292989    -1.567436   0.783207    2.368118    0.994222    0.210672    0.060373    0.652423     #> 129: -6.026360   0.134431    -5.730523   2.080405    2.279718    -1.560976   0.774327    2.367867    0.944511    0.207261    0.057354    0.646028     #> 130: -6.182462   0.182418    -5.854656   2.108885    2.282749    -1.562019   0.772143    2.336400    1.141696    0.206348    0.054486    0.651123     #> 131: -6.123334   0.226231    -5.956765   2.269243    2.261948    -1.562097   0.764782    2.345229    1.084611    0.203200    0.063076    0.646223     #> 132: -6.157793   0.253613    -5.899925   2.213909    2.231974    -1.566266   0.763625    2.348024    1.030380    0.193040    0.072373    0.646635     #> 133: -6.160282   0.176399    -5.600395   2.237008    2.202996    -1.566850   0.759821    2.343707    0.978861    0.200522    0.068755    0.643980     #> 134: -6.091373   0.214783    -5.522203   2.174087    2.204914    -1.567717   0.766791    2.351139    0.929918    0.190496    0.065317    0.639176     #> 135: -6.223544   0.196752    -5.619198   2.134648    2.148990    -1.569439   0.762407    2.354880    1.029688    0.189921    0.062051    0.638897     #> 136: -6.351980   0.222879    -5.619590   1.940290    2.136948    -1.569182   0.777299    2.362702    0.978204    0.180425    0.060331    0.638686     #> 137: -6.254703   0.238560    -5.325081   1.962909    2.156771    -1.567986   0.778301    2.386634    0.929294    0.197500    0.060935    0.642611     #> 138: -6.325032   0.223826    -5.596957   1.927149    2.119538    -1.568227   0.777141    2.401026    0.882829    0.208409    0.057888    0.645660     #> 139: -6.327387   0.252262    -5.794480   1.837559    2.130708    -1.571525   0.771579    2.385050    0.849735    0.205737    0.054994    0.648003     #> 140: -6.315469   0.252960    -5.515650   1.918284    2.087438    -1.569570   0.765491    2.393909    1.066001    0.200785    0.052244    0.650808     #> 141: -6.259260   0.196768    -5.359083   1.898649    2.102203    -1.572031   0.760099    2.389715    1.012701    0.190746    0.054229    0.650098     #> 142: -6.286116   0.207886    -5.429603   1.828356    2.113582    -1.568979   0.760490    2.398108    1.040263    0.210455    0.051517    0.644076     #> 143: -6.277863   0.144409    -5.400326   1.798129    2.124122    -1.568783   0.766750    2.390298    1.135030    0.199932    0.083070    0.640880     #> 144: -6.097191   0.152707    -5.265616   1.784166    2.067682    -1.569320   0.775770    2.387152    1.078278    0.189935    0.081843    0.640220     #> 145: -6.030562   0.169422    -5.372859   1.638945    2.042808    -1.571701   0.782241    2.388795    1.024364    0.182802    0.079024    0.646379     #> 146: -5.929208   0.183166    -5.215155   1.582296    2.124695    -1.572587   0.799206    2.384018    0.973146    0.173661    0.080349    0.649840     #> 147: -6.091094   0.148861    -5.413417   1.518910    2.117711    -1.577794   0.803974    2.390770    1.018066    0.189119    0.076332    0.651413     #> 148: -6.038322   0.163040    -5.364643   1.405403    2.060034    -1.580065   0.800919    2.394011    0.967163    0.199397    0.075860    0.643081     #> 149: -6.144971   0.162795    -5.434824   1.639964    2.046322    -1.578302   0.788771    2.397330    0.918804    0.189427    0.100187    0.642488     #> 150: -6.158308   0.153766    -5.322483   1.715597    2.019627    -1.577785   0.777469    2.393026    0.872864    0.179956    0.095178    0.642393     #> 151: -6.325919   0.162711    -5.333445   1.774397    1.980282    -1.576951   0.764681    2.393685    0.924791    0.177011    0.090419    0.640315     #> 152: -6.275873   0.140045    -5.434571   1.728362    1.946403    -1.579603   0.779750    2.395632    0.947999    0.177398    0.074118    0.640285     #> 153: -6.388154   0.204051    -5.674642   1.587373    1.920670    -1.577911   0.790669    2.395030    0.973367    0.198067    0.059956    0.633047     #> 154: -6.392683   0.185443    -5.801330   1.582848    1.964034    -1.578287   0.793954    2.392946    1.015318    0.204812    0.070121    0.631243     #> 155: -6.318437   0.228441    -5.918381   1.503735    1.936745    -1.577975   0.794713    2.391426    0.593669    0.212431    0.062457    0.635381     #> 156: -6.244482   0.191055    -5.744870   1.600130    1.955168    -1.577474   0.795110    2.391378    0.654095    0.239660    0.058790    0.636975     #> 157: -6.280873   0.176652    -5.640207   1.532814    1.973167    -1.579682   0.792470    2.391740    0.693335    0.222825    0.054457    0.642161     #> 158: -6.347095   0.192369    -5.639766   1.674537    1.995592    -1.580147   0.791439    2.396190    0.803920    0.212944    0.051899    0.642383     #> 159: -6.316945   0.133937    -5.675075   1.639609    1.976042    -1.579965   0.785751    2.394868    0.984798    0.193061    0.052124    0.642193     #> 160: -6.196957   0.133609    -5.674684   1.679991    1.981697    -1.580074   0.785797    2.393723    0.826229    0.196067    0.071522    0.636361     #> 161: -6.158592   0.155390    -5.689167   1.712191    2.025802    -1.580988   0.784514    2.392092    0.581564    0.166288    0.073511    0.634819     #> 162: -6.137448   0.154718    -5.678096   1.699526    2.025256    -1.580696   0.782306    2.393472    0.572338    0.162702    0.065574    0.636686     #> 163: -6.100945   0.148876    -5.661370   1.590237    2.003860    -1.582737   0.776825    2.392300    0.717984    0.148697    0.056941    0.645844     #> 164: -6.169722   0.144153    -5.675152   1.588790    2.007761    -1.583089   0.780865    2.393946    0.791595    0.180963    0.062668    0.639522     #> 165: -6.165415   0.136011    -5.468960   1.626551    2.036934    -1.584196   0.776216    2.391671    0.953662    0.223472    0.055287    0.653602     #> 166: -6.168184   0.169013    -5.549479   1.658533    2.018651    -1.584383   0.776294    2.390741    1.047761    0.222250    0.050838    0.653822     #> 167: -6.228627   0.220283    -5.594599   1.565492    2.028183    -1.583950   0.781883    2.391679    1.008091    0.206021    0.035260    0.641002     #> 168: -6.313146   0.222538    -5.916894   1.534677    2.032115    -1.584270   0.784079    2.390755    1.151038    0.223107    0.030725    0.645640     #> 169: -6.245363   0.215022    -5.951179   1.528584    2.022510    -1.584000   0.785383    2.389286    0.970954    0.219767    0.032126    0.647806     #> 170: -6.147276   0.130025    -5.557288   1.601452    2.020010    -1.584146   0.787341    2.386905    0.940890    0.185054    0.031372    0.650503     #> 171: -6.189950   0.113086    -5.714958   1.737105    2.031047    -1.584089   0.782702    2.386961    1.128114    0.135486    0.036217    0.647351     #> 172: -6.221322   0.102054    -5.701951   1.781948    2.055567    -1.583864   0.781344    2.387267    1.214306    0.128140    0.033982    0.652524     #> 173: -6.375344   0.146202    -5.820274   1.867366    2.078362    -1.583308   0.788934    2.388403    1.604321    0.132159    0.027481    0.653632     #> 174: -6.317145   0.145986    -5.704583   1.950026    2.081375    -1.583737   0.794455    2.389226    1.069156    0.151687    0.024780    0.645972     #> 175: -6.354248   0.193550    -5.778465   1.889422    2.079067    -1.583930   0.799495    2.388396    1.196044    0.158432    0.027334    0.655684     #> 176: -6.474609   0.164674    -5.288514   1.896971    2.095629    -1.584153   0.802286    2.389881    1.636644    0.176902    0.025370    0.642049     #> 177: -6.481511   0.194558    -5.409854   1.920877    2.108349    -1.583950   0.800018    2.388218    1.798048    0.155473    0.027795    0.651002     #> 178: -6.236869   0.174708    -5.611176   1.800213    2.116938    -1.583644   0.802930    2.386063    1.219576    0.140254    0.032773    0.649996     #> 179: -6.402773   0.160141    -5.504130   1.821194    2.150982    -1.583531   0.807279    2.384348    1.661895    0.128963    0.034756    0.648968     #> 180: -6.200352   0.201573    -5.379617   1.622757    2.098665    -1.583212   0.808068    2.384942    1.291450    0.136027    0.034760    0.648252     #> 181: -6.154629   0.134022    -5.703647   1.517957    2.097937    -1.583226   0.808596    2.384396    1.267142    0.109287    0.038464    0.653541     #> 182: -6.017586   0.152084    -5.624867   1.590407    2.115783    -1.582320   0.809266    2.382520    0.877975    0.112818    0.049803    0.646338     #> 183: -6.035195   0.155852    -5.615884   1.541263    2.122084    -1.582177   0.812211    2.383690    1.082328    0.138553    0.063931    0.643350     #> 184: -6.030149   0.160561    -5.709429   1.547401    2.114630    -1.581728   0.814090    2.381816    0.915867    0.133825    0.054102    0.644647     #> 185: -6.104584   0.163207    -5.562519   1.570250    2.105220    -1.582416   0.815267    2.381782    0.914228    0.115981    0.058587    0.651388     #> 186: -6.083656   0.135009    -5.728530   1.448787    2.091375    -1.582231   0.812878    2.382702    1.109141    0.121905    0.049311    0.642822     #> 187: -6.043931   0.169513    -5.766415   1.324844    2.099793    -1.581689   0.812464    2.383573    1.185721    0.131987    0.028303    0.653313     #> 188: -6.248159   0.200303    -5.861558   1.228064    2.095785    -1.580921   0.814914    2.382313    1.274920    0.189190    0.025971    0.655708     #> 189: -6.216796   0.232604    -6.067062   1.177817    2.121533    -1.581297   0.814820    2.380523    0.890098    0.128944    0.026408    0.657238     #> 190: -6.051454   0.196362    -5.895573   1.255496    2.123353    -1.581410   0.814494    2.380912    0.935833    0.110422    0.029227    0.663242     #> 191: -5.991635   0.211124    -5.892124   1.298279    2.106945    -1.580958   0.817877    2.382479    0.892656    0.156577    0.024955    0.655780     #> 192: -6.047691   0.215289    -5.783624   1.295377    2.101948    -1.580537   0.822596    2.383478    0.727932    0.177825    0.023867    0.652239     #> 193: -6.058464   0.208433    -5.788977   1.327596    2.102704    -1.579820   0.820865    2.383558    0.693397    0.190835    0.021649    0.648304     #> 194: -6.127456   0.199013    -5.709657   1.387952    2.107181    -1.579817   0.821016    2.384216    1.010959    0.157728    0.016798    0.643460     #> 195: -6.227061   0.196115    -5.660851   1.380943    2.065294    -1.579715   0.824801    2.383256    0.925967    0.197993    0.010805    0.639466     #> 196: -6.266126   0.189600    -5.536753   1.370643    2.057695    -1.579833   0.823964    2.384284    0.846838    0.197563    0.010803    0.647238     #> 197: -6.115913   0.236366    -5.580681   1.288545    2.072621    -1.579683   0.822335    2.384590    0.802606    0.166022    0.009784    0.655001     #> 198: -6.208735   0.238806    -5.787343   1.374681    2.085660    -1.579910   0.823466    2.385170    0.827327    0.160943    0.007928    0.655151     #> 199: -6.026800   0.172341    -5.542369   1.381131    2.078567    -1.579377   0.829612    2.386308    0.707425    0.132404    0.009525    0.657788     #> 200: -6.065896   0.195934    -5.843292   1.245720    2.077078    -1.579436   0.835513    2.386421    0.703542    0.153531    0.010915    0.654184     #> 201: -6.037815   0.179665    -5.856646   1.228126    2.079716    -1.579472   0.834502    2.386669    0.695206    0.146807    0.010431    0.652812     #> 202: -6.028586   0.181602    -5.843096   1.212655    2.070687    -1.579546   0.834535    2.386968    0.657706    0.159442    0.009587    0.649653     #> 203: -6.044318   0.180826    -5.858661   1.217956    2.062988    -1.579690   0.835442    2.387093    0.672605    0.162923    0.009638    0.648720     #> 204: -6.046978   0.181294    -5.894891   1.237035    2.059972    -1.579767   0.836940    2.386929    0.685689    0.160335    0.009125    0.649360     #> 205: -6.043055   0.182333    -5.884985   1.239171    2.058677    -1.579866   0.837564    2.386514    0.723288    0.160096    0.008652    0.648540     #> 206: -6.036032   0.181109    -5.852392   1.233912    2.057789    -1.579925   0.838107    2.386205    0.738081    0.162979    0.008352    0.648612     #> 207: -6.021484   0.174248    -5.818854   1.226714    2.058142    -1.579931   0.838259    2.386064    0.739126    0.167603    0.008222    0.649271     #> 208: -6.021153   0.178548    -5.781242   1.217706    2.058278    -1.579969   0.837869    2.385988    0.734650    0.170048    0.008390    0.648289     #> 209: -6.024589   0.179765    -5.779787   1.212574    2.058043    -1.580034   0.837517    2.385894    0.726853    0.174663    0.008344    0.647845     #> 210: -6.030079   0.175771    -5.780179   1.204973    2.058852    -1.580046   0.837288    2.385857    0.734415    0.176820    0.008288    0.648433     #> 211: -6.040055   0.177450    -5.794317   1.198500    2.057909    -1.580059   0.837219    2.385841    0.739096    0.178775    0.008551    0.648061     #> 212: -6.035596   0.178451    -5.827752   1.192430    2.057509    -1.580042   0.837034    2.385903    0.734221    0.178636    0.008799    0.648304     #> 213: -6.029890   0.179485    -5.830050   1.203492    2.056636    -1.580063   0.836721    2.385927    0.726448    0.178199    0.008916    0.648118     #> 214: -6.033296   0.179384    -5.832462   1.208809    2.055636    -1.580080   0.836647    2.386086    0.737925    0.175812    0.009218    0.648277     #> 215: -6.030611   0.179355    -5.827819   1.207980    2.054422    -1.580124   0.837061    2.386209    0.735468    0.173543    0.009301    0.648179     #> 216: -6.035382   0.179111    -5.815675   1.207442    2.053668    -1.580101   0.836748    2.386266    0.731987    0.174308    0.009478    0.647885     #> 217: -6.035829   0.176307    -5.811447   1.208206    2.053912    -1.580079   0.836504    2.386225    0.735263    0.176265    0.009634    0.647785     #> 218: -6.038716   0.175212    -5.803094   1.206385    2.053257    -1.580077   0.836465    2.386161    0.733623    0.176340    0.009662    0.647668     #> 219: -6.041517   0.175288    -5.801713   1.201899    2.052986    -1.580071   0.836203    2.386120    0.742767    0.174339    0.009691    0.647549     #> 220: -6.043059   0.176269    -5.796338   1.200782    2.052814    -1.580064   0.835774    2.386176    0.746294    0.174218    0.009577    0.647663     #> 221: -6.036313   0.173807    -5.789282   1.197929    2.052883    -1.580060   0.835830    2.386210    0.747214    0.173470    0.009509    0.647661     #> 222: -6.032821   0.173200    -5.789147   1.197023    2.053001    -1.580068   0.836058    2.386252    0.748097    0.173701    0.009505    0.647812     #> 223: -6.036244   0.174542    -5.792903   1.198885    2.051814    -1.580075   0.836298    2.386294    0.747196    0.173818    0.009628    0.647757     #> 224: -6.041139   0.175180    -5.793230   1.200699    2.050583    -1.580088   0.836439    2.386350    0.749775    0.173900    0.009679    0.648171     #> 225: -6.043020   0.175228    -5.791977   1.202539    2.049128    -1.580091   0.836605    2.386423    0.746513    0.172858    0.009645    0.648319     #> 226: -6.046010   0.176542    -5.800956   1.206747    2.049049    -1.580100   0.836478    2.386463    0.740736    0.172758    0.009670    0.648484     #> 227: -6.047372   0.177541    -5.797073   1.208294    2.048999    -1.580110   0.836630    2.386540    0.735427    0.173241    0.009569    0.648499     #> 228: -6.046613   0.179333    -5.790336   1.209323    2.048665    -1.580151   0.836746    2.386574    0.734800    0.173869    0.009545    0.648611     #> 229: -6.044694   0.178995    -5.787903   1.204573    2.048612    -1.580161   0.836807    2.386575    0.737819    0.173179    0.009451    0.648555     #> 230: -6.042447   0.179510    -5.784850   1.201315    2.048126    -1.580167   0.836830    2.386646    0.737473    0.172945    0.009373    0.648470     #> 231: -6.039397   0.178523    -5.791924   1.197328    2.047892    -1.580168   0.837007    2.386696    0.733809    0.172560    0.009365    0.648534     #> 232: -6.036427   0.178179    -5.789821   1.196629    2.048126    -1.580190   0.837114    2.386712    0.731822    0.172685    0.009345    0.648553     #> 233: -6.033091   0.177061    -5.799356   1.194444    2.048561    -1.580205   0.837205    2.386745    0.731844    0.173215    0.009316    0.648459     #> 234: -6.031825   0.177946    -5.802713   1.196768    2.049599    -1.580209   0.837133    2.386682    0.729929    0.173644    0.009350    0.648295     #> 235: -6.034125   0.178225    -5.803463   1.196937    2.050089    -1.580215   0.837158    2.386677    0.738386    0.173230    0.009321    0.648398     #> 236: -6.033578   0.178278    -5.803268   1.197542    2.050695    -1.580205   0.836972    2.386695    0.740681    0.173695    0.009310    0.648269     #> 237: -6.031523   0.177823    -5.807296   1.197821    2.051536    -1.580196   0.836803    2.386713    0.738362    0.174924    0.009297    0.648264     #> 238: -6.032938   0.178312    -5.804907   1.199093    2.052565    -1.580187   0.836730    2.386708    0.741566    0.174679    0.009273    0.648278     #> 239: -6.036625   0.178590    -5.802814   1.200676    2.053060    -1.580198   0.836685    2.386695    0.748088    0.174349    0.009254    0.648200     #> 240: -6.038614   0.178476    -5.805921   1.199476    2.052806    -1.580209   0.836699    2.386687    0.751567    0.173535    0.009186    0.648094     #> 241: -6.039377   0.179273    -5.802644   1.201012    2.053554    -1.580221   0.836574    2.386679    0.755957    0.173417    0.009161    0.648230     #> 242: -6.038992   0.178773    -5.800146   1.200837    2.053305    -1.580236   0.836671    2.386614    0.756825    0.173937    0.009164    0.648202     #> 243: -6.037900   0.177973    -5.805214   1.201441    2.053442    -1.580241   0.836707    2.386597    0.750510    0.174491    0.009193    0.648137     #> 244: -6.040853   0.178040    -5.806775   1.200190    2.053385    -1.580238   0.836878    2.386595    0.752354    0.174600    0.009297    0.648071     #> 245: -6.041440   0.177158    -5.807770   1.198658    2.053476    -1.580236   0.836873    2.386585    0.755209    0.174053    0.009363    0.648010     #> 246: -6.040935   0.176217    -5.809667   1.193594    2.053928    -1.580223   0.836785    2.386542    0.756366    0.173823    0.009379    0.648088     #> 247: -6.042686   0.176416    -5.814321   1.193132    2.054173    -1.580211   0.836709    2.386513    0.759862    0.173311    0.009408    0.648109     #> 248: -6.043405   0.176550    -5.819465   1.192699    2.054664    -1.580192   0.836713    2.386501    0.765463    0.172159    0.009460    0.648017     #> 249: -6.043893   0.177021    -5.824353   1.192617    2.055544    -1.580199   0.836803    2.386499    0.763867    0.171985    0.009560    0.648053     #> 250: -6.044945   0.177262    -5.819880   1.194029    2.056006    -1.580193   0.836721    2.386489    0.765597    0.171627    0.009683    0.647954     #> 251: -6.047887   0.177378    -5.820870   1.195264    2.056631    -1.580186   0.836656    2.386486    0.771218    0.171941    0.009698    0.648057     #> 252: -6.048612   0.177427    -5.823707   1.194988    2.057101    -1.580191   0.836783    2.386541    0.772344    0.172590    0.009635    0.647889     #> 253: -6.049066   0.177827    -5.825395   1.194089    2.057479    -1.580196   0.837006    2.386538    0.774513    0.172940    0.009634    0.647771     #> 254: -6.049048   0.178839    -5.826311   1.193668    2.057369    -1.580210   0.836932    2.386556    0.774409    0.173425    0.009584    0.647762     #> 255: -6.048001   0.179124    -5.827309   1.192610    2.057279    -1.580221   0.836922    2.386566    0.771649    0.174069    0.009614    0.647635     #> 256: -6.047107   0.178913    -5.826684   1.193528    2.057428    -1.580223   0.836962    2.386578    0.771121    0.174244    0.009592    0.647521     #> 257: -6.048364   0.179067    -5.832659   1.192514    2.057655    -1.580227   0.836982    2.386577    0.769778    0.174925    0.009565    0.647441     #> 258: -6.049405   0.178953    -5.836710   1.192253    2.057754    -1.580233   0.837061    2.386589    0.770680    0.174636    0.009540    0.647455     #> 259: -6.050180   0.179745    -5.836728   1.191039    2.057760    -1.580242   0.837214    2.386570    0.772053    0.174236    0.009477    0.647323     #> 260: -6.049428   0.179666    -5.835383   1.191068    2.057765    -1.580256   0.837334    2.386555    0.770341    0.174152    0.009441    0.647381     #> 261: -6.051605   0.179912    -5.836785   1.190800    2.057749    -1.580263   0.837337    2.386565    0.771234    0.174262    0.009441    0.647680     #> 262: -6.052710   0.180040    -5.837382   1.191502    2.057984    -1.580270   0.837338    2.386585    0.774370    0.174398    0.009459    0.647753     #> 263: -6.053974   0.180336    -5.837455   1.190250    2.057962    -1.580278   0.837275    2.386585    0.774144    0.175086    0.009458    0.647630     #> 264: -6.054064   0.180412    -5.837370   1.189923    2.057767    -1.580283   0.837224    2.386604    0.772050    0.175621    0.009481    0.647624     #> 265: -6.053364   0.180051    -5.838664   1.189542    2.057349    -1.580276   0.837090    2.386607    0.771275    0.175555    0.009413    0.647627     #> 266: -6.053209   0.179397    -5.839791   1.189392    2.057116    -1.580270   0.837089    2.386608    0.770433    0.174799    0.009360    0.647701     #> 267: -6.051532   0.178090    -5.842313   1.189751    2.056841    -1.580266   0.837161    2.386618    0.767936    0.174527    0.009323    0.647705     #> 268: -6.050828   0.177429    -5.840276   1.189344    2.056821    -1.580268   0.837191    2.386622    0.767327    0.174388    0.009331    0.647681     #> 269: -6.049406   0.177114    -5.837303   1.188262    2.056895    -1.580266   0.837178    2.386643    0.764614    0.174535    0.009306    0.647585     #> 270: -6.049433   0.177187    -5.830595   1.188201    2.056686    -1.580265   0.837200    2.386646    0.764728    0.174772    0.009310    0.647612     #> 271: -6.049443   0.177363    -5.831428   1.188125    2.056419    -1.580271   0.837225    2.386656    0.765160    0.174783    0.009325    0.647655     #> 272: -6.051996   0.178100    -5.830547   1.188394    2.056143    -1.580272   0.837242    2.386657    0.766096    0.174963    0.009286    0.647686     #> 273: -6.053571   0.178575    -5.832195   1.188197    2.056127    -1.580269   0.837184    2.386657    0.767302    0.175488    0.009238    0.647795     #> 274: -6.056184   0.179485    -5.835056   1.188628    2.055770    -1.580266   0.837159    2.386661    0.768545    0.176191    0.009206    0.647853     #> 275: -6.057057   0.179438    -5.834413   1.188943    2.055673    -1.580272   0.837111    2.386649    0.768505    0.176338    0.009184    0.647834     #> 276: -6.057962   0.178982    -5.833021   1.190094    2.055464    -1.580269   0.837097    2.386646    0.768050    0.176209    0.009204    0.647776     #> 277: -6.058703   0.178756    -5.833162   1.189989    2.055481    -1.580268   0.837103    2.386654    0.766992    0.176468    0.009223    0.647724     #> 278: -6.059102   0.178395    -5.834376   1.190078    2.055408    -1.580267   0.837177    2.386656    0.764714    0.177226    0.009204    0.647745     #> 279: -6.057286   0.177536    -5.833635   1.190416    2.055383    -1.580268   0.837201    2.386671    0.763163    0.177514    0.009195    0.647823     #> 280: -6.057668   0.177602    -5.832522   1.191050    2.055035    -1.580268   0.837163    2.386690    0.762942    0.177939    0.009196    0.648017     #> 281: -6.057448   0.177591    -5.831519   1.191456    2.054938    -1.580265   0.837136    2.386702    0.763840    0.178164    0.009177    0.647994     #> 282: -6.057426   0.177837    -5.829458   1.192467    2.054967    -1.580265   0.837145    2.386697    0.766685    0.177837    0.009146    0.648047     #> 283: -6.057274   0.177812    -5.828143   1.193473    2.055194    -1.580266   0.837172    2.386704    0.766852    0.177680    0.009163    0.648082     #> 284: -6.056543   0.177530    -5.828204   1.193807    2.055465    -1.580265   0.837165    2.386715    0.766715    0.177692    0.009141    0.648147     #> 285: -6.057796   0.177368    -5.827359   1.194291    2.055632    -1.580263   0.837151    2.386712    0.767489    0.177905    0.009125    0.648220     #> 286: -6.056816   0.176908    -5.827372   1.194164    2.055920    -1.580265   0.837189    2.386715    0.767285    0.178143    0.009144    0.648354     #> 287: -6.056175   0.176334    -5.827578   1.194194    2.056145    -1.580267   0.837262    2.386719    0.766393    0.178137    0.009158    0.648389     #> 288: -6.056441   0.176516    -5.828566   1.193477    2.056228    -1.580270   0.837354    2.386718    0.764927    0.178744    0.009165    0.648437     #> 289: -6.058400   0.176810    -5.828672   1.193913    2.056237    -1.580272   0.837374    2.386716    0.764114    0.178813    0.009161    0.648486     #> 290: -6.060409   0.177255    -5.827538   1.194646    2.056333    -1.580274   0.837377    2.386716    0.764562    0.179031    0.009147    0.648570     #> 291: -6.060679   0.177193    -5.825811   1.194235    2.056358    -1.580276   0.837342    2.386721    0.764426    0.179092    0.009117    0.648646     #> 292: -6.060304   0.176963    -5.825061   1.194517    2.056542    -1.580276   0.837317    2.386719    0.764202    0.179245    0.009085    0.648572     #> 293: -6.059629   0.176429    -5.825661   1.194346    2.056700    -1.580278   0.837306    2.386719    0.764391    0.178857    0.009066    0.648610     #> 294: -6.059987   0.176295    -5.824778   1.194817    2.056676    -1.580279   0.837332    2.386726    0.765443    0.178739    0.009074    0.648613     #> 295: -6.061109   0.176425    -5.826245   1.195581    2.056675    -1.580278   0.837325    2.386732    0.766450    0.178804    0.009101    0.648772     #> 296: -6.062310   0.176179    -5.827352   1.196032    2.056804    -1.580278   0.837293    2.386740    0.767684    0.179088    0.009115    0.648824     #> 297: -6.063260   0.176214    -5.828144   1.195971    2.056936    -1.580276   0.837302    2.386736    0.767862    0.179344    0.009153    0.648854     #> 298: -6.063789   0.176357    -5.827673   1.196394    2.056891    -1.580278   0.837327    2.386728    0.768145    0.179817    0.009125    0.648987     #> 299: -6.064205   0.176159    -5.827665   1.196184    2.057022    -1.580280   0.837328    2.386725    0.767278    0.180212    0.009118    0.648982     #> 300: -6.063257   0.175864    -5.827706   1.195928    2.057239    -1.580281   0.837306    2.386723    0.767917    0.179755    0.009094    0.649096     #> 301: -6.063963   0.175417    -5.827506   1.196154    2.057201    -1.580281   0.837273    2.386713    0.769572    0.179628    0.009082    0.649142     #> 302: -6.064292   0.174989    -5.827463   1.195917    2.057216    -1.580282   0.837255    2.386715    0.771041    0.179851    0.009086    0.649162     #> 303: -6.065281   0.175079    -5.827874   1.195542    2.057290    -1.580282   0.837222    2.386715    0.772002    0.180495    0.009080    0.649111     #> 304: -6.066031   0.175445    -5.827980   1.194970    2.057348    -1.580283   0.837203    2.386710    0.771087    0.180828    0.009083    0.649185     #> 305: -6.066728   0.175550    -5.828371   1.195149    2.057141    -1.580282   0.837195    2.386715    0.769650    0.181103    0.009084    0.649273     #> 306: -6.066555   0.175765    -5.827260   1.195322    2.057172    -1.580285   0.837174    2.386718    0.769288    0.180810    0.009086    0.649373     #> 307: -6.066312   0.175838    -5.826478   1.195334    2.057111    -1.580284   0.837147    2.386726    0.770957    0.180264    0.009081    0.649494     #> 308: -6.067659   0.175986    -5.826741   1.195422    2.057049    -1.580283   0.837118    2.386728    0.771725    0.180197    0.009100    0.649578     #> 309: -6.068875   0.175607    -5.826290   1.195720    2.057057    -1.580284   0.837104    2.386727    0.772746    0.180148    0.009082    0.649652     #> 310: -6.069327   0.175429    -5.827419   1.195983    2.056916    -1.580283   0.837124    2.386724    0.773253    0.180170    0.009061    0.649749     #> 311: -6.071000   0.175214    -5.827659   1.196453    2.056900    -1.580282   0.837119    2.386724    0.774159    0.180513    0.009085    0.649809     #> 312: -6.074942   0.175568    -5.827848   1.196635    2.056893    -1.580280   0.837108    2.386723    0.777990    0.180673    0.009087    0.649991     #> 313: -6.077020   0.175466    -5.828379   1.196787    2.056811    -1.580276   0.837090    2.386721    0.782056    0.180356    0.009095    0.650238     #> 314: -6.077813   0.175686    -5.828444   1.196532    2.056751    -1.580276   0.837074    2.386725    0.783074    0.180264    0.009099    0.650399     #> 315: -6.078419   0.175724    -5.828864   1.196629    2.056473    -1.580277   0.837054    2.386720    0.781925    0.180084    0.009100    0.650539     #> 316: -6.078243   0.175286    -5.829453   1.196758    2.056541    -1.580276   0.837034    2.386720    0.781681    0.180067    0.009101    0.650599     #> 317: -6.077354   0.175082    -5.829594   1.196830    2.056561    -1.580276   0.837005    2.386718    0.781178    0.179934    0.009086    0.650763     #> 318: -6.078394   0.175126    -5.830734   1.197140    2.056532    -1.580276   0.836999    2.386719    0.782015    0.180161    0.009091    0.650991     #> 319: -6.078994   0.174825    -5.830709   1.197440    2.056751    -1.580278   0.836994    2.386718    0.783338    0.180342    0.009091    0.651111     #> 320: -6.078722   0.174449    -5.831040   1.197470    2.057027    -1.580279   0.836994    2.386720    0.782489    0.180331    0.009092    0.651213     #> 321: -6.079064   0.174437    -5.831676   1.197376    2.057171    -1.580279   0.836982    2.386720    0.782364    0.180845    0.009078    0.651353     #> 322: -6.080840   0.174540    -5.832640   1.197239    2.057164    -1.580278   0.836955    2.386721    0.785828    0.180890    0.009069    0.651475     #> 323: -6.081529   0.174380    -5.834011   1.196861    2.057252    -1.580279   0.836944    2.386720    0.788400    0.181074    0.009091    0.651630     #> 324: -6.081900   0.174392    -5.835389   1.196590    2.057373    -1.580280   0.836936    2.386716    0.789000    0.181314    0.009124    0.651712     #> 325: -6.082667   0.174088    -5.837475   1.196511    2.057462    -1.580281   0.836939    2.386715    0.790673    0.181340    0.009155    0.651787     #> 326: -6.083294   0.173871    -5.839127   1.196273    2.057714    -1.580282   0.836930    2.386713    0.791467    0.181211    0.009158    0.651891     #> 327: -6.084230   0.173938    -5.840173   1.195935    2.057873    -1.580284   0.836915    2.386713    0.792885    0.181126    0.009170    0.652037     #> 328: -6.084604   0.173845    -5.841502   1.195788    2.058130    -1.580285   0.836916    2.386712    0.793185    0.180720    0.009160    0.652217     #> 329: -6.085434   0.173819    -5.842126   1.195706    2.058175    -1.580286   0.836887    2.386712    0.794439    0.180548    0.009158    0.652371     #> 330: -6.086003   0.173672    -5.843371   1.195737    2.058235    -1.580287   0.836868    2.386708    0.795014    0.180510    0.009145    0.652514     #> 331: -6.086434   0.173781    -5.844106   1.195800    2.058287    -1.580288   0.836866    2.386704    0.795323    0.180489    0.009137    0.652618     #> 332: -6.086570   0.173309    -5.845219   1.196107    2.058212    -1.580290   0.836867    2.386703    0.795779    0.180370    0.009129    0.652714     #> 333: -6.087548   0.173305    -5.846386   1.196440    2.058193    -1.580291   0.836874    2.386701    0.795284    0.180352    0.009159    0.652782     #> 334: -6.088154   0.173063    -5.846765   1.196665    2.058296    -1.580291   0.836872    2.386699    0.794973    0.180655    0.009190    0.652891     #> 335: -6.088465   0.173118    -5.847050   1.196799    2.058661    -1.580291   0.836871    2.386697    0.795671    0.180681    0.009238    0.653021     #> 336: -6.088392   0.173090    -5.847709   1.196950    2.058844    -1.580292   0.836866    2.386695    0.794775    0.180643    0.009277    0.653192     #> 337: -6.089316   0.173286    -5.848658   1.196894    2.059079    -1.580293   0.836848    2.386694    0.793864    0.180809    0.009286    0.653409     #> 338: -6.090231   0.173594    -5.849502   1.196900    2.059419    -1.580292   0.836838    2.386694    0.794475    0.181080    0.009305    0.653552     #> 339: -6.090790   0.173772    -5.850307   1.196937    2.059704    -1.580293   0.836845    2.386694    0.793953    0.181163    0.009341    0.653762     #> 340: -6.091524   0.173708    -5.850852   1.197127    2.059737    -1.580292   0.836852    2.386695    0.795821    0.181104    0.009352    0.653986     #> 341: -6.093583   0.173634    -5.852101   1.197156    2.059691    -1.580293   0.836857    2.386695    0.801092    0.180756    0.009367    0.654131     #> 342: -6.095329   0.173581    -5.853323   1.197093    2.059677    -1.580293   0.836861    2.386697    0.805043    0.180648    0.009363    0.654359     #> 343: -6.096139   0.173497    -5.854044   1.197042    2.059594    -1.580293   0.836868    2.386699    0.806763    0.180475    0.009353    0.654567     #> 344: -6.097481   0.173515    -5.854938   1.196970    2.059392    -1.580293   0.836874    2.386698    0.808511    0.180374    0.009357    0.654756     #> 345: -6.098826   0.173461    -5.855573   1.197049    2.059177    -1.580293   0.836870    2.386697    0.810282    0.180272    0.009352    0.654916     #> 346: -6.099580   0.173645    -5.856468   1.197044    2.059152    -1.580293   0.836864    2.386698    0.812035    0.180058    0.009350    0.655130     #> 347: -6.100172   0.173749    -5.857303   1.196936    2.059309    -1.580293   0.836859    2.386697    0.813129    0.180190    0.009351    0.655346     #> 348: -6.100944   0.173606    -5.857872   1.196896    2.059371    -1.580294   0.836859    2.386696    0.816074    0.180351    0.009333    0.655551     #> 349: -6.101458   0.173568    -5.858367   1.196887    2.059371    -1.580294   0.836846    2.386696    0.816761    0.180302    0.009337    0.655757     #> 350: -6.102804   0.173572    -5.859193   1.196853    2.059304    -1.580294   0.836836    2.386695    0.818264    0.180365    0.009348    0.656007     #> 351: -6.104791   0.173801    -5.859258   1.196882    2.059309    -1.580294   0.836820    2.386695    0.822139    0.180277    0.009375    0.656187     #> 352: -6.106087   0.174053    -5.859334   1.196883    2.059223    -1.580294   0.836820    2.386696    0.822448    0.180278    0.009364    0.656362     #> 353: -6.106770   0.173900    -5.859721   1.196853    2.059240    -1.580294   0.836825    2.386698    0.821934    0.180446    0.009381    0.656548     #> 354: -6.107426   0.173984    -5.860248   1.196877    2.059368    -1.580294   0.836828    2.386699    0.821918    0.180865    0.009381    0.656733     #> 355: -6.108138   0.174113    -5.860629   1.196969    2.059441    -1.580295   0.836831    2.386698    0.823038    0.180795    0.009395    0.656959     #> 356: -6.108404   0.174174    -5.861406   1.197054    2.059530    -1.580294   0.836836    2.386697    0.822943    0.180596    0.009404    0.657120     #> 357: -6.108877   0.174093    -5.861779   1.197079    2.059590    -1.580294   0.836834    2.386698    0.823159    0.180446    0.009408    0.657302     #> 358: -6.108763   0.173932    -5.862791   1.196975    2.059704    -1.580294   0.836834    2.386698    0.823043    0.180195    0.009393    0.657505     #> 359: -6.108732   0.173967    -5.863424   1.197018    2.059771    -1.580295   0.836840    2.386698    0.823419    0.180162    0.009391    0.657751     #> 360: -6.109942   0.174047    -5.863960   1.197041    2.059871    -1.580295   0.836846    2.386698    0.824655    0.180121    0.009382    0.657998     #> 361: -6.111187   0.174529    -5.864635   1.196936    2.059896    -1.580294   0.836850    2.386698    0.825532    0.180048    0.009371    0.658219     #> 362: -6.112350   0.174840    -5.865256   1.196929    2.059929    -1.580294   0.836857    2.386697    0.827003    0.179934    0.009360    0.658434     #> 363: -6.114102   0.175022    -5.865708   1.196969    2.059881    -1.580294   0.836854    2.386698    0.828675    0.179605    0.009355    0.658633     #> 364: -6.114782   0.175159    -5.866213   1.196941    2.059826    -1.580294   0.836856    2.386699    0.828047    0.179563    0.009366    0.658791     #> 365: -6.115472   0.175249    -5.867194   1.197043    2.059777    -1.580294   0.836856    2.386700    0.827486    0.179740    0.009374    0.659018     #> 366: -6.116723   0.175305    -5.868093   1.197034    2.059806    -1.580294   0.836864    2.386700    0.827939    0.179718    0.009381    0.659287     #> 367: -6.118015   0.175355    -5.868623   1.196983    2.059828    -1.580294   0.836869    2.386699    0.828761    0.179685    0.009384    0.659532     #> 368: -6.119776   0.175627    -5.869040   1.196933    2.059834    -1.580294   0.836866    2.386700    0.830846    0.179849    0.009369    0.659779     #> 369: -6.121534   0.176057    -5.869051   1.196896    2.059831    -1.580293   0.836863    2.386700    0.832659    0.179995    0.009351    0.659987     #> 370: -6.122019   0.175997    -5.869564   1.196877    2.059989    -1.580293   0.836864    2.386700    0.832322    0.180110    0.009350    0.660181     #> 371: -6.122684   0.175957    -5.869990   1.196850    2.060024    -1.580294   0.836862    2.386700    0.832180    0.180233    0.009342    0.660412     #> 372: -6.123321   0.175811    -5.870265   1.196823    2.060100    -1.580293   0.836863    2.386699    0.832969    0.180303    0.009341    0.660702     #> 373: -6.125075   0.176070    -5.870562   1.196833    2.060072    -1.580293   0.836867    2.386699    0.836367    0.180286    0.009353    0.660910     #> 374: -6.126267   0.176255    -5.871124   1.196805    2.060173    -1.580293   0.836866    2.386699    0.839078    0.180160    0.009364    0.661131     #> 375: -6.127959   0.176680    -5.871373   1.196842    2.060157    -1.580293   0.836870    2.386698    0.841202    0.180125    0.009383    0.661356     #> 376: -6.129673   0.177089    -5.872011   1.196822    2.060142    -1.580293   0.836870    2.386697    0.842788    0.180090    0.009401    0.661564     #> 377: -6.131429   0.177355    -5.872411   1.196874    2.060121    -1.580293   0.836872    2.386697    0.845215    0.179833    0.009408    0.661743     #> 378: -6.132754   0.177368    -5.872805   1.196915    2.060110    -1.580293   0.836870    2.386696    0.846563    0.179758    0.009451    0.661912     #> 379: -6.133762   0.177410    -5.873260   1.196992    2.060206    -1.580293   0.836868    2.386696    0.848371    0.179577    0.009466    0.662095     #> 380: -6.134338   0.177342    -5.873345   1.197032    2.060309    -1.580293   0.836865    2.386696    0.850785    0.179277    0.009467    0.662290     #> 381: -6.135501   0.177564    -5.873448   1.196968    2.060399    -1.580293   0.836859    2.386695    0.853946    0.179073    0.009462    0.662489     #> 382: -6.136397   0.177847    -5.873716   1.196910    2.060423    -1.580293   0.836857    2.386694    0.855726    0.179073    0.009471    0.662719     #> 383: -6.137161   0.177858    -5.874207   1.196919    2.060457    -1.580293   0.836857    2.386693    0.858043    0.179168    0.009472    0.662931     #> 384: -6.137219   0.177761    -5.874653   1.196958    2.060603    -1.580292   0.836857    2.386693    0.858753    0.179163    0.009476    0.663153     #> 385: -6.138451   0.178104    -5.874775   1.196967    2.060686    -1.580293   0.836855    2.386693    0.859541    0.179169    0.009463    0.663399     #> 386: -6.139182   0.177998    -5.875010   1.196973    2.060818    -1.580292   0.836852    2.386694    0.859719    0.179125    0.009460    0.663630     #> 387: -6.139428   0.178177    -5.875211   1.196938    2.060923    -1.580292   0.836852    2.386694    0.859764    0.179052    0.009453    0.663859     #> 388: -6.139561   0.178218    -5.875550   1.196970    2.060993    -1.580292   0.836850    2.386694    0.860798    0.178854    0.009470    0.664097     #> 389: -6.140247   0.178272    -5.876004   1.197022    2.061058    -1.580293   0.836851    2.386693    0.862558    0.178709    0.009462    0.664348     #> 390: -6.140819   0.178336    -5.876475   1.197081    2.061152    -1.580293   0.836851    2.386693    0.863234    0.178583    0.009475    0.664577     #> 391: -6.142423   0.178440    -5.876900   1.197080    2.061289    -1.580293   0.836850    2.386693    0.865048    0.178452    0.009505    0.664795     #> 392: -6.143787   0.178602    -5.877018   1.197081    2.061398    -1.580293   0.836850    2.386692    0.866582    0.178507    0.009511    0.665024     #> 393: -6.144871   0.178722    -5.877099   1.197104    2.061459    -1.580293   0.836849    2.386692    0.868765    0.178422    0.009520    0.665251     #> 394: -6.144994   0.178652    -5.877345   1.197072    2.061425    -1.580293   0.836847    2.386692    0.868791    0.178364    0.009533    0.665504     #> 395: -6.145551   0.178788    -5.877386   1.197057    2.061347    -1.580293   0.836845    2.386692    0.868717    0.178285    0.009544    0.665774     #> 396: -6.146122   0.178946    -5.877413   1.197063    2.061320    -1.580293   0.836848    2.386692    0.869142    0.178089    0.009546    0.666037     #> 397: -6.145799   0.179001    -5.877612   1.197070    2.061295    -1.580293   0.836850    2.386692    0.868917    0.177956    0.009551    0.666323     #> 398: -6.145435   0.178883    -5.877766   1.197048    2.061314    -1.580292   0.836850    2.386692    0.868514    0.177910    0.009539    0.666586     #> 399: -6.145462   0.178975    -5.877899   1.197007    2.061444    -1.580293   0.836851    2.386693    0.868424    0.177735    0.009539    0.666833     #> 400: -6.145058   0.179045    -5.877900   1.196988    2.061540    -1.580292   0.836848    2.386692    0.868677    0.177788    0.009542    0.667075     #> 401: -6.145929   0.179370    -5.877934   1.196991    2.061566    -1.580292   0.836848    2.386692    0.870083    0.177713    0.009543    0.667305     #> 402: -6.146705   0.179472    -5.878118   1.197008    2.061634    -1.580292   0.836847    2.386692    0.870916    0.177513    0.009546    0.667512     #> 403: -6.147052   0.179507    -5.878108   1.196991    2.061536    -1.580292   0.836848    2.386692    0.871450    0.177380    0.009542    0.667749     #> 404: -6.147439   0.179502    -5.878152   1.196961    2.061486    -1.580292   0.836849    2.386692    0.870963    0.177192    0.009540    0.668005     #> 405: -6.148872   0.179571    -5.878141   1.196958    2.061559    -1.580292   0.836849    2.386692    0.872419    0.176999    0.009533    0.668235     #> 406: -6.149616   0.179602    -5.878109   1.196963    2.061706    -1.580292   0.836849    2.386692    0.873656    0.176962    0.009529    0.668445     #> 407: -6.150745   0.179548    -5.878181   1.197021    2.061733    -1.580291   0.836848    2.386692    0.875736    0.177017    0.009511    0.668696     #> 408: -6.152057   0.179614    -5.878206   1.197060    2.061787    -1.580291   0.836847    2.386692    0.876787    0.177122    0.009493    0.668959     #> 409: -6.152907   0.179679    -5.878269   1.197066    2.061828    -1.580291   0.836847    2.386692    0.877639    0.177037    0.009510    0.669191     #> 410: -6.153211   0.179743    -5.878329   1.197069    2.061731    -1.580291   0.836847    2.386693    0.877610    0.176870    0.009518    0.669482     #> 411: -6.154053   0.179854    -5.878413   1.197053    2.061627    -1.580291   0.836845    2.386693    0.877629    0.176622    0.009508    0.669717     #> 412: -6.154495   0.179887    -5.878600   1.197058    2.061530    -1.580291   0.836845    2.386693    0.877304    0.176533    0.009495    0.669959     #> 413: -6.155504   0.180021    -5.878722   1.197081    2.061466    -1.580291   0.836844    2.386693    0.878849    0.176532    0.009507    0.670183     #> 414: -6.156257   0.180234    -5.878737   1.197091    2.061474    -1.580291   0.836845    2.386693    0.880300    0.176613    0.009525    0.670395     #> 415: -6.157630   0.180359    -5.878791   1.197106    2.061513    -1.580291   0.836845    2.386692    0.881421    0.176836    0.009533    0.670575     #> 416: -6.158151   0.180682    -5.878840   1.197115    2.061490    -1.580291   0.836846    2.386692    0.881584    0.177025    0.009531    0.670785     #> 417: -6.159223   0.180914    -5.878827   1.197114    2.061459    -1.580291   0.836847    2.386693    0.881917    0.176890    0.009543    0.671019     #> 418: -6.160714   0.181202    -5.879019   1.197139    2.061475    -1.580291   0.836846    2.386693    0.883315    0.177017    0.009521    0.671212     #> 419: -6.162107   0.181335    -5.879189   1.197155    2.061568    -1.580291   0.836846    2.386693    0.884814    0.176974    0.009514    0.671446     #> 420: -6.163023   0.181595    -5.879221   1.197141    2.061631    -1.580291   0.836846    2.386693    0.885840    0.176835    0.009501    0.671652     #> 421: -6.163378   0.181839    -5.879217   1.197128    2.061777    -1.580291   0.836847    2.386693    0.885780    0.176739    0.009503    0.671901     #> 422: -6.163771   0.182005    -5.879175   1.197152    2.061916    -1.580291   0.836847    2.386693    0.885581    0.176690    0.009504    0.672121     #> 423: -6.164718   0.182121    -5.879384   1.197165    2.061966    -1.580291   0.836848    2.386692    0.886795    0.176612    0.009506    0.672339     #> 424: -6.164925   0.181878    -5.879565   1.197185    2.061924    -1.580291   0.836850    2.386693    0.887431    0.176430    0.009510    0.672570     #> 425: -6.165348   0.181904    -5.879662   1.197232    2.061947    -1.580291   0.836850    2.386693    0.888161    0.176160    0.009502    0.672801     #> 426: -6.165820   0.182066    -5.879694   1.197257    2.061949    -1.580291   0.836851    2.386693    0.888357    0.176192    0.009488    0.673030     #> 427: -6.166490   0.182272    -5.879682   1.197287    2.062022    -1.580291   0.836849    2.386692    0.888447    0.176075    0.009485    0.673340     #> 428: -6.167066   0.182693    -5.879685   1.197295    2.062091    -1.580291   0.836847    2.386692    0.889431    0.175840    0.009487    0.673586     #> 429: -6.167569   0.182839    -5.879752   1.197279    2.062132    -1.580291   0.836846    2.386692    0.889514    0.175718    0.009492    0.673774     #> 430: -6.168188   0.182904    -5.879848   1.197276    2.062090    -1.580291   0.836847    2.386692    0.889279    0.175665    0.009502    0.673962     #> 431: -6.169256   0.183025    -5.879826   1.197262    2.062136    -1.580291   0.836847    2.386692    0.889977    0.175652    0.009508    0.674146     #> 432: -6.169799   0.183043    -5.879832   1.197251    2.062179    -1.580291   0.836848    2.386692    0.890746    0.175726    0.009519    0.674342     #> 433: -6.171019   0.183080    -5.879886   1.197253    2.062111    -1.580291   0.836847    2.386692    0.892795    0.175585    0.009525    0.674527     #> 434: -6.171730   0.182909    -5.880017   1.197256    2.062039    -1.580291   0.836847    2.386692    0.894755    0.175482    0.009526    0.674720     #> 435: -6.172819   0.182984    -5.879975   1.197276    2.062015    -1.580291   0.836848    2.386692    0.896099    0.175325    0.009517    0.674922     #> 436: -6.173393   0.183071    -5.880058   1.197257    2.062058    -1.580291   0.836847    2.386692    0.896909    0.175101    0.009517    0.675102     #> 437: -6.174209   0.183222    -5.880144   1.197266    2.062064    -1.580291   0.836847    2.386692    0.897442    0.174937    0.009530    0.675302     #> 438: -6.175162   0.183554    -5.880142   1.197250    2.062152    -1.580291   0.836847    2.386692    0.898984    0.174830    0.009532    0.675500     #> 439: -6.175614   0.183697    -5.880175   1.197256    2.062320    -1.580291   0.836846    2.386692    0.898876    0.174789    0.009551    0.675659     #> 440: -6.176162   0.184060    -5.880090   1.197247    2.062343    -1.580291   0.836846    2.386693    0.899166    0.174724    0.009562    0.675842     #> 441: -6.176646   0.184162    -5.880063   1.197232    2.062358    -1.580291   0.836846    2.386693    0.898976    0.174798    0.009565    0.676046     #> 442: -6.177091   0.184350    -5.880082   1.197219    2.062396    -1.580291   0.836846    2.386693    0.898716    0.174735    0.009560    0.676243     #> 443: -6.177304   0.184469    -5.880130   1.197223    2.062376    -1.580291   0.836846    2.386693    0.898474    0.174740    0.009544    0.676433     #> 444: -6.177979   0.184653    -5.880119   1.197244    2.062441    -1.580291   0.836846    2.386693    0.899919    0.174669    0.009524    0.676598     #> 445: -6.179327   0.184709    -5.880164   1.197258    2.062410    -1.580291   0.836845    2.386693    0.901296    0.174705    0.009513    0.676764     #> 446: -6.180538   0.184884    -5.880229   1.197261    2.062440    -1.580291   0.836845    2.386693    0.902108    0.174730    0.009505    0.676955     #> 447: -6.181524   0.185152    -5.880232   1.197242    2.062434    -1.580291   0.836846    2.386693    0.902555    0.174573    0.009507    0.677146     #> 448: -6.181977   0.185336    -5.880225   1.197245    2.062467    -1.580291   0.836846    2.386693    0.903022    0.174478    0.009499    0.677310     #> 449: -6.182526   0.185462    -5.880183   1.197244    2.062539    -1.580291   0.836846    2.386693    0.904547    0.174330    0.009505    0.677510     #> 450: -6.182784   0.185534    -5.880244   1.197254    2.062657    -1.580291   0.836846    2.386693    0.904591    0.174204    0.009517    0.677681     #> 451: -6.182754   0.185583    -5.880271   1.197261    2.062817    -1.580291   0.836847    2.386693    0.904089    0.174101    0.009532    0.677868     #> 452: -6.183551   0.185804    -5.880360   1.197260    2.062911    -1.580291   0.836847    2.386693    0.903807    0.174118    0.009544    0.678058     #> 453: -6.184528   0.186019    -5.880356   1.197251    2.062976    -1.580291   0.836847    2.386693    0.904310    0.174051    0.009537    0.678243     #> 454: -6.185329   0.186176    -5.880404   1.197271    2.063050    -1.580291   0.836847    2.386693    0.903861    0.174140    0.009526    0.678400     #> 455: -6.186111   0.186385    -5.880416   1.197267    2.063051    -1.580291   0.836847    2.386693    0.904025    0.174133    0.009511    0.678582     #> 456: -6.186933   0.186661    -5.880432   1.197261    2.063071    -1.580291   0.836847    2.386693    0.904163    0.174035    0.009504    0.678751     #> 457: -6.187594   0.186814    -5.880443   1.197264    2.063124    -1.580291   0.836847    2.386693    0.904756    0.174213    0.009499    0.678916     #> 458: -6.187833   0.186925    -5.880423   1.197271    2.063245    -1.580291   0.836848    2.386693    0.905474    0.174193    0.009489    0.679067     #> 459: -6.188186   0.187009    -5.880417   1.197279    2.063305    -1.580291   0.836848    2.386693    0.906362    0.174159    0.009473    0.679239     #> 460: -6.188835   0.187154    -5.880444   1.197274    2.063328    -1.580291   0.836848    2.386693    0.906750    0.174187    0.009461    0.679387     #> 461: -6.188948   0.187371    -5.880464   1.197265    2.063374    -1.580291   0.836850    2.386693    0.906941    0.174048    0.009462    0.679561     #> 462: -6.189564   0.187509    -5.880440   1.197270    2.063329    -1.580291   0.836849    2.386693    0.907676    0.173916    0.009469    0.679725     #> 463: -6.190448   0.187587    -5.880441   1.197271    2.063329    -1.580291   0.836850    2.386693    0.908502    0.173872    0.009466    0.679868     #> 464: -6.191483   0.187701    -5.880423   1.197266    2.063374    -1.580291   0.836850    2.386693    0.910099    0.173762    0.009477    0.680031     #> 465: -6.191756   0.187716    -5.880443   1.197268    2.063375    -1.580291   0.836850    2.386693    0.910741    0.173583    0.009484    0.680203     #> 466: -6.192128   0.187945    -5.880462   1.197272    2.063466    -1.580291   0.836851    2.386693    0.910617    0.173468    0.009496    0.680363     #> 467: -6.191922   0.187986    -5.880462   1.197265    2.063485    -1.580291   0.836850    2.386694    0.911220    0.173283    0.009502    0.680564     #> 468: -6.192252   0.188121    -5.880465   1.197268    2.063575    -1.580291   0.836851    2.386693    0.912097    0.173186    0.009509    0.680744     #> 469: -6.192807   0.188083    -5.880455   1.197263    2.063700    -1.580291   0.836851    2.386693    0.913243    0.172981    0.009521    0.680925     #> 470: -6.193546   0.188353    -5.880434   1.197273    2.063757    -1.580291   0.836851    2.386693    0.914142    0.172986    0.009528    0.681071     #> 471: -6.194452   0.188554    -5.880468   1.197277    2.063826    -1.580291   0.836851    2.386693    0.914835    0.172966    0.009525    0.681231     #> 472: -6.194954   0.188785    -5.880463   1.197277    2.063924    -1.580291   0.836850    2.386693    0.915274    0.172895    0.009533    0.681370     #> 473: -6.195435   0.188911    -5.880493   1.197276    2.063962    -1.580291   0.836851    2.386693    0.915866    0.172796    0.009543    0.681511     #> 474: -6.195670   0.189023    -5.880503   1.197272    2.063964    -1.580291   0.836851    2.386693    0.916550    0.172677    0.009551    0.681684     #> 475: -6.195548   0.189017    -5.880527   1.197284    2.064029    -1.580291   0.836851    2.386693    0.916422    0.172827    0.009558    0.681829     #> 476: -6.195939   0.189132    -5.880514   1.197285    2.064093    -1.580291   0.836851    2.386693    0.916113    0.173001    0.009559    0.681970     #> 477: -6.196285   0.189300    -5.880506   1.197286    2.064137    -1.580291   0.836851    2.386693    0.916195    0.173037    0.009554    0.682134     #> 478: -6.196794   0.189424    -5.880502   1.197295    2.064253    -1.580291   0.836851    2.386693    0.916532    0.173020    0.009558    0.682283     #> 479: -6.197305   0.189458    -5.880503   1.197302    2.064222    -1.580291   0.836851    2.386693    0.916986    0.172824    0.009552    0.682427     #> 480: -6.197515   0.189553    -5.880513   1.197302    2.064361    -1.580291   0.836852    2.386693    0.917864    0.172647    0.009570    0.682563     #> 481: -6.197319   0.189526    -5.880549   1.197303    2.064397    -1.580291   0.836852    2.386693    0.917497    0.172473    0.009572    0.682717     #> 482: -6.197479   0.189246    -5.880568   1.197303    2.064415    -1.580291   0.836851    2.386693    0.917853    0.172456    0.009571    0.682878     #> 483: -6.198094   0.189202    -5.880576   1.197300    2.064436    -1.580291   0.836851    2.386693    0.918094    0.172321    0.009579    0.683033     #> 484: -6.198382   0.189400    -5.880546   1.197304    2.064482    -1.580291   0.836851    2.386693    0.918337    0.172155    0.009588    0.683176     #> 485: -6.199007   0.189562    -5.880550   1.197308    2.064467    -1.580291   0.836852    2.386693    0.918739    0.172011    0.009588    0.683330     #> 486: -6.199466   0.189584    -5.880568   1.197314    2.064401    -1.580291   0.836852    2.386693    0.918423    0.171895    0.009587    0.683461     #> 487: -6.200135   0.189629    -5.880574   1.197317    2.064334    -1.580291   0.836852    2.386693    0.918636    0.171781    0.009595    0.683593     #> 488: -6.200577   0.189829    -5.880561   1.197316    2.064251    -1.580291   0.836852    2.386693    0.919075    0.171611    0.009605    0.683714     #> 489: -6.201068   0.190060    -5.880585   1.197313    2.064314    -1.580291   0.836852    2.386693    0.920265    0.171515    0.009605    0.683839     #> 490: -6.201465   0.190254    -5.880614   1.197319    2.064358    -1.580291   0.836852    2.386693    0.920794    0.171382    0.009615    0.683986     #> 491: -6.202337   0.190338    -5.880630   1.197318    2.064367    -1.580291   0.836852    2.386693    0.922308    0.171253    0.009623    0.684113     #> 492: -6.202564   0.190382    -5.880622   1.197314    2.064366    -1.580291   0.836852    2.386693    0.921999    0.171198    0.009645    0.684249     #> 493: -6.203172   0.190543    -5.880638   1.197317    2.064325    -1.580291   0.836853    2.386693    0.922254    0.171084    0.009656    0.684387     #> 494: -6.203512   0.190569    -5.880659   1.197320    2.064366    -1.580291   0.836853    2.386693    0.922135    0.171025    0.009664    0.684514     #> 495: -6.204128   0.190650    -5.880655   1.197325    2.064434    -1.580291   0.836853    2.386693    0.923104    0.171044    0.009664    0.684658     #> 496: -6.204598   0.190819    -5.880648   1.197317    2.064495    -1.580291   0.836853    2.386693    0.923249    0.171073    0.009657    0.684797     #> 497: -6.204884   0.190909    -5.880661   1.197316    2.064589    -1.580291   0.836853    2.386693    0.923414    0.171080    0.009651    0.684930     #> 498: -6.205137   0.190943    -5.880657   1.197310    2.064630    -1.580291   0.836853    2.386693    0.923029    0.170945    0.009653    0.685066     #> 499: -6.205292   0.191066    -5.880633   1.197302    2.064681    -1.580291   0.836853    2.386693    0.922783    0.170733    0.009649    0.685234     #> 500: -6.205790   0.191033    -5.880628   1.197297    2.064696    -1.580291   0.836853    2.386693    0.923242    0.170624    0.009641    0.685365     #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/nimo.html","id":"goodness-of-fit-plots","dir":"Articles","previous_headings":"","what":"Goodness of fit Plots","title":"Nimotuzumab","text":"","code":"## Add cwres/npde after fit fit  <- fit %>% addCwres() %>% addNpde() #> [====|====|====|====|====|====|====|====|====|====] 0:00:03  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:04  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:01  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:01  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  plot(fit) ## Standard nlmixr plots ################################################################################ ## Xpose plots; Need to print otherwise running a script won't ## show xpose plots ################################################################################ xpdb <- xpose_data_nlmixr(fit) ## first convert to nlmixr object #>        ID           TIME              AMT         RATE         DV          #>  1      : 28   Min.   :   0.48   Min.   :0   Min.   :0   Min.   :-0.2319   #>  5      : 28   1st Qu.: 169.02   1st Qu.:0   1st Qu.:0   1st Qu.: 3.2848   #>  7      : 28   Median : 837.80   Median :0   Median :0   Median : 4.0197   #>  8      : 28   Mean   : 837.85   Mean   :0   Mean   :0   Mean   : 4.2188   #>  2      : 27   3rd Qu.:1344.69   3rd Qu.:0   3rd Qu.:0   3rd Qu.: 5.3016   #>  3      : 27   Max.   :2252.34   Max.   :0   Max.   :0   Max.   : 8.0973   #>  (Other):155                                                               #>       TAD              OCC              MDV         EVID        WGT        #>  Min.   :  0.00   Min.   : 1.000   Min.   :0   Min.   :0   Min.   :53.00   #>  1st Qu.:  0.60   1st Qu.: 2.000   1st Qu.:0   1st Qu.:0   1st Qu.:59.00   #>  Median : 96.31   Median : 5.000   Median :0   Median :0   Median :65.00   #>  Mean   :114.27   Mean   : 5.321   Mean   :0   Mean   :0   Mean   :65.03   #>  3rd Qu.:168.14   3rd Qu.: 9.000   3rd Qu.:0   3rd Qu.:0   3rd Qu.:71.00   #>  Max.   :623.03   Max.   :10.000   Max.   :0   Max.   :0   Max.   :75.00   #>                                                                            #>       BSA             AGE             HGT             DOS        #>  Min.   :1.500   Min.   :34.00   Min.   :145.0   Min.   : 50.0   #>  1st Qu.:1.560   1st Qu.:42.00   1st Qu.:153.0   1st Qu.: 50.0   #>  Median :1.600   Median :45.00   Median :157.0   Median :200.0   #>  Mean   :1.637   Mean   :49.55   Mean   :155.4   Mean   :186.9   #>  3rd Qu.:1.730   3rd Qu.:59.00   3rd Qu.:160.0   3rd Qu.:200.0   #>  Max.   :1.800   Max.   :64.00   Max.   :162.0   Max.   :400.0   #>                                                                  #>       PRED            RES               IPRED             IRES          #>  Min.   :1.575   Min.   :-3.78853   Min.   :0.7366   Min.   :-2.48821   #>  1st Qu.:3.540   1st Qu.:-0.60308   1st Qu.:3.2714   1st Qu.:-0.42777   #>  Median :4.294   Median : 0.03732   Median :4.2834   Median : 0.02403   #>  Mean   :4.295   Mean   :-0.07623   Mean   :4.2366   Mean   :-0.01783   #>  3rd Qu.:5.213   3rd Qu.: 0.50777   3rd Qu.:5.0927   3rd Qu.: 0.43955   #>  Max.   :6.345   Max.   : 1.79710   Max.   :6.7995   Max.   : 1.90157   #>                                                                         #>      IWRES              ETA.CL             ETA.V1             ETA.KSS          #>  Min.   :-3.63049   Min.   :-0.94578   Min.   :-0.579774   Min.   :-0.038563   #>  1st Qu.:-0.62415   1st Qu.:-0.79105   1st Qu.:-0.097603   1st Qu.:-0.021951   #>  Median : 0.03506   Median :-0.43457   Median :-0.088156   Median : 0.013319   #>  Mean   :-0.02601   Mean   :-0.09681   Mean   : 0.004423   Mean   : 0.004266   #>  3rd Qu.: 0.64134   3rd Qu.: 0.31317   3rd Qu.: 0.250051   3rd Qu.: 0.033573   #>  Max.   : 2.77454   Max.   : 1.89999   Max.   : 0.742166   Max.   : 0.045985   #>                                                                                #>   IPRED.STATE        CENTRAL          PERIPHERAL             EFF         #>  Min.   :0.7366   Min.   :  2.379   Min.   :   0.0067   Min.   :0.2665   #>  1st Qu.:3.2714   1st Qu.: 38.849   1st Qu.:  33.4444   1st Qu.:0.8485   #>  Median :4.2834   Median : 99.459   Median :  81.8242   Median :1.3100   #>  Mean   :4.2366   Mean   :151.189   Mean   : 188.7635   Mean   :1.8337   #>  3rd Qu.:5.0927   3rd Qu.:192.029   3rd Qu.: 249.4742   3rd Qu.:2.5040   #>  Max.   :6.7995   Max.   :673.295   Max.   :1234.1818   Max.   :7.5016   #>                                                                          #>        CL                  V1               Q                  V2        #>  Min.   :0.0007836   Min.   :0.6779   Min.   :0.002793   Min.   :3.311   #>  1st Qu.:0.0009148   1st Qu.:1.0979   1st Qu.:0.002793   1st Qu.:3.311   #>  Median :0.0013066   Median :1.1084   Median :0.002793   Median :3.311   #>  Mean   :0.0027877   Mean   :1.2969   Mean   :0.002793   Mean   :3.311   #>  3rd Qu.:0.0027597   3rd Qu.:1.5544   3rd Qu.:0.002793   3rd Qu.:3.311   #>  Max.   :0.0134900   Max.   :2.5426   Max.   :0.002793   Max.   :3.311   #>                                                                          #>       KSS             KINT             KSYN            KDEG       #>  Min.   :7.585   Min.   :0.2059   Min.   :2.309   Min.   :10.88   #>  1st Qu.:7.712   1st Qu.:0.2059   1st Qu.:2.309   1st Qu.:10.88   #>  Median :7.989   Median :0.2059   Median :2.309   Median :10.88   #>  Mean   :7.920   Mean   :0.2059   Mean   :2.309   Mean   :10.88   #>  3rd Qu.:8.152   3rd Qu.:0.2059   3rd Qu.:2.309   3rd Qu.:10.88   #>  Max.   :8.254   Max.   :0.2059   Max.   :2.309   Max.   :10.88   #>                                                                   #>        K                  K12                K21                 CONC         #>  Min.   :0.0006286   Min.   :0.001098   Min.   :0.0008435   Min.   :  2.089   #>  1st Qu.:0.0007936   1st Qu.:0.001797   1st Qu.:0.0008435   1st Qu.: 26.349   #>  Median :0.0010572   Median :0.002520   Median :0.0008435   Median : 72.488   #>  Mean   :0.0023268   Mean   :0.002443   Mean   :0.0008435   Mean   :139.822   #>  3rd Qu.:0.0017525   3rd Qu.:0.002544   3rd Qu.:0.0008435   3rd Qu.:162.824   #>  Max.   :0.0121571   Max.   :0.004120   Max.   :0.0008435   Max.   :897.433   #>                                                                               #>     DOSENUM            WRES              CPRED            CRES          #>  Min.   : 1.000   Min.   :-4.71598   Min.   :1.621   Min.   :-5.42969   #>  1st Qu.: 2.000   1st Qu.:-0.74609   1st Qu.:3.633   1st Qu.:-0.71569   #>  Median : 5.000   Median : 0.04229   Median :4.456   Median :-0.05629   #>  Mean   : 5.321   Mean   :-0.09183   Mean   :4.400   Mean   :-0.18118   #>  3rd Qu.: 9.000   3rd Qu.: 0.64245   3rd Qu.:5.330   3rd Qu.: 0.46526   #>  Max.   :10.000   Max.   : 2.27240   Max.   :6.362   Max.   : 1.77846   #>                                                                         #>      CWRES             EPRED            ERES               NPDE          #>  Min.   :-3.5241   Min.   :1.324   Min.   :-3.63859   Min.   :-2.93520   #>  1st Qu.:-0.8241   1st Qu.:3.339   1st Qu.:-0.48221   1st Qu.:-0.58284   #>  Median :-0.0728   Median :4.067   Median : 0.19066   Median : 0.09204   #>  Mean   :-0.1187   Mean   :4.168   Mean   : 0.05068   Mean   : 0.04898   #>  3rd Qu.: 0.5917   3rd Qu.:5.022   3rd Qu.: 0.64555   3rd Qu.: 0.70630   #>  Max.   : 2.2907   Max.   :6.296   Max.   : 1.88685   Max.   : 2.93520   #>                                                                          #>       NPD               eta.cl             eta.v1             eta.kss          #>  Min.   :-2.93520   Min.   :-0.94578   Min.   :-0.579774   Min.   :-0.038563   #>  1st Qu.:-0.58284   1st Qu.:-0.79105   1st Qu.:-0.097603   1st Qu.:-0.021951   #>  Median : 0.09204   Median :-0.43457   Median :-0.088156   Median : 0.013319   #>  Mean   : 0.04898   Mean   :-0.09681   Mean   : 0.004423   Mean   : 0.004266   #>  3rd Qu.: 0.70630   3rd Qu.: 0.31317   3rd Qu.: 0.250051   3rd Qu.: 0.033573   #>  Max.   : 2.93520   Max.   : 1.89999   Max.   : 0.742166   Max.   : 0.045985   #>   print(dv_vs_pred(xpdb) +       ylab(\"Observed Nimotuzumab Concentrations (ug/mL)\") +       xlab(\"Population Predicted Nimotuzumab Concentrations (ug/mL)\")) print(dv_vs_ipred(xpdb) +       ylab(\"Observed Nimotuzumab Concentrations (ug/mL)\") +       xlab(\"Individual Predicted Nimotuzumab Concentrations (ug/mL)\")) print(res_vs_pred(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Population Predicted Nimotuzumab Concentrations (ug/mL)\")) print(res_vs_idv(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Time (h)\")) print(prm_vs_iteration(xpdb)) print(absval_res_vs_idv(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Time (h)\")) print(absval_res_vs_pred(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Population Predicted Nimotuzumab Concentrations (ug/mL)\")) print(ind_plots(xpdb, nrow=3, ncol=4) +       ylab(\"Predicted and Observed Nimotuzumab concentrations (ug/mL)\") +       xlab(\"Time (h)\")) print(res_distrib(xpdb) +      ylab(\"Density\") +      xlab(\"Conditional Weighted Residuals\")) ################################################################################ ##Visual Predictive Checks ################################################################################ vpcPlot(fit,n=500,stratify=c(\"DOS\"), show=list(obs_dv=T),        bins = c(-0.5,0,25,75,100,200,400,600,750,900,1100,1200,1400,1600,1900,2150,2300),        ylab = \"Nimotuzumab Concentrations (ug/mL)\", xlab = \"Time (h)\") vpcPlot(fit,n=500, show=list(obs_dv=T),        bins = c(-0.5,0,25,75,100,200,400,600,750,900,1100,1200,1400,1600,1900,2150,2300),        ylab = \"Nimotuzumab Concentrations (ug/mL)\", xlab = \"Time (h)\")"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"running-pk-models-with-nlmixr","dir":"Articles","previous_headings":"","what":"Running PK models with nlmixr","title":"Running PK models with nlmixr","text":"nlmixr uses unified interface specifying running models. Let’s start simple PK example, using single-dose theophylline dataset generously provided Dr. Robert . Upton University California, San Francisco:  can try fitting simple one-compartment PK model small dataset. write model follows: can now run model… can alternatively express model ordinary differential equations (ODEs): can try Stochastic Approximation EM (SAEM) method model: wanted , even apply traditional R method nlme method model: example delivers complete model fit fit object, including parameter history, set fixed effect estimates, random effects included subjects. Now back saem fit; Let’s look fit using nlmixr’s built-diagnostics…  Default trace plots can generated using:  little work, can get nicer set iteration trace plots (“wriggly worms”)…  … random-effects histograms…","code":"## Load libraries library(ggplot2) library(nlmixr2) str(theo_sd) #> 'data.frame':    144 obs. of  7 variables: #>  $ ID  : int  1 1 1 1 1 1 1 1 1 1 ... #>  $ TIME: num  0 0 0.25 0.57 1.12 2.02 3.82 5.1 7.03 9.05 ... #>  $ DV  : num  0 0.74 2.84 6.57 10.5 9.66 8.58 8.36 7.47 6.89 ... #>  $ AMT : num  320 0 0 0 0 ... #>  $ EVID: int  101 0 0 0 0 0 0 0 0 0 ... #>  $ CMT : int  1 2 2 2 2 2 2 2 2 2 ... #>  $ WT  : num  79.6 79.6 79.6 79.6 79.6 79.6 79.6 79.6 79.6 79.6 ...  ggplot(theo_sd, aes(TIME, DV)) + geom_line(aes(group=ID), col=\"red\") +   scale_x_continuous(\"Time (h)\") + scale_y_continuous(\"Concentration\") +   labs(title=\"Theophylline single-dose\", subtitle=\"Concentration vs. time by individual\") one.cmt <- function() {   ini({     ## You may label each parameter with a comment     tka <- 0.45 # Ka     tcl <- log(c(0, 2.7, 100)) # Log Cl     ## This works with interactive models     ## You may also label the preceding line with label(\"label text\")     tv <- 3.45; label(\"log V\")     ## the label(\"Label name\") works with all models     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     linCmt() ~ add(add.sd)   }) }  f <- nlmixr(one.cmt) fit <- nlmixr(one.cmt, theo_sd, est=\"focei\",               control=list(print=0)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #> done  print(fit) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 116.8035 373.4033 393.5829      -179.7016         68.42019 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.019951 0.203282   0.203285 0.046    0.011 1.496482 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka           Ka 0.464  0.195 42.1       1.59 (1.08, 2.33)     70.4      1.81%  #> tcl       Log Cl  1.01 0.0751 7.42       2.75 (2.37, 3.19)     26.8      3.87%  #> tv         log V  3.46 0.0437 1.26       31.8 (29.2, 34.6)     13.9      10.3%  #> add.sd           0.695                               0.695                      #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     relative convergence (4)  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 20 #>   ID     TIME    DV     PRED    RES   WRES IPRED   IRES  IWRES     CPRED   CRES #>   <fct> <dbl> <dbl>    <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl>     <dbl>  <dbl> #> 1 1      0     0.74 1.79e-15  0.740  1.07   0     0.74   1.07  -5.61e-16  0.740 #> 2 1      0.25  2.84 3.26e+ 0 -0.423 -0.225  3.85 -1.01  -1.45   3.22e+ 0 -0.379 #> 3 1      0.57  6.57 5.83e+ 0  0.740  0.297  6.78 -0.215 -0.309  5.77e+ 0  0.795 #> # … with 129 more rows, and 9 more variables: CWRES <dbl>, eta.ka <dbl>, #> #   eta.cl <dbl>, eta.v <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl> one.compartment <- function() {   ini({     tka <- 0.45 # Log Ka     tcl <- 1 # Log Cl     tv <- 3.45    # Log V     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     d/dt(depot) = -ka * depot     d/dt(center) = ka * depot - cl / v * center     cp = center / v     cp ~ add(add.sd)   }) } fit2 <- nlmixr(one.compartment, theo_sd,  est=\"saem\",                control=list(print=0)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 print(fit2) #> ── nlmixr SAEM OBJF by FOCEi approximation ── #>  #>  Gaussian/Laplacian Likelihoods: AIC() or $objf etc.  #>  FOCEi CWRES & Likelihoods: addCwres()  #>  #> ── Time (sec $time): ── #>  #>            setup covariance  saem table compress    other #> elapsed 0.002412   0.013006 8.147 0.032    0.029 1.648582 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka       Log Ka 0.454  0.196 43.1       1.57 (1.07, 2.31)     71.5   -0.0203%  #> tcl       Log Cl  1.02 0.0853  8.4       2.76 (2.34, 3.26)     27.6      3.46%  #> tv         Log V  3.45 0.0454 1.32       31.5 (28.8, 34.4)     13.4      9.89%  #> add.sd           0.693                               0.693                      #>   #>   Covariance Type ($covMethod): linFim #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 19 #>   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    cp #>   <fct> <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl>   <dbl> <dbl> #> 1 1      0     0.74  0     0.74   0     0.74   1.07   0.103 -0.491 -0.0820  0    #> 2 1      0.25  2.84  3.27 -0.426  3.87 -1.03  -1.48   0.103 -0.491 -0.0820  3.87 #> 3 1      0.57  6.57  5.85  0.723  6.82 -0.246 -0.356  0.103 -0.491 -0.0820  6.82 #> # … with 129 more rows, and 7 more variables: depot <dbl>, center <dbl>, #> #   ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, dosenum <dbl> fitN <- nlmixr(one.compartment, theo_sd, list(pnlsTol=0.5), est=\"nlme\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #>  #> **Iteration 1 #> LME step: Loglik: -183.2083, nlminb iterations: 1 #> reStruct  parameters: #>       ID1       ID2       ID3  #> 0.2195819 0.9924330 1.6502972  #>  Beginning PNLS step: ..  completed fit_nlme() step. #> PNLS step: RSS =  64.95306  #>  fixed effects: 0.4464074  1.033353  3.45079   #>  iterations: 3  #> Convergence crit. (must all become <= tolerance = 1e-05): #>      fixed   reStruct  #> 0.03227684 0.54047252  #>  #> **Iteration 2 #> LME step: Loglik: -180.6328, nlminb iterations: 1 #> reStruct  parameters: #>       ID1       ID2       ID3  #> 0.1425419 0.9780287 1.6452264  #>  Beginning PNLS step: ..  completed fit_nlme() step. #> PNLS step: RSS =  64.95308  #>  fixed effects: 0.4464074  1.033353  3.45079   #>  iterations: 1  #> Convergence crit. (must all become <= tolerance = 1e-05): #>        fixed     reStruct  #> 0.000000e+00 3.794674e-06  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 print(fitN) #> ── nlmixr nlme by maximum likelihood ── #>  #>          OBJF      AIC      BIC Log-likelihood Condition Number #> nlme 118.6658 375.2656 395.4452      -180.6328         9.736076 #>  #> ── Time (sec $time): ── #>  #>            setup table compress    other #> elapsed 0.002419  0.04    0.007 3.073581 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter   Est.      SE  %RSE Back-transformed(95%CI) BSV(CV%) #> tka       Log Ka 0.4464  0.1442 32.31    1.563 (1.178, 2.073)     66.6 #> tcl       Log Cl  1.033 0.08626 8.347     2.81 (2.373, 3.328)     26.7 #> tv         Log V  3.451 0.04622  1.34    31.53 (28.79, 34.51)     13.5 #> add.sd           0.6988                                0.6988          #>        Shrink(SD)% #> tka        -6.31%  #> tcl         7.24%  #> tv          7.82%  #> add.sd             #>   #>   Covariance Type ($covMethod): nlme #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 19 #>   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    cp #>   <fct> <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl>   <dbl> <dbl> #> 1 1      0     0.74  0     0.74   0     0.74   1.06  0.0740 -0.478 -0.0902  0    #> 2 1      0.25  2.84  3.24 -0.404  3.78 -0.944 -1.35  0.0740 -0.478 -0.0902  3.78 #> 3 1      0.57  6.57  5.81  0.756  6.72 -0.147 -0.210 0.0740 -0.478 -0.0902  6.72 #> # … with 129 more rows, and 7 more variables: depot <dbl>, center <dbl>, #> #   ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, dosenum <dbl> plot(fit) print(fit) #> ── nlmixr FOCEi (outer: nlminb) ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 116.8035 373.4033 393.5829      -179.7016         68.42019 #>  #> ── Time (sec $time): ── #>  #>            setup optimize covariance table compress    other #> elapsed 0.019951 0.203282   0.203285 0.046    0.011 1.496482 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka           Ka 0.464  0.195 42.1       1.59 (1.08, 2.33)     70.4      1.81%  #> tcl       Log Cl  1.01 0.0751 7.42       2.75 (2.37, 3.19)     26.8      3.87%  #> tv         log V  3.46 0.0437 1.26       31.8 (29.2, 34.6)     13.9      10.3%  #> add.sd           0.695                               0.695                      #>   #>   Covariance Type ($covMethod): r,s #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>   Minimization message ($message):   #>     relative convergence (4)  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 20 #>   ID     TIME    DV     PRED    RES   WRES IPRED   IRES  IWRES     CPRED   CRES #>   <fct> <dbl> <dbl>    <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl>     <dbl>  <dbl> #> 1 1      0     0.74 1.79e-15  0.740  1.07   0     0.74   1.07  -5.61e-16  0.740 #> 2 1      0.25  2.84 3.26e+ 0 -0.423 -0.225  3.85 -1.01  -1.45   3.22e+ 0 -0.379 #> 3 1      0.57  6.57 5.83e+ 0  0.740  0.297  6.78 -0.215 -0.309  5.77e+ 0  0.795 #> # … with 129 more rows, and 9 more variables: CWRES <dbl>, eta.ka <dbl>, #> #   eta.cl <dbl>, eta.v <dbl>, ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl> fit$eta #>    ID      eta.ka      eta.cl         eta.v #> 1   1  0.08633989 -0.47406277 -9.110262e-02 #> 2   2  0.19824403  0.14438007  5.214363e-03 #> 3   3  0.37188038  0.02832174  5.310541e-02 #> 4   4 -0.28167853 -0.01803295 -1.295651e-02 #> 5   5 -0.04256582 -0.15001965 -1.433194e-01 #> 6   6 -0.38597392  0.37218972  1.935431e-01 #> 7   7 -0.77183271  0.14633531  5.515352e-02 #> 8   8 -0.16778000  0.16482442  9.359308e-02 #> 9   9  1.36338837  0.04551583 -6.709389e-05 #> 10 10 -0.73251205 -0.38171082 -1.716858e-01 #> 11 11  0.75433206  0.28790437  1.365735e-01 #> 12 12 -0.51928526 -0.12524871 -2.015633e-01 traceplot(fit) iter <- fit2$par.hist.stacked iter$Parameter[iter$par==\"add.sd\"] <- \"Additive error\" iter$Parameter[iter$par==\"eta.cl\"]  <- \"IIV CL/F\" iter$Parameter[iter$par==\"eta.v\"]   <- \"IIV V/F\" iter$Parameter[iter$par==\"eta.ka\"]  <- \"IIV ka\" iter$Parameter[iter$par==\"tcl\"]     <- \"log(CL/F)\" iter$Parameter[iter$par==\"tv\"]      <- \"log(V/F)\" iter$Parameter[iter$par==\"tka\"]     <- \"log(ka)\" iter$Parameter <- ordered(iter$Parameter, c(\"log(CL/F)\", \"log(V/F)\", \"log(ka)\",                                             \"IIV CL/F\", \"IIV V/F\", \"IIV ka\",                                             \"Additive error\"))  ggplot(iter, aes(iter, val)) +   geom_line(col=\"red\") +    scale_x_continuous(\"Iteration\") +   scale_y_continuous(\"Value\") +   facet_wrap(~ Parameter, scales=\"free_y\") +   labs(title=\"Theophylline single-dose\", subtitle=\"Parameter estimation iterations\") etas <- data.frame(eta = c(fit2$eta$eta.ka, fit2$eta$eta.cl, fit2$eta$eta.v),                    lab = rep(c(\"eta(ka)\", \"eta(CL/F)\", \"eta(V/F)\"), each=nrow(fit2$eta))) etas$lab <- ordered(etas$lab, c(\"eta(CL/F)\",\"eta(V/F)\",\"eta(ka)\"))  ggplot(etas, aes(eta)) +   geom_histogram(fill=\"red\", col=\"white\") +    geom_vline(xintercept=0) +   scale_x_continuous(expression(paste(eta))) +   scale_y_continuous(\"Count\") +   facet_grid(~ lab) +   coord_cartesian(xlim=c(-1.75,1.75)) +   labs(title=\"Theophylline single-dose\", subtitle=\"IIV distributions\")"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"xpose","dir":"Articles","previous_headings":"Running PK models with nlmixr","what":"xpose","title":"Running PK models with nlmixr","text":"nice. really want complete suite model diagnostic tools, like available xpose, right? Restart R, install xpose CRAN, haven’t already… Now install extension nlmixr: … convert nlmixr fit object xpose fit object.    information using xpose, see Uppsala pharmacometrics group’s comprehensive site .","code":"## install.packages(\"xpose\") library(xpose) devtools::install_github(\"nlmixr2/xpose.nlmixr\") library(xpose.nlmixr) xp <- xpose_data_nlmixr(fit2) #>        ID          TIME              DV              AMT         EVID   #>  1      :11   Min.   : 0.000   Min.   : 0.000   Min.   :0   Min.   :0   #>  2      :11   1st Qu.: 0.595   1st Qu.: 2.877   1st Qu.:0   1st Qu.:0   #>  3      :11   Median : 3.530   Median : 5.275   Median :0   Median :0   #>  4      :11   Mean   : 5.895   Mean   : 4.960   Mean   :0   Mean   :0   #>  5      :11   3rd Qu.: 9.000   3rd Qu.: 7.140   3rd Qu.:0   3rd Qu.:0   #>  6      :11   Max.   :24.650   Max.   :11.400   Max.   :0   Max.   :0   #>  (Other):66                                                             #>       CMT          WT             PRED            RES              IPRED       #>  Min.   :2   Min.   :54.60   Min.   :0.000   Min.   :-3.0456   Min.   :0.000   #>  1st Qu.:2   1st Qu.:63.58   1st Qu.:3.471   1st Qu.:-0.9546   1st Qu.:3.128   #>  Median :2   Median :70.50   Median :5.515   Median :-0.1108   Median :5.428   #>  Mean   :2   Mean   :69.58   Mean   :5.025   Mean   :-0.0642   Mean   :4.999   #>  3rd Qu.:2   3rd Qu.:74.42   3rd Qu.:7.265   3rd Qu.: 0.7469   3rd Qu.:7.075   #>  Max.   :2   Max.   :86.40   Max.   :8.583   Max.   : 4.2147   Max.   :9.804   #>                                                                                #>       IRES              IWRES              ETA.KA              ETA.CL          #>  Min.   :-2.30170   Min.   :-3.32225   Min.   :-0.798170   Min.   :-0.490712   #>  1st Qu.:-0.29296   1st Qu.:-0.42285   1st Qu.:-0.436312   1st Qu.:-0.134923   #>  Median : 0.00000   Median : 0.00000   Median :-0.109144   Median : 0.035380   #>  Mean   :-0.03871   Mean   :-0.05587   Mean   :-0.004456   Mean   : 0.002638   #>  3rd Qu.: 0.20151   3rd Qu.: 0.29085   3rd Qu.: 0.255856   3rd Qu.: 0.168102   #>  Max.   : 2.77714   Max.   : 4.00849   Max.   : 1.429816   Max.   : 0.388593   #>                                                                                #>      ETA.V                 CP            DEPOT              CENTER      #>  Min.   :-0.195522   Min.   :0.000   Min.   :  0.0000   Min.   :  0.0   #>  1st Qu.:-0.095508   1st Qu.:3.128   1st Qu.:  0.0004   1st Qu.:101.0   #>  Median : 0.016087   Median :5.428   Median :  2.5415   Median :166.9   #>  Mean   :-0.002467   Mean   :4.999   Mean   : 69.0922   Mean   :155.9   #>  3rd Qu.: 0.065787   3rd Qu.:7.075   3rd Qu.:120.2246   3rd Qu.:226.4   #>  Max.   : 0.184904   Max.   :9.804   Max.   :320.6500   Max.   :286.8   #>                                                                         #>        KA               CL              V              TAD            DOSENUM  #>  Min.   :0.7087   Min.   :1.691   Min.   :25.91   Min.   : 0.000   Min.   :1   #>  1st Qu.:1.0188   1st Qu.:2.413   1st Qu.:28.64   1st Qu.: 0.595   1st Qu.:1   #>  Median :1.4154   Median :2.861   Median :32.01   Median : 3.530   Median :1   #>  Mean   :1.9538   Mean   :2.853   Mean   :31.63   Mean   : 5.895   Mean   :1   #>  3rd Qu.:2.0372   3rd Qu.:3.267   3rd Qu.:33.65   3rd Qu.: 9.000   3rd Qu.:1   #>  Max.   :6.5772   Max.   :4.073   Max.   :37.90   Max.   :24.650   Max.   :1   #>                                                                                #>       WRES              CPRED            CRES              CWRES          #>  Min.   :-1.94205   Min.   :0.000   Min.   :-2.58246   Min.   :-2.14627   #>  1st Qu.:-0.66636   1st Qu.:3.434   1st Qu.:-0.96926   1st Qu.:-0.68995   #>  Median :-0.09749   Median :5.523   Median :-0.09416   Median :-0.07605   #>  Mean   :-0.02151   Mean   :5.049   Mean   :-0.08828   Mean   :-0.07784   #>  3rd Qu.: 0.47996   3rd Qu.:7.497   3rd Qu.: 0.74108   3rd Qu.: 0.39650   #>  Max.   : 2.37019   Max.   :9.561   Max.   : 3.83596   Max.   : 2.00705   #>                                                                           #>      eta.ka              eta.cl              eta.v           #>  Min.   :-0.798170   Min.   :-0.490712   Min.   :-0.195522   #>  1st Qu.:-0.436312   1st Qu.:-0.134923   1st Qu.:-0.095508   #>  Median :-0.109144   Median : 0.035380   Median : 0.016087   #>  Mean   :-0.004456   Mean   : 0.002638   Mean   :-0.002467   #>  3rd Qu.: 0.255856   3rd Qu.: 0.168102   3rd Qu.: 0.065787   #>  Max.   : 1.429816   Max.   : 0.388593   Max.   : 0.184904   #> dv_vs_pred(xp) dv_vs_ipred(xp) dv_vs_pred(xp) absval_res_vs_pred(xp, res=\"IWRES\")"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"the-ui","dir":"Articles","previous_headings":"","what":"The UI","title":"Running PK models with nlmixr","text":"nlmixr modeling dialect, inspired R NONMEM, can used fit models using current future estimation algorithms within nlmixr. Using widely-used tools inspiration advantage delivering model specification syntax instantly familiar majority analysts working pharmacometrics related fields.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"overall-model-structure","dir":"Articles","previous_headings":"The UI","what":"Overall model structure","title":"Running PK models with nlmixr","text":"Model specifications nlmixr written using functions containing ini model blocks. functions can called anything, must contain two components. Let’s look simple one-compartment model covariates.","code":"f <- function() {   ini({   # Initial conditions/variables     # are specified here   })   model({ # The model is specified     # here   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"the-ini-block","dir":"Articles","previous_headings":"The UI > Overall model structure","what":"The ini block","title":"Running PK models with nlmixr","text":"ini block specifies initial conditions, including initial estimates boundaries algorithms support (currently, built-nlme saem methods ). Nomenclature similar used NONMEM, Monolix similar packages. NONMEM world, ini block analogous $THETA, $OMEGA $SIGMA blocks. shown example: Simple parameter values specified using R-compatible assignment Boundaries may specified c(lower, est, upper). Like NONMEM, c(lower,est) equivalent c(lower,est,Inf) Also like NONMEM, c(est) specify lower bound, equivalent specifying parameter without using R’s c() function. parameters can named using almost R-compatible name. Please note : Residual error estimates coded population estimates (.e. using = <-, ~). Variable names start _ supported. Note R allow variable starting _ assigned without quoting . Naming variables start rx_ nlmixr_ allowed, since rxode2() nlmixr use prefixes internally certain estimation routines calculating residuals. Variable names case-sensitive, just like R. CL Cl. mixture models, multivariate normal individual deviations normal population parameters estimated (NONMEM called “ETA” parameters). Additionally, variance/covariance matrix deviations also estimated (NONMEM “OMEGA” matrix). also take initial estimates. nlmixr, specified ~ operator. typically used statistics R “modeled ”, chosen distinguish estimates population residual error parameters. Continuing prior example, can annotate estimates -subject error distribution… shown example: Simple variances specified variable name estimate separated ~. Correlated parameters specified sum variable labels lower triangular matrix covariance specified left handed side equation. also separated ~. initial estimates specified variance scale, analogy NONMEM, square roots diagonal elements correspond coefficients variation used exponential IIV implementation. Currently, comments inside lower triangular matrix allowed.","code":"f <- function() { # Note that arguments to the function are currently   # ignored by nlmixr   ini({     # Initial conditions for population parameters (sometimes     # called THETA parameters) are defined by either '<-' or '='     lCl <- 1.6      # log Cl (L/hr)          # Note that simple expressions that evaluate to a number are     # OK for defining initial conditions (like in R)     lVc = log(90)  # log V (L)          ## Also, note that a comment on a parameter is captured as a parameter label     lKa <- 1       # log Ka (1/hr)          # Bounds may be specified by c(lower, est, upper), like NONMEM:     # Residuals errors are assumed to be population parameters     prop.err <- c(0, 0.2, 1)          # IIV terms will be discussed in the next example   })      # The model block will be discussed later   model({}) } f <- function() {   ini({     lCl <- 1.6      # log Cl (L/hr)     lVc = log(90)   # log V (L)     lKa <- 1        # log Ka (1/hr)     prop.err <- c(0, 0.2, 1)          # Initial estimate for ka IIV variance     # Labels work for single parameters     eta.ka ~ 0.1    ## BSV Ka      # For correlated parameters, you specify the names of each     # correlated parameter separated by a addition operator `+`     # and the left handed side specifies the lower triangular     # matrix initial of the covariance matrix.     eta.cl + eta.vc ~ c(0.1,                         0.005, 0.1)          # Note that labels do not currently work for correlated     # parameters.  Also, do not put comments inside the lower     # triangular matrix as this will currently break the model.   })      # The model block will be discussed later   model({}) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"the-model-block","dir":"Articles","previous_headings":"The UI > Overall model structure","what":"The model block","title":"Running PK models with nlmixr","text":"model block specifies model, analogous $PK, $PRED $ERROR blocks NONMEM. initialization block defined, can define model terms variables defined ini block. can also mix rxode2() blocks model needed. current method defining nlmixr model specify parameters, required rxode2() lines. Continuing annotated example: points note: Parameters defined differential equations. Currently directly defining differential equations terms population parameters supported. differential equations, parameters error terms single block, instead multiple sections. Additionally state names, calculated variables, also start either rx_ nlmixr_ since used internally estimation routines. Errors specified using tilde, ~. Currently can use either add(parameter) additive error, prop(parameter) proportional error add(parameter1) + prop(parameter2) combined additive proportional error. can also specify norm(parameter) additive error, since follows normal distribution. routines, like saem, require parameters expressed terms Pop.Parameter + Individual.Deviation.Parameter + Covariate*Covariate.Parameter. order parameters matter. similar NONMEM’s mu-referencing, though restrictive. means saem, parameterization form Cl <- Cl*exp(eta.Cl) allowed. type parameter model determined ini block; covariates used model included ini block. variables need present modeling dataset model run.","code":"f <- function() {   ini({     lCl <- 1.6       # log Cl (L/hr)     lVc <- log(90)   # log Vc (L)     lKA <- 0.1       # log Ka (1/hr)     prop.err <- c(0, 0.2, 1)          eta.Cl ~ 0.1     # BSV Cl     eta.Vc ~ 0.1     # BSV Vc     eta.KA ~ 0.1     # BSV Ka   })   model({     # Parameters are defined in terms of the previously-defined     # parameter names:     Cl <- exp(lCl + eta.Cl)     Vc =  exp(lVc + eta.Vc)     KA <- exp(lKA + eta.KA)          # Next, the differential equations are defined:     kel <- Cl / Vc;          d/dt(depot)  = -KA*depot;     d/dt(centr)  =  KA*depot-kel*centr;          # And the concentration is then calculated     cp = centr / Vc;     # Finally, we specify that the plasma concentration follows     # a proportional error distribution (estimated by the parameter      # prop.err)     cp ~ prop(prop.err)   })  }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"running-models","dir":"Articles","previous_headings":"The UI","what":"Running models","title":"Running PK models with nlmixr","text":"Models can fitted several ways, including via [magrittr] forward-pipe operator. Options estimation routines can specified using nlmeControl nlme estimation: options specified nlme documentation. Options saem can specified using saemControl: example specifies 250 burn-iterations, 350 em iterations print progress every 50 runs.","code":"fit <- nlmixr(one.compartment) %>% saem.fit(data=theo_sd) fit2 <- nlmixr(one.compartment, data=theo_sd, est=\"saem\") fit3 <- one.compartment %>% saem.fit(data=theo_sd) fit4 <- nlmixr(one.compartment, theo_sd,est=\"nlme\",control = nlmeControl(pnlsTol = .5)) fit5 <- nlmixr(one.compartment,theo_sd,est=\"saem\",control=saemControl(n.burn=250,n.em=350,print=50))"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"model-syntax-for-solved-pk-systems","dir":"Articles","previous_headings":"The UI","what":"Model Syntax for solved PK systems","title":"Running PK models with nlmixr","text":"Solved PK systems also currently supported nlmixr ‘linCmt()’ pseudo-function. annotated example solved system : things keep mind: * Currently solved systems support either oral dosing, IV dosing IV infusion dosing allow mixing dosing types. * rxode2() allows mixing solved systems ODEs, implemented nlmixr yet. * solved systems implemented one, two three compartment models without first-order absorption. models support lag time tlag parameter. * general linear compartment model figures model parameter names. nlmixr currently knows numbered volumes, Vc/Vp, Clearances terms Cl Q/CLD. Additionally nlmixr knows elimination micro-constants (ie K12). Mixing parameters models currently supported.","code":"f <- function(){   ini({     lCl <- 1.6      #log Cl (L/hr)     lVc <- log(90)  #log Vc (L)     lKA <- 0.1      #log Ka (1/hr)     prop.err <- c(0, 0.2, 1)     eta.Cl ~ 0.1   # BSV Cl     eta.Vc ~ 0.1   # BSV Vc     eta.KA ~ 0.1   # BSV Ka   })   model({     Cl <- exp(lCl + eta.Cl)     Vc = exp(lVc + eta.Vc)     KA <- exp(lKA + eta.KA)     ## Instead of specifying the ODEs, you can use     ## the linCmt() function to use the solved system.     ##     ## This function determines the type of PK solved system     ## to use by the parameters that are defined.  In this case     ## it knows that this is a one-compartment model with first-order     ## absorption.     linCmt() ~ prop(prop.err)   }) }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/running_nlmixr.html","id":"checking-model-syntax","dir":"Articles","previous_headings":"The UI","what":"Checking model syntax","title":"Running PK models with nlmixr","text":"specifying model syntax can check nlmixr interpreting correctly using nlmixr function . Using function can get: general gives information model (type solved system/rxode2()), initial estimates well code model block.","code":"nlmixr(f) #>  ── rxode2-based solved PK 1-compartment model with first-order absorption ──────  #>  ── Initalization: ──   #> Fixed Effects ($theta):  #>      lCl      lVc      lKA prop.err  #>  1.60000  4.49981  0.10000  0.20000  #>  #> Omega ($omega):  #>        eta.Cl eta.Vc eta.KA #> eta.Cl    0.1    0.0    0.0 #> eta.Vc    0.0    0.1    0.0 #> eta.KA    0.0    0.0    0.1 #>  ── μ-referencing ($muRefTable): ──   #>   theta    eta level #> 1   lCl eta.Cl    id #> 2   lVc eta.Vc    id #> 3   lKA eta.KA    id #>  #>  ── Model (Normalized Syntax): ──  #> function() { #>     ini({ #>         lCl <- 1.6 #>         label(\"log Cl (L/hr)\") #>         lVc <- 4.49980967033027 #>         label(\"log Vc (L)\") #>         lKA <- 0.1 #>         label(\"log Ka (1/hr)\") #>         prop.err <- c(0, 0.2, 1) #>         label(\"BSV Ka\") #>         eta.Cl ~ 0.1 #>         eta.Vc ~ 0.1 #>         eta.KA ~ 0.1 #>     }) #>     model({ #>         Cl <- exp(lCl + eta.Cl) #>         Vc = exp(lVc + eta.Vc) #>         KA <- exp(lKA + eta.KA) #>         linCmt() ~ prop(prop.err) #>     }) #> }"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/wbc.html","id":"fit-model-using-saem","dir":"Articles","previous_headings":"","what":"Fit model using saem","title":"Friberg myelosuppression model","text":"","code":"d3 = read.csv(\"Simulated_WBC_pacl_ddmore_samePK_nlmixr.csv\", na.string = \".\")  fit.S <- nlmixr(wbc, d3, est=\"saem\", list(print=0), table=list(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:03  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  library(xpose.nlmixr)  xpdb <- xpose_data_nlmixr(fit.S) #>        ID           TIME             RATE        AMT          DV         #>  33     : 18   Min.   :   0.0   Min.   :0   Min.   :0   Min.   : 0.700   #>  12     :  6   1st Qu.:   0.0   1st Qu.:0   1st Qu.:0   1st Qu.: 3.675   #>  44     :  5   Median : 276.0   Median :0   Median :0   Median : 5.800   #>  1      :  4   Mean   : 451.7   Mean   :0   Mean   :0   Mean   : 6.428   #>  4      :  4   3rd Qu.: 480.0   3rd Qu.:0   3rd Qu.:0   3rd Qu.: 8.375   #>  5      :  4   Max.   :4580.0   Max.   :0   Max.   :0   Max.   :20.400   #>  (Other):135                                                             #>       CMT         V2I              V1I             CLI           PARFLAG  #>  Min.   :3   Min.   : 663.0   Min.   :179.0   Min.   :151.0   Min.   :0   #>  1st Qu.:3   1st Qu.: 917.2   1st Qu.:358.0   1st Qu.:262.5   1st Qu.:0   #>  Median :3   Median :1010.0   Median :410.0   Median :323.0   Median :0   #>  Mean   :3   Mean   : 999.8   Mean   :421.5   Mean   :328.9   Mean   :0   #>  3rd Qu.:3   3rd Qu.:1060.0   3rd Qu.:485.0   3rd Qu.:377.2   3rd Qu.:0   #>  Max.   :3   Max.   :1390.0   Max.   :679.0   Max.   :619.0   Max.   :0   #>                                                                           #>       EVID       EPRED             ERES              NPDE            #>  Min.   :0   Min.   : 2.113   Min.   :-7.7217   Min.   :-2.7130519   #>  1st Qu.:0   1st Qu.: 4.457   1st Qu.:-2.2585   1st Qu.:-0.6536562   #>  Median :0   Median : 7.730   Median :-0.7159   Median :-0.0334291   #>  Mean   :0   Mean   : 6.696   Mean   :-0.2672   Mean   : 0.0000195   #>  3rd Qu.:0   3rd Qu.: 8.423   3rd Qu.: 1.5209   3rd Qu.: 0.7279133   #>  Max.   :0   Max.   :11.073   Max.   :14.6532   Max.   : 2.7130519   #>                                                                      #>       NPD                  PRED             RES               WRES         #>  Min.   :-2.7130519   Min.   : 1.506   Min.   :-8.1628   Min.   :-1.6762   #>  1st Qu.:-0.6536562   1st Qu.: 3.861   1st Qu.:-1.9112   1st Qu.:-0.7231   #>  Median :-0.0334291   Median : 7.522   Median :-0.2987   Median :-0.1000   #>  Mean   : 0.0000195   Mean   : 6.320   Mean   : 0.1084   Mean   : 0.0835   #>  3rd Qu.: 0.7279133   3rd Qu.: 7.699   3rd Qu.: 1.9165   3rd Qu.: 0.7245   #>  Max.   : 2.7130519   Max.   :11.570   Max.   :15.5450   Max.   : 5.9017   #>                                                                            #>      IPRED              IRES               IWRES                CPRED        #>  Min.   : 0.6196   Min.   :-6.536908   Min.   :-2.3109441   Min.   :-4.196   #>  1st Qu.: 3.9270   1st Qu.:-0.536075   1st Qu.:-0.5471058   1st Qu.: 3.634   #>  Median : 6.1222   Median : 0.000618   Median : 0.0006606   Median : 6.111   #>  Mean   : 6.3883   Mean   : 0.040116   Mean   :-0.0869993   Mean   : 5.859   #>  3rd Qu.: 8.6636   3rd Qu.: 0.576408   3rd Qu.: 0.3617582   3rd Qu.: 7.677   #>  Max.   :15.8990   Max.   : 5.427836   Max.   : 2.0875911   Max.   :14.989   #>                                                                              #>       CRES             CWRES            ETA.CIRC0           ETA.MTT           #>  Min.   :-5.5566   Min.   :-2.70241   Min.   :-0.82137   Min.   :-0.3565698   #>  1st Qu.:-1.5183   1st Qu.:-0.86270   1st Qu.:-0.22980   1st Qu.:-0.0857153   #>  Median :-0.1647   Median :-0.06106   Median :-0.00503   Median : 0.0506072   #>  Mean   : 0.5697   Mean   :-0.14162   Mean   :-0.06248   Mean   : 0.0009022   #>  3rd Qu.: 2.0185   3rd Qu.: 0.65107   3rd Qu.: 0.22797   3rd Qu.: 0.1034825   #>  Max.   :18.6962   Max.   : 2.47053   Max.   : 0.51756   Max.   : 0.3746142   #>                                                                               #>    ETA.SLOPU           A_CENTR              A_PERIPH             A_PROL        #>  Min.   :-0.51756   Min.   :-2.000e-08   Min.   :0.0000000   Min.   : 0.7901   #>  1st Qu.:-0.22665   1st Qu.: 0.000e+00   1st Qu.:0.0000000   1st Qu.: 4.6138   #>  Median :-0.11168   Median : 0.000e+00   Median :0.0000000   Median : 7.2413   #>  Mean   :-0.04416   Mean   : 2.817e-04   Mean   :0.0008848   Mean   : 7.2321   #>  3rd Qu.: 0.09229   3rd Qu.: 0.000e+00   3rd Qu.:0.0000000   3rd Qu.: 9.6738   #>  Max.   : 0.79047   Max.   : 4.933e-02   Max.   :0.1543434   Max.   :19.1385   #>                                                                                #>      A_TR1            A_TR2             A_TR3             A_CIRC        #>  Min.   : 0.700   Min.   : 0.6446   Min.   : 0.7466   Min.   : 0.6196   #>  1st Qu.: 4.358   1st Qu.: 4.0886   1st Qu.: 3.8571   1st Qu.: 3.9270   #>  Median : 6.975   Median : 6.5607   Median : 6.2229   Median : 6.1222   #>  Mean   : 6.964   Mean   : 6.7218   Mean   : 6.5254   Mean   : 6.3883   #>  3rd Qu.: 9.381   3rd Qu.: 9.1819   3rd Qu.: 8.9956   3rd Qu.: 8.6636   #>  Max.   :18.062   Max.   :16.3480   Max.   :15.9568   Max.   :15.8990   #>                                                                         #>      CIRC0             MTT            SLOPU           GAMMA        #>  Min.   : 3.386   Min.   : 81.4   Min.   :18.21   Min.   :0.2094   #>  1st Qu.: 6.119   1st Qu.:106.7   1st Qu.:24.35   1st Qu.:0.2094   #>  Median : 7.660   Median :122.3   Median :27.32   Median :0.2094   #>  Mean   : 7.671   Mean   :118.0   Mean   :30.66   Mean   :0.2094   #>  3rd Qu.: 9.670   3rd Qu.:128.9   3rd Qu.:33.51   3rd Qu.:0.2094   #>  Max.   :12.918   Max.   :169.1   Max.   :67.34   Max.   :0.2094   #>                                                                    #>        CL              V1              V2              CONC            #>  Min.   :151.0   Min.   :179.0   Min.   : 663.0   Min.   :-1.000e-11   #>  1st Qu.:262.5   1st Qu.:358.0   1st Qu.: 917.2   1st Qu.: 0.000e+00   #>  Median :323.0   Median :410.0   Median :1010.0   Median : 0.000e+00   #>  Mean   :328.9   Mean   :421.5   Mean   : 999.8   Mean   : 4.569e-07   #>  3rd Qu.:377.2   3rd Qu.:485.0   3rd Qu.:1060.0   3rd Qu.: 1.000e-11   #>  Max.   :619.0   Max.   :679.0   Max.   :1390.0   Max.   : 7.969e-05   #>                                                                        #>       KTR              EDRUG             FDBK             TAD        #>  Min.   :0.02365   Min.   :0.9958   Min.   :0.8684   Min.   :  0.0   #>  1st Qu.:0.03102   1st Qu.:1.0000   1st Qu.:1.0000   1st Qu.:  0.0   #>  Median :0.03270   Median :1.0000   Median :1.0080   Median :216.0   #>  Mean   :0.03487   Mean   :1.0000   Mean   :1.0670   Mean   :247.1   #>  3rd Qu.:0.03748   3rd Qu.:1.0000   3rd Qu.:1.1212   3rd Qu.:360.0   #>  Max.   :0.04914   Max.   :1.0000   Max.   :1.6628   Max.   :720.0   #>                                                      NA's   :1       #>     DOSENUM       eta.CIRC0           eta.MTT             eta.SLOPU        #>  Min.   :0.00   Min.   :-0.82137   Min.   :-0.3565698   Min.   :-0.51756   #>  1st Qu.:1.00   1st Qu.:-0.22980   1st Qu.:-0.0857153   1st Qu.:-0.22665   #>  Median :1.00   Median :-0.00503   Median : 0.0506072   Median :-0.11168   #>  Mean   :1.25   Mean   :-0.06248   Mean   : 0.0009022   Mean   :-0.04416   #>  3rd Qu.:1.00   3rd Qu.: 0.22797   3rd Qu.: 0.1034825   3rd Qu.: 0.09229   #>  Max.   :6.00   Max.   : 0.51756   Max.   : 0.3746142   Max.   : 0.79047   #>   plot(fit.S) print(dv_vs_pred(xpdb) +       ylab(\"Observed Neutrophil Count (10^9/L)\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(dv_vs_ipred(xpdb) +       ylab(\"Observed Neutrophil Count (10^9/L)\") +       xlab(\"Individual Predicted Neutrophil Count (10^9/L)\")) print(res_vs_pred(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(res_vs_idv(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Time (h)\")) print(prm_vs_iteration(xpdb)) print(absval_res_vs_idv(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Time (h)\")) print(absval_res_vs_pred(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(ind_plots(xpdb, nrow=3, ncol=4) +       ylab(\"Predicted and Observed Neutrophil Count (10^9/L)\") +       xlab(\"Time (h)\")) print(res_distrib(xpdb) +       ylab(\"Density\") +       xlab(\"Conditional Weighted Residuals\")) vpcPlot(fit.S, n=500, n_bins = 10, show=list(obs_dv=T),         ylab = \"Neutrophil Count (10^9/L)\", xlab = \"Time (h)\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:05 vpcPlot(fit.S, n=500, bins = c(0,170,300,350,500,600,900,3000,4580),         show=list(obs_dv=T), ylab = \"Neutrophil Count (10^9/L)\", xlab = \"Time (h)\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:05"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/wbc.html","id":"fit-model-using-focei","dir":"Articles","previous_headings":"","what":"Fit model using FOCEi","title":"Friberg myelosuppression model","text":"","code":"fit.F <- nlmixr(wbc, d3, est=\"focei\", list(print=0), table=list(cwres=TRUE, npde=TRUE)) #> calculating covariance matrix #> [====|====|====|====|====|====|====|====|====|====] 0:00:29  #> done #> [====|====|====|====|====|====|====|====|====|====] 0:00:03"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/wbc.html","id":"focei-goodness-of-fit-plots","dir":"Articles","previous_headings":"Fit model using FOCEi","what":"FOCEi Goodness of fit plots","title":"Friberg myelosuppression model","text":"","code":"xpdb <- xpose_data_nlmixr(fit.F) #>        ID           TIME             RATE        AMT          DV         #>  33     : 18   Min.   :   0.0   Min.   :0   Min.   :0   Min.   : 0.700   #>  12     :  6   1st Qu.:   0.0   1st Qu.:0   1st Qu.:0   1st Qu.: 3.675   #>  44     :  5   Median : 276.0   Median :0   Median :0   Median : 5.800   #>  1      :  4   Mean   : 451.7   Mean   :0   Mean   :0   Mean   : 6.428   #>  4      :  4   3rd Qu.: 480.0   3rd Qu.:0   3rd Qu.:0   3rd Qu.: 8.375   #>  5      :  4   Max.   :4580.0   Max.   :0   Max.   :0   Max.   :20.400   #>  (Other):135                                                             #>       CMT         V2I              V1I             CLI           PARFLAG  #>  Min.   :3   Min.   : 663.0   Min.   :179.0   Min.   :151.0   Min.   :0   #>  1st Qu.:3   1st Qu.: 917.2   1st Qu.:358.0   1st Qu.:262.5   1st Qu.:0   #>  Median :3   Median :1010.0   Median :410.0   Median :323.0   Median :0   #>  Mean   :3   Mean   : 999.8   Mean   :421.5   Mean   :328.9   Mean   :0   #>  3rd Qu.:3   3rd Qu.:1060.0   3rd Qu.:485.0   3rd Qu.:377.2   3rd Qu.:0   #>  Max.   :3   Max.   :1390.0   Max.   :679.0   Max.   :619.0   Max.   :0   #>                                                                           #>       EVID       EPRED             ERES               NPDE          #>  Min.   :0   Min.   :-5.933   Min.   :-13.9504   Min.   :-0.22754   #>  1st Qu.:0   1st Qu.: 3.278   1st Qu.: -3.3752   1st Qu.:-0.04179   #>  Median :0   Median : 5.841   Median : -0.3651   Median : 0.01671   #>  Mean   :0   Mean   : 6.264   Mean   :  0.1641   Mean   : 0.02150   #>  3rd Qu.:0   3rd Qu.: 8.761   3rd Qu.:  2.8424   3rd Qu.: 0.07527   #>  Max.   :0   Max.   :22.419   Max.   : 17.0043   Max.   : 0.37634   #>                                                                     #>       NPD                PRED             RES                WRES           #>  Min.   :-0.22754   Min.   : 1.769   Min.   :-8.31049   Min.   :-0.077650   #>  1st Qu.:-0.04179   1st Qu.: 3.997   1st Qu.:-1.84761   1st Qu.:-0.032655   #>  Median : 0.01671   Median : 7.211   Median :-0.07836   Median :-0.001942   #>  Mean   : 0.02150   Mean   : 6.170   Mean   : 0.25881   Mean   : 0.005816   #>  3rd Qu.: 0.07527   3rd Qu.: 7.223   3rd Qu.: 2.13908   3rd Qu.: 0.035374   #>  Max.   : 0.37634   Max.   :11.457   Max.   :15.47635   Max.   : 0.331424   #>                                                                             #>      IPRED             IRES             IWRES               CPRED        #>  Min.   :0.5768   Min.   :-3.5124   Min.   :-0.063104   Min.   : 1.150   #>  1st Qu.:2.4919   1st Qu.: 0.4658   1st Qu.: 0.009421   1st Qu.: 3.635   #>  Median :3.8123   Median : 1.7984   Median : 0.055027   Median : 5.943   #>  Mean   :3.9290   Mean   : 2.4994   Mean   : 0.073607   Mean   : 5.644   #>  3rd Qu.:5.3495   3rd Qu.: 4.1565   3rd Qu.: 0.106029   3rd Qu.: 6.952   #>  Max.   :7.7763   Max.   :17.3333   Max.   : 0.565211   Max.   :10.659   #>                                                                          #>       CRES             CWRES            ETA.CIRC0           ETA.MTT          #>  Min.   :-5.7439   Min.   :-0.16495   Min.   :-1.00000   Min.   :-0.070770   #>  1st Qu.:-1.2207   1st Qu.:-0.03677   1st Qu.:-0.39799   1st Qu.:-0.003319   #>  Median : 0.2667   Median : 0.01087   Median :-0.39175   Median : 0.030900   #>  Mean   : 0.7847   Mean   : 0.02183   Mean   :-0.43184   Mean   : 0.037894   #>  3rd Qu.: 2.6182   3rd Qu.: 0.06451   3rd Qu.:-0.30044   3rd Qu.: 0.050633   #>  Max.   :15.8496   Max.   : 0.51613   Max.   :-0.09985   Max.   : 0.220879   #>                                                                              #>    ETA.SLOPU           A_CENTR              A_PERIPH              A_PROL       #>  Min.   :-0.04189   Min.   :-5.390e-06   Min.   :-2.500e-06   Min.   :0.3636   #>  1st Qu.: 0.11260   1st Qu.: 0.000e+00   1st Qu.: 0.000e+00   1st Qu.:2.7752   #>  Median : 0.16447   Median : 0.000e+00   Median : 0.000e+00   Median :4.9537   #>  Mean   : 0.18661   Mean   : 2.818e-04   Mean   : 8.848e-04   Mean   :4.5987   #>  3rd Qu.: 0.23089   3rd Qu.: 3.000e-08   3rd Qu.: 7.000e-08   3rd Qu.:6.0565   #>  Max.   : 0.53749   Max.   : 4.933e-02   Max.   : 1.543e-01   Max.   :9.0836   #>                                                                                #>      A_TR1           A_TR2           A_TR3            A_CIRC       #>  Min.   :0.334   Min.   :0.386   Min.   :0.4407   Min.   :0.5768   #>  1st Qu.:2.385   1st Qu.:2.291   1st Qu.:2.3185   1st Qu.:2.4919   #>  Median :4.890   Median :4.800   Median :4.2522   Median :3.8123   #>  Mean   :4.380   Mean   :4.183   Mean   :4.0284   Mean   :3.9290   #>  3rd Qu.:5.768   3rd Qu.:5.352   3rd Qu.:5.3476   3rd Qu.:5.3495   #>  Max.   :9.563   Max.   :9.484   Max.   :8.8454   Max.   :7.7763   #>                                                                    #>      CIRC0            MTT            SLOPU           GAMMA        #>  Min.   :2.653   Min.   :112.9   Min.   :27.13   Min.   :0.2391   #>  1st Qu.:4.843   1st Qu.:120.8   1st Qu.:31.67   1st Qu.:0.2391   #>  Median :4.873   Median :125.0   Median :33.35   Median :0.2391   #>  Mean   :4.766   Mean   :126.2   Mean   :34.35   Mean   :0.2391   #>  3rd Qu.:5.339   3rd Qu.:127.5   3rd Qu.:35.64   3rd Qu.:0.2391   #>  Max.   :6.525   Max.   :151.1   Max.   :48.43   Max.   :0.2391   #>                                                                   #>        CL              V1              V2              CONC            #>  Min.   :151.0   Min.   :179.0   Min.   : 663.0   Min.   :-2.340e-09   #>  1st Qu.:262.5   1st Qu.:358.0   1st Qu.: 917.2   1st Qu.: 0.000e+00   #>  Median :323.0   Median :410.0   Median :1010.0   Median : 0.000e+00   #>  Mean   :328.9   Mean   :421.5   Mean   : 999.8   Mean   : 4.571e-07   #>  3rd Qu.:377.2   3rd Qu.:485.0   3rd Qu.:1060.0   3rd Qu.: 1.000e-11   #>  Max.   :619.0   Max.   :679.0   Max.   :1390.0   Max.   : 7.969e-05   #>                                                                        #>       KTR              EDRUG             FDBK            TAD        #>  Min.   :0.02647   Min.   :0.9973   Min.   :0.885   Min.   :  0.0   #>  1st Qu.:0.03138   1st Qu.:1.0000   1st Qu.:1.000   1st Qu.:  0.0   #>  Median :0.03200   Median :1.0000   Median :1.038   Median :216.0   #>  Mean   :0.03185   Mean   :1.0000   Mean   :1.081   Mean   :247.1   #>  3rd Qu.:0.03312   3rd Qu.:1.0000   3rd Qu.:1.169   3rd Qu.:360.0   #>  Max.   :0.03543   Max.   :1.0000   Max.   :1.440   Max.   :720.0   #>                                                     NA's   :1       #>     DOSENUM       eta.CIRC0           eta.MTT            eta.SLOPU        #>  Min.   :0.00   Min.   :-1.00000   Min.   :-0.070770   Min.   :-0.04189   #>  1st Qu.:1.00   1st Qu.:-0.39799   1st Qu.:-0.003319   1st Qu.: 0.11260   #>  Median :1.00   Median :-0.39175   Median : 0.030900   Median : 0.16447   #>  Mean   :1.25   Mean   :-0.43184   Mean   : 0.037894   Mean   : 0.18661   #>  3rd Qu.:1.00   3rd Qu.:-0.30044   3rd Qu.: 0.050633   3rd Qu.: 0.23089   #>  Max.   :6.00   Max.   :-0.09985   Max.   : 0.220879   Max.   : 0.53749   #>  plot(fit.F) print(dv_vs_pred(xpdb) +       ylab(\"Observed Neutrophil Count (10^9/L)\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(dv_vs_ipred(xpdb) +       ylab(\"Observed Neutrophil Count (10^9/L)\") +       xlab(\"Individual Predicted Neutrophil Count (10^9/L)\")) print(res_vs_pred(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(res_vs_idv(xpdb) +       ylab(\"Conditional Weighted Residuals\") +       xlab(\"Time (h)\")) print(absval_res_vs_idv(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Time (h)\")) print(absval_res_vs_pred(xpdb, res = 'IWRES') +       ylab(\"Individual Weighted Residuals\") +       xlab(\"Population Predicted Neutrophil Count (10^9/L)\")) print(ind_plots(xpdb, nrow=3, ncol=4) +       ylab(\"Predicted and Observed Neutrophil Count (10^9/L)\") +       xlab(\"Time (h)\")) print(res_distrib(xpdb) +       ylab(\"Density\") +       xlab(\"Conditional Weighted Residuals\")) #vpc.ui(fit.S, n=500, show=list(obs_dv=T), ylab = \"Neutrophil count (10^9/L)\", xlab = \"Time (h)\") # 10 bins is slightly better than auto bin vpcPlot(fit.F, n=500, n_bins = 10, show=list(obs_dv=T),         ylab = \"Neutrophil Count (10^9/L)\", xlab = \"Time (h)\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:05 # specify bins vpcPlot(fit.F, n=500, bins = c(0,170,300,350,500,600,900,3000,4580),         show=list(obs_dv=T),         ylab = \"Neutrophil Count (10^9/L)\", xlab = \"Time (h)\") #> [====|====|====|====|====|====|====|====|====|====] 0:00:05"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"load-the-data","dir":"Articles","previous_headings":"","what":"Load the data","title":"xgxr and ggPMX integration with nlmixr2","text":"","code":"pkpd_data <- case1_pkpd %>%   arrange(DOSE) %>%   select(-IPRED) %>%   mutate(TRTACT_low2high = factor(TRTACT, levels = unique(TRTACT)),          TRTACT_high2low = factor(TRTACT, levels = rev(unique(TRTACT))),          DAY_label = paste(\"Day\", PROFDAY),          DAY_label = ifelse(DAY_label == \"Day 0\",\"Baseline\",DAY_label))   pk_data <- pkpd_data %>%   filter(CMT == 2)  pk_data_cycle1 <- pk_data %>%   filter(CYCLE == 1)"},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"use-xgxr-for-simplified-concentration-over-time-colored-by-dose-mean---95-ci","dir":"Articles","previous_headings":"Exploratory analysis using ggplot and xgx helper functions","what":"Use xgxr for simplified concentration over time, colored by Dose, mean +/- 95% CI","title":"xgxr and ggPMX integration with nlmixr2","text":"Often exploring data worthwhile plot dose nominal time add 95% confidence interval. typical plot can cumbersome lack nice features xgxr can help . Note following helper functions: xgx_theme_set() sets theme black white color theme best practices xgxr. xgx_geom_ci() creates Confidence Interval mean plots simple interface. xgx_scale_y_log10() creates log-scale includes minor grids immediately show viewer plot semi-log plot without carefully examining y axis. xgx_scale_x_time_units() creates appropriate scale based times observed units use. also allows convert units easily right display. xgx_annote_status() adds DRAFT annotation often considered best practice data plots draft.  plot see mean concentrations confidence intervals stratified dose","code":"xgx_theme_set() # This uses black and white theme based on xgxr best                 # practices  # flag for labeling figures as draft status <- \"DRAFT\"  time_units_dataset <- \"hours\" time_units_plot    <- \"days\" trtact_label       <- \"Dose\" dose_label         <- \"Dose (mg)\" conc_label         <- \"Concentration (ng/ml)\"  auc_label          <- \"AUCtau (h.(ng/ml))\" concnorm_label     <- \"Normalized Concentration (ng/ml)/mg\" sex_label          <- \"Sex\" w100_label         <- \"WEIGHTB>100\" pd_label           <- \"FEV1 (mL)\" cens_label         <- \"Censored\"   ggplot(data = pk_data_cycle1, aes(x     = NOMTIME,                                   y     = LIDV,                                   group = DOSE,                                   color = TRTACT_high2low)) +     xgx_geom_ci(conf_level = 0.95) + # Easy CI with xgxr     xgx_scale_y_log10() + # semi-log plots with semi-log grid minor lines     xgx_scale_x_time_units(units_dataset = time_units_dataset,                            units_plot = time_units_plot) +     # The last line creates an appropriate x scale based on time-units     # and time unit scale     labs(y = conc_label, color = trtact_label) +     xgx_annotate_status(status) #  Adds draft status to plot"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"concentration-over-time-faceted-by-dose-mean---95-ci-overlaid-on-gray-spaghetti-plots","dir":"Articles","previous_headings":"Exploratory analysis using ggplot and xgx helper functions","what":"Concentration over time, faceted by Dose, mean +/- 95% CI, overlaid on gray spaghetti plots","title":"xgxr and ggPMX integration with nlmixr2","text":"useful look mean concentrations, often useful look mean concentrations relationship actual individual profiles. Using ggplot coupled xgxr helper functions used , can easily create plots well:  appears variability seems higher higher doses higher later times.","code":"ggplot(data = pk_data_cycle1, aes(x = TIME, y = LIDV)) +   geom_line(aes(group = ID), color = \"grey50\", size = 1, alpha = 0.3) +   geom_cens(aes(cens=CENS)) +    xgx_geom_ci(aes(x = NOMTIME, color = NULL, group = NULL, shape = NULL), conf_level = 0.95) +   xgx_scale_y_log10() +   xgx_scale_x_time_units(units_dataset = time_units_dataset, units_plot = time_units_plot) +   labs(y = conc_label, color = trtact_label) +   theme(legend.position = \"none\") +   facet_grid(.~TRTACT_low2high) +   xgx_annotate_status(status)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"exploring-the-dose-linearity","dir":"Articles","previous_headings":"Exploratory analysis using ggplot and xgx helper functions","what":"Exploring the dose linearity","title":"xgxr and ggPMX integration with nlmixr2","text":"common way explore dose linearity normalize dose. confidence intervals overlap, often dose linear example.  example seems dose-linear, exception censored data. can made even clear removing censored data plot:  lowest dose, censoring, one seems outlier. likely artifact censoring. ways explore data include looking normalized Cmax AUC values (skip vignette).","code":"ggplot(data = pk_data_cycle1,        aes(x = NOMTIME,            y = LIDV / as.numeric(as.character(DOSE)),            group = DOSE,            color = TRTACT_high2low)) +   xgx_geom_ci(conf_level = 0.95, alpha = 0.5, position = position_dodge(1)) +   xgx_scale_y_log10() +   xgx_scale_x_time_units(units_dataset = time_units_dataset, units_plot = time_units_plot) +   labs(y = concnorm_label, color = trtact_label) +   xgx_annotate_status(status) ggplot(data = pk_data_cycle1 %>% filter(CENS == 0),        aes(x = NOMTIME,            y = LIDV / as.numeric(as.character(DOSE)),            group = DOSE,            color = TRTACT_high2low)) +   xgx_geom_ci(conf_level = 0.95, alpha = 0.5, position = position_dodge(1)) +   xgx_scale_y_log10() +   xgx_scale_x_time_units(units_dataset = time_units_dataset, units_plot = time_units_plot) +   labs(y = concnorm_label, color = trtact_label) +   xgx_annotate_status(status)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"exploring-covariates-in-the-dataset","dir":"Articles","previous_headings":"","what":"Exploring Covariates in the dataset","title":"xgxr and ggPMX integration with nlmixr2","text":"Using xgx helper functions ggplot can explore effect high baseline weight. particular plot shown :  seems weight effect extreme either dose group","code":"ggplot(data = pk_data_cycle1, aes(x = NOMTIME,                                   y = LIDV,                                   group = WEIGHTB > 100,                                   color = WEIGHTB > 100)) +      xgx_geom_ci(conf_level = 0.95) +     xgx_scale_y_log10() +     xgx_scale_x_time_units(units_dataset = time_units_dataset, units_plot = time_units_plot) +     facet_grid(.~DOSE) +     labs(y = conc_label, color = w100_label) +     xgx_annotate_status(status)"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"summary-of-exploratory-analysis-findings","dir":"Articles","previous_headings":"Exploring Covariates in the dataset","what":"Summary of exploratory analysis findings","title":"xgxr and ggPMX integration with nlmixr2","text":"exploratory analysis see: - doses seem proportional - PK seems 2-compartment model - Censoring large effect PK data.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"fitting-the-data-with-nlmixr","dir":"Articles","previous_headings":"","what":"Fitting the data with nlmixr","title":"xgxr and ggPMX integration with nlmixr2","text":"First need subset PK data rename LIDV DV Next, purpose demostrtaion subset 7 patients per dose group): approach good demonstration, allows variety structural models applied quickly developing base model. full dataset can applied selected model make sure makes sense data. Next create 2 compartment model: Now parsing nlmixr model complete start compare models: Now run 3 different estimation methods, can compare results side--side Note additive proportional model additive component approach zero. comparing objective functions log-normal proportional models, proportional model lowest objective function value. (Since modeled log-normal without data transformation appropriate compare AIC/Objective function values)","code":"dat <- case1_pkpd %>%   rename(DV=LIDV) %>%   filter(CMT %in% 1:2) %>%   filter(TRTACT != \"Placebo\") doses <- unique(dat$DOSE) nid <- 7 # 7 ids per dose group dat2 <- do.call(\"rbind\",                 lapply(doses, function(x) {                   ids <- dat %>%                     filter(DOSE == x) %>%                     summarize(ids=unique(ID)) %>%                     pull()                   ids <- ids[seq(1, nid)]                   dat %>%                      filter(ID %in% ids)                 })) ## Use 2 compartment model cmt2 <- function(){   ini({     lka <- log(0.1) # log Ka     lv <- log(10) # Log Vc     lcl <- log(4) # Log Cl     lq <- log(10) # log Q     lvp <- log(20) # Log Vp      eta.ka ~ 0.01     eta.v ~ 0.1     eta.cl ~ 0.1     logn.sd = 10   })   model({     ka <- exp(lka + eta.ka)     cl <- exp(lcl + eta.cl)     v <- exp(lv + eta.v)     q <- exp(lq)     vp <- exp(lvp)     linCmt() ~ lnorm(logn.sd)   }) }  ## Check parsing cmt2m <- nlmixr(cmt2) print(cmt2m) #>  ── rxode2-based solved PK 2-compartment model with first-order absorption ──────  #>  ── Initalization: ──   #> Fixed Effects ($theta):  #>       lka        lv       lcl        lq       lvp   logn.sd  #> -2.302585  2.302585  1.386294  2.302585  2.995732 10.000000  #>  #> Omega ($omega):  #>        eta.ka eta.v eta.cl #> eta.ka   0.01   0.0    0.0 #> eta.v    0.00   0.1    0.0 #> eta.cl   0.00   0.0    0.1 #>  ── μ-referencing ($muRefTable): ──   #>   theta    eta level #> 1   lka eta.ka    id #> 2   lcl eta.cl    id #> 3    lv  eta.v    id #>  #>  ── Model (Normalized Syntax): ──  #> function() { #>     ini({ #>         lka <- -2.30258509299405 #>         label(\"log Ka\") #>         lv <- 2.30258509299405 #>         label(\"Log Vc\") #>         lcl <- 1.38629436111989 #>         label(\"Log Cl\") #>         lq <- 2.30258509299405 #>         label(\"log Q\") #>         lvp <- 2.99573227355399 #>         label(\"Log Vp\") #>         logn.sd <- c(0, 10) #>         eta.ka ~ 0.01 #>         eta.v ~ 0.1 #>         eta.cl ~ 0.1 #>     }) #>     model({ #>         ka <- exp(lka + eta.ka) #>         cl <- exp(lcl + eta.cl) #>         v <- exp(lv + eta.v) #>         q <- exp(lq) #>         vp <- exp(lvp) #>         linCmt() ~ lnorm(logn.sd) #>     }) #> } ## First try log-normal (since the variability seemed proportional to concentration) cmt2fit.logn <- nlmixr(cmt2m, dat2, \"saem\",                        control=list(print=0),                         table=tableControl(cwres=TRUE, npde=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  ## Now try proportional cmt2fit.prop <- cmt2fit.logn %>%     update(linCmt() ~ prop(prop.sd)) %>%     nlmixr(est=\"saem\", control=list(print=0),            table=tableControl(npde=TRUE, cwres=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  ## now try add+prop cmt2fit.add.prop <- cmt2fit.prop %>%     update(linCmt() ~ prop(prop.sd) + add(add.sd)) %>%     nlmixr(est=\"saem\", control=list(print=0),             table=tableControl(npde=TRUE, cwres=TRUE)) #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00  #>  #> [====|====|====|====|====|====|====|====|====|====] 0:00:00 library(huxtable)  huxreg(\"lognormal\"=cmt2fit.logn, \"proportional\"=cmt2fit.prop, \"add+prop\"=cmt2fit.add.prop,        statistics=c(N=\"nobs\", \"logLik\", \"AIC\"))"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"model-diagnostics-with-ggpmx","dir":"Articles","previous_headings":"","what":"Model Diagnostics with ggPMX","title":"xgxr and ggPMX integration with nlmixr2","text":"creates two reports default settings, pdf word document. report can customized editing default template include project specificities (change labels, stratifications, filtering, etc.).    creates two reports default settings, pdf word document. report can customized editing default template include project specificities (change labels, stratifications, filtering, etc.).","code":"## The controller then can be piped into a specific plot ctr <- pmx_nlmixr(cmt2fit.logn, conts = c(\"WEIGHTB\"), cats=\"TRTACT\", vpc=TRUE) ctr %>% pmx_plot_npde_pred ## Modify graphical options and remove DRAFT label: ctr %>% pmx_plot_npde_time(smooth = list(color=\"blue\"), point = list(shape=4), is.draft=FALSE,                             labels = list(x = \"Time after first dose (days)\", y = \"Normalized PDE\")) ctr %>% pmx_plot_dv_ipred(scale_x_log10=TRUE, scale_y_log10=TRUE,filter=IPRED>0.001) ctr %>% pmx_plot_dv_pred(scale_x_log10=TRUE, scale_y_log10=TRUE,filter=IPRED>0.001) ctr %>% pmx_plot_abs_iwres_ipred ## For this display only show 1x1 individual plot for ID 110 for time < 12 ctr %>% pmx_plot_individual(1, filter=ID == 31 & TIME > 0 & TIME < 12,                              facets = list(nrow = 1, ncol = 1)) ctr %>% pmx_plot_iwres_dens ctr %>% pmx_plot_eta_qq ctr %>% pmx_plot_eta_box ctr %>% pmx_plot_eta_hist ctr %>% pmx_plot_eta_matrix ctr %>% pmx_plot_eta_matrix"},{"path":"https://nlmixr2.github.io/nlmixr2/articles/xgxr-nlmixr-ggpmx.html","id":"simulation-of-a-new-scenario-with-rxode2","dir":"Articles","previous_headings":"","what":"Simulation of a new scenario with rxode2","title":"xgxr and ggPMX integration with nlmixr2","text":"creating events can simply simulate new scenario. Perhaps drug development team wants explore 100 mg dose 3 times day dosing see happens PK. can simply simulate nlmixr model using new event table created rxode2(). case wish simulate variability see happens steady state: nlmixr model already includes information parameter estimates can simulate without uncertainty population parameters covariances, like done VPC. wish simulate 100 patients repeated 100 different theoretical studies simulate uncertainty fixed parameter estimates covariances can easily nlmixr2/rxode2: may examine simulated study information easily, show rxode2() printout: can also see covariance matricies simulated (note come inverse Wishart distribution): also easy enough create plot see going simulation:   complex simulations variability can also simulate dosing windows sampling windows use tool want summarize way wish.","code":"# Start a new simulation (ev <- et(amt=100, ii=8, ss=1)) ev$add.sampling(seq(0, 8, length.out=50)) print(ev) #> ── EventTable with 51 records ── #> 1 dosing records (see $get.dosing(); add with add.dosing or et) #> 50 observation times (see $get.sampling(); add with add.sampling or et) #> ── First part of : ── #> # A tibble: 51 × 5 #>     time   amt    ii evid             ss #>    <dbl> <dbl> <dbl> <evid>        <int> #>  1 0        NA    NA 0:Observation    NA #>  2 0       100     8 1:Dose (Add)      1 #>  3 0.163    NA    NA 0:Observation    NA #>  4 0.327    NA    NA 0:Observation    NA #>  5 0.490    NA    NA 0:Observation    NA #>  6 0.653    NA    NA 0:Observation    NA #>  7 0.816    NA    NA 0:Observation    NA #>  8 0.980    NA    NA 0:Observation    NA #>  9 1.14     NA    NA 0:Observation    NA #> 10 1.31     NA    NA 0:Observation    NA #> # … with 41 more rows set.seed(100) sim1 <- rxSolve(cmt2fit.logn, ev, nSub=100, nStud=100) print(sim1) #> ── Solved rxode2 object ── #> ── Parameters ($params): ── #> # A tibble: 10,000 × 10 #>    sim.id   lka    lv   lcl    lq   lvp logn.sd eta.ka    eta.v  eta.cl #>     <int> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>  <dbl>    <dbl>   <dbl> #>  1      1 -1.15 0.984  2.14  2.51  4.63   0.352  0.356  0.103    0.435  #>  2      2 -1.15 0.984  2.14  2.51  4.63   0.352 -0.618 -0.00364  0.0610 #>  3      3 -1.15 0.984  2.14  2.51  4.63   0.352  0.239  0.00271  0.694  #>  4      4 -1.15 0.984  2.14  2.51  4.63   0.352 -0.525  0.261   -0.506  #>  5      5 -1.15 0.984  2.14  2.51  4.63   0.352  0.492 -1.22     0.579  #>  6      6 -1.15 0.984  2.14  2.51  4.63   0.352 -1.20   0.144    0.214  #>  7      7 -1.15 0.984  2.14  2.51  4.63   0.352 -2.10  -0.829    0.165  #>  8      8 -1.15 0.984  2.14  2.51  4.63   0.352 -0.920  0.272   -0.744  #>  9      9 -1.15 0.984  2.14  2.51  4.63   0.352  1.32  -0.136    0.269  #> 10     10 -1.15 0.984  2.14  2.51  4.63   0.352 -0.553 -0.596   -0.428  #> # … with 9,990 more rows #> ── Initial Conditions ($inits): ── #> named numeric(0) #>  #> Simulation with uncertainty in: #> • parameters ($thetaMat for changes) #> • omega matrix ($omegaList) #> • sigma matrix ($sigmaList) #>  #> ── First part of data (object): ── #> # A tibble: 500,000 × 9 #>   sim.id  time    ka    cl     v     q    vp ipredSim   sim #>    <int> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl> <dbl> #> 1      1 0     0.451  13.2  2.97  12.3  103.    0.460 0.559 #> 2      1 0.163 0.451  13.2  2.97  12.3  103.    1.73  1.85  #> 3      1 0.327 0.451  13.2  2.97  12.3  103.    1.96  2.03  #> 4      1 0.490 0.451  13.2  2.97  12.3  103.    1.93  1.81  #> 5      1 0.653 0.451  13.2  2.97  12.3  103.    1.86  2.23  #> 6      1 0.816 0.451  13.2  2.97  12.3  103.    1.77  0.884 #> # … with 499,994 more rows head(sim1$thetaMat) #>             lka         lv          lcl          lq          lvp #> [1,] 0.14624398 -0.4086970  0.148948234 -0.12286484 -0.013141442 #> [2,] 0.29754673  0.2877020 -0.140145807  0.18035533  0.053950443 #> [3,] 0.16599788  0.3947279  0.122784513  0.12342623  0.016885174 #> [4,] 0.10627425 -0.3509796  0.063974342  0.05341122  0.036445560 #> [5,] 0.07925247  0.1569209 -0.008418402  0.16874062  0.042176966 #> [6,] 0.03858317 -0.4124237 -0.078408241 -0.06939259  0.006522178 head(sim1$omegaList) #> [[1]] #>             eta.ka       eta.v      eta.cl #> eta.ka  0.75723787 -0.03941287  0.07129737 #> eta.v  -0.03941287  2.24018382 -0.14698494 #> eta.cl  0.07129737 -0.14698494  0.66321303 #>  #> [[2]] #>            eta.ka      eta.v     eta.cl #> eta.ka  0.6265270 -0.1501761  0.1045931 #> eta.v  -0.1501761  2.5019886 -0.2344552 #> eta.cl  0.1045931 -0.2344552  0.6103688 #>  #> [[3]] #>            eta.ka      eta.v     eta.cl #> eta.ka  0.6261422 -0.3484433  0.1426269 #> eta.v  -0.3484433  3.1009407 -0.2637253 #> eta.cl  0.1426269 -0.2637253  0.6613656 #>  #> [[4]] #>            eta.ka     eta.v     eta.cl #> eta.ka 0.40814990 0.1640374 0.07279401 #> eta.v  0.16403739 2.7727074 0.18381331 #> eta.cl 0.07279401 0.1838133 0.80266640 #>  #> [[5]] #>             eta.ka       eta.v     eta.cl #> eta.ka  0.60279063 -0.09658454 0.08482646 #> eta.v  -0.09658454  2.78250394 0.06074504 #> eta.cl  0.08482646  0.06074504 0.78717652 #>  #> [[6]] #>             eta.ka      eta.v      eta.cl #> eta.ka  0.48381282 -0.2021803  0.02843517 #> eta.v  -0.20218033  2.5771963 -0.26188336 #> eta.cl  0.02843517 -0.2618834  0.57036416 head(sim1$sigmaList) #> [[1]] #>              err.rxLinCmt #> err.rxLinCmt    0.9855042 #>  #> [[2]] #>              err.rxLinCmt #> err.rxLinCmt     1.050166 #>  #> [[3]] #>              err.rxLinCmt #> err.rxLinCmt     1.029402 #>  #> [[4]] #>              err.rxLinCmt #> err.rxLinCmt     1.042186 #>  #> [[5]] #>              err.rxLinCmt #> err.rxLinCmt    0.9566666 #>  #> [[6]] #>              err.rxLinCmt #> err.rxLinCmt     1.044673 conf <- confint(sim1, \"sim\")  p1 <- plot(conf) ## This returns a ggplot2 object  ## you can tweak the plot by the standard ggplot commands p1 + xlab(\"Time (hr)\") +    ylab(\"Simulated Concentrations of TID steady state\") # And put the same plot on a semi-log plot p1 + xlab(\"Time (hr)\") +    ylab(\"Simulated Concentrations of TID steady state\") +   xgx_scale_y_log10()"},{"path":"https://nlmixr2.github.io/nlmixr2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matthew Fidler. Author, maintainer. Yuan Xiong. Contributor. Rik Schoemaker. Contributor. Justin Wilkins. Contributor. Wenping Wang. Author. Mirjam Trame. Contributor. Huijan Xu. Contributor. John Harrold. Contributor. Bill Denney. Contributor. Theodoros Papathanasiou. Contributor. Teun Post. Contributor. Richard Hooijmaijers. Contributor.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Fidler M, Wang W (2022). nlmixr2: Nonlinear Mixed Effects Models Population PK/PD. https://nlmixr2.github.io/nlmixr2/, https://github.com/nlmixr2/nlmixr2/.","code":"@Manual{,   title = {nlmixr2: Nonlinear Mixed Effects Models in Population PK/PD},   author = {Matthew Fidler and Wenping Wang},   year = {2022},   note = {https://nlmixr2.github.io/nlmixr2/, https://github.com/nlmixr2/nlmixr2/}, }"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"nlmixr2","dir":"","previous_headings":"","what":"Nonlinear Mixed Effects Models in Population PK/PD","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"goal nlmixr2 support easy robust nonlinear mixed effects models R","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"can install development version nlmixr2 nlmixr2-family dependencies like : Optional supporting packages can installed like :","code":"remotes::install_github(\"nlmixr2/nlmixr2data\") remotes::install_github(\"nlmixr2/lotri\") remotes::install_github(\"nlmixr2/rxode2\") remotes::install_github(\"nlmixr2/nlmixr2est\") remotes::install_github(\"nlmixr2/nlmixr2extra\") remotes::install_github(\"nlmixr2/nlmixr2plot\") remotes::install_github(\"nlmixr2/nlmixr2\") remotes::install_github(\"ggPMXdevelopment/ggPMX\") # Goodness of fit plots remotes::install_github(\"nlmixr2/xpose.nlmixr\") # Additional goodness of fit plots remotes::install_github(\"RichardHooijmaijers/shinyMixR\") # Shiny run manager (like Piranha) remotes::install_github(\"nlmixr2/nlmixr2targets\") # Simplify work with the `targets` package"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"basic example shows solve common problem:","code":"library(nlmixr2) #> Loading required package: nlmixr2data  ## The basic model consiss of an ini block that has initial estimates one.compartment <- function() {   ini({     tka <- 0.45 # Log Ka     tcl <- 1 # Log Cl     tv <- 3.45    # Log V     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   # and a model block with the error sppecification and model specification   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     d/dt(depot) = -ka * depot     d/dt(center) = ka * depot - cl / v * center     cp = center / v     cp ~ add(add.sd)   }) }  ## The fit is performed by the function nlmixr/nlmix2 specifying the model, data and estimate fit <- nlmixr2(one.compartment, theo_sd,  est=\"saem\", saemControl(print=0)) #>  #>   #>  #> ℹ parameter labels from comments will be replaced by 'label()' #>  #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of saem model... #> ✔ done #> → finding duplicate expressions in saem model... #> → optimizing duplicate expressions in saem model... #> ✔ done #> rxode2 2.0.6 using 4 threads (see ?getRxThreads) #> Calculating covariance matrix #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of saem model... #> ✔ done #> → finding duplicate expressions in saem predOnly model 0... #> → finding duplicate expressions in saem predOnly model 1... #> → optimizing duplicate expressions in saem predOnly model 1... #> → finding duplicate expressions in saem predOnly model 2... #> ✔ done #>  #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 5952 #> → compress phiM in nlmixr2 object, save 62360 #> → compress parHist in nlmixr2 object, save 9408 #> → compress saem0 in nlmixr2 object, save 23176 print(fit) #> ── nlmixr SAEM OBJF by FOCEi approximation ── #>  #>  Gaussian/Laplacian Likelihoods: AIC() or $objf etc.  #>  FOCEi CWRES & Likelihoods: addCwres()  #>  #> ── Time (sec $time): ── #>  #>            setup covariance  saem table compress    other #> elapsed 0.001318   0.008003 2.544 0.026    0.019 1.722679 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka       Log Ka 0.454  0.196 43.1       1.57 (1.07, 2.31)     71.5   -0.0203%  #> tcl       Log Cl  1.02 0.0853  8.4       2.76 (2.34, 3.26)     27.6      3.46%  #> tv         Log V  3.45 0.0454 1.32       31.5 (28.8, 34.4)     13.4      9.89%  #> add.sd           0.693                               0.693                      #>   #>   Covariance Type ($covMethod): linFim #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 19 #>   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    cp #>   <fct> <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl>   <dbl> <dbl> #> 1 1      0     0.74  0     0.74   0     0.74   1.07   0.103 -0.491 -0.0820  0    #> 2 1      0.25  2.84  3.27 -0.426  3.87 -1.03  -1.48   0.103 -0.491 -0.0820  3.87 #> 3 1      0.57  6.57  5.85  0.723  6.82 -0.246 -0.356  0.103 -0.491 -0.0820  6.82 #> # … with 129 more rows, and 7 more variables: depot <dbl>, center <dbl>, #> #   ka <dbl>, cl <dbl>, v <dbl>, tad <dbl>, dosenum <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/index.html","id":"default-plots","dir":"","previous_headings":"","what":"Default plots","title":"Nonlinear Mixed Effects Models in Population PK/PD","text":"","code":"plot(fit) #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous y-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis #> Warning: Transformation introduced infinite values in continuous x-axis"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addCwres.html","id":null,"dir":"Reference","previous_headings":"","what":"Add CWRES — addCwres","title":"Add CWRES — addCwres","text":"returns new fit object CWRES attached","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addCwres.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add CWRES — addCwres","text":"","code":"addCwres(fit, focei = TRUE, updateObject = TRUE, envir = parent.frame(1))"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addCwres.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add CWRES — addCwres","text":"fit nlmixr2 fit without WRES/CWRES focei Boolean indicating focei objective function added.  foce objective function added. updateObject Boolean indicating original fit object updated. default true. envir Environment checked object update.  default global environment.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addCwres.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add CWRES — addCwres","text":"fit CWRES","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addCwres.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Add CWRES — addCwres","text":"Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addCwres.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add CWRES — addCwres","text":"","code":"# \\donttest{  one.cmt <- function() {   ini({     ## You may label each parameter with a comment     tka <- 0.45 # Log Ka     tcl <- log(c(0, 2.7, 100)) # Log Cl     ## This works with interactive models     ## You may also label the preceding line with label(\"label text\")     tv <- 3.45; label(\"log V\")     ## the label(\"Label name\") works with all models     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     linCmt() ~ add(add.sd)   }) }  f <- try(nlmixr2(one.cmt, theo_sd, \"saem\")) #>   #>   #>   #> ℹ parameter labels from comments will be replaced by 'label()' #>   #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of saem model... #> ✔ done #> → finding duplicate expressions in saem model... #> ✔ done #> params:\ttka\ttcl\ttv\tV(eta.ka)\tV(eta.cl)\tV(eta.v)\tadd.sd #> rxode2 2.0.6 using 1 threads (see ?getRxThreads) #>   no cache: create with `rxCreateCache()` #> Calculating covariance matrix #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of saem model... #> ✔ done #> → finding duplicate expressions in saem predOnly model 0... #> → finding duplicate expressions in saem predOnly model 1... #> → finding duplicate expressions in saem predOnly model 2... #> ✔ done #>   #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 5952 #> → compress phiM in nlmixr2 object, save 63664 #> → compress parHist in nlmixr2 object, save 9392 #> → compress saem0 in nlmixr2 object, save 22896  print(f) #> ── nlmixr SAEM OBJF by FOCEi approximation ── #>  #>  Gaussian/Laplacian Likelihoods: AIC() or $objf etc.  #>  FOCEi CWRES & Likelihoods: addCwres()  #>  #> ── Time (sec $time): ── #>  #>            setup covariance  saem table compress    other #> elapsed 0.002192   0.037007 1.695 0.028    0.025 3.244801 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka       Log Ka 0.453  0.195 43.1       1.57 (1.07, 2.31)     71.4    -0.445%  #> tcl       Log Cl  1.02 0.0843 8.29       2.76 (2.34, 3.26)     27.2      3.88%  #> tv         log V  3.45 0.0467 1.35       31.5 (28.8, 34.5)     13.9      10.2%  #> add.sd           0.695                               0.695                      #>   #>   Covariance Type ($covMethod): linFim #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 16 #>   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    ka #>   <fct> <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl>   <dbl> <dbl> #> 1 1      0     0.74  0     0.74   0     0.74   1.07   0.107 -0.485 -0.0809  1.75 #> 2 1      0.25  2.84  3.26 -0.424  3.87 -1.03  -1.49   0.107 -0.485 -0.0809  1.75 #> 3 1      0.57  6.57  5.84  0.726  6.82 -0.250 -0.360  0.107 -0.485 -0.0809  1.75 #> # … with 129 more rows, and 4 more variables: cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>  # even though you may have forgotten to add the cwres, you can add it to the data.frame:  if (!inherits(f, \"try-error\")) {   f <- try(addCwres(f))   print(f) } #>   #>   #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of full model... #> ✔ done #> → calculate jacobian #> → calculate ∂(f)/∂(η) #> → calculate ∂(R²)/∂(η) #> → finding duplicate expressions in inner model... #> → optimizing duplicate expressions in inner model... #> → finding duplicate expressions in EBE model... #> → optimizing duplicate expressions in EBE model... #> → compiling inner model... #>   #> ✔ done #> → finding duplicate expressions in FD model... #> → compiling EBE model... #>   #> ✔ done #> → compiling events FD model... #>   #> ✔ done #> → Calculating residuals/tables #> ✔ done #> ── nlmixr SAEM OBJF by FOCEi approximation ── #>  #>           OBJF      AIC      BIC Log-likelihood Condition Number #> FOCEi 116.9949 373.5947 393.7743      -179.7973         18.15903 #>  #> ── Time (sec $time): ── #>  #>            setup covariance  saem table compress    other #> elapsed 0.002192   0.037007 1.695 0.028    0.025 3.244801 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka       Log Ka 0.453  0.195 43.1       1.57 (1.07, 2.31)     71.4    -0.445%  #> tcl       Log Cl  1.02 0.0843 8.29       2.76 (2.34, 3.26)     27.2      3.88%  #> tv         log V  3.45 0.0467 1.35       31.5 (28.8, 34.5)     13.9      10.2%  #> add.sd           0.695                               0.695                      #>   #>   Covariance Type ($covMethod): linFim #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 20 #>   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    ka #>   <fct> <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl>   <dbl> <dbl> #> 1 1      0     0.74  0     0.74   0     0.74   1.07   0.107 -0.485 -0.0809  1.75 #> 2 1      0.25  2.84  3.26 -0.424  3.87 -1.03  -1.49   0.107 -0.485 -0.0809  1.75 #> 3 1      0.57  6.57  5.84  0.726  6.82 -0.250 -0.360  0.107 -0.485 -0.0809  1.75 #> # … with 129 more rows, and 8 more variables: cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>, WRES <dbl>, CPRED <dbl>, CRES <dbl>, CWRES <dbl>  # Note this also adds the FOCEi objective function # }"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addNpde.html","id":null,"dir":"Reference","previous_headings":"","what":"NPDE calculation for nlmixr2 — addNpde","title":"NPDE calculation for nlmixr2 — addNpde","text":"NPDE calculation nlmixr2","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addNpde.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"NPDE calculation for nlmixr2 — addNpde","text":"","code":"addNpde(   object,   updateObject = TRUE,   table = tableControl(),   ...,   envir = parent.frame(1) )"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addNpde.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"NPDE calculation for nlmixr2 — addNpde","text":"object nlmixr2 fit object updateObject Boolean indicating original object updated.  default TRUE. table `tableControl()` list options ... Additional arguments passed nlmixr2est::addNpde(). envir Environment checked object update.  default global environment.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addNpde.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"NPDE calculation for nlmixr2 — addNpde","text":"New nlmixr2 fit object","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addNpde.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"NPDE calculation for nlmixr2 — addNpde","text":"Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addNpde.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"NPDE calculation for nlmixr2 — addNpde","text":"","code":"# \\donttest{  one.cmt <- function() {   ini({     ## You may label each parameter with a comment     tka <- 0.45 # Log Ka     tcl <- log(c(0, 2.7, 100)) # Log Cl     ## This works with interactive models     ## You may also label the preceding line with label(\"label text\")     tv <- 3.45; label(\"log V\")     ## the label(\"Label name\") works with all models     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     linCmt() ~ add(add.sd)   }) }  f <- nlmixr2(one.cmt, theo_sd, \"saem\") #>   #>   #>   #> ℹ parameter labels from comments will be replaced by 'label()' #>   #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of saem model... #> ✔ done #> → finding duplicate expressions in saem model... #> ✔ done #> params:\ttka\ttcl\ttv\tV(eta.ka)\tV(eta.cl)\tV(eta.v)\tadd.sd #> Calculating covariance matrix #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of saem model... #> ✔ done #> → finding duplicate expressions in saem predOnly model 0... #> → finding duplicate expressions in saem predOnly model 1... #> → finding duplicate expressions in saem predOnly model 2... #> ✔ done #>   #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 5952 #> → compress phiM in nlmixr2 object, save 63664 #> → compress parHist in nlmixr2 object, save 9392 #> → compress saem0 in nlmixr2 object, save 23480  # even though you may have forgotten to add the NPDE, you can add it to the data.frame:  f <- addNpde(f) #> → Add NPDE #>   #> ✔ done  # }"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addTable.html","id":null,"dir":"Reference","previous_headings":"","what":"Add table information to nlmixr2 fit object without tables — addTable","title":"Add table information to nlmixr2 fit object without tables — addTable","text":"Add table information nlmixr2 fit object without tables","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addTable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add table information to nlmixr2 fit object without tables — addTable","text":"","code":"addTable(   object,   updateObject = FALSE,   data = object$dataSav,   thetaEtaParameters = object$foceiThetaEtaParameters,   table = tableControl(),   keep = NULL,   drop = NULL,   envir = parent.frame(1) )"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addTable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add table information to nlmixr2 fit object without tables — addTable","text":"object nlmixr2 family objects updateObject Update object (default FALSE) data Saved data thetaEtaParameters Internal theta/eta parameters table `tableControl()` list options keep Character Vector items keep drop Character Vector items drop NULL envir Environment search updating","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addTable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add table information to nlmixr2 fit object without tables — addTable","text":"Fit table information attached","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addTable.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Add table information to nlmixr2 fit object without tables — addTable","text":"Matthew Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/addTable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add table information to nlmixr2 fit object without tables — addTable","text":"","code":"# \\donttest{  one.cmt <- function() {   ini({     ## You may label each parameter with a comment     tka <- 0.45 # Log Ka     tcl <- log(c(0, 2.7, 100)) # Log Cl     ## This works with interactive models     ## You may also label the preceding line with label(\"label text\")     tv <- 3.45; label(\"log V\")     ## the label(\"Label name\") works with all models     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     linCmt() ~ add(add.sd)   }) }  # run without tables step f <- nlmixr2(one.cmt, theo_sd, \"saem\", control=list(calcTables=FALSE)) #>   #>   #>   #> ℹ parameter labels from comments will be replaced by 'label()' #>   #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of saem model... #> ✔ done #> → finding duplicate expressions in saem model... #> ✔ done #> params:\ttka\ttcl\ttv\tV(eta.ka)\tV(eta.cl)\tV(eta.v)\tadd.sd #> Calculating covariance matrix #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of saem model... #> ✔ done #> → finding duplicate expressions in saem predOnly model 0... #> → finding duplicate expressions in saem predOnly model 1... #> → finding duplicate expressions in saem predOnly model 2... #> ✔ done #>   #> → compress origData in nlmixr2 object, save 5952 #> → compress phiM in nlmixr2 object, save 63664 #> → compress parHist in nlmixr2 object, save 9392 #> → compress saem0 in nlmixr2 object, save 24648  print(f) #> ── nlmixr SAEM OBJF by FOCEi approximation ── #>  #>  Gaussian/Laplacian Likelihoods: AIC() or $objf etc.  #>  FOCEi CWRES & Likelihoods: addCwres()  #>  #> ── Time (sec $time): ── #>  #>            setup covariance  saem compress    other #> elapsed 0.001914   0.008008 1.175    0.025 1.398078 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka       Log Ka 0.453  0.195 43.1       1.57 (1.07, 2.31)     71.4    -0.445%  #> tcl       Log Cl  1.02 0.0843 8.29       2.76 (2.34, 3.26)     27.2      3.88%  #> tv         log V  3.45 0.0467 1.35       31.5 (28.8, 34.5)     13.9      10.2%  #> add.sd           0.695                               0.695                      #>   #>   Covariance Type ($covMethod): linFim #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink   # Now add the tables  f <- addTable(f) #> → Calculating residuals/tables #> ✔ done  print(f) #> ── nlmixr SAEM OBJF by FOCEi approximation ── #>  #>  Gaussian/Laplacian Likelihoods: AIC() or $objf etc.  #>  FOCEi CWRES & Likelihoods: addCwres()  #>  #> ── Time (sec $time): ── #>  #>            setup covariance  saem compress    other #> elapsed 0.001914   0.008008 1.175    0.025 1.398078 #>  #> ── Population Parameters ($parFixed or $parFixedDf): ── #>  #>        Parameter  Est.     SE %RSE Back-transformed(95%CI) BSV(CV%) Shrink(SD)% #> tka       Log Ka 0.453  0.195 43.1       1.57 (1.07, 2.31)     71.4    -0.445%  #> tcl       Log Cl  1.02 0.0843 8.29       2.76 (2.34, 3.26)     27.2      3.88%  #> tv         log V  3.45 0.0467 1.35       31.5 (28.8, 34.5)     13.9      10.2%  #> add.sd           0.695                               0.695                      #>   #>   Covariance Type ($covMethod): linFim #>   No correlations in between subject variability (BSV) matrix #>   Full BSV covariance ($omega) or correlation ($omegaR; diagonals=SDs)  #>   Distribution stats (mean/skewness/kurtosis/p-value) available in $shrink  #>  #> ── Fit Data (object is a modified tibble): ── #> # A tibble: 132 × 16 #>   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    ka #>   <fct> <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl>  <dbl>  <dbl>   <dbl> <dbl> #> 1 1      0     0.74  0     0.74   0     0.74   1.07   0.107 -0.485 -0.0809  1.75 #> 2 1      0.25  2.84  3.26 -0.424  3.87 -1.03  -1.49   0.107 -0.485 -0.0809  1.75 #> 3 1      0.57  6.57  5.84  0.726  6.82 -0.250 -0.360  0.107 -0.485 -0.0809  1.75 #> # … with 129 more rows, and 4 more variables: cl <dbl>, v <dbl>, tad <dbl>, #> #   dosenum <dbl>  # }"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Produce delta objective function for boostrap — bootplot","title":"Produce delta objective function for boostrap — bootplot","text":"Produce delta objective function boostrap","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produce delta objective function for boostrap — bootplot","text":"","code":"bootplot(x, ...)"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produce delta objective function for boostrap — bootplot","text":"x fit object ... Additional arguments passed nlmixr2extra::bootplot().","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produce delta objective function for boostrap — bootplot","text":"Fit traceplot nothing.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootplot.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Produce delta objective function for boostrap — bootplot","text":"R Niebecker,  MO Karlsson. (2013) datasets NLME models large enough bootstrap provide reliable parameter uncertainty distributions? PAGE 2013. https://www.page-meeting.org/?abstract=2899","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootplot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Produce delta objective function for boostrap — bootplot","text":"Vipul Mann,  Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootstrapFit.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrap nlmixr2 fit — bootstrapFit","title":"Bootstrap nlmixr2 fit — bootstrapFit","text":"Bootstrap input dataset rerun model get confidence bounds aggregated parameters","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootstrapFit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrap nlmixr2 fit — bootstrapFit","text":"","code":"bootstrapFit(   fit,   nboot = 200,   nSampIndiv,   stratVar,   stdErrType = c(\"perc\", \"se\"),   ci = 0.95,   pvalues = NULL,   restart = FALSE,   plotHist = FALSE,   fitName = as.character(substitute(fit)) )"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootstrapFit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrap nlmixr2 fit — bootstrapFit","text":"fit nlmixr2 fit object nboot integer giving number bootstrapped models fit; default value 200 nSampIndiv integer specifying number samples bootstrapped sample; default number unique subjects original dataset stratVar Variable original dataset stratify ; useful distinguish sparse full sampling features may wish keep distinct bootstrap stdErrType gives standard error type updated standard errors; current possibilities : \"perc\" gives standard errors percentiles (default) \"se\" gives standard errors traditional formula. ci Confidence interval level calculate.  Default 0.95 95 percent confidence interval pvalues vector pvalues indicating probability subject get selected; default value NULL implying probability subject restart boolean try restart interrupted incomplete boostrap.  default FALSE plotHist boolean indicating histogram plot assess well bootstrap .  default turned (FALSE) fitName fit name used name boostrap files.  default fit provided though something else.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootstrapFit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bootstrap nlmixr2 fit — bootstrapFit","text":"Nothing, called side effects; original fit updated bootstrap confidence bands","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootstrapFit.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bootstrap nlmixr2 fit — bootstrapFit","text":"Vipul Mann, Matthew Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/bootstrapFit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bootstrap nlmixr2 fit — bootstrapFit","text":"","code":"# \\donttest{  one.cmt <- function() {   ini({     ## You may label each parameter with a comment     tka <- 0.45 # Log Ka     tcl <- 1 # Log Cl     ## This works with interactive models     ## You may also label the preceding line with label(\"label text\")     tv <- 3.45     label(\"log V\")     ## the label(\"Label name\") works with all models     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     linCmt() ~ add(add.sd)   }) }  fit <- nlmixr2(one.cmt, nlmixr2data::theo_sd, \"focei\") #>   #>   #>   #> ℹ parameter labels from comments will be replaced by 'label()' #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 5952 #> → compress parHist in nlmixr2 object, save 2024 #> Warning: gradient problems with initial estimate and covariance; see $scaleInfo #> Warning: last objective function was not at minimum, possible problems in optimization #> Warning: ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.)) #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  withr::with_tempdir({ # Run example in temp dir  bootstrapFit(fit, nboot = 5, restart = TRUE) # overwrites any of the existing data or model files bootstrapFit(fit, nboot = 7) # resumes fitting using the stored data and model files  # Note this resumes because the total number of bootstrap samples is not 50  bootstrapFit(fit, nboot=50)  # Note the boostrap standard error and variance/covariance matrix is retained. # If you wish to switch back you can change the covariance matrix by  nlmixr2est::setCov(fit,\"r,s\")  # And change it back again  nlmixr2est::setCov(fit,\"boot50\")  # This change will affect any simulations with uncertainty in their parameters  # You may also do a chi-square diagnostic plot check for the bootstrap with  bootplot(fit)  }) #>  #> ── Running nlmixr2 for model index: 1 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 2 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 3 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 4 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 5 ────────────────────────────────────────── #>   #>   #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of full model... #> ✔ done #> → calculate jacobian #> → calculate ∂(f)/∂(η) #> → finding duplicate expressions in inner model... #> → optimizing duplicate expressions in inner model... #> → finding duplicate expressions in EBE model... #> → optimizing duplicate expressions in EBE model... #> → compiling inner model... #>   #> ✔ done #> → finding duplicate expressions in FD model... #> → compiling EBE model... #>   #> ✔ done #> → compiling events FD model... #>   #> ✔ done #> → compress origData in nlmixr2 object, save 5952 #> Updated original fit object fit #> ✔ resuming bootstrap data sampling using data at ./nlmixr2BootstrapCache_fit_d24853598216a0695834adad6c62ff0e #> ✔ resuming bootstrap model fitting using data and models stored at /tmp/RtmpSr2Jlq/file39ec41dc6a25/nlmixr2BootstrapCache_fit_d24853598216a0695834adad6c62ff0e #>  #> ── Running nlmixr2 for model index: 6 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 7 ────────────────────────────────────────── #>   #>   #> → compress origData in nlmixr2 object, save 5952 #> Updated original fit object fit #> ✔ resuming bootstrap data sampling using data at ./nlmixr2BootstrapCache_fit_d24853598216a0695834adad6c62ff0e #> ✔ resuming bootstrap model fitting using data and models stored at /tmp/RtmpSr2Jlq/file39ec41dc6a25/nlmixr2BootstrapCache_fit_d24853598216a0695834adad6c62ff0e #>  #> ── Running nlmixr2 for model index: 8 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 9 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 10 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 11 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 12 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 13 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 14 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 15 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 16 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 17 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 18 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 19 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 20 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 21 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 22 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 23 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 24 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 25 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 26 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 27 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 28 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 29 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 30 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 31 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 32 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 33 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 34 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 35 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 36 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 37 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 38 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 39 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 40 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 41 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 42 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 43 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 44 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 45 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 46 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 47 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 48 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 49 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 50 ───────────────────────────────────────── #>   #>   #> → compress origData in nlmixr2 object, save 5952 #> Updated original fit object fit #> → compress origData in nlmixr2 object, save 5952 #> Updated original fit object fit #> → compress origData in nlmixr2 object, save 5952 #> Updated original fit object fit #>  #> ── Running nlmixr2 for model index: 1 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 2 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 3 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 4 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 5 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 6 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 7 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 8 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 9 ────────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 10 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 11 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 12 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 13 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 14 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 15 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 16 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 17 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 18 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 19 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 20 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 21 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 22 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 23 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 24 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 25 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 26 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 27 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 28 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 29 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 30 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 31 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 32 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 33 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 34 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 35 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 36 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 37 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 38 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 39 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 40 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 41 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 42 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 43 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 44 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 45 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 46 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 47 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 48 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 49 ───────────────────────────────────────── #>   #>   #>  #> ── Running nlmixr2 for model index: 50 ───────────────────────────────────────── #>   #>   #>  #> ── Loading/Calculating Δ Objective function ──────────────────────────────────── #>  #> ── Running bootstrap estimates on original data for model index: 1 ───────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 2 ───────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 3 ───────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 4 ───────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 5 ───────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 6 ───────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 7 ───────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 8 ───────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 9 ───────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 10 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 11 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 12 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 13 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 14 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 15 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 16 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 17 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 18 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 19 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 20 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 21 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 22 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 23 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 24 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 25 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 26 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 27 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 28 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 29 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 30 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 31 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 32 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 33 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 34 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 35 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 36 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 37 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 38 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 39 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 40 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 41 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 42 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 43 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 44 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 45 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 46 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 47 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 48 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 49 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #>  #> ── Running bootstrap estimates on original data for model index: 50 ──────────── #>   #>   #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) #> → compress origData in nlmixr2 object, save 5952 #> Updated original fit object x #> $title #> [1] \"Distribution of Δ objective function values for 50 df=12 models\" #>  #> $caption #> [1] \"Δ objective function curve should be on or below the reference distribution curve\" #>  #> attr(,\"class\") #> [1] \"labels\"  # }"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/covarSearchAuto.html","id":null,"dir":"Reference","previous_headings":"","what":"Stepwise Covariate Model-selection (SCM) method — covarSearchAuto","title":"Stepwise Covariate Model-selection (SCM) method — covarSearchAuto","text":"Stepwise Covariate Model-selection (SCM) method","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/covarSearchAuto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stepwise Covariate Model-selection (SCM) method — covarSearchAuto","text":"","code":"covarSearchAuto(   fit,   varsVec,   covarsVec,   pVal = list(fwd = 0.05, bck = 0.01),   covInformation = NULL,   catCovariates = NULL,   searchType = c(\"scm\", \"forward\", \"backward\"),   restart = FALSE )"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/covarSearchAuto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stepwise Covariate Model-selection (SCM) method — covarSearchAuto","text":"fit nlmixr2 'fit' object varsVec list candidate variables covariates added covarsVec list candidate covariates need tested pVal named list names 'fwd' 'bck' specifying p-values forward backward searches, respectively covInformation list containing additionl information variables-covariates pairs passed addCovMultiple function catCovariates list covariates treated categorical searchType one 'scm', 'forward' 'backward' specify covariate search method; default 'scm' restart boolean controls search restarted; default FALSE","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/covarSearchAuto.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stepwise Covariate Model-selection (SCM) method — covarSearchAuto","text":"list summarizing covariate selection steps output; list \"summaryTable\" overall summary covariate selection well \"resFwd\" forward selection method \"resBck\" backward selection method.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/covarSearchAuto.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Stepwise Covariate Model-selection (SCM) method — covarSearchAuto","text":"Vipul Mann, Matthew Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/covarSearchAuto.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stepwise Covariate Model-selection (SCM) method — covarSearchAuto","text":"","code":"# \\donttest{  one.cmt <- function() {   ini({     ## You may label each parameter with a comment     tka <- 0.45 # Log Ka     tcl <- log(c(0, 2.7, 100)) # Log Cl     ## This works with interactive models     ## You may also label the preceding line with label(\"label text\")     tv <- 3.45; label(\"log V\")     ## the label(\"Label name\") works with all models     eta.ka ~ 0.6     eta.cl ~ 0.3     eta.v ~ 0.1     add.sd <- 0.7   })   model({     ka <- exp(tka + eta.ka)     cl <- exp(tcl + eta.cl)     v <- exp(tv + eta.v)     linCmt() ~ add(add.sd)   }) }  fit <- nlmixr2(one.cmt, nlmixr2data::theo_sd,\"focei\") #>   #>   #>   #> ℹ parameter labels from comments will be replaced by 'label()' #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 5952 #> → compress parHist in nlmixr2 object, save 2072 #> Warning: gradient problems with initial estimate and covariance; see $scaleInfo #> Warning: last objective function was not at minimum, possible problems in optimization #> Warning: ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.)) #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) rxode2::.rxWithWd(tempdir(), {# with temporary directory  auto1 <- covarSearchAuto(fit, varsVec = c(\"ka\", \"cl\"),     covarsVec = c(\"WT\", \"SEX\"), catCovariates = c(\"SEX\"))  }) #> Warning: some covariates are not in the dataset: 'WT', '' #>  #> ── starting forward search... ────────────────────────────────────────────────── #> ✔ added centered_WT*cov_WT_ka to ka's equation in the model #> ✔ updated value: ka<-exp(tka+centered_WT*cov_WT_ka+eta.ka) #> ℹ add population parameter `centered_WT` and set estimate to 1 #> ℹ add population parameter `cov_WT_ka` and set estimate to 1 #>   #>   #> ℹ use `control` from pipeline #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of full model... #> ✔ done #> → calculate jacobian #> → calculate ∂(f)/∂(η) #> → calculate ∂(R²)/∂(η) #> → finding duplicate expressions in inner model... #> → optimizing duplicate expressions in inner model... #> → finding duplicate expressions in EBE model... #> → optimizing duplicate expressions in EBE model... #> → compiling inner model... #>   #> ✔ done #> → finding duplicate expressions in FD model... #> → compiling EBE model... #>   #> ✔ done #> → compiling events FD model... #>   #> ✔ done #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 7072 #> → compress parHist in nlmixr2 object, save 2800 #> ✔ added centered_WT*cov_WT_cl to cl's equation in the model #> ✔ updated value: cl<-exp(tcl+centered_WT*cov_WT_cl+eta.cl) #> ℹ add population parameter `centered_WT` and set estimate to 1 #> ℹ add population parameter `cov_WT_cl` and set estimate to 1 #>   #>   #> ℹ use `control` from pipeline #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of full model... #> ✔ done #> → calculate jacobian #> → calculate ∂(f)/∂(η) #> → calculate ∂(R²)/∂(η) #> → finding duplicate expressions in inner model... #> → optimizing duplicate expressions in inner model... #> → finding duplicate expressions in EBE model... #> → optimizing duplicate expressions in EBE model... #> → compiling inner model... #>   #> ✔ done #> → finding duplicate expressions in FD model... #> → compiling EBE model... #>   #> ✔ done #> → compiling events FD model... #>   #> ✔ done #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 7072 #> → compress parHist in nlmixr2 object, save 2400 #>  #> ── objf value did not improve, exiting the search ... ────────────────────────── #>  #> ── forward search complete ── #>  #> ── starting backward search... ───────────────────────────────────────────────── #> ! no covariates added in the forward search, skipping backward search  ## Note that this didn't include sex, add it to dataset and restart model   d <- nlmixr2data::theo_sd d$SEX <-0 d$SEX[d$ID<=6] <-1  fit <- nlmixr2(one.cmt, d, \"focei\") #>   #>   #>   #> ℹ parameter labels from comments will be replaced by 'label()' #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 7184 #> → compress parHist in nlmixr2 object, save 2072 #> Warning: gradient problems with initial estimate and covariance; see $scaleInfo #> Warning: last objective function was not at minimum, possible problems in optimization #> Warning: ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.)) #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  # This would restart if for some reason the search crashed:  rxode2::.rxWithWd(tempdir(), {# with temporary directory  auto2 <- covarSearchAuto(fit, varsVec = c(\"ka\", \"cl\"), covarsVec = c(\"WT\", \"SEX\"),                 catCovariates = c(\"SEX\"), restart = TRUE)  auto3 <- covarSearchAuto(fit, varsVec = c(\"ka\", \"cl\"), covarsVec = c(\"WT\", \"SEX\"),                 catCovariates = c(\"SEX\"), restart = TRUE,                 searchType = \"forward\") }) #>  #> ── starting forward search... ────────────────────────────────────────────────── #> ✔ added centered_WT*cov_WT_ka to ka's equation in the model #> ✔ updated value: ka<-exp(tka+centered_WT*cov_WT_ka+eta.ka) #> ℹ add population parameter `centered_WT` and set estimate to 1 #> ℹ add population parameter `cov_WT_ka` and set estimate to 1 #>   #>   #> ℹ use `control` from pipeline #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 8432 #> → compress parHist in nlmixr2 object, save 2800 #> ✔ added centered_WT*cov_WT_cl to cl's equation in the model #> ✔ updated value: cl<-exp(tcl+centered_WT*cov_WT_cl+eta.cl) #> ℹ add population parameter `centered_WT` and set estimate to 1 #> ℹ add population parameter `cov_WT_cl` and set estimate to 1 #>   #>   #> ℹ use `control` from pipeline #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 8432 #> → compress parHist in nlmixr2 object, save 2400 #> ✔ added categorical_SEX_0*cov_SEX_0_ka to ka's equation in the model #> ✔ updated value: ka<-exp(tka+categorical_SEX_0*cov_SEX_0_ka+eta.ka) #> ℹ add covariate `categorical_SEX_0` #> ℹ add population parameter `cov_SEX_0_ka` and set estimate to 1 #>   #>   #> ℹ use `control` from pipeline #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of full model... #> ✔ done #> → calculate jacobian #> → calculate ∂(f)/∂(η) #> → calculate ∂(R²)/∂(η) #> → finding duplicate expressions in inner model... #> → optimizing duplicate expressions in inner model... #> → finding duplicate expressions in EBE model... #> → optimizing duplicate expressions in EBE model... #> → compiling inner model... #>   #> ✔ done #> → finding duplicate expressions in FD model... #> → compiling EBE model... #>   #> ✔ done #> → compiling events FD model... #>   #> ✔ done #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 7984 #> → compress parHist in nlmixr2 object, save 2816 #> ✔ added categorical_SEX_0*cov_SEX_0_cl to cl's equation in the model #> ✔ updated value: cl<-exp(tcl+categorical_SEX_0*cov_SEX_0_cl+eta.cl) #> ℹ add covariate `categorical_SEX_0` #> ℹ add population parameter `cov_SEX_0_cl` and set estimate to 1 #>   #>   #> ℹ use `control` from pipeline #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of full model... #> ✔ done #> → calculate jacobian #> → calculate ∂(f)/∂(η) #> → calculate ∂(R²)/∂(η) #> → finding duplicate expressions in inner model... #> → optimizing duplicate expressions in inner model... #> → finding duplicate expressions in EBE model... #> → optimizing duplicate expressions in EBE model... #> → compiling inner model... #>   #> ✔ done #> → finding duplicate expressions in FD model... #> → compiling EBE model... #>   #> ✔ done #> → compiling events FD model... #>   #> ✔ done #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 7984 #> → compress parHist in nlmixr2 object, save 2648 #>  #> ── objf value did not improve, exiting the search ... ────────────────────────── #>  #> ── forward search complete ── #>  #> ── starting backward search... ───────────────────────────────────────────────── #> ! no covariates added in the forward search, skipping backward search #>  #> ── starting forward search... ────────────────────────────────────────────────── #> ✔ added centered_WT*cov_WT_ka to ka's equation in the model #> ✔ updated value: ka<-exp(tka+centered_WT*cov_WT_ka+eta.ka) #> ℹ add population parameter `centered_WT` and set estimate to 1 #> ℹ add population parameter `cov_WT_ka` and set estimate to 1 #>   #>   #> ℹ use `control` from pipeline #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 8432 #> → compress parHist in nlmixr2 object, save 2800 #> ✔ added centered_WT*cov_WT_cl to cl's equation in the model #> ✔ updated value: cl<-exp(tcl+centered_WT*cov_WT_cl+eta.cl) #> ℹ add population parameter `centered_WT` and set estimate to 1 #> ℹ add population parameter `cov_WT_cl` and set estimate to 1 #>   #>   #> ℹ use `control` from pipeline #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 8432 #> → compress parHist in nlmixr2 object, save 2400 #> ✔ added categorical_SEX_0*cov_SEX_0_ka to ka's equation in the model #> ✔ updated value: ka<-exp(tka+categorical_SEX_0*cov_SEX_0_ka+eta.ka) #> ℹ add covariate `categorical_SEX_0` #> ℹ add population parameter `cov_SEX_0_ka` and set estimate to 1 #>   #>   #> ℹ use `control` from pipeline #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 7984 #> → compress parHist in nlmixr2 object, save 2816 #> ✔ added categorical_SEX_0*cov_SEX_0_cl to cl's equation in the model #> ✔ updated value: cl<-exp(tcl+categorical_SEX_0*cov_SEX_0_cl+eta.cl) #> ℹ add covariate `categorical_SEX_0` #> ℹ add population parameter `cov_SEX_0_cl` and set estimate to 1 #>   #>   #> ℹ use `control` from pipeline #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 7984 #> → compress parHist in nlmixr2 object, save 2648 #>  #> ── objf value did not improve, exiting the search ... ────────────────────────── #>  #> ── forward search complete ── #>   # }"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/foceiControl.html","id":null,"dir":"Reference","previous_headings":"","what":"Control Options for FOCEi — foceiControl","title":"Control Options for FOCEi — foceiControl","text":"Control Options FOCEi","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/foceiControl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control Options for FOCEi — foceiControl","text":"","code":"foceiControl(   sigdig = 3,   ...,   epsilon = NULL,   maxInnerIterations = 1000,   maxOuterIterations = 5000,   n1qn1nsim = NULL,   print = 1L,   printNcol = floor((getOption(\"width\") - 23)/12),   scaleTo = 1,   scaleObjective = 0,   normType = c(\"rescale2\", \"mean\", \"rescale\", \"std\", \"len\", \"constant\"),   scaleType = c(\"nlmixr2\", \"norm\", \"mult\", \"multAdd\"),   scaleCmax = 1e+05,   scaleCmin = 1e-05,   scaleC = NULL,   scaleC0 = 1e+05,   derivEps = rep(20 * sqrt(.Machine$double.eps), 2),   derivMethod = c(\"switch\", \"forward\", \"central\"),   derivSwitchTol = NULL,   covDerivMethod = c(\"central\", \"forward\"),   covMethod = c(\"r,s\", \"r\", \"s\", \"\"),   hessEps = (.Machine$double.eps)^(1/3),   eventFD = sqrt(.Machine$double.eps),   eventType = c(\"gill\", \"central\", \"forward\"),   centralDerivEps = rep(20 * sqrt(.Machine$double.eps), 2),   lbfgsLmm = 7L,   lbfgsPgtol = 0,   lbfgsFactr = NULL,   eigen = TRUE,   addPosthoc = TRUE,   diagXform = c(\"sqrt\", \"log\", \"identity\"),   sumProd = FALSE,   optExpression = TRUE,   ci = 0.95,   useColor = crayon::has_color(),   boundTol = NULL,   calcTables = TRUE,   noAbort = TRUE,   interaction = TRUE,   cholSEtol = (.Machine$double.eps)^(1/3),   cholAccept = 0.001,   resetEtaP = 0.15,   resetThetaP = 0.05,   resetThetaFinalP = 0.15,   diagOmegaBoundUpper = 5,   diagOmegaBoundLower = 100,   cholSEOpt = FALSE,   cholSECov = FALSE,   fo = FALSE,   covTryHarder = FALSE,   outerOpt = c(\"nlminb\", \"bobyqa\", \"lbfgsb3c\", \"L-BFGS-B\", \"mma\", \"lbfgsbLG\", \"slsqp\",     \"Rvmmin\"),   innerOpt = c(\"n1qn1\", \"BFGS\"),   rhobeg = 0.2,   rhoend = NULL,   npt = NULL,   rel.tol = NULL,   x.tol = NULL,   eval.max = 4000,   iter.max = 2000,   abstol = NULL,   reltol = NULL,   resetHessianAndEta = FALSE,   stateTrim = Inf,   gillK = 10L,   gillStep = 4,   gillFtol = 0,   gillRtol = sqrt(.Machine$double.eps),   gillKcov = 10L,   gillStepCov = 2,   gillFtolCov = 0,   rmatNorm = TRUE,   smatNorm = TRUE,   covGillF = TRUE,   optGillF = TRUE,   covSmall = 1e-05,   adjLik = TRUE,   gradTrim = Inf,   maxOdeRecalc = 5,   odeRecalcFactor = 10^(0.5),   gradCalcCentralSmall = 1e-04,   gradCalcCentralLarge = 10000,   etaNudge = qnorm(1 - 0.05/2)/sqrt(3),   etaNudge2 = qnorm(1 - 0.05/2) * sqrt(3/5),   nRetries = 3,   seed = 42,   resetThetaCheckPer = 0.1,   etaMat = NULL,   repeatGillMax = 3,   stickyRecalcN = 5,   gradProgressOfvTime = 10,   addProp = c(\"combined2\", \"combined1\"),   badSolveObjfAdj = 100,   compress = TRUE,   rxControl = NULL,   sigdigTable = NULL,   fallbackFD = FALSE )"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/foceiControl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control Options for FOCEi — foceiControl","text":"sigdig Optimization significant digits. controls: tolerance inner outer optimization 10^-sigdig tolerance ODE solvers  0.5*10^(-sigdig-2); sensitivity equations  steady-state solutions default 0.5*10^(-sigdig-1.5)  (sensitivity changes applicable liblsoda) tolerance boundary check 5 * 10 ^ (-sigdig + 1) ... Additional arguments passed nlmixr2est::foceiControl(). epsilon Precision estimate n1qn1 optimization. maxInnerIterations Number iterations n1qn1 optimization. maxOuterIterations Maximum number L-BFGS-B optimization outer problem. n1qn1nsim Number function evaluations n1qn1 optimization. print Integer representing outer step printed. 0 print iterations.  1 print every function evaluation (default), 5 print every 5 evaluations. printNcol Number columns printout wrapping parameter estimates/gradient scaleTo Scale initial parameter estimate value. default 1.  zero , scaling performed. scaleObjective Scale initial objective function value.  default 0 (meaning scale) normType type parameter     normalization/scaling used get scaled initial values     nlmixr2.  used scaleType . exception rescale2, come         Feature     Scaling. rescale2 rescaling type     described     OptdesX     software manual. general, scaling formula can described : v_scaled = (v_unscaled-C_1)/C_2 data normalization approaches follow following formula v_scaled = (v_unscaled-C_1)/C_2; rescale2 scales parameters (-1 1).     relative differences parameters preserved     approach constants : C_1 = (max(unscaled values)+min(unscaled values))/2 C_2 = (max(unscaled values) - min(unscaled values))/2 rescale min-max normalization. rescales     parameters (0 1).  rescale2     relative differences preserved.  approach: C_1 = min(unscaled values) C_2 = max(unscaled values) - min(unscaled values) mean mean normalization.  rescales center     parameters around mean parameters 0     1.  approach: C_1 = mean(unscaled values) C_2 = max(unscaled values) - min(unscaled values) std standardization.  standardizes mean      standard deviation.  approach: C_1 = mean(unscaled values) C_2 = sd(unscaled values) len unit length scaling.  scales    parameters unit length.  approach use Euclidean length,    : C_1 = 0 C_2 = sqrt(v_1^2 + v_2^2 + ... + v_n^2) constant perform data normalization. C_1 = 0 C_2 = 1 scaleType scaling scheme nlmixr2.  supported types : nlmixr2  approach scaling performed following equation: v_scaled = (v_current - v_init)/scaleC[] + scaleTo scaleTo parameter specified normType, scales specified scaleC. norm approach uses simple scaling provided     normType argument. mult approach use data normalization provided normType, rather uses multiplicative scaling constant provided scaleTo argument. case: v_scaled = v_current/v_init*scaleTo multAdd approach changes scaling based parameter specified.  parameter defined exponential block (ie exp(theta)), scaled linearly, : v_scaled = (v_current-v_init) + scaleTo Otherwise parameter scaled multiplicatively. v_scaled = v_current/v_init*scaleTo scaleCmax Maximum value scaleC prevent overflow. scaleCmin Minimum value scaleC prevent underflow. scaleC scaling constant used     scaleType=nlmixr2.  specified, based     type parameter estimated.  idea keep     derivatives similar log scale similar     gradient sizes.  Hence parameters like log(exp(theta))     scaling factor 1 log(theta) scaling     factor ini_value (scale 1/value; ie     d/dt(log(ini_value)) = 1/ini_value scaleC=ini_value)  parameters exponential (ie exp(theta))    parameters specifying powers, boxCox yeoJohnson    transformations , 1. additive, proportional, lognormal error structures,    given 0.5*abs(initial_estimate) Factorials scaled abs(1/digamma(inital_estimate+1)) parameters log scale (ie log(theta)) transformed    log(abs(initial_estimate))*abs(initial_estimate) parameter scaling coefficients chose try keep    similar slopes among parameters.  follow    slopes approximately log-scale. chosen logical manner, may always    apply.  can specify parameters scaling factor    parameter wish. scaleC0 Number adjust scaling factor initial gradient zero. derivEps Forward difference tolerances,     vector relative difference absolute difference.      central/forward difference step size h calculated : h = abs(x)*derivEps[1] + derivEps[2] derivMethod indicates method calculating derivatives outer problem.  Currently supports \"switch\", \"central\" \"forward\" difference methods.  Switch starts forward differences.  switch central differences abs(delta(OFV)) <= derivSwitchTol switch back forward differences abs(delta(OFV)) > derivSwitchTol. derivSwitchTol tolerance switch forward central differences. covDerivMethod indicates method calculating derivatives calculating covariance components (Hessian S). covMethod Method calculating covariance.      discussion, R Hessian matrix objective     function. S matrix sum individual     gradient cross-product (evaluated individual empirical     Bayes estimates). \"r,s\" Uses sandwich matrix calculate  covariance, : solve(R) %*% S %*% solve(R) \"r\" Uses Hessian matrix calculate  covariance 2 %*% solve(R) \"s\" Uses cross-product matrix calculate  covariance 4 %*% solve(S) \"\" calculate covariance step. hessEps double value representing epsilon Hessian calculation. eventFD Finite difference step forward central difference estimation event-based gradients eventType Event gradient type dosing events; Can \"gill\", \"central\" \"forward\" centralDerivEps Central difference tolerances.      numeric vector relative difference absolute difference.     central/forward difference step size h calculated : h = abs(x)*derivEps[1] + derivEps[2] lbfgsLmm integer giving number BFGS updates retained \"L-BFGS-B\" method, defaults 7. lbfgsPgtol double precision variable. entry pgtol >= 0 specified user.  iteration     stop : max(\\| proj g_i \\| = 1, ..., n) <= lbfgsPgtol pg_i ith component projected gradient. exit pgtol unchanged.  defaults zero,     check suppressed. lbfgsFactr Controls convergence \"L-BFGS-B\" method.  Convergence occurs reduction objective within factor machine tolerance. Default 1e10, gives tolerance 2e-6, approximately 4 sigdigs.  can check exact tolerance multiplying value .Machine$double.eps eigen boolean indicating eigenvectors calculated include condition number calculation. addPosthoc Boolean indicating posthoc parameters added table output. diagXform transformation used diagonal     chol(solve(omega)). matrix values     parameters estimated FOCEi. possibilities : sqrt Estimates sqrt diagonal elements chol(solve(omega)).  default method. log Estimates log diagonal elements chol(solve(omega)) identity Estimates diagonal elements without transformations sumProd boolean indicating model change multiplication high precision multiplication sums high precision sums using PreciseSums package.  default FALSE. optExpression Optimize rxode2 expression speed calculation. default turned . ci Confidence level tables.  default 0.95 95% confidence. useColor Boolean indicating focei can use ASCII color codes boundTol Tolerance boundary issues. calcTables boolean determine foceiFit calculate tables. default TRUE noAbort Boolean indicate abort FOCEi evaluation runs troubles.  (default TRUE) interaction Boolean indicate FOCEi used (TRUE) instead FOCE (FALSE) cholSEtol tolerance Generalized Cholesky Decomposition.  Defaults suggested (.Machine$double.eps)^(1/3) cholAccept Tolerance accept Generalized Cholesky Decomposition R S matrix. resetEtaP represents p-value reseting individual ETA 0 optimization (instead saved value).  two test statistics used z-test either chol(omega^-1) %*% eta eta/sd(allEtas).  p-value 0 indicates ETAs never reset.  p-value 1 indicates ETAs always reset. resetThetaP represents p-value reseting population mu-referenced THETA parameters based ETA drift optimization, resetting optimization.  p-value 0 indicates THETAs never reset.  p-value 1 indicates THETAs always reset allowed.  theta reset checked beginning nearing local minima.  percent change objective function theta reset check initiated controlled resetThetaCheckPer. resetThetaFinalP represents p-value reseting population mu-referenced THETA parameters based ETA drift optimization, resetting optimization one final time. diagOmegaBoundUpper represents upper bound diagonal omega matrix.  upper bound given diag(omega)*diagOmegaBoundUpper.  diagOmegaBoundUpper 1, upper bound Omega. diagOmegaBoundLower represents lower bound diagonal omega matrix.  lower bound given diag(omega)/diagOmegaBoundUpper.  diagOmegaBoundLower 1, lower bound Omega. cholSEOpt Boolean indicating generalized Cholesky used optimizing. cholSECov Boolean indicating generalized Cholesky used calculating Covariance Matrix. fo boolean indicating FO approximation routine. covTryHarder R matrix non-positive definite corrected non-positive definite try estimating Hessian unscaled parameter space. outerOpt optimization method outer problem innerOpt optimization method inner problem (implemented yet.) rhobeg Beginning change parameters bobyqa algorithm (trust region).  default 0.2 20 parameters parameters scaled 1. rhobeg rhoend must set initial final values trust region radius, must positive 0 < rhoend < rhobeg. Typically rhobeg one tenth greatest expected change variable.  Note also smallest difference abs(upper-lower) greater equal rhobeg*2. case rhobeg adjusted. (bobyqa) rhoend smallest value trust region radius allowed. defined, 10^(-sigdig-1) used. (bobyqa) npt number points used approximate objective function via quadratic approximation bobyqa. value npt must interval [n+2,(n+1)(n+2)/2] n number parameters par. Choices exceed 2*n+1 recommended. defined, set 2*n + 1. (bobyqa) rel.tol Relative tolerance nlminb stops (nlmimb). x.tol X tolerance nlmixr2 optimizer eval.max Number maximum evaluations objective function (nlmimb) iter.max Maximum number iterations allowed (nlmimb) abstol Absolute tolerance nlmixr2 optimizer (BFGS) reltol tolerance nlmixr2 (BFGS) resetHessianAndEta boolean representing individual Hessian reset ETAs reset using option resetEtaP. stateTrim Trim state amounts/concentrations value. gillK total number possible steps determine optimal forward/central difference step size per parameter (Gill 1983 method).  0, optimal step size determined.  Otherwise optimal step size determined. gillStep looking optimal forward difference step size, step size increase initial estimate .  iteration new step size = (prior step size)*gillStep gillFtol gillFtol gradient error tolerance acceptable issuing warning/error gradient estimates. gillRtol relative tolerance used Gill 1983 determination optimal step size. gillKcov total number possible steps determine optimal forward/central difference step size per parameter (Gill 1983 method) covariance step.  0, optimal step size determined.  Otherwise optimal step size determined. gillStepCov looking optimal forward difference step size, step size increase initial estimate .  iteration covariance step equal new step size = (prior step size)*gillStepCov gillFtolCov gillFtol gradient error tolerance acceptable issuing warning/error gradient estimates covariance step. rmatNorm parameter normalize gradient step size parameter value calculation R matrix smatNorm parameter normalize gradient step size parameter value calculation S matrix covGillF Use Gill calculated optimal Forward difference step size instead central difference step size central difference gradient calculation. optGillF Use Gill calculated optimal Forward difference step size instead central difference step size central differences optimization. covSmall covSmall small number compare covariance numbers rejecting estimate covariance final estimate (comparing sandwich vs R/S matrix estimates covariance).  number controls small variance covariance matrix rejected. adjLik nlmixr2, objective function matches NONMEM's objective function, removes 2*pi constant likelihood calculation. TRUE, likelihood function adjusted 2*pi factor.  adjusted number closely matches likelihood approximations nlme, SAS approximations.  Regardless turned objective function matches NONMEM's objective function. gradTrim parameter adjust gradient |gradient| large. maxOdeRecalc Maximum number times reduce ODE tolerances try resolve system bad ODE solve. odeRecalcFactor ODE recalculation factor ODE solving goes bad, factor rtol/atol reduced gradCalcCentralSmall small number represents value |grad| < gradCalcCentralSmall forward differences switch central differences. gradCalcCentralLarge large number represents value |grad| > gradCalcCentralLarge forward differences switch central differences. etaNudge default initial ETA estimates start zero; Sometimes optimize appropriately.  value non-zero, n1qn1 optimization perform appropriately, reset Hessian, nudge ETA value; ETA still move, nudge ETA value. default value qnorm(1-0.05/2)*1/sqrt(3), first Gauss Quadrature numbers times 0.95% normal region. successful try second eta nudge number ().  +-etaNudge2 successful, assign zero optimize longer etaNudge2 second eta nudge.  default qnorm(1-0.05/2)*sqrt(3/5), n=3 quadrature point (excluding zero) times 0.95% normal region nRetries FOCEi fit current parameter estimates, randomly sample new parameter estimates restart problem.  similar 'PsN' resampling. seed object specifying random number generator initialized resetThetaCheckPer represents objective function % percentage resetThetaP checked. etaMat Eta matrix initial estimates final estimates ETAs. repeatGillMax tolerances reduced calculating initial Gill differences, Gill difference repeated maximum number times defined parameter. stickyRecalcN number bad ODE solves reducing atol/rtol rest problem. gradProgressOfvTime time single objective function evaluation (seconds) start progress bars gradient evaluations addProp specifies type additive plus proportional   errors, one standard deviations add (combined1)   type variances add (combined2). combined1 error type can described following equation: y = f + (+ b*f^c)*err combined2 error model can described following equation: y = f + sqrt(^2 + b^2*(f^c)^2)*err : - y represents observed value - f represents predicted value -  additive standard deviation - b proportional/power standard deviation - c power exponent (proportional case c=1) badSolveObjfAdj objective function adjustment ODE system solved.  based individual bad solve. compress object compressed items rxControl `rxode2` ODE solving options fitting, created `rxControl()` sigdigTable Significant digits final output table. specified, matches significant digits `sigdig` optimization algorithm.  `sigdig` NULL, use 3. fallbackFD Fallback finite differences sensitivity equations solve.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/foceiControl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control Options for FOCEi — foceiControl","text":"control object changes options FOCEi   family estimation methods","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/foceiControl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Control Options for FOCEi — foceiControl","text":"Note uses R's L-BFGS-B optim outer problem BFGS n1qn1 allows restoring prior individual Hessian (faster optimization speed). However inner problem scaled.  Since eta estimates start near zero, scaling parameters make sense. process scaling can fix ill conditioning unscaled problem.  covariance step performed unscaled problem, condition number matrix may reflective scaled problem's condition-number.","code":""},{"path":[]},{"path":"https://nlmixr2.github.io/nlmixr2/reference/foceiControl.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control Options for FOCEi — foceiControl","text":"Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmeControl.html","id":null,"dir":"Reference","previous_headings":"","what":"Control Values for nlme Fit with extra options for nlmixr — nlmeControl","title":"Control Values for nlme Fit with extra options for nlmixr — nlmeControl","text":"values supplied function call replace defaults list possible arguments returned.  returned list used ‘control’ argument ‘nlme’ function.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmeControl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control Values for nlme Fit with extra options for nlmixr — nlmeControl","text":"","code":"nlmeControl(   maxIter = 100,   pnlsMaxIter = 100,   msMaxIter = 100,   minScale = 0.001,   tolerance = 1e-05,   niterEM = 25,   pnlsTol = 0.001,   msTol = 1e-06,   returnObject = FALSE,   msVerbose = FALSE,   msWarnNoConv = TRUE,   gradHess = TRUE,   apVar = TRUE,   .relStep = .Machine$double.eps^(1/3),   minAbsParApVar = 0.05,   opt = c(\"nlminb\", \"nlm\"),   natural = TRUE,   sigma = NULL,   optExpression = TRUE,   sumProd = FALSE,   rxControl = NULL,   method = c(\"ML\", \"REML\"),   random = NULL,   fixed = NULL,   weights = NULL,   verbose = TRUE,   returnNlme = FALSE,   addProp = c(\"combined2\", \"combined1\"),   calcTables = TRUE,   compress = TRUE,   adjObf = TRUE,   ci = 0.95,   sigdig = 4,   sigdigTable = NULL,   ... )"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmeControl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control Values for nlme Fit with extra options for nlmixr — nlmeControl","text":"maxIter maximum number iterations nlme    optimization algorithm.  Default 50. pnlsMaxIter maximum number iterations    PNLS optimization step inside nlme    optimization.  Default 7. msMaxIter maximum number iterations nlminb    (iter.max) nlm (iterlim,    10-th step) optimization step inside nlme    optimization.  Default 50 (may small e.g.    overparametrized cases). minScale minimum factor shrink default step size    attempt decrease sum squares PNLS step.    Default 0.001. tolerance tolerance convergence criterion    nlme algorithm.  Default 1e-6. niterEM number iterations EM algorithm used refine    initial estimates random effects variance-covariance    coefficients.  Default 25. pnlsTol tolerance convergence criterion PNLS    step.  Default 1e-3. msTol tolerance convergence criterion nlm,    passed gradtol argument function (see    documentation nlm).  Default 1e-7. returnObject logical value indicating whether fitted    object returned maximum number iterations    reached without convergence algorithm.  Default    FALSE. msVerbose logical value passed trace    nlminb(.., control= list(trace = *, ..))    argument print.level nlm().  Default    FALSE. msWarnNoConv logical indicating warning    signalled whenever minimization (opt)    LME step converge; defaults TRUE. gradHess logical value indicating whether numerical gradient    vectors Hessian matrices log-likelihood function    used nlm optimization. option available    correlation structure (corStruct) variance    function structure (varFunc) \"varying\" parameters    pdMat classes used random effects structure    pdSymm (general positive-definite), pdDiag (diagonal),    pdIdent (multiple identity),     pdCompSymm (compound symmetry).  Default TRUE. apVar logical value indicating whether approximate    covariance matrix variance-covariance parameters    calculated.  Default TRUE. .relStep relative step numerical derivatives    calculations.  Default .Machine$double.eps^(1/3). minAbsParApVar numeric value - minimum absolute parameter value    approximate variance calculation.  default 0.05. opt optimizer used, either \"nlminb\" (   default) \"nlm\". natural logical value indicating whether pdNatural    parametrization used general positive-definite matrices    (pdSymm) reStruct, approximate covariance    matrix estimators calculated.  Default TRUE. sigma optionally positive number fix residual error .    NULL, default, 0, sigma estimated. optExpression Optimize rxode2 expression speed calculation. default turned . sumProd boolean indicating model change multiplication high precision multiplication sums high precision sums using PreciseSums package.  default FALSE. rxControl `rxode2` ODE solving options fitting, created `rxControl()` method character string.  \"REML\" model fit    maximizing restricted log-likelihood.  \"ML\"    log-likelihood maximized.  Defaults \"ML\". random optionally, following: () two-sided formula    form r1+...+rn~x1+...+xm | g1/.../gQ,    r1,...,rn naming parameters included right    hand side model, x1+...+xm specifying    random-effects model    parameters g1/.../gQ grouping structure    (Q may equal 1, case /    required). random effects formula repeated     levels grouping, case multiple levels    grouping; (ii) two-sided formula form    r1+...+rn~x1+..+xm, list two-sided formulas form    r1~x1+...+xm, possibly different random-effects models    different parameters, pdMat object two-sided    formula, list two-sided formulas (.e. non-NULL value    formula(random)), list pdMat objects two-sided    formulas, lists two-sided formulas. case, grouping    structure formula given groups, derived    data used fit nonlinear mixed-effects model,    inherit class  groupedData,; (iii) named list    formulas, lists formulas, pdMat objects (ii),    grouping factors names. order nesting    assumed order order elements    list; (iv) reStruct object. See documentation    pdClasses description available pdMat    classes. Defaults fixed,     resulting fixed effects also random effects. fixed two-sided linear formula form    f1+...+fn~x1+...+xm, list two-sided formulas form    f1~x1+...+xm, possibly different models different    parameters. f1,...,fn names parameters included    right hand side model x1+...+xm    expressions define linear models parameters (left    hand side formula contains several parameters,    assumed follow linear model, described right hand    side expression).    1 right hand side formula(s) indicates single    fixed effects corresponding parameter(s). weights optional varFunc object one-sided formula    describing within-group heteroscedasticity structure. given    formula, used argument varFixed,    corresponding fixed variance weights. See documentation    varClasses description available varFunc    classes. Defaults NULL, corresponding homoscedastic    within-group errors. verbose optional logical value. TRUE information    evolution iterative algorithm printed. Default    FALSE. returnNlme Returns nlme object instead nlmixr object (default FALSE).  nlme specific options `random`, `fixed`, `sens`, nlme object returned addProp specifies type additive plus proportional   errors, one standard deviations add (combined1)   type variances add (combined2). combined1 error type can described following equation: y = f + (+ b*f^c)*err combined2 error model can described following equation: y = f + sqrt(^2 + b^2*(f^c)^2)*err : - y represents observed value - f represents predicted value -  additive standard deviation - b proportional/power standard deviation - c power exponent (proportional case c=1) calcTables boolean determine foceiFit calculate tables. default TRUE compress object compressed items adjObf boolean indicate objective function adjusted closer NONMEM's default objective function.  default TRUE ci Confidence level tables.  default 0.95 95% confidence. sigdig Optimization significant digits. controls: tolerance inner outer optimization 10^-sigdig tolerance ODE solvers  0.5*10^(-sigdig-2); sensitivity equations  steady-state solutions default 0.5*10^(-sigdig-1.5)  (sensitivity changes applicable liblsoda) tolerance boundary check 5 * 10 ^ (-sigdig + 1) sigdigTable Significant digits final output table. specified, matches significant digits `sigdig` optimization algorithm.  `sigdig` NULL, use 3. ... Additional arguments passed nlmixr2est::nlmeControl().","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmeControl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Control Values for nlme Fit with extra options for nlmixr — nlmeControl","text":"","code":"nlmixr2est::nlmeControl() #> $maxIter #> [1] 100 #>  #> $pnlsMaxIter #> [1] 100 #>  #> $msMaxIter #> [1] 100 #>  #> $minScale #> [1] 0.001 #>  #> $tolerance #> [1] 1e-05 #>  #> $niterEM #> [1] 25 #>  #> $pnlsTol #> [1] 0.001 #>  #> $msTol #> [1] 1e-06 #>  #> $returnObject #> [1] FALSE #>  #> $msVerbose #> [1] FALSE #>  #> $msWarnNoConv #> [1] TRUE #>  #> $gradHess #> [1] TRUE #>  #> $apVar #> [1] TRUE #>  #> $.relStep #> [1] 6.055454e-06 #>  #> $minAbsParApVar #> [1] 0.05 #>  #> $opt #> [1] \"nlminb\" #>  #> $natural #> [1] TRUE #>  #> $sigma #> [1] 0 #>  #> $optExpression #> [1] TRUE #>  #> $sumProd #> [1] FALSE #>  #> $rxControl #> $scale #> NULL #>  #> $method #> liblsoda  #>        2  #>  #> $atol #> [1] 1e-04 #>  #> $rtol #> [1] 1e-04 #>  #> $maxsteps #> [1] 70000 #>  #> $hmin #> [1] 0 #>  #> $hmax #> [1] NA #>  #> $hini #> [1] 0 #>  #> $maxordn #> [1] 12 #>  #> $maxords #> [1] 5 #>  #> $covsInterpolation #> locf  #>    1  #>  #> $addCov #> [1] TRUE #>  #> $returnType #> rxSolve  #>       0  #>  #> $sigma #> NULL #>  #> $sigmaDf #> NULL #>  #> $nCoresRV #> [1] 1 #>  #> $sigmaIsChol #> [1] FALSE #>  #> $sigmaSeparation #> [1] \"auto\" #>  #> $sigmaXform #> identity  #>        4  #>  #> $nDisplayProgress #> [1] 10000 #>  #> $amountUnits #> [1] NA #>  #> $timeUnits #> [1] \"hours\" #>  #> $addDosing #> [1] FALSE #>  #> $stateTrim #> [1] Inf #>  #> $updateObject #> [1] FALSE #>  #> $omega #> NULL #>  #> $omegaDf #> NULL #>  #> $omegaIsChol #> [1] FALSE #>  #> $omegaSeparation #> [1] \"auto\" #>  #> $omegaXform #> variance  #>        6  #>  #> $nSub #> [1] 1 #>  #> $thetaMat #> NULL #>  #> $thetaDf #> NULL #>  #> $thetaIsChol #> [1] FALSE #>  #> $nStud #> [1] 1 #>  #> $dfSub #> [1] 0 #>  #> $dfObs #> [1] 0 #>  #> $seed #> NULL #>  #> $nsim #> NULL #>  #> $minSS #> [1] 10 #>  #> $maxSS #> [1] 1000 #>  #> $strictSS #> [1] 1 #>  #> $infSSstep #> [1] 12 #>  #> $istateReset #> [1] TRUE #>  #> $subsetNonmem #> [1] TRUE #>  #> $hmaxSd #> [1] 0 #>  #> $maxAtolRtolFactor #> [1] 0.1 #>  #> $from #> NULL #>  #> $to #> NULL #>  #> $by #> NULL #>  #> $length.out #> NULL #>  #> $iCov #> NULL #>  #> $keep #> NULL #>  #> $keepF #> character(0) #>  #> $drop #> NULL #>  #> $warnDrop #> [1] TRUE #>  #> $omegaLower #> [1] -Inf #>  #> $omegaUpper #> [1] Inf #>  #> $sigmaLower #> [1] -Inf #>  #> $sigmaUpper #> [1] Inf #>  #> $thetaLower #> [1] -Inf #>  #> $thetaUpper #> [1] Inf #>  #> $indLinPhiM #> [1] 0 #>  #> $indLinPhiTol #> [1] 1e-07 #>  #> $indLinMatExpType #> expokit  #>       2  #>  #> $indLinMatExpOrder #> [1] 6 #>  #> $idFactor #> [1] TRUE #>  #> $mxhnil #> [1] 0 #>  #> $hmxi #> [1] 0 #>  #> $warnIdSort #> [1] TRUE #>  #> $ssAtol #> [1] 1e-08 #>  #> $ssRtol #> [1] 1e-06 #>  #> $safeZero #> [1] 1 #>  #> $sumType #> pairwise  #>        1  #>  #> $prodType #> long double  #>           1  #>  #> $sensType #> advan  #>     4  #>  #> $linDiff #>    tlag       f    rate     dur   tlag2      f2   rate2    dur2  #> 1.5e-05 1.5e-05 1.5e-05 1.5e-05 1.5e-05 1.5e-05 1.5e-05 1.5e-05  #>  #> $linDiffCentral #>  tlag     f  rate   dur tlag2    f2 rate2  dur2  #>  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  #>  #> $resample #> NULL #>  #> $resampleID #> [1] TRUE #>  #> $maxwhile #> [1] 100000 #>  #> $cores #> [1] 0 #>  #> $atolSens #> [1] 1e-08 #>  #> $rtolSens #> [1] 1e-06 #>  #> $ssAtolSens #> [1] 1e-08 #>  #> $ssRtolSens #> [1] 1e-06 #>  #> $simVariability #> [1] NA #>  #> attr(,\"class\") #> [1] \"rxControl\" #>  #> $method #> [1] \"ML\" #>  #> $verbose #> [1] TRUE #>  #> $returnNlme #> [1] FALSE #>  #> $addProp #> [1] \"combined2\" #>  #> $calcTables #> [1] TRUE #>  #> $compress #> [1] TRUE #>  #> $random #> NULL #>  #> $fixed #> NULL #>  #> $weights #> NULL #>  #> $ci #> [1] 0.95 #>  #> $sigdig #> [1] 4 #>  #> $sigdigTable #> [1] 4 #>  #> $genRxControl #> [1] TRUE #>  #> attr(,\"class\") #> [1] \"nlmeControl\" nlmixr2NlmeControl() #> $maxIter #> [1] 100 #>  #> $pnlsMaxIter #> [1] 100 #>  #> $msMaxIter #> [1] 100 #>  #> $minScale #> [1] 0.001 #>  #> $tolerance #> [1] 1e-05 #>  #> $niterEM #> [1] 25 #>  #> $pnlsTol #> [1] 0.001 #>  #> $msTol #> [1] 1e-06 #>  #> $returnObject #> [1] FALSE #>  #> $msVerbose #> [1] FALSE #>  #> $msWarnNoConv #> [1] TRUE #>  #> $gradHess #> [1] TRUE #>  #> $apVar #> [1] TRUE #>  #> $.relStep #> [1] 6.055454e-06 #>  #> $minAbsParApVar #> [1] 0.05 #>  #> $opt #> [1] \"nlminb\" #>  #> $natural #> [1] TRUE #>  #> $sigma #> [1] 0 #>  #> $optExpression #> [1] TRUE #>  #> $sumProd #> [1] FALSE #>  #> $rxControl #> $scale #> NULL #>  #> $method #> liblsoda  #>        2  #>  #> $atol #> [1] 1e-04 #>  #> $rtol #> [1] 1e-04 #>  #> $maxsteps #> [1] 70000 #>  #> $hmin #> [1] 0 #>  #> $hmax #> [1] NA #>  #> $hini #> [1] 0 #>  #> $maxordn #> [1] 12 #>  #> $maxords #> [1] 5 #>  #> $covsInterpolation #> locf  #>    1  #>  #> $addCov #> [1] TRUE #>  #> $returnType #> rxSolve  #>       0  #>  #> $sigma #> NULL #>  #> $sigmaDf #> NULL #>  #> $nCoresRV #> [1] 1 #>  #> $sigmaIsChol #> [1] FALSE #>  #> $sigmaSeparation #> [1] \"auto\" #>  #> $sigmaXform #> identity  #>        4  #>  #> $nDisplayProgress #> [1] 10000 #>  #> $amountUnits #> [1] NA #>  #> $timeUnits #> [1] \"hours\" #>  #> $addDosing #> [1] FALSE #>  #> $stateTrim #> [1] Inf #>  #> $updateObject #> [1] FALSE #>  #> $omega #> NULL #>  #> $omegaDf #> NULL #>  #> $omegaIsChol #> [1] FALSE #>  #> $omegaSeparation #> [1] \"auto\" #>  #> $omegaXform #> variance  #>        6  #>  #> $nSub #> [1] 1 #>  #> $thetaMat #> NULL #>  #> $thetaDf #> NULL #>  #> $thetaIsChol #> [1] FALSE #>  #> $nStud #> [1] 1 #>  #> $dfSub #> [1] 0 #>  #> $dfObs #> [1] 0 #>  #> $seed #> NULL #>  #> $nsim #> NULL #>  #> $minSS #> [1] 10 #>  #> $maxSS #> [1] 1000 #>  #> $strictSS #> [1] 1 #>  #> $infSSstep #> [1] 12 #>  #> $istateReset #> [1] TRUE #>  #> $subsetNonmem #> [1] TRUE #>  #> $hmaxSd #> [1] 0 #>  #> $maxAtolRtolFactor #> [1] 0.1 #>  #> $from #> NULL #>  #> $to #> NULL #>  #> $by #> NULL #>  #> $length.out #> NULL #>  #> $iCov #> NULL #>  #> $keep #> NULL #>  #> $keepF #> character(0) #>  #> $drop #> NULL #>  #> $warnDrop #> [1] TRUE #>  #> $omegaLower #> [1] -Inf #>  #> $omegaUpper #> [1] Inf #>  #> $sigmaLower #> [1] -Inf #>  #> $sigmaUpper #> [1] Inf #>  #> $thetaLower #> [1] -Inf #>  #> $thetaUpper #> [1] Inf #>  #> $indLinPhiM #> [1] 0 #>  #> $indLinPhiTol #> [1] 1e-07 #>  #> $indLinMatExpType #> expokit  #>       2  #>  #> $indLinMatExpOrder #> [1] 6 #>  #> $idFactor #> [1] TRUE #>  #> $mxhnil #> [1] 0 #>  #> $hmxi #> [1] 0 #>  #> $warnIdSort #> [1] TRUE #>  #> $ssAtol #> [1] 1e-08 #>  #> $ssRtol #> [1] 1e-06 #>  #> $safeZero #> [1] 1 #>  #> $sumType #> pairwise  #>        1  #>  #> $prodType #> long double  #>           1  #>  #> $sensType #> advan  #>     4  #>  #> $linDiff #>    tlag       f    rate     dur   tlag2      f2   rate2    dur2  #> 1.5e-05 1.5e-05 1.5e-05 1.5e-05 1.5e-05 1.5e-05 1.5e-05 1.5e-05  #>  #> $linDiffCentral #>  tlag     f  rate   dur tlag2    f2 rate2  dur2  #>  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  #>  #> $resample #> NULL #>  #> $resampleID #> [1] TRUE #>  #> $maxwhile #> [1] 100000 #>  #> $cores #> [1] 0 #>  #> $atolSens #> [1] 1e-08 #>  #> $rtolSens #> [1] 1e-06 #>  #> $ssAtolSens #> [1] 1e-08 #>  #> $ssRtolSens #> [1] 1e-06 #>  #> $simVariability #> [1] NA #>  #> attr(,\"class\") #> [1] \"rxControl\" #>  #> $method #> [1] \"ML\" #>  #> $verbose #> [1] TRUE #>  #> $returnNlme #> [1] FALSE #>  #> $addProp #> [1] \"combined2\" #>  #> $calcTables #> [1] TRUE #>  #> $compress #> [1] TRUE #>  #> $random #> NULL #>  #> $fixed #> NULL #>  #> $weights #> NULL #>  #> $ci #> [1] 0.95 #>  #> $sigdig #> [1] 4 #>  #> $sigdigTable #> [1] 4 #>  #> $genRxControl #> [1] TRUE #>  #> attr(,\"class\") #> [1] \"nlmeControl\""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2.html","id":null,"dir":"Reference","previous_headings":"","what":"nlmixr2 fits population PK and PKPD non-linear mixed effects models. — nlmixr2","title":"nlmixr2 fits population PK and PKPD non-linear mixed effects models. — nlmixr2","text":"nlmixr2 R package fitting population pharmacokinetic (PK) pharmacokinetic-pharmacodynamic (PKPD) models.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"nlmixr2 fits population PK and PKPD non-linear mixed effects models. — nlmixr2","text":"","code":"nlmixr2(   object,   data,   est = NULL,   control = list(),   table = tableControl(),   ...,   save = NULL,   envir = parent.frame() )"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"nlmixr2 fits population PK and PKPD non-linear mixed effects models. — nlmixr2","text":"object Fitted object function specifying model. data nlmixr data est estimation method (methods shown `nlmixr2AllEst()`). Methods can added tools control estimation control object.  expected different type estimation method table output table control object (like `tableControl()`) ... Additional arguments passed nlmixr2est::nlmixr2(). save Boolean save nlmixr2 object rds file working directory.  NULL, uses option \"nlmixr2.save\" envir Environment nlmixr object/function evaluated running estimation routine.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"nlmixr2 fits population PK and PKPD non-linear mixed effects models. — nlmixr2","text":"Either nlmixr2 model nlmixr2 fit object","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"nlmixr2 fits population PK and PKPD non-linear mixed effects models. — nlmixr2","text":"nlmixr2 generalized function allows common access nlmixr2 estimation routines.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2.html","id":"nlmixr-modeling-mini-language","dir":"Reference","previous_headings":"","what":"nlmixr modeling mini-language","title":"nlmixr2 fits population PK and PKPD non-linear mixed effects models. — nlmixr2","text":"Rationale nlmixr estimation routines way specifying models.  Often models specified ways intuitive one estimation routine, make sense another estimation routine.  Sometimes, legacy estimation routines like nlme syntax outside control nlmixr package. unique syntax routine makes routines easier maintain expand, allows interfacing existing packages outside nlmixr (like nlme).  However, model definition language common estimation methods, output object uniform, make easier switch estimation routines facilitate interfacing output external packages like Xpose. nlmixr mini-modeling language, attempts address issue incorporating common language.  language inspired R NONMEM, since languages familiar many pharmacometricians. Initial Estimates boundaries population parameters nlmixr models contained R function two blocks: ini model.  R function can named anything, meant called directly R.  fact try likely get error Error: find function \"ini\". ini model block meant hold initial estimates model, boundaries parameters estimation routines support boundaries (note nlmixr's saem nlme currently support parameter boundaries). explain initial estimates specified start annotated example: shown examples: Simple parameter values specified R-compatible assignment Boundaries specified c(lower, est, upper). Like NONMEM, c(lower,est) equivalent c(lower,est,Inf) Also like NONMEM, c(est) specify lower bound, equivalent   specifying parameter  without R's `c` function. initial estimates specified variance scale, analogy      NONMEM, square roots diagonal elements correspond coefficients      variation used exponential IIV implementation parameters can named almost R compatible name.  Please note : Residual error estimates coded population estimates (.e. using    '=' '<-' statement, '~'). Naming variables start \"_\" supported.  Note R     allow variable starting \"_\" assigned without quoting . Naming variables start \"rx_\" \"nlmixr_\"   supported since rxode2 nlmixr2 use prefixes   internally certain estimation routines calculating residuals. Variable names case sensitive, just like R. \"CL\"    \"Cl\". Initial Estimates subject error distribution (NONMEM's  $OMEGA) mixture models, multivariate normal individual deviations population parameters estimated (NONMEM called eta parameters).  Additionally variance/covariance matrix deviations also estimated (NONMEM OMEGA matrix).  also initial estimates.  nlmixr specified `~` operator typically used R \"modeled \", chosen distinguish estimates population residual error parameters. Continuing prior example, can annotate estimates subject error distribution shown examples: Simple variances specified variable name     estimate separated `~`. Correlated parameters specified sum variable    labels lower triangular matrix covariance    specified left handed side equation. also    separated `~`. Currently model syntax allow comments inside lower triangular matrix. Model Syntax ODE based models (NONMEM's $PK, $PRED, $DES $ERROR) initialization block defined, can define model terms defined variables ini block.  can also mix RxODE blocks model. current method defining nlmixr model specify parameters, possibly RxODE lines: Continuing describing syntax annotated example: points note: Parameters often defined differential equations. differential equations, parameters error terms single      block, instead multiple sections. State names, calculated variables start either \"rx_\"      \"nlmixr_\" since used internally estimation routines. Errors specified using `~`.  Currently can use either add(parameter)      additive error,  prop(parameter) proportional error add(parameter1) + prop(parameter2)      additive plus proportional error.  can also specify norm(parameter) additive error,      since follows normal distribution. routines, like saem require  parameters terms Pop.Parameter + Individual.Deviation.Parameter + Covariate*Covariate.Parameter.      order parameters matter.  similar NONMEM's mu-referencing, though      quite restrictive. type parameter model determined initial block;  Covariates used      model missing ini block.  variables need present modeling      dataset model run. Model Syntax solved PK systems Solved PK systems also currently supported nlmixr `linCmt()` pseudo-function.  annotated example solved system : ##' things keep mind: RxODE allows mixing solved systems ODEs,     implemented nlmixr yet. solved systems implemented one, two three compartment     models without first-order absorption.  models support     lag time tlag parameter. general linear compartment model figures model parameter names.     nlmixr currently knows numbered volumes, Vc/Vp, Clearances terms Cl     Q/CLD.  Additionally nlmixr knows elimination micro-constants (ie K12).  Mixing     parameters models currently supported. Checking model syntax specifying model syntax can check nlmixr interpreting correctly using nlmixr function . Using function can get: general gives information model (type solved system/RxODE), initial estimates well code model block. Using model syntax estimating model model function created, can use dataset estimate parameters model given dataset. dataset RxODE compatible events IDs.  Monolix NONMEM use similar standard nlmixr can support. data converted appropriate format, can use nlmixr function run appropriate code. method estimate model : Currently nlme saem implemented.  example, run model saem, following: options saem controlled saemControl. may wish make sure minimization complete case saem.  can traceplot shows iteration history divided burn-EM phases.  case, burn seems reasonable; may wish increase number iterations EM phase estimation. Overall probably semi-reasonable solution. nlmixr output objects addition unifying modeling language sent estimation routines, outputs currently unified structure. can see fit object typing object name: example shows typical printout nlmixr fit object.  elements fit : type fit (nlme, saem, etc) Metrics goodness fit (AIC, BIC,    logLik). align comparison methods, FOCEi likelihood objective calculated           regardless method used used goodness fit metrics. FOCEi likelihood compared NONMEM's objective function gives          values (based data Wang 2007) Also note saem calculate objective function,             FOCEi used objective function fit. Even though objective functions calculated manner, caution          used comparing fits various estimation routines. next item timing steps fit. can also accessed (fit.s$time). mnemonic, access item shown printout.         true almost items printout. timing fit, parameter estimates displayed (can accessed    fit.s$par.fixed) items rounded R printing, estimate without rounding still accessible `$` syntax.        example, `$Untransformed` gives untransformed parameter values. Untransformed parameter takes log-space parameters back-transforms normal parameters.  CIs        listed back-transformed parameter space. Proportional Errors converted Omega block (accessed fit.s$omega) table fit data. Please note: nlmixr fit object actually data frame.  Saving Rdata object loading        without nlmixr just show data .  worry; fit information vanished,        can bring back simply loading nlmixr, accessing data. Special access fit information (like $omega) needs nlmixr extract information. use $ access information, order precedence : Fit data overall data.frame Information parsed nlmixr model (via $uif) Parameter history available (via $par.hist $par.hist.stacked) Fixed effects table (via $par.fixed) Individual differences typical population parameters (via $eta) Fit information list information generated post-hoc            residual calculation. Fit information environment post-hoc residual calculated Fit information data options interacted specified model            (estimation options solved system infusion IV bolus). printout may displays data data.table object tbl        object, data objects, rather derived data frame. Since object data.frame, can treat like one. addition properties fit object, additional may helpful modeler: $theta gives fixed effects parameter estimates (NONMEM     thetas). can also accessed fixed.effects     function. Note residual variability treated fixed effect parameter     included list. $eta gives random effects parameter estimates, NONMEM     etas.  can also accessed using random.effects     function.","code":"f <- function(){ ## Note the arguments to the function are currently                  ## ignored by nlmixr     ini({         ## Initial conditions for population parameters (sometimes         ## called theta parameters) are defined by either `<-` or '='         lCl <- 1.6      #log Cl (L/hr)         ## Note that simple expressions that evaluate to a number are         ## OK for defining initial conditions (like in R)         lVc = log(90)  #log V (L)         ## Also a comment on a parameter is captured as a parameter label         lKa <- 1 #log Ka (1/hr)         ## Bounds may be specified by c(lower, est, upper), like NONMEM:         ## Residuals errors are assumed to be population parameters         prop.err <- c(0, 0.2, 1)     })     ## The model block will be discussed later     model({}) } f <- function(){     ini({         lCl <- 1.6      #log Cl (L/hr)         lVc = log(90)  #log V (L)         lKa <- 1 #log Ka (1/hr)         prop.err <- c(0, 0.2, 1)         ## Initial estimate for ka IIV variance         ## Labels work for single parameters         eta.ka ~ 0.1 # BSV Ka          ## For correlated parameters, you specify the names of each         ## correlated parameter separated by a addition operator `+`         ## and the left handed side specifies the lower triangular         ## matrix initial of the covariance matrix.         eta.cl + eta.vc ~ c(0.1,                             0.005, 0.1)         ## Note that labels do not currently work for correlated         ## parameters.  Also do not put comments inside the lower         ## triangular matrix as this will currently break the model.     })     ## The model block will be discussed later     model({}) } f <- function(){     ini({         lCl <- 1.6      #log Cl (L/hr)         lVc <- log(90)   #log Vc (L)         lKA <- 0.1      #log Ka (1/hr)         prop.err <- c(0, 0.2, 1)         eta.Cl ~ 0.1 ## BSV Cl         eta.Vc ~ 0.1 ## BSV Vc         eta.KA ~ 0.1 ## BSV Ka     })     model({         ## First parameters are defined in terms of the initial estimates         ## parameter names.         Cl <- exp(lCl + eta.Cl)         Vc = exp(lVc + eta.Vc)         KA <- exp(lKA + eta.KA)         ## After the differential equations are defined         kel <- Cl / Vc;         d/dt(depot)    = -KA*depot;         d/dt(centr)  =  KA*depot-kel*centr;         ## And the concentration is then calculated         cp = centr / Vc;         ## Last, nlmixr is told that the plasma concentration follows         ## a proportional error (estimated by the parameter prop.err)         cp ~ prop(prop.err)     }) } f <- function(){     ini({         lCl <- 1.6      #log Cl (L/hr)         lVc <- log(90)   #log Vc (L)         lKA <- 0.1      #log Ka (1/hr)         prop.err <- c(0, 0.2, 1)         eta.Cl ~ 0.1 ## BSV Cl         eta.Vc ~ 0.1 ## BSV Vc         eta.KA ~ 0.1 ## BSV Ka     })     model({         Cl <- exp(lCl + eta.Cl)         Vc = exp(lVc + eta.Vc)         KA <- exp(lKA + eta.KA)         ## Instead of specifying the ODEs, you can use         ## the linCmt() function to use the solved system.         ##         ## This function determines the type of PK solved system         ## to use by the parameters that are defined.  In this case         ## it knows that this is a one-compartment model with first-order         ## absorption.         linCmt() ~ prop(prop.err)     }) } > nlmixr(f) ## 1-compartment model with first-order absorption in terms of Cl ## Initialization: ################################################################################ Fixed Effects ($theta):     lCl     lVc     lKA 1.60000 4.49981 0.10000  Omega ($omega):      [,1] [,2] [,3] [1,]  0.1  0.0  0.0 [2,]  0.0  0.1  0.0 [3,]  0.0  0.0  0.1  ## Model: ################################################################################ Cl <- exp(lCl + eta.Cl) Vc = exp(lVc + eta.Vc) KA <- exp(lKA + eta.KA) ## Instead of specifying the ODEs, you can use ## the linCmt() function to use the solved system. ## ## This function determines the type of PK solved system ## to use by the parameters that are defined.  In this case ## it knows that this is a one-compartment model with first-order ## absorption. linCmt() ~ prop(prop.err) fit <- nlmixr(model.function, dataset, est=\"est\", control=estControl(options)) > f <- function(){     ini({         lCl <- 1.6      #log Cl (L/hr)         lVc <- log(90)   #log Vc (L)         lKA <- 0.1      #log Ka (1/hr)         prop.err <- c(0, 0.2, 1)         eta.Cl ~ 0.1 ## BSV Cl         eta.Vc ~ 0.1 ## BSV Vc         eta.KA ~ 0.1 ## BSV Ka     })     model({         ## First parameters are defined in terms of the initial estimates         ## parameter names.         Cl <- exp(lCl + eta.Cl)         Vc = exp(lVc + eta.Vc)         KA <- exp(lKA + eta.KA)         ## After the differential equations are defined         kel <- Cl / Vc;         d/dt(depot)    = -KA*depot;         d/dt(centr)  =  KA*depot-kel*centr;         ## And the concentration is then calculated         cp = centr / Vc;         ## Last, nlmixr is told that the plasma concentration follows         ## a proportional error (estimated by the parameter prop.err)         cp ~ prop(prop.err)     }) } > fit.s <- nlmixr(f,d,est=\"saem\",control=saemControl(n.burn=50,n.em=100,print=50)); Compiling RxODE differential equations...done. c:/Rtools/mingw_64/bin/g++  -I\"c:/R/R-34~1.1/include\" -DNDEBUG     -I\"d:/Compiler/gcc-4.9.3/local330/include\"  -Ic:/nlmixr/inst/include -Ic:/R/R-34~1.1/library/STANHE~1/include -Ic:/R/R-34~1.1/library/Rcpp/include -Ic:/R/R-34~1.1/library/RCPPAR~1/include -Ic:/R/R-34~1.1/library/RCPPEI~1/include -Ic:/R/R-34~1.1/library/BH/include   -O2 -Wall  -mtune=core2 -c saem3090757b4bd1x64.cpp -o saem3090757b4bd1x64.o In file included from c:/R/R-34~1.1/library/RCPPAR~1/include/armadillo:52:0,                  from c:/R/R-34~1.1/library/RCPPAR~1/include/RcppArmadilloForward.h:46,                  from c:/R/R-34~1.1/library/RCPPAR~1/include/RcppArmadillo.h:31,                  from saem3090757b4bd1x64.cpp:1: c:/R/R-34~1.1/library/RCPPAR~1/include/armadillo_bits/compiler_setup.hpp:474:96: note: #pragma message: WARNING: use of OpenMP disabled; this compiler doesn't support OpenMP 3.0+    #pragma message (\"WARNING: use of OpenMP disabled; this compiler doesn't support OpenMP 3.0+\")                                                                                                 ^ c:/Rtools/mingw_64/bin/g++ -shared -s -static-libgcc -o saem3090757b4bd1x64.dll tmp.def saem3090757b4bd1x64.o c:/nlmixr/R/rx_855815def56a50f0e7a80e48811d947c_x64.dll -Lc:/R/R-34~1.1/bin/x64 -lRblas -Lc:/R/R-34~1.1/bin/x64 -lRlapack -lgfortran -lm -lquadmath -Ld:/Compiler/gcc-4.9.3/local330/lib/x64 -Ld:/Compiler/gcc-4.9.3/local330/lib -Lc:/R/R-34~1.1/bin/x64 -lR done. 1:    1.8174   4.6328   0.0553   0.0950   0.0950   0.0950   0.6357 50:    1.3900   4.2039   0.0001   0.0679   0.0784   0.1082   0.1992 100:    1.3894   4.2054   0.0107   0.0686   0.0777   0.1111   0.1981 150:    1.3885   4.2041   0.0089   0.0683   0.0778   0.1117   0.1980 Using sympy via SnakeCharmR ## Calculate ETA-based prediction and error derivatives: Calculate Jacobian...................done. Calculate sensitivities....... done. ## Calculate d(f)/d(eta) ## ... ## done ## ... ## done The model-based sensitivities have been calculated Calculating Table Variables... done > fit.s  -- nlmixr SAEM fit (ODE); OBJF calculated from FOCEi approximation -------------       OBJF      AIC      BIC Log-likelihood Condition Number   62337.09 62351.09 62399.01      -31168.55          82.6086   -- Time (sec; fit.s$time): -----------------------------------------------------            saem setup Likelihood Calculation covariance table  elapsed 430.25 31.64                   1.19          0  3.44   -- Parameters (fit.s$par.fixed): -----------------------------------------------               Parameter Estimate     SE    lCl      log Cl (L/hr)     1.39 0.0240  1.73       4.01 (3.83, 4.20)    26.6  lVc         log Vc (L)     4.20 0.0256 0.608       67.0 (63.7, 70.4)    28.5  lKA      log Ka (1/hr)  0.00924 0.0323  349.      1.01 (0.947, 1.08)    34.3  prop.err      prop.err    0.198                             19.8           Shrink(SD)  lCl          0.248  lVc           1.09  lKA           4.19  prop.err      1.81     No correlations in between subject variability (BSV) matrix    Full BSV covariance (fit.s$omega) or correlation (fit.s$omega.R; diagonals=SDs)    Distribution stats (mean/skewness/kurtosis/p-value) available in fit.s$shrink   -- Fit Data (object fit.s is a modified data.frame): ---------------------------  # A tibble: 6,947 x 22    ID     TIME    DV  PRED    RES    WRES IPRED  IRES  IWRES CPRED   CRES  * <fct> <dbl> <dbl> <dbl>  <dbl>   <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>  1 1      0.25  205.  198.   6.60  0.0741  189.  16.2  0.434  198.   6.78  2 1      0.5   311.  349. -38.7  -0.261   330. -19.0 -0.291  349. -38.3  3 1      0.75  389.  464. -74.5  -0.398   434. -45.2 -0.526  463. -73.9  # ... with 6,944 more rows, and 11 more variables: CWRES <dbl>, eta.Cl <dbl>,  #   eta.Vc <dbl>, eta.KA <dbl>, depot <dbl>, centr <dbl>, Cl <dbl>, Vc <dbl>,  #   KA <dbl>, kel <dbl>, cp <dbl>"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"nlmixr2 fits population PK and PKPD non-linear mixed effects models. — nlmixr2","text":"Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/nlmixr2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"nlmixr2 fits population PK and PKPD non-linear mixed effects models. — nlmixr2","text":"","code":"# \\donttest{  one.cmt <- function() {  ini({    ## You may label each parameter with a comment    tka <- 0.45 # Ka    tcl <- log(c(0, 2.7, 100)) # Log Cl    ## This works with interactive models    ## You may also label the preceding line with label(\"label text\")    tv <- 3.45; label(\"log V\")    ## the label(\"Label name\") works with all models    eta.ka ~ 0.6    eta.cl ~ 0.3    eta.v ~ 0.1    add.sd <- 0.7    prop.sd <- 0.01  })  model({    ka <- exp(tka + eta.ka)    cl <- exp(tcl + eta.cl)    v <- exp(tv + eta.v)    linCmt() ~ add(add.sd) + prop(prop.sd)  }) }  fitF <- nlmixr(one.cmt, theo_sd, \"focei\") #>   #>   #>   #> ℹ parameter labels from comments will be replaced by 'label()' #> ℹ use `control` from pipeline #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of full model... #> ✔ done #> → calculate jacobian #> → calculate ∂(f)/∂(η) #> → calculate ∂(R²)/∂(η) #> → finding duplicate expressions in inner model... #> → optimizing duplicate expressions in inner model... #> → finding duplicate expressions in EBE model... #> → optimizing duplicate expressions in EBE model... #> → compiling inner model... #>   #> ✔ done #> → finding duplicate expressions in FD model... #> → optimizing duplicate expressions in FD model... #> → compiling EBE model... #>   #> ✔ done #> → compiling events FD model... #>   #> ✔ done #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 5952 #> → compress parHist in nlmixr2 object, save 2936 #> Warning: gradient problems with initial estimate and covariance; see $scaleInfo #> Warning: last objective function was not at minimum, possible problems in optimization #> Warning: ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.)) #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  fitS <- nlmixr(one.cmt, theo_sd, \"saem\") #>   #>   #>   #> ℹ parameter labels from comments will be replaced by 'label()' #>   #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of saem model... #> ✔ done #> → finding duplicate expressions in saem model... #> ✔ done #> params:\ttka\ttcl\ttv\tV(eta.ka)\tV(eta.cl)\tV(eta.v)\tadd.sd\tprop.sd #> Calculating covariance matrix #> → loading into symengine environment... #> → pruning branches (`if`/`else`) of saem model... #> ✔ done #> → finding duplicate expressions in saem predOnly model 0... #> → finding duplicate expressions in saem predOnly model 1... #> → finding duplicate expressions in saem predOnly model 2... #> → optimizing duplicate expressions in saem predOnly model 2... #> ✔ done #>   #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 5952 #> → compress phiM in nlmixr2 object, save 64632 #> → compress parHist in nlmixr2 object, save 10472  # }"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/preconditionFit.html","id":null,"dir":"Reference","previous_headings":"","what":"Linearly re-parameterize the model to be less sensitive to rounding errors — preconditionFit","title":"Linearly re-parameterize the model to be less sensitive to rounding errors — preconditionFit","text":"Linearly re-parameterize model less sensitive rounding errors","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/preconditionFit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linearly re-parameterize the model to be less sensitive to rounding errors — preconditionFit","text":"","code":"preconditionFit(fit, estType = c(\"full\", \"posthoc\", \"none\"), ntry = 10L)"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/preconditionFit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linearly re-parameterize the model to be less sensitive to rounding errors — preconditionFit","text":"fit nlmixr2 fit preconditioned estType fit linearly reparameterized, \"full\" estimation, \"posthoc\" estimation simply estimation covariance matrix \"none\" fit updated ntry number tries giving pre-conditioned covariance estimate","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/preconditionFit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linearly re-parameterize the model to be less sensitive to rounding errors — preconditionFit","text":"nlmixr2 fit object preconditioned stabilize variance/covariance calculation","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/preconditionFit.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Linearly re-parameterize the model to be less sensitive to rounding errors — preconditionFit","text":"Aoki Y, Nordgren R, Hooker AC. Preconditioning Nonlinear Mixed Effects Models Stabilisation Variance-Covariance Matrix Computations. AAPS J. 2016;18(2):505-518. doi:10.1208/s12248-016-9866-5","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. magrittr %>% nlmixr2est .nlmixrNlmeFun, ACF, VarCorr, augPred, fixed.effects, fixef, getData, getVarCov, groupedData, nlme, nlmixr, nlmixr2NlmeControl, pdBlocked, pdCompSymm, pdConstruct, pdDiag, pdFactor, pdIdent, pdLogChol, pdMat, pdMatrix, pdNatural, pdSymm, random.effects, ranef, reStruct, varComb, varConstPower, varExp, varFixed, varFunc, varIdent, varPower, varWeights rxode2 RxODE, add.dosing, add.sampling, et, eventTable, expit, geom_amt, geom_cens, ini, lotri, model, probit, probitInv, rxCat, rxClean, rxControl, rxParam, rxParams, rxSolve, rxode, rxode2, stat_amt, stat_cens","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/saemControl.html","id":null,"dir":"Reference","previous_headings":"","what":"Control Options for SAEM — saemControl","title":"Control Options for SAEM — saemControl","text":"Control Options SAEM","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/saemControl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control Options for SAEM — saemControl","text":"","code":"saemControl(   seed = 99,   nBurn = 200,   nEm = 300,   nmc = 3,   nu = c(2, 2, 2),   print = 1,   trace = 0,   covMethod = c(\"linFim\", \"fim\", \"r,s\", \"r\", \"s\", \"\"),   calcTables = TRUE,   logLik = FALSE,   nnodesGq = 3,   nsdGq = 1.6,   optExpression = TRUE,   adjObf = TRUE,   sumProd = FALSE,   addProp = c(\"combined2\", \"combined1\"),   tol = 1e-06,   itmax = 30,   type = c(\"nelder-mead\", \"newuoa\"),   powRange = 10,   lambdaRange = 3,   odeRecalcFactor = 10^(0.5),   maxOdeRecalc = 5L,   perSa = 0.75,   perNoCor = 0.75,   perFixOmega = 0.1,   perFixResid = 0.1,   compress = TRUE,   rxControl = NULL,   sigdig = NULL,   sigdigTable = NULL,   ci = 0.95,   muRefCov = TRUE,   ... )"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/saemControl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control Options for SAEM — saemControl","text":"seed Random Seed SAEM step.  (Needs set reproducibility.)  default 99. nBurn Number iterations first phase, ie  MCMC/Stochastic Approximation steps. equivalent Monolix's K_0 K_b. nEm Number iterations Expectation-Maximization (EM) Step. equivalent Monolix's K_1. nmc Number Markov Chains. default 3.  increase number chains numerical integration MC method accurate cost computation.  Monolix equivalent L. nu vector 3 integers. represent     numbers transitions three different kernels used     Hasting-Metropolis algorithm.  default value c(2,2,2),     representing 40 transition initially (value     multiplied 20). first value represents initial number multi-variate     Gibbs samples taken normal distribution. second value represents number uni-variate, multi-     dimensional random walk Gibbs samples taken. third value represents number bootstrap/reshuffling     uni-dimensional random samples taken. print number iterations completed anything printed console.  default, 1. trace integer indicating want trace(1) SAEM algorithm process.  Useful debugging, typical fitting. covMethod Method calculating covariance.      discussion, R Hessian matrix objective     function. S matrix sum individual's     gradient cross-product (evaluated individual empirical     Bayes estimates). \"linFim\" Use Linearized Fisher Information Matrix calculate covariance. \"fim\" Use SAEM-calculated Fisher Information Matrix calculate covariance. \"r,s\" Uses sandwich matrix calculate covariance, : \\(R^-1 \\times S \\times R^-1\\) \"r\" Uses Hessian matrix calculate covariance \\(2\\times R^-1\\) \"s\" Uses crossproduct matrix calculate covariance \\(4\\times S^-1\\) \"\" calculate covariance step. calcTables boolean determine foceiFit calculate tables. default TRUE logLik boolean indicating log-likelihood calculate Gaussian quadrature. nnodesGq number nodes use Gaussian quadrature computing likelihood method (defaults 1, equivalent Laplaclian likelihood) nsdGq span (SD) integrate computing likelihood Gaussian quadrature. Defaults 3 (eg 3 times SD) optExpression Optimize rxode2 expression speed calculation. default turned . adjObf boolean indicate objective function adjusted closer NONMEM's default objective function.  default TRUE sumProd boolean indicating model change multiplication high precision multiplication sums high precision sums using PreciseSums package.  default FALSE. addProp specifies type additive plus proportional   errors, one standard deviations add (combined1)   type variances add (combined2). combined1 error type can described following equation: y = f + (+ b*f^c)*err combined2 error model can described following equation: y = f + sqrt(^2 + b^2*(f^c)^2)*err : - y represents observed value - f represents predicted value -  additive standard deviation - b proportional/power standard deviation - c power exponent (proportional case c=1) tol tolerance regression models used complex residual errors (ie add+prop etc) itmax maximum number iterations regression models used complex residual errors.  number iterations itmax*number parameters type indicates type optimization residuals; Can one c(\"nelder-mead\", \"newuoa\") powRange indicates range powers can take residual errors;  default 10 indicating range c(-10, 10) lambdaRange indicates range Box-Cox Yeo-Johnson parameters constrained ;  default 3 indicating range c(-3,3) odeRecalcFactor ODE recalculation factor ODE solving goes bad, factor rtol/atol reduced maxOdeRecalc Maximum number times reduce ODE tolerances try resolve system bad ODE solve. perSa percent time `nBurn` iterations phase runs runs simulated annealing. perNoCor percentage MCMC phase SAEM algorithm variance/covariance matrix correlations.  Byt defualt 0.75 75 Monte-carlo iteration perFixOmega percentage `nBurn` phase omega values unfixed allow better exploration likelihood surface.  time, omegas fixed optimization. perFixResid percentage `nBurn` phase residual components unfixed allow better exploration likelihood surface. compress object compressed items rxControl `rxode2` ODE solving options fitting, created `rxControl()` sigdig Specifies \"significant digits\" ode solving requests.  specified controls relative absolute tolerances ODE solvers.  default tolerance 0.5*10^(-sigdig-2) regular ODEs. sensitivity equations steady-state solutions default 0.5*10^(-sigdig-1.5) (sensitivity changes applicable liblsoda).  default unspecified (NULL) uses standard atol/rtol. sigdigTable Significant digits final output table. specified, matches significant digits `sigdig` optimization algorithm.  `sigdig` NULL, use 3. ci Confidence level tables.  default 0.95 95% confidence. muRefCov controls mu-referenced covariates `saem` handled differently non mu-referenced covariates.  `TRUE`, mu-referenced covariates special handling.  `FALSE` mu-referenced covariates treated input parameter. ... Additional arguments passed nlmixr2est::saemControl().","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/saemControl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control Options for SAEM — saemControl","text":"List options used nlmixr2 fit     SAEM.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/saemControl.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control Options for SAEM — saemControl","text":"Wenping Wang & Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/setOfv.html","id":null,"dir":"Reference","previous_headings":"","what":"Set/get Objective function type for a nlmixr2 object — setOfv","title":"Set/get Objective function type for a nlmixr2 object — setOfv","text":"Set/get Objective function type nlmixr2 object","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/setOfv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set/get Objective function type for a nlmixr2 object — setOfv","text":"","code":"setOfv(x, type)"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/setOfv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set/get Objective function type for a nlmixr2 object — setOfv","text":"x nlmixr2 fit object type Type objective function use AIC, BIC, $objective","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/setOfv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set/get Objective function type for a nlmixr2 object — setOfv","text":"Nothing","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/setOfv.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Set/get Objective function type for a nlmixr2 object — setOfv","text":"Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/tableControl.html","id":null,"dir":"Reference","previous_headings":"","what":"Output table/data.frame options — tableControl","title":"Output table/data.frame options — tableControl","text":"Output table/data.frame options","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/tableControl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Output table/data.frame options — tableControl","text":"","code":"tableControl(   npde = NULL,   cwres = NULL,   nsim = 300,   ties = TRUE,   censMethod = c(\"truncated-normal\", \"cdf\", \"ipred\", \"pred\", \"epred\", \"omit\"),   seed = 1009,   cholSEtol = (.Machine$double.eps)^(1/3),   state = TRUE,   lhs = TRUE,   eta = TRUE,   covariates = TRUE,   addDosing = FALSE,   subsetNonmem = TRUE,   cores = NULL,   keep = NULL,   drop = NULL )"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/tableControl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Output table/data.frame options — tableControl","text":"npde TRUE, request npde regardless algorithm used. cwres TRUE, request CWRES FOCEi likelihood regardless algorithm used. nsim represents number simulations.  rxode2, supply single subject event tables (created [eventTable()]) ties `TRUE` jitter prediction-discrepancy points discourage ties cdf. censMethod Handle censoring method: - `\"truncated-normal\"` Simulates truncated normal distribution assumption model censoring. - `\"cdf\"` Use cdf-method censoring npde use residuals (`cwres` etc) - `\"omit\"` omit residuals censoring seed object specifying random number generator initialized cholSEtol tolerance `rxode2::choleSE` function state Boolean indicating `state` values included (default `TRUE`) lhs Boolean indicating remaining `lhs` values included (default `TRUE`) eta Boolean indicating `eta` values included (default `TRUE`) covariates Boolean indicating covariates included (default `TRUE`) addDosing Boolean indicating solve add rxode2 EVID related columns.  also include dosing information estimates doses.  default, rxode2 includes estimates observations. (default FALSE). addDosing NULL, include EVID=0 solve exclude model-times EVID=2. addDosing NA classic rxode2 EVID events returned. addDosing TRUE add event information NONMEM-style format; subsetNonmem=FALSE rxode2 also include extra event types (EVID) ending infusion modeled times: EVID=-1 modeled rate infusions turned (matches rate=-1) EVID=-2 modeled duration infusions turned (matches rate=-2) EVID=-10 specified rate infusions turned (matches rate>0) EVID=-20 specified dur infusions turned (matches dur>0) EVID=101,102,103,... Modeled time 101 first model time, 102 second etc. subsetNonmem subset NONMEM compatible EVIDs .  default TRUE. cores Number cores used parallel ODE solving.  equivalent calling setRxThreads() keep keep sent table drop dropped variables sent table","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/tableControl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Output table/data.frame options — tableControl","text":"list table options nlmixr2","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/tableControl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Output table/data.frame options — tableControl","text":"ever want add CWRES/FOCEi objective function can use addCwres ever want add NPDE/EPRED columns can use addNpde","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/tableControl.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Output table/data.frame options — tableControl","text":"Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/traceplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Produce trace-plot for fit if applicable — traceplot","title":"Produce trace-plot for fit if applicable — traceplot","text":"Produce trace-plot fit applicable","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/traceplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produce trace-plot for fit if applicable — traceplot","text":"","code":"traceplot(x, ...)"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/traceplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produce trace-plot for fit if applicable — traceplot","text":"x fit object ... Additional arguments passed nlmixr2plot::traceplot().","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/traceplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produce trace-plot for fit if applicable — traceplot","text":"Fit traceplot nothing.","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/traceplot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Produce trace-plot for fit if applicable — traceplot","text":"Rik Schoemaker, Wenping Wang & Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"VPC based on ui model — vpcPlot","title":"VPC based on ui model — vpcPlot","text":"VPC based ui model","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"VPC based on ui model — vpcPlot","text":"","code":"vpcPlot(   fit,   data = NULL,   n = 300,   bins = \"jenks\",   n_bins = \"auto\",   bin_mid = \"mean\",   show = NULL,   stratify = NULL,   pred_corr = FALSE,   pred_corr_lower_bnd = 0,   pi = c(0.05, 0.95),   ci = c(0.05, 0.95),   uloq = NULL,   lloq = NULL,   log_y = FALSE,   log_y_min = 0.001,   xlab = NULL,   ylab = NULL,   title = NULL,   smooth = TRUE,   vpc_theme = NULL,   facet = \"wrap\",   scales = \"fixed\",   labeller = NULL,   vpcdb = FALSE,   verbose = FALSE,   ...,   seed = 1009 )"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"VPC based on ui model — vpcPlot","text":"fit nlmixr2 fit object data data use augment VPC fit.  default fitted data, (can retrieved getData), can changed specifying argument. n Number VPC simulations.  default 100 bins either \"density\", \"time\", \"data\", \"none\", one approaches available classInterval() \"jenks\" (default) \"pretty\", numeric vector specifying bin separators. n_bins using \"auto\" binning method, number bins aim bin_mid either \"mean\" mean timepoints (default) \"middle\" use average bin boundaries. show show VPC (obs_dv, obs_ci, pi, pi_as_area, pi_ci, obs_median, sim_median, sim_median_ci) stratify character vector stratification variables. 1 2 stratification variables can supplied. pred_corr perform prediction-correction? pred_corr_lower_bnd lower bound prediction-correction pi simulated prediction interval plot. Default c(0.05, 0.95), ci confidence interval plot. Default (0.05, 0.95) uloq Number NULL indicating upper limit quantification. Default NULL. lloq Number NULL indicating lower limit quantification. Default NULL. log_y Boolean indicting whether y-axis shown logarithmic. Default FALSE. log_y_min minimal value using log_y argument. Default 1e-3. xlab label x axis ylab label y axis title title smooth \"smooth\" VPC (connect bin midpoints) show bins rectangular boxes. Default TRUE. vpc_theme theme used VPC. Expects list class vpc_theme created function vpc_theme() facet either \"wrap\", \"columns\", \"rows\" scales either \"fixed\" (default), \"free_y\", \"free_x\" \"free\" labeller ggplot2 labeller function passed underlying ggplot object vpcdb Boolean whether return underlying vpcdb rather plot verbose show debugging information (TRUE FALSE) ... Additional arguments passed nlmixr2plot::vpcPlot(). seed object specifying random number generator initialized","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"VPC based on ui model — vpcPlot","text":"Simulated dataset (invisibly)","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcPlot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"VPC based on ui model — vpcPlot","text":"Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"VPC based on ui model — vpcPlot","text":"","code":"# \\donttest{ one.cmt <- function() {  ini({    ## You may label each parameter with a comment    tka <- 0.45 # Log Ka    tcl <- log(c(0, 2.7, 100)) # Log Cl    ## This works with interactive models    ## You may also label the preceding line with label(\"label text\")    tv <- 3.45; label(\"log V\")    ## the label(\"Label name\") works with all models    eta.ka ~ 0.6    eta.cl ~ 0.3    eta.v ~ 0.1    add.sd <- 0.7  })  model({    ka <- exp(tka + eta.ka)    cl <- exp(tcl + eta.cl)    v <- exp(tv + eta.v)    linCmt() ~ add(add.sd)  }) }  fit <- nlmixr2est::nlmixr(one.cmt, nlmixr2data::theo_sd, est=\"focei\") #>   #>   #>   #> ℹ parameter labels from comments will be replaced by 'label()' #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 5952 #> → compress parHist in nlmixr2 object, save 2072 #> Warning: gradient problems with initial estimate and covariance; see $scaleInfo #> Warning: last objective function was not at minimum, possible problems in optimization #> Warning: ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.)) #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  vpcPlot(fit) #>     # }"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcSim.html","id":null,"dir":"Reference","previous_headings":"","what":"VPC simulation — vpcSim","title":"VPC simulation — vpcSim","text":"VPC simulation","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcSim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"VPC simulation — vpcSim","text":"","code":"vpcSim(object, ..., keep = NULL, n = 300, pred = FALSE, seed = 1009)"},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcSim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"VPC simulation — vpcSim","text":"object nlmixr2 fit object ... Additional arguments passed nlmixr2est::vpcSim(). keep Keep character vector n Number simulations pred predictions added simulation seed Seed set VPC simulation","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcSim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"VPC simulation — vpcSim","text":"data frame VPC simulation","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcSim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"VPC simulation — vpcSim","text":"Matthew L. Fidler","code":""},{"path":"https://nlmixr2.github.io/nlmixr2/reference/vpcSim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"VPC simulation — vpcSim","text":"","code":"# \\donttest{ one.cmt <- function() {  ini({    ## You may label each parameter with a comment    tka <- 0.45 # Log Ka    tcl <- log(c(0, 2.7, 100)) # Log Cl    ## This works with interactive models    ## You may also label the preceding line with label(\"label text\")    tv <- 3.45; label(\"log V\")    ## the label(\"Label name\") works with all models    eta.ka ~ 0.6    eta.cl ~ 0.3    eta.v ~ 0.1    add.sd <- 0.7  })  model({    ka <- exp(tka + eta.ka)    cl <- exp(tcl + eta.cl)    v <- exp(tv + eta.v)    linCmt() ~ add(add.sd)  }) }  fit <- nlmixr(one.cmt, theo_sd, est=\"focei\") #>   #>   #>   #> ℹ parameter labels from comments will be replaced by 'label()' #> → Calculating residuals/tables #> ✔ done #> → compress origData in nlmixr2 object, save 5952 #> → compress parHist in nlmixr2 object, save 2072 #> Warning: gradient problems with initial estimate and covariance; see $scaleInfo #> Warning: last objective function was not at minimum, possible problems in optimization #> Warning: ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.)) #> Warning: initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=))  head(vpcSim(fit, pred=TRUE)) #>   #>   sim.id id time    ipred        sim nlmixrRowNums rxLambda rxYj rxLow rxHi #> 1      1  1 0.00 0.000000 -0.6283886             2        1    2     0    1 #> 2      1  1 0.25 3.019619  2.6545739             3        1    2     0    1 #> 3      1  1 0.57 5.628867  6.6265894             4        1    2     0    1 #> 4      1  1 1.12 8.039087  8.7118336             5        1    2     0    1 #> 5      1  1 2.02 9.211883  8.9025113             6        1    2     0    1 #> 6      1  1 3.82 8.607713  7.9094706             7        1    2     0    1 #>       pred #> 1 0.000000 #> 2 3.262732 #> 3 5.830087 #> 4 7.865576 #> 5 8.506533 #> 6 7.622375  # }"}]
