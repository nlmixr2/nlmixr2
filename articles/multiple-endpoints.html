<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Working with multiple endpoints • nlmixr2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Working with multiple endpoints">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nlmixr2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/running_nlmixr.html">Introduction to Running Nlmixr</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-endpoints.html">Using Multiple Endpoints in Nlmixr</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Going further</h6></li>
    <li><a class="dropdown-item" href="../articles/modelPiping.html">Model Piping</a></li>
    <li><a class="dropdown-item" href="../articles/broom.html">Sweeping models to tidy datasets (broom)</a></li>
    <li><a class="dropdown-item" href="../articles/censoring.html">Censoring in nlmixr2 (M3 and others)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/xgxr-nlmixr-ggpmx.html">Integrated development with xgxr/nlmixr/ggPMX</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/citations.html">Citations of nlmixr2</a></li>
    <li><a class="dropdown-item" href="../articles/nlmixr2-team-and-advisory-committee.html">Who we are</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-example-models" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-chalkboard-teacher"></span> Example models</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-example-models">
<li><a class="dropdown-item" href="../articles/addingCovariances.html">Phenobarbatol with correlations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/nimo.html">Nonlinear PK/PD -- Nimotuzumab</a></li>
    <li><a class="dropdown-item" href="../articles/mavoglurant.html">PBPK -- Mavoglurant</a></li>
    <li><a class="dropdown-item" href="../articles/wbc.html">PKPD -- Myelosuppression model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2/raw/main/CheatSheet_nlmixr_220621.pdf"><span class="fa fa-scroll fa-lg"></span> Cheat Sheet</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://doi.org/10.1002/psp4.12445"><span class="fa fas fa-life-ring"></span> Tutorial</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o fa-lg"></span> Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2/releases"><span class="fa fa-download"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Working with multiple endpoints</h1>
            
            <h4 data-toc-skip class="date">2025-09-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nlmixr2/blob/main/vignettes/multiple-endpoints.Rmd" class="external-link"><code>vignettes/multiple-endpoints.Rmd</code></a></small>
      <div class="d-none name"><code>multiple-endpoints.Rmd</code></div>
    </div>

    
    
<div class="float">
<img src="logo.png" alt="nlmixr"><div class="figcaption">nlmixr</div>
</div>
<div class="section level2">
<h2 id="multiple-endpoints">Multiple endpoints<a class="anchor" aria-label="anchor" href="#multiple-endpoints"></a>
</h2>
<p>Joint PK/PD models, or PK/PD models where you fix certain components
are common in pharmacometrics. A classic example, (provided by Tomoo
Funaki and Nick Holford) is Warfarin.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.org/" class="external-link">nlmixr2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>In this example, we have a transit-compartment (from depot to gut to
central volume) PK model and an effect compartment for the PCA
measurement.</p>
<p>Below is an illustrated example of a model that can be applied to the
data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pk.turnover.emax</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">tktr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">tka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">tcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="va">tv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">eta.ktr</span> <span class="op">~</span> <span class="fl">1</span></span>
<span>    <span class="va">eta.ka</span> <span class="op">~</span> <span class="fl">1</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">~</span> <span class="fl">2</span></span>
<span>    <span class="va">eta.v</span> <span class="op">~</span> <span class="fl">1</span></span>
<span>    <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>    <span class="va">pkadd.err</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">temax</span> <span class="op">&lt;-</span> <span class="fu">logit</span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span></span>
<span>    <span class="co">#temax &lt;- 7.5</span></span>
<span>    <span class="va">tec50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="va">tkout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span></span>
<span>    <span class="va">te0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">eta.emax</span> <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="va">eta.ec50</span>  <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="va">eta.kout</span> <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="va">eta.e0</span> <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">pdadd.err</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">ktr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tktr</span> <span class="op">+</span> <span class="va">eta.ktr</span><span class="op">)</span></span>
<span>    <span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span> <span class="op">+</span> <span class="va">eta.ka</span><span class="op">)</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tcl</span> <span class="op">+</span> <span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tv</span> <span class="op">+</span> <span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="co">#poplogit = log(temax/(1-temax))</span></span>
<span>    <span class="va">emax</span><span class="op">=</span><span class="fu">expit</span><span class="op">(</span><span class="va">temax</span><span class="op">+</span><span class="va">eta.emax</span><span class="op">)</span></span>
<span>    <span class="co">#logit=temax+eta.emax</span></span>
<span>    <span class="va">ec50</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tec50</span> <span class="op">+</span> <span class="va">eta.ec50</span><span class="op">)</span></span>
<span>    <span class="va">kout</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tkout</span> <span class="op">+</span> <span class="va">eta.kout</span><span class="op">)</span></span>
<span>    <span class="va">e0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">te0</span> <span class="op">+</span> <span class="va">eta.e0</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">DCP</span> <span class="op">=</span> <span class="va">center</span><span class="op">/</span><span class="va">v</span></span>
<span>    <span class="va">PD</span><span class="op">=</span><span class="fl">1</span><span class="op">-</span><span class="va">emax</span><span class="op">*</span><span class="va">DCP</span><span class="op">/</span><span class="op">(</span><span class="va">ec50</span><span class="op">+</span><span class="va">DCP</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="fu">effect</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="va">e0</span></span>
<span>    <span class="va">kin</span> <span class="op">=</span> <span class="va">e0</span><span class="op">*</span><span class="va">kout</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">ktr</span> <span class="op">*</span> <span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">gut</span><span class="op">)</span> <span class="op">=</span>  <span class="va">ktr</span> <span class="op">*</span> <span class="va">depot</span> <span class="op">-</span><span class="va">ka</span> <span class="op">*</span> <span class="va">gut</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">center</span><span class="op">)</span> <span class="op">=</span>  <span class="va">ka</span> <span class="op">*</span> <span class="va">gut</span> <span class="op">-</span> <span class="va">cl</span> <span class="op">/</span> <span class="va">v</span> <span class="op">*</span> <span class="va">center</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span> <span class="op">=</span> <span class="va">kin</span><span class="op">*</span><span class="va">PD</span> <span class="op">-</span><span class="va">kout</span><span class="op">*</span><span class="va">effect</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">cp</span> <span class="op">=</span> <span class="va">center</span> <span class="op">/</span> <span class="va">v</span></span>
<span>    <span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span> <span class="op">+</span> <span class="fu">add</span><span class="op">(</span><span class="va">pkadd.err</span><span class="op">)</span></span>
<span>    <span class="va">effect</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">pdadd.err</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Notice there are two endpoints in the model <code>cp</code> and
<code>effect</code>. Both are modeled in nlmixr using the <code>~</code>
“modeled by” specification.</p>
<p>To see more about how nlmixr will handle the multiple compartment
model, it is quite informative to parse the model and print the
information about that model. In this case an initial parsing would
give:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">pk.turnover.emax</span><span class="op">)</span></span>
<span><span class="va">ui</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>t</mi><mi>r</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>a</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>k</mi><mi>a</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>k</mi><mi>a</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>l</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>c</mi><mi>l</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>c</mi><mi>l</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>v</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>v</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>v</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>c</mi><mn>50</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>t</mi><mi>e</mi><mn>0</mn></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>e</mi><mn>0</mn></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>D</mi><mi>C</mi><mi>P</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow><mi>v</mi></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>P</mi><mi>D</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mrow><mi>e</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mo>×</mo><mrow><mi>D</mi><mi>C</mi><mi>P</mi></mrow></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>e</mi><mi>c</mi><mn>50</mn></mrow><mo>+</mo><mrow><mi>D</mi><mi>C</mi><mi>P</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>c</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>k</mi><mi>i</mi><mi>n</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>e</mi><mn>0</mn></mrow><mo>×</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>d</mi><mi>e</mi><mi>p</mi><mi>o</mi><mi>t</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>−</mo><mrow><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>×</mo><mrow><mi>d</mi><mi>e</mi><mi>p</mi><mi>o</mi><mi>t</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>g</mi><mi>u</mi><mi>t</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>t</mi><mi>r</mi></mrow><mo>×</mo><mrow><mi>d</mi><mi>e</mi><mi>p</mi><mi>o</mi><mi>t</mi></mrow><mo>−</mo><mrow><mi>k</mi><mi>a</mi></mrow><mo>×</mo><mrow><mi>g</mi><mi>u</mi><mi>t</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>a</mi></mrow><mo>×</mo><mrow><mi>g</mi><mi>u</mi><mi>t</mi></mrow><mo>−</mo><mfrac><mrow><mi>c</mi><mi>l</mi></mrow><mi>v</mi></mfrac><mo>×</mo><mrow><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mi>e</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>c</mi><mi>t</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi>k</mi><mi>i</mi><mi>n</mi></mrow><mo>×</mo><mrow><mi>P</mi><mi>D</mi></mrow><mo>−</mo><mrow><mi>k</mi><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mo>×</mo><mrow><mi>e</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>c</mi><mi>t</mi></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow><mi>v</mi></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>c</mi><mi>p</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>k</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>e</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>c</mi><mi>t</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>d</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
{ktr} &amp; = \exp\left({tktr}+{eta.ktr}\right) \\
{ka} &amp; = \exp\left({tka}+{eta.ka}\right) \\
{cl} &amp; = \exp\left({tcl}+{eta.cl}\right) \\
{v} &amp; = \exp\left({tv}+{eta.v}\right) \\
{emax} &amp; = expit({temax}+{eta.emax}, {0}, {1}) \\
{ec50} &amp; = \exp\left({tec50}+{eta.ec50}\right) \\
{kout} &amp; = \exp\left({tkout}+{eta.kout}\right) \\
{e0} &amp; = \exp\left({te0}+{eta.e0}\right) \\
{DCP} &amp; = \frac{{center}}{{v}} \\
{PD} &amp; = {1}-\frac{{emax} {\times} {DCP}}{\left({ec50}+{DCP}\right)} \\
effect({0}) &amp; = {e0} \\
{kin} &amp; = {e0} {\times} {kout} \\
\frac{d \: depot}{dt} &amp; = -{ktr} {\times} {depot} \\
\frac{d \: gut}{dt} &amp; = {ktr} {\times} {depot}-{ka} {\times} {gut} \\
\frac{d \: center}{dt} &amp; = {ka} {\times} {gut}-\frac{{cl}}{{v}} {\times} {center} \\
\frac{d \: effect}{dt} &amp; = {kin} {\times} {PD}-{kout} {\times} {effect} \\
{cp} &amp; = \frac{{center}}{{v}} \\
{cp} &amp; \sim prop({prop.err})+add({pkadd.err}) \\
{effect} &amp; \sim add({pdadd.err})
\end{align*}</annotation></semantics></math></p>
<p>In the middle of the printout, it shows how the data must be
formatted (using the <code>cmt</code> and <code>dvid</code> data items)
to allow nlmixr to model the multiple endpoint appropriately.</p>
<p>Of course, if you are interested you can directly access the
information in <code>ui$multipleEndpoint</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ui</span><span class="op">$</span><span class="va">multipleEndpoint</span></span>
<span><span class="co">#&gt;     variable                   cmt                   dvid*</span></span>
<span><span class="co">#&gt; 1     cp ~ …     cmt='cp' or cmt=5     dvid='cp' or dvid=1</span></span>
<span><span class="co">#&gt; 2 effect ~ … cmt='effect' or cmt=4 dvid='effect' or dvid=2</span></span></code></pre></div>
<p>Notice that the <code>cmt</code> and <code>dvid</code> items can use
the named variables directly as either the <code>cmt</code> or
<code>dvid</code> specification. This flexible notation makes it so you
do not have to rename your compartments to run nlmixr model
functions.</p>
<p>The other thing to note is that the <code>cp</code> is specified by
an ODE compartment above the number of compartments defined in the
<code>rxode2</code> part of the <code>nlmixr</code> model. This is
because <code>cp</code> is not a defined compartment, but a related
variable <code>cp</code>.</p>
<p>The last thing to notice that the <code>cmt</code> items are numbered
<code>cmt=5</code> for <code>cp</code> or <code>cmt=4</code> for
<code>effect</code> even though they were specified in the model first
by <code>cp</code> and <code>cmt</code>. This ordering is because
<code>effect</code> is a compartment in the <code>rxode2</code> system.
Of course <code>cp</code> is related to the compartment
<code>center</code>, and it may make more sense to pair <code>cp</code>
with the <code>center</code> compartment.</p>
<p>If this is something you want to have you can specify the compartment
to relate the effect to by the <code>|</code> operator. In this case you
would change</p>
<pre><code><span><span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span> <span class="op">+</span> <span class="fu">add</span><span class="op">(</span><span class="va">pkadd.err</span><span class="op">)</span></span></code></pre>
<p>to</p>
<pre><code><span><span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span> <span class="op">+</span> <span class="fu">add</span><span class="op">(</span><span class="va">pkadd.err</span><span class="op">)</span> <span class="op">|</span> <span class="va">center</span></span></code></pre>
<p>With this change, the model could be updated to:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pk.turnover.emax2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">tktr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">tka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">tcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="va">tv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">eta.ktr</span> <span class="op">~</span> <span class="fl">1</span></span>
<span>    <span class="va">eta.ka</span> <span class="op">~</span> <span class="fl">1</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">~</span> <span class="fl">2</span></span>
<span>    <span class="va">eta.v</span> <span class="op">~</span> <span class="fl">1</span></span>
<span>    <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>    <span class="va">pkadd.err</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">temax</span> <span class="op">&lt;-</span> <span class="fu">logit</span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span></span>
<span>    <span class="va">tec50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="va">tkout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span></span>
<span>    <span class="va">te0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">eta.emax</span> <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="va">eta.ec50</span>  <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="va">eta.kout</span> <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="va">eta.e0</span> <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">pdadd.err</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">ktr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tktr</span> <span class="op">+</span> <span class="va">eta.ktr</span><span class="op">)</span></span>
<span>    <span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span> <span class="op">+</span> <span class="va">eta.ka</span><span class="op">)</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tcl</span> <span class="op">+</span> <span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tv</span> <span class="op">+</span> <span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">emax</span><span class="op">=</span><span class="fu">expit</span><span class="op">(</span><span class="va">temax</span><span class="op">+</span><span class="va">eta.emax</span><span class="op">)</span></span>
<span>    <span class="va">ec50</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tec50</span> <span class="op">+</span> <span class="va">eta.ec50</span><span class="op">)</span></span>
<span>    <span class="va">kout</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tkout</span> <span class="op">+</span> <span class="va">eta.kout</span><span class="op">)</span></span>
<span>    <span class="va">e0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">te0</span> <span class="op">+</span> <span class="va">eta.e0</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">DCP</span> <span class="op">=</span> <span class="va">center</span><span class="op">/</span><span class="va">v</span></span>
<span>    <span class="va">PD</span><span class="op">=</span><span class="fl">1</span><span class="op">-</span><span class="va">emax</span><span class="op">*</span><span class="va">DCP</span><span class="op">/</span><span class="op">(</span><span class="va">ec50</span><span class="op">+</span><span class="va">DCP</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="fu">effect</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="va">e0</span></span>
<span>    <span class="va">kin</span> <span class="op">=</span> <span class="va">e0</span><span class="op">*</span><span class="va">kout</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">ktr</span> <span class="op">*</span> <span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">gut</span><span class="op">)</span> <span class="op">=</span>  <span class="va">ktr</span> <span class="op">*</span> <span class="va">depot</span> <span class="op">-</span><span class="va">ka</span> <span class="op">*</span> <span class="va">gut</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">center</span><span class="op">)</span> <span class="op">=</span>  <span class="va">ka</span> <span class="op">*</span> <span class="va">gut</span> <span class="op">-</span> <span class="va">cl</span> <span class="op">/</span> <span class="va">v</span> <span class="op">*</span> <span class="va">center</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span> <span class="op">=</span> <span class="va">kin</span><span class="op">*</span><span class="va">PD</span> <span class="op">-</span><span class="va">kout</span><span class="op">*</span><span class="va">effect</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">cp</span> <span class="op">=</span> <span class="va">center</span> <span class="op">/</span> <span class="va">v</span></span>
<span>    <span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span> <span class="op">+</span> <span class="fu">add</span><span class="op">(</span><span class="va">pkadd.err</span><span class="op">)</span> <span class="op">|</span> <span class="va">center</span></span>
<span>    <span class="va">effect</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">pdadd.err</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ui2</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">pk.turnover.emax2</span><span class="op">)</span></span>
<span><span class="va">ui2</span><span class="op">$</span><span class="va">multipleEndpoint</span></span>
<span><span class="co">#&gt;     variable                   cmt                   dvid*</span></span>
<span><span class="co">#&gt; 1     cp ~ … cmt='center' or cmt=3 dvid='center' or dvid=1</span></span>
<span><span class="co">#&gt; 2 effect ~ … cmt='effect' or cmt=4 dvid='effect' or dvid=2</span></span></code></pre></div>
<p>Notice in this case the <code>cmt</code> variables are numbered
sequentially and the <code>cp</code> variable matches the
<code>center</code> compartment.</p>
<div class="section level3">
<h3 id="dvid-vs-cmt-which-one-is-used">DVID vs CMT, which one is used<a class="anchor" aria-label="anchor" href="#dvid-vs-cmt-which-one-is-used"></a>
</h3>
<p>When <code>dvid</code> and <code>cmt</code> are combined in the same
dataset, the <code>cmt</code> data item is always used on the event
information and the <code>dvid</code> is used on the observations.
<code>nlmixr</code> expects the <code>cmt</code> data item to match the
<code>dvid</code> item for observations OR to be either zero or one for
the <code>dvid</code> to replace the <code>cmt</code> information.</p>
<p>If you do not wish to use <code>dvid</code> items to define multiple
endpoints in nlmixr, you can set the following option:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>rxode2.combine.dvid<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">ui2</span><span class="op">$</span><span class="va">multipleEndpoint</span></span>
<span><span class="co">#&gt;     variable                   cmt</span></span>
<span><span class="co">#&gt; 1     cp ~ … cmt='center' or cmt=3</span></span>
<span><span class="co">#&gt; 2 effect ~ … cmt='effect' or cmt=4</span></span></code></pre></div>
<p>Then only <code>cmt</code> items are used for the multiple endpoint
models. Of course you can turn it on or off for different models if you
wish:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>rxode2.combine.dvid<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ui2</span><span class="op">$</span><span class="va">multipleEndpoint</span></span>
<span><span class="co">#&gt;     variable                   cmt                   dvid*</span></span>
<span><span class="co">#&gt; 1     cp ~ … cmt='center' or cmt=3 dvid='center' or dvid=1</span></span>
<span><span class="co">#&gt; 2 effect ~ … cmt='effect' or cmt=4 dvid='effect' or dvid=2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-a-multiple-endpoint-model">Running a multiple endpoint model<a class="anchor" aria-label="anchor" href="#running-a-multiple-endpoint-model"></a>
</h3>
<p>With this information, we can use the built-in warfarin dataset in
<code>nlmixr2</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">warfarin</span><span class="op">)</span></span>
<span><span class="co">#&gt;        id             time             amt                dv          dvid    </span></span>
<span><span class="co">#&gt;  Min.   : 1.00   Min.   :  0.00   Min.   :  0.000   Min.   :  0.00   cp :283  </span></span>
<span><span class="co">#&gt;  1st Qu.: 8.00   1st Qu.: 24.00   1st Qu.:  0.000   1st Qu.:  4.50   pca:232  </span></span>
<span><span class="co">#&gt;  Median :15.00   Median : 48.00   Median :  0.000   Median : 11.40            </span></span>
<span><span class="co">#&gt;  Mean   :16.08   Mean   : 52.08   Mean   :  6.524   Mean   : 20.02            </span></span>
<span><span class="co">#&gt;  3rd Qu.:24.00   3rd Qu.: 96.00   3rd Qu.:  0.000   3rd Qu.: 26.00            </span></span>
<span><span class="co">#&gt;  Max.   :33.00   Max.   :144.00   Max.   :153.000   Max.   :100.00            </span></span>
<span><span class="co">#&gt;       evid               wt              age            sex     </span></span>
<span><span class="co">#&gt;  Min.   :0.00000   Min.   : 40.00   Min.   :21.00   female:101  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.00000   1st Qu.: 60.00   1st Qu.:23.00   male  :414  </span></span>
<span><span class="co">#&gt;  Median :0.00000   Median : 70.00   Median :28.00               </span></span>
<span><span class="co">#&gt;  Mean   :0.06214   Mean   : 69.27   Mean   :31.85               </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.00000   3rd Qu.: 78.00   3rd Qu.:36.00               </span></span>
<span><span class="co">#&gt;  Max.   :1.00000   Max.   :102.00   Max.   :63.00</span></span></code></pre></div>
<p>Since dvid specifies <code>pca</code> as the effect endpoint, you can
update the model to be more explicit making one last change:</p>
<pre><code><span><span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span> <span class="op">+</span> <span class="fu">add</span><span class="op">(</span><span class="va">pkadd.err</span><span class="op">)</span></span>
<span><span class="va">effect</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">pdadd.err</span><span class="op">)</span> </span></code></pre>
<p>to</p>
<pre><code><span><span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span> <span class="op">+</span> <span class="fu">add</span><span class="op">(</span><span class="va">pkadd.err</span><span class="op">)</span></span>
<span><span class="va">effect</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">pdadd.err</span><span class="op">)</span>  <span class="op">|</span> <span class="va">pca</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pk.turnover.emax3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">tktr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">tka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">tcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="va">tv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">eta.ktr</span> <span class="op">~</span> <span class="fl">1</span></span>
<span>    <span class="va">eta.ka</span> <span class="op">~</span> <span class="fl">1</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">~</span> <span class="fl">2</span></span>
<span>    <span class="va">eta.v</span> <span class="op">~</span> <span class="fl">1</span></span>
<span>    <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>    <span class="va">pkadd.err</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">temax</span> <span class="op">&lt;-</span> <span class="fu">logit</span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span></span>
<span>    <span class="va">tec50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="va">tkout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span></span>
<span>    <span class="va">te0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">eta.emax</span> <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="va">eta.ec50</span>  <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="va">eta.kout</span> <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="va">eta.e0</span> <span class="op">~</span> <span class="fl">.5</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">pdadd.err</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">ktr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tktr</span> <span class="op">+</span> <span class="va">eta.ktr</span><span class="op">)</span></span>
<span>    <span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span> <span class="op">+</span> <span class="va">eta.ka</span><span class="op">)</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tcl</span> <span class="op">+</span> <span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tv</span> <span class="op">+</span> <span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="va">emax</span> <span class="op">=</span> <span class="fu">expit</span><span class="op">(</span><span class="va">temax</span><span class="op">+</span><span class="va">eta.emax</span><span class="op">)</span></span>
<span>    <span class="va">ec50</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tec50</span> <span class="op">+</span> <span class="va">eta.ec50</span><span class="op">)</span></span>
<span>    <span class="va">kout</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tkout</span> <span class="op">+</span> <span class="va">eta.kout</span><span class="op">)</span></span>
<span>    <span class="va">e0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">te0</span> <span class="op">+</span> <span class="va">eta.e0</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">DCP</span> <span class="op">=</span> <span class="va">center</span><span class="op">/</span><span class="va">v</span></span>
<span>    <span class="va">PD</span><span class="op">=</span><span class="fl">1</span><span class="op">-</span><span class="va">emax</span><span class="op">*</span><span class="va">DCP</span><span class="op">/</span><span class="op">(</span><span class="va">ec50</span><span class="op">+</span><span class="va">DCP</span><span class="op">)</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="fu">effect</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="va">e0</span></span>
<span>    <span class="va">kin</span> <span class="op">=</span> <span class="va">e0</span><span class="op">*</span><span class="va">kout</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">ktr</span> <span class="op">*</span> <span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">gut</span><span class="op">)</span> <span class="op">=</span>  <span class="va">ktr</span> <span class="op">*</span> <span class="va">depot</span> <span class="op">-</span><span class="va">ka</span> <span class="op">*</span> <span class="va">gut</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">center</span><span class="op">)</span> <span class="op">=</span>  <span class="va">ka</span> <span class="op">*</span> <span class="va">gut</span> <span class="op">-</span> <span class="va">cl</span> <span class="op">/</span> <span class="va">v</span> <span class="op">*</span> <span class="va">center</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span> <span class="op">=</span> <span class="va">kin</span><span class="op">*</span><span class="va">PD</span> <span class="op">-</span><span class="va">kout</span><span class="op">*</span><span class="va">effect</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="va">cp</span> <span class="op">=</span> <span class="va">center</span> <span class="op">/</span> <span class="va">v</span></span>
<span>    <span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span> <span class="op">+</span> <span class="fu">add</span><span class="op">(</span><span class="va">pkadd.err</span><span class="op">)</span></span>
<span>    <span class="va">effect</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">pdadd.err</span><span class="op">)</span> <span class="op">|</span> <span class="va">pca</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-the-models-with-saem">Run the models with SAEM<a class="anchor" aria-label="anchor" href="#run-the-models-with-saem"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.TOS</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">pk.turnover.emax3</span>, <span class="va">warfarin</span>, <span class="st">"saem"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>                  table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cwres<span class="op">=</span><span class="cn">TRUE</span>, npde<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit.TOS</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r²</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">SAEM </span><span style="color: #555555; font-weight: bold; font-style: italic;">OBJF by FOCEi approximation</span><span style="font-weight: bold;"> ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor)</span></span>
<span><span class="co">#&gt; FOCEi 1384.332 2310.026 2389.447      -1136.013        3858.333        21.90437</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            setup optimize covariance   saem  table compress</span></span>
<span><span class="co">#&gt; elapsed 0.002848    7e-06   0.040017 89.608 15.726    0.026</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span>  <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV% or SD)</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tktr</span>        0.439  0.557   127      1.55 (0.521, 4.62)           110.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>        -0.262  0.279   107      0.77 (0.445, 1.33)           13.4</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>         -1.97 0.0515  2.62     0.14 (0.126, 0.155)           26.8</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>           2.01 0.0483  2.41       7.43 (6.76, 8.17)           21.7</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">prop.err</span>     0.12                                 0.12               </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pkadd.err</span>   0.805                                0.805               </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">temax</span>        3.44  0.694  20.2    0.969 (0.889, 0.992)          0.251</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tec50</span>     -0.0938  0.146   155      0.91 (0.684, 1.21)           45.9</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tkout</span>       -2.94 0.0384  1.31 0.0531 (0.0492, 0.0572)           5.97</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">te0</span>          4.57 0.0116 0.253       96.6 (94.4, 98.8)           5.29</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pdadd.err</span>     3.6                                  3.6               </span></span>
<span><span class="co">#&gt;           <span style="font-weight: bold;">Shrink(SD)%</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tktr</span>           <span style="color: #BB0000; font-weight: bold;">44.2%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>            <span style="color: #BB0000; font-weight: bold;">81.7%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>            6.72% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>             15.9% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">prop.err</span>             </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pkadd.err</span>            </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">temax</span>          <span style="color: #BB0000; font-weight: bold;">81.3%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tec50</span>          9.87% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tkout</span>          <span style="color: #BB0000; font-weight: bold;">45.6%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">te0</span>            17.1% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pdadd.err</span>            </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">linFim</span></span></span>
<span><span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span></span>
<span><span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span></span>
<span><span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span></span>
<span><span class="co">#&gt;   Censoring (<span style="color: #0000BB; font-weight: bold;">$censInformation</span>): No censoring</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 483 × 44</span></span></span>
<span><span class="co">#&gt;   ID     TIME CMT      DV EPRED  ERES  NPDE    NPD    PDE     PD  PRED   RES</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1       0.5 cp      0    1.76 -<span style="color: #BB0000;">1.76</span> -<span style="color: #BB0000;">1.79</span> -<span style="color: #BB0000;">1.50</span>  0.036<span style="text-decoration: underline;">7</span> 0.066<span style="text-decoration: underline;">7</span>  1.38 -<span style="color: #BB0000;">1.38</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1       1   cp      1.9  4.06 -<span style="color: #BB0000;">2.16</span>  1.75 -<span style="color: #BB0000;">0.954</span> 0.96   0.17    3.87 -<span style="color: #BB0000;">1.97</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1       2   cp      3.3  7.93 -<span style="color: #BB0000;">4.63</span> -<span style="color: #BB0000;">1.99</span> -<span style="color: #BB0000;">1.71</span>  0.023<span style="text-decoration: underline;">3</span> 0.043<span style="text-decoration: underline;">3</span>  8.18 -<span style="color: #BB0000;">4.88</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 480 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 32 more variables: WRES &lt;dbl&gt;, IPRED &lt;dbl&gt;, IRES &lt;dbl&gt;, IWRES &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   CPRED &lt;dbl&gt;, CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.ktr &lt;dbl&gt;, eta.ka &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;, eta.emax &lt;dbl&gt;, eta.ec50 &lt;dbl&gt;, eta.kout &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   eta.e0 &lt;dbl&gt;, depot &lt;dbl&gt;, gut &lt;dbl&gt;, center &lt;dbl&gt;, effect &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ktr &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, emax &lt;dbl&gt;, ec50 &lt;dbl&gt;, kout &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   e0 &lt;dbl&gt;, DCP &lt;dbl&gt;, PD.1 &lt;dbl&gt;, kin &lt;dbl&gt;, tad &lt;dbl&gt;, dosenum &lt;dbl&gt;</span></span></span></code></pre></div>
<div class="section level4">
<h4 id="saem-diagnostic-plots">SAEM Diagnostic plots<a class="anchor" aria-label="anchor" href="#saem-diagnostic-plots"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit.TOS</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-1.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-2.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-3.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-4.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-5.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-6.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-7.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-8.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-9.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-10.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-11.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-12.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-13.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-14.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-15.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-16.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-17.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-18.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-19.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-20.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-21.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-22.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-23.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-24.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-25.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-26.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-27.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-28.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-29.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-30.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-31.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-32.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-33.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-34.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-35.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-36.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-37.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-38.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-39.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-40.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-41.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-42.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-43.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-44.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-45.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-46.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-47.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-48.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-49.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-50.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-51.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-52.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-53.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-54.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-55.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-56.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-57.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-58.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-59.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-60.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-61.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-62.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-63.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-64.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-65.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-66.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-67.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-68.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-69.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-70.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-71.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-72.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-73.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-74.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-75.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-76.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-77.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-78.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-79.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-80.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-81.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-82.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-83.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-84.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-85.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-86.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-87.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-88.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-89.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-90.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-91.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-92.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-93.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-94.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-95.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-96.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-97.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-98.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-99.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-100.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-101.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-102.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-103.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-104.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-105.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-106.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-107.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-108.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-109.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-110.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-111.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-112.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-113.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-114.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-115.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-116.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-117.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-118.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-119.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-120.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-121.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-122.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-123.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-124.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-125.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-126.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-127.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-128.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-129.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-130.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-131.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-132.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-133.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-134.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-135.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-136.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-137.png" width="100%"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">v1s</span> <span class="op">&lt;-</span> <span class="fu">vpcPlot</span><span class="op">(</span><span class="va">fit.TOS</span>, show<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, scales<span class="op">=</span><span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Warfarin Cp [mg/L] or PCA"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">v2s</span> <span class="op">&lt;-</span> <span class="fu">vpcPlot</span><span class="op">(</span><span class="va">fit.TOS</span>, show<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, pred_corr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Prediction Corrected Warfarin Cp [mg/L] or PCA"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">v1s</span></span></code></pre></div>
<p><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-138.png" width="100%"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v2s</span></span></code></pre></div>
<p><img src="multiple-endpoints_files/figure-html/unnamed-chunk-12-139.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="focei-fits">FOCEi fits<a class="anchor" aria-label="anchor" href="#focei-fits"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## FOCEi fit/vpcs</span></span>
<span><span class="va">fit.TOF</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">pk.turnover.emax3</span>, <span class="va">warfarin</span>, <span class="st">"focei"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>                  table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cwres<span class="op">=</span><span class="cn">TRUE</span>, npde<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; calculating covariance matrix</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:01:12 </span></span>
<span><span class="co">#&gt; done</span></span></code></pre></div>
<div class="section level4">
<h4 id="focei-diagnostic-plots">FOCEi Diagnostic Plots<a class="anchor" aria-label="anchor" href="#focei-diagnostic-plots"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit.TOF</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r²</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor)</span></span>
<span><span class="co">#&gt; FOCEi 1409.421 2335.116 2414.536      -1148.558        32318.05        93.02754</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           setup optimize covariance table compress    other</span></span>
<span><span class="co">#&gt; elapsed 0.00256 72.77665   72.77665 1.552     0.01 36.13213</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span>     <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV% or SD)</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tktr</span>      0.104    2.2 2.11e+03      1.11 (0.015, 82.2)           101.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>       0.302   2.18      723       1.35 (0.0188, 97)           120.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>       -2.04  0.109     5.36     0.13 (0.105, 0.162)           27.3</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>         2.06 0.0916     4.44       7.87 (6.57, 9.42)           22.4</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">prop.err</span>  0.148                                   0.148               </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pkadd.err</span> 0.172                                   0.172               </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">temax</span>      4.75    6.2      130     0.991 (0.000614, 1)          0.590</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tec50</span>     0.157  0.229      146      1.17 (0.747, 1.83)           47.7</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tkout</span>     -2.93  0.128     4.36 0.0534 (0.0416, 0.0686)           15.4</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">te0</span>        4.57 0.0399    0.874          96.3 (89, 104)           10.3</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pdadd.err</span>  3.76                                    3.76               </span></span>
<span><span class="co">#&gt;           <span style="font-weight: bold;">Shrink(SD)%</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tktr</span>           <span style="color: #BB0000; font-weight: bold;">62.3%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>            <span style="color: #BB0000; font-weight: bold;">60.6%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>         <span style="color: #BB0000; font-weight: bold;">-0.0757%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>             10.3% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">prop.err</span>             </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pkadd.err</span>            </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">temax</span>          <span style="color: #BB0000; font-weight: bold;">95.1%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tec50</span>          5.19% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tkout</span>          <span style="color: #BB0000; font-weight: bold;">32.3%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">te0</span>            <span style="color: #BB0000; font-weight: bold;">39.6%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">pdadd.err</span>            </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">s</span></span></span>
<span><span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span></span>
<span><span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span></span>
<span><span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span></span>
<span><span class="co">#&gt;   Information about run found (<span style="color: #0000BB; font-weight: bold;">$runInfo</span>):</span></span>
<span><span class="co">#&gt;    • gradient problems with initial estimate and covariance; see $scaleInfo </span></span>
<span><span class="co">#&gt;    • using S matrix to calculate covariance, can check sandwich or R matrix with $covRS and $covR </span></span>
<span><span class="co">#&gt;    • last objective function was not at minimum, possible problems in optimization </span></span>
<span><span class="co">#&gt;    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.)) </span></span>
<span><span class="co">#&gt;    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) </span></span>
<span><span class="co">#&gt;   Censoring (<span style="color: #0000BB; font-weight: bold;">$censInformation</span>): No censoring</span></span>
<span><span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span></span>
<span><span class="co">#&gt;     false convergence (8) </span></span>
<span><span class="co">#&gt;   In an ODE system, false convergence may mean "useless" evaluations were performed.</span></span>
<span><span class="co">#&gt;   See https://tinyurl.com/yyrrwkce</span></span>
<span><span class="co">#&gt;   It could also mean the convergence is poor, check results before accepting fit</span></span>
<span><span class="co">#&gt;   You may also try a good derivative free optimization:</span></span>
<span><span class="co">#&gt;     nlmixr2(...,control=list(outerOpt="bobyqa"))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 483 × 44</span></span></span>
<span><span class="co">#&gt;   ID     TIME CMT      DV EPRED  ERES  NPDE    NPD    PDE    PD  PRED   RES</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1       0.5 cp      0    2.22 -<span style="color: #BB0000;">2.22</span> -<span style="color: #BB0000;">1.48</span> -<span style="color: #BB0000;">2.33</span>  0.07   0.01   1.59 -<span style="color: #BB0000;">1.59</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1       1   cp      1.9  4.67 -<span style="color: #BB0000;">2.77</span>  1.88 -<span style="color: #BB0000;">0.795</span> 0.97   0.213  4.36 -<span style="color: #BB0000;">2.46</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1       2   cp      3.3  7.92 -<span style="color: #BB0000;">4.62</span> -<span style="color: #BB0000;">2.13</span> -<span style="color: #BB0000;">1.19</span>  0.016<span style="text-decoration: underline;">7</span> 0.117  8.76 -<span style="color: #BB0000;">5.46</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 480 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 32 more variables: WRES &lt;dbl&gt;, IPRED &lt;dbl&gt;, IRES &lt;dbl&gt;, IWRES &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   CPRED &lt;dbl&gt;, CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.ktr &lt;dbl&gt;, eta.ka &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;, eta.emax &lt;dbl&gt;, eta.ec50 &lt;dbl&gt;, eta.kout &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   eta.e0 &lt;dbl&gt;, depot &lt;dbl&gt;, gut &lt;dbl&gt;, center &lt;dbl&gt;, effect &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ktr &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, emax &lt;dbl&gt;, ec50 &lt;dbl&gt;, kout &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   e0 &lt;dbl&gt;, DCP &lt;dbl&gt;, PD.1 &lt;dbl&gt;, kin &lt;dbl&gt;, tad &lt;dbl&gt;, dosenum &lt;dbl&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit.TOF</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-1.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-2.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-3.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-4.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-5.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-6.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-7.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-8.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-9.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-10.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-11.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-12.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-13.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-14.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-15.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-16.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-17.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-18.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-19.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-20.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-21.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-22.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-23.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-24.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-25.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-26.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-27.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-28.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-29.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-30.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-31.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-32.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-33.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-34.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-35.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-36.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-37.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-38.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-39.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-40.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-41.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-42.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-43.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-44.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-45.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-46.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-47.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-48.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-49.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-50.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-51.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-52.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-53.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-54.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-55.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-56.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-57.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-58.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-59.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-60.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-61.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-62.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-63.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-64.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-65.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-66.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-67.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-68.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-69.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-70.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-71.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-72.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-73.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-74.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-75.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-76.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-77.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-78.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-79.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-80.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-81.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-82.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-83.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-84.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-85.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-86.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-87.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-88.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-89.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-90.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-91.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-92.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-93.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-94.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-95.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-96.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-97.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-98.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-99.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-100.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-101.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-102.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-103.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-104.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-105.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-106.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-107.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-108.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-109.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-110.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-111.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-112.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-113.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-114.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-115.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-116.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-117.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-118.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-119.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-120.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-121.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-122.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-123.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-124.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-125.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-126.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-127.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-128.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-129.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-130.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-131.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-132.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-133.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-134.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-135.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-136.png" width="100%"><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-137.png" width="100%"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">v1f</span> <span class="op">&lt;-</span> <span class="fu">vpcPlot</span><span class="op">(</span><span class="va">fit.TOF</span>, show<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, scales<span class="op">=</span><span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Warfarin Cp [mg/L] or PCA"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">v2f</span> <span class="op">&lt;-</span> <span class="fu">vpcPlot</span><span class="op">(</span><span class="va">fit.TOF</span>, show<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, pred_corr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Prediction Corrected Warfarin Cp [mg/L] or PCA"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">v1f</span></span></code></pre></div>
<p><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-138.png" width="100%"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v2f</span></span></code></pre></div>
<p><img src="multiple-endpoints_files/figure-html/unnamed-chunk-14-139.png" width="100%"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Fidler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
