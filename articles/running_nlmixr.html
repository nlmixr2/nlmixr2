<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Running PK models with nlmixr • nlmixr2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Running PK models with nlmixr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nlmixr2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/running_nlmixr.html">Introduction to Running Nlmixr</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-endpoints.html">Using Multiple Endpoints in Nlmixr</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Going further</h6></li>
    <li><a class="dropdown-item" href="../articles/modelPiping.html">Model Piping</a></li>
    <li><a class="dropdown-item" href="../articles/broom.html">Sweeping models to tidy datasets (broom)</a></li>
    <li><a class="dropdown-item" href="../articles/censoring.html">Censoring in nlmixr2 (M3 and others)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/xgxr-nlmixr-ggpmx.html">Integrated development with xgxr/nlmixr/ggPMX</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/citations.html">Citations of nlmixr2</a></li>
    <li><a class="dropdown-item" href="../articles/nlmixr2-team-and-advisory-committee.html">Who we are</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-example-models" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-chalkboard-teacher"></span> Example models</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-example-models">
<li><a class="dropdown-item" href="../articles/addingCovariances.html">Phenobarbatol with correlations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/nimo.html">Nonlinear PK/PD -- Nimotuzumab</a></li>
    <li><a class="dropdown-item" href="../articles/mavoglurant.html">PBPK -- Mavoglurant</a></li>
    <li><a class="dropdown-item" href="../articles/wbc.html">PKPD -- Myelosuppression model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2/raw/main/CheatSheet_nlmixr_220621.pdf"><span class="fa fa-scroll fa-lg"></span> Cheat Sheet</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://doi.org/10.1002/psp4.12445"><span class="fa fas fa-life-ring"></span> Tutorial</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o fa-lg"></span> Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2/releases"><span class="fa fa-download"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Running PK models with nlmixr</h1>
            
            <h4 data-toc-skip class="date">2025-11-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nlmixr2/blob/main/vignettes/running_nlmixr.Rmd" class="external-link"><code>vignettes/running_nlmixr.Rmd</code></a></small>
      <div class="d-none name"><code>running_nlmixr.Rmd</code></div>
    </div>

    
    
<div class="float">
<img src="logo.png" alt="nlmixr"><div class="figcaption">nlmixr</div>
</div>
<div class="section level2">
<h2 id="running-pk-models-with-nlmixr">Running PK models with nlmixr<a class="anchor" aria-label="anchor" href="#running-pk-models-with-nlmixr"></a>
</h2>
<p>nlmixr uses a unified interface for specifying and running models.
Let’s start with a very simple PK example, using the single-dose
theophylline dataset generously provided by Dr. Robert A. Upton of the
University of California, San Francisco:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.org/" class="external-link">nlmixr2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">theo_sd</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    144 obs. of  7 variables:</span></span>
<span><span class="co">#&gt;  $ ID  : int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ TIME: num  0 0 0.25 0.57 1.12 2.02 3.82 5.1 7.03 9.05 ...</span></span>
<span><span class="co">#&gt;  $ DV  : num  0 0.74 2.84 6.57 10.5 9.66 8.58 8.36 7.47 6.89 ...</span></span>
<span><span class="co">#&gt;  $ AMT : num  320 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ EVID: int  101 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ CMT : int  1 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ WT  : num  79.6 79.6 79.6 79.6 79.6 79.6 79.6 79.6 79.6 79.6 ...</span></span></code></pre></div>
<p>We can try fitting a simple one-compartment PK model to this small
dataset. We write the model as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">one.cmt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="co">## You may label each parameter with a comment</span></span>
<span>    <span class="va">tka</span> <span class="op">&lt;-</span> <span class="fl">0.45</span> <span class="co"># Log Ka</span></span>
<span>    <span class="va">tcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.7</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="co"># Log Cl</span></span>
<span>    <span class="co">## This works with interactive models</span></span>
<span>    <span class="co">## You may also label the preceding line with label("label text")</span></span>
<span>    <span class="va">tv</span> <span class="op">&lt;-</span> <span class="fl">3.45</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"log V"</span><span class="op">)</span></span>
<span>    <span class="co">## the label("Label name") works with all models</span></span>
<span>    <span class="va">eta.ka</span> <span class="op">~</span> <span class="fl">0.6</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">~</span> <span class="fl">0.3</span></span>
<span>    <span class="va">eta.v</span> <span class="op">~</span> <span class="fl">0.1</span></span>
<span>    <span class="va">add.sd</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span> <span class="op">+</span> <span class="va">eta.ka</span><span class="op">)</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tcl</span> <span class="op">+</span> <span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tv</span> <span class="op">+</span> <span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="fu">linCmt</span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">add.sd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">one.cmt</span><span class="op">)</span></span></code></pre></div>
<p>We can now run the model…</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">one.cmt</span>, <span class="va">theo_sd</span>, est<span class="op">=</span><span class="st">"focei"</span>,</span>
<span>              control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; calculating covariance matrix</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span></span>
<span><span class="co">#&gt; done</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r²</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor)</span></span>
<span><span class="co">#&gt; FOCEi 116.812 373.4118 393.5914      -179.7059        68.29718        9.353349</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            setup optimize covariance table compress    other</span></span>
<span><span class="co">#&gt; elapsed 0.002081 0.347814   0.347816 0.069     0.01 5.921289</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        <span style="font-weight: bold;">Parameter</span>  <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span> <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>              0.461  0.195 42.4       1.59 (1.08, 2.32)     70.3      1.59% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>               1.01 0.0751 7.42       2.75 (2.37, 3.19)     26.7      4.03% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>         log V  3.46 0.0436 1.26       31.8 (29.2, 34.6)     14.2      11.0% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>           0.692                               0.692                     </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r,s</span></span></span>
<span><span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span></span>
<span><span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span></span>
<span><span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span></span>
<span><span class="co">#&gt;   Information about run found (<span style="color: #0000BB; font-weight: bold;">$runInfo</span>):</span></span>
<span><span class="co">#&gt;    • gradient problems with initial estimate and covariance; see $scaleInfo </span></span>
<span><span class="co">#&gt;    • ETAs were reset to zero during optimization; (Can control by foceiControl(resetEtaP=.)) </span></span>
<span><span class="co">#&gt;    • initial ETAs were nudged; (can control by foceiControl(etaNudge=., etaNudge2=)) </span></span>
<span><span class="co">#&gt;   Censoring (<span style="color: #0000BB; font-weight: bold;">$censInformation</span>): No censoring</span></span>
<span><span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span></span>
<span><span class="co">#&gt;     relative convergence (4) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 22</span></span></span>
<span><span class="co">#&gt;   ID     TIME    DV  PRED    RES   WRES IPRED   IRES  IWRES CPRED   CRES  CWRES</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74  0     0.74   1.07   0     0.74   1.07   0     0.74   1.07 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84  3.26 -<span style="color: #BB0000;">0.417</span> -<span style="color: #BB0000;">0.502</span>  3.84 -<span style="color: #BB0000;">1.00</span>  -<span style="color: #BB0000;">1.45</span>   3.50 -<span style="color: #BB0000;">0.656</span> -<span style="color: #BB0000;">0.746</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57  5.82  0.746  0.695  6.78 -<span style="color: #BB0000;">0.215</span> -<span style="color: #BB0000;">0.311</span>  6.17  0.401  0.340</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 129 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 10 more variables: eta.ka &lt;dbl&gt;, eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;, depot &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   central &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, tad &lt;dbl&gt;, dosenum &lt;dbl&gt;</span></span></span></code></pre></div>
<p>We can alternatively express the same model by ordinary differential
equations (ODEs):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">one.compartment</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">tka</span> <span class="op">&lt;-</span> <span class="fl">0.45</span> <span class="co"># Log Ka</span></span>
<span>    <span class="va">tcl</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># Log Cl</span></span>
<span>    <span class="va">tv</span> <span class="op">&lt;-</span> <span class="fl">3.45</span>    <span class="co"># Log V</span></span>
<span>    <span class="va">eta.ka</span> <span class="op">~</span> <span class="fl">0.6</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">~</span> <span class="fl">0.3</span></span>
<span>    <span class="va">eta.v</span> <span class="op">~</span> <span class="fl">0.1</span></span>
<span>    <span class="va">add.sd</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span> <span class="op">+</span> <span class="va">eta.ka</span><span class="op">)</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tcl</span> <span class="op">+</span> <span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tv</span> <span class="op">+</span> <span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">ka</span> <span class="op">*</span> <span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">center</span><span class="op">)</span> <span class="op">=</span> <span class="va">ka</span> <span class="op">*</span> <span class="va">depot</span> <span class="op">-</span> <span class="va">cl</span> <span class="op">/</span> <span class="va">v</span> <span class="op">*</span> <span class="va">center</span></span>
<span>    <span class="va">cp</span> <span class="op">=</span> <span class="va">center</span> <span class="op">/</span> <span class="va">v</span></span>
<span>    <span class="va">cp</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">add.sd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We can try the Stochastic Approximation EM (SAEM) method to this
model:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">one.compartment</span>, <span class="va">theo_sd</span>,  est<span class="op">=</span><span class="st">"saem"</span>,</span>
<span>               control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====</span></span>
<span><span class="co">#&gt; ==|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r²</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">SAEM </span><span style="color: #555555; font-weight: bold; font-style: italic;">OBJF by FOCEi approximation</span><span style="font-weight: bold;"> ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Gaussian/Laplacian Likelihoods: AIC() or <span style="color: #0000BB; font-weight: bold;">$objf</span> etc. </span></span>
<span><span class="co">#&gt;  FOCEi CWRES &amp; Likelihoods: addCwres() </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            setup covariance saem table compress    other</span></span>
<span><span class="co">#&gt; elapsed 0.002249   0.009013 4.97  0.11    0.016 1.979738</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span> <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>    0.464  0.195   42       1.59 (1.09, 2.33)     71.1   <span style="color: #BB0000; font-weight: bold;">-0.0900%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>     1.01  0.085 8.43       2.74 (2.32, 3.24)     27.4      4.80% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>      3.46 0.0447 1.29         31.7 (29, 34.6)     13.1      8.77% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">add.sd</span> 0.696                               0.696                     </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">linFim</span></span></span>
<span><span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span></span>
<span><span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span></span>
<span><span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span></span>
<span><span class="co">#&gt;   Censoring (<span style="color: #0000BB; font-weight: bold;">$censInformation</span>): No censoring</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 19</span></span></span>
<span><span class="co">#&gt;   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    cp</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74  0     0.74   0     0.74   1.06  0.083<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.477</span> -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">9</span>  0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84  3.28 -<span style="color: #BB0000;">0.437</span>  3.83 -<span style="color: #BB0000;">0.991</span> -<span style="color: #BB0000;">1.42</span>  0.083<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.477</span> -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">9</span>  3.83</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57  5.86  0.715  6.76 -<span style="color: #BB0000;">0.194</span> -<span style="color: #BB0000;">0.278</span> 0.083<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.477</span> -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">9</span>  6.76</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 129 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: depot &lt;dbl&gt;, center &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   tad &lt;dbl&gt;, dosenum &lt;dbl&gt;</span></span></span></code></pre></div>
<p>And if we wanted to, we could even apply the traditional R method
nlme method to this model:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitN</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">one.compartment</span>, <span class="va">theo_sd</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pnlsTol<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>, est<span class="op">=</span><span class="st">"nlme"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; **Iteration 1</span></span>
<span><span class="co">#&gt; LME step: Loglik: -183.2083, nlminb iterations: 1</span></span>
<span><span class="co">#&gt; reStruct  parameters:</span></span>
<span><span class="co">#&gt;       ID1       ID2       ID3 </span></span>
<span><span class="co">#&gt; 0.2195819 0.9924330 1.6502972 </span></span>
<span><span class="co">#&gt;  Beginning PNLS step: ..  completed fit_nlme() step.</span></span>
<span><span class="co">#&gt; PNLS step: RSS =  64.59841 </span></span>
<span><span class="co">#&gt;  fixed effects: 0.4443024  1.038584  3.449959  </span></span>
<span><span class="co">#&gt;  iterations: 3 </span></span>
<span><span class="co">#&gt; Convergence crit. (must all become &lt;= tolerance = 1e-05):</span></span>
<span><span class="co">#&gt;      fixed   reStruct </span></span>
<span><span class="co">#&gt; 0.03715048 0.91006943 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; **Iteration 2</span></span>
<span><span class="co">#&gt; LME step: Loglik: -182.0743, nlminb iterations: 1</span></span>
<span><span class="co">#&gt; reStruct  parameters:</span></span>
<span><span class="co">#&gt;       ID1       ID2       ID3 </span></span>
<span><span class="co">#&gt; 0.1149602 0.9686071 1.6508466 </span></span>
<span><span class="co">#&gt;  Beginning PNLS step: ..  completed fit_nlme() step.</span></span>
<span><span class="co">#&gt; PNLS step: RSS =  64.59843 </span></span>
<span><span class="co">#&gt;  fixed effects: 0.4443024  1.038584  3.449959  </span></span>
<span><span class="co">#&gt;  iterations: 1 </span></span>
<span><span class="co">#&gt; Convergence crit. (must all become &lt;= tolerance = 1e-05):</span></span>
<span><span class="co">#&gt;        fixed     reStruct </span></span>
<span><span class="co">#&gt; 0.000000e+00 5.047516e-06</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fitN</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r²</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">nlme</span><span style="font-weight: bold;"> by </span><span style="color: #BBBB00; font-weight: bold;">maximum likelihood</span><span style="font-weight: bold;"> ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          OBJF      AIC      BIC Log-likelihood Condition#(Cov) Condition#(Cor)</span></span>
<span><span class="co">#&gt; nlme 121.5489 378.1487 398.3283      -182.0743        18.17386               1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            setup table compress    other</span></span>
<span><span class="co">#&gt; elapsed 0.001763 0.102    0.006 3.281237</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          <span style="font-weight: bold;">Est.</span>      <span style="font-weight: bold;">SE</span>  <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tka</span>    0.4443  0.1916 43.12     1.559 (1.071, 2.27)     68.7     <span style="color: #BB0000; font-weight: bold;">-3.49%</span> </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tcl</span>     1.039 0.08335 8.026    2.825 (2.399, 3.327)     27.0      7.85% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">tv</span>       3.45 0.04494 1.303      31.5 (28.84, 34.4)     13.5      7.29% </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">add.sd</span> 0.6979                                0.6979                     </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">nlme</span></span></span>
<span><span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span></span>
<span><span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span></span>
<span><span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span></span>
<span><span class="co">#&gt;   Censoring (<span style="color: #0000BB; font-weight: bold;">$censInformation</span>): No censoring</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 19</span></span></span>
<span><span class="co">#&gt;   ID     TIME    DV  PRED    RES IPRED   IRES  IWRES eta.ka eta.cl   eta.v    cp</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74  0     0.74   0     0.74   1.06  0.075<span style="text-decoration: underline;">6</span> -<span style="color: #BB0000;">0.483</span> -<span style="color: #BB0000;">0.089</span><span style="color: #BB0000; text-decoration: underline;">6</span>  0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84  3.24 -<span style="color: #BB0000;">0.401</span>  3.78 -<span style="color: #BB0000;">0.943</span> -<span style="color: #BB0000;">1.35</span>  0.075<span style="text-decoration: underline;">6</span> -<span style="color: #BB0000;">0.483</span> -<span style="color: #BB0000;">0.089</span><span style="color: #BB0000; text-decoration: underline;">6</span>  3.78</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57  5.81  0.760  6.72 -<span style="color: #BB0000;">0.146</span> -<span style="color: #BB0000;">0.210</span> 0.075<span style="text-decoration: underline;">6</span> -<span style="color: #BB0000;">0.483</span> -<span style="color: #BB0000;">0.089</span><span style="color: #BB0000; text-decoration: underline;">6</span>  6.72</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 129 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: depot &lt;dbl&gt;, center &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   tad &lt;dbl&gt;, dosenum &lt;dbl&gt;</span></span></span></code></pre></div>
<p>This example delivers a complete model fit as the <code>fit</code>
object, including parameter history, a set of fixed effect estimates,
and random effects for all included subjects.</p>
</div>
<div class="section level2">
<h2 id="the-ui">The UI<a class="anchor" aria-label="anchor" href="#the-ui"></a>
</h2>
<p>The nlmixr modeling dialect, inspired by R and NONMEM, can be used to
fit models using all current and future estimation algorithms within
nlmixr. Using these widely-used tools as inspiration has the advantage
of delivering a model specification syntax that is instantly familiar to
the majority of analysts working in pharmacometrics and related
fields.</p>
<div class="section level3">
<h3 id="overall-model-structure">Overall model structure<a class="anchor" aria-label="anchor" href="#overall-model-structure"></a>
</h3>
<p>Model specifications for nlmixr are written using functions
containing <code>ini</code> and <code>model</code> blocks. These
functions can be called anything, but often contain these two
components. Let’s look at a very simple one-compartment model with no
covariates.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span>   <span class="co"># Initial conditions/variables</span></span>
<span>    <span class="co"># are specified here</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span> <span class="co"># The model is specified</span></span>
<span>    <span class="co"># here</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level4">
<h4 id="the-ini-block">The ini block<a class="anchor" aria-label="anchor" href="#the-ini-block"></a>
</h4>
<p>The <code>ini</code> block specifies initial conditions, including
initial estimates and boundaries for those algorithms which support them
(currently, the built-in <code>nlme</code> and <code>saem</code> methods
do not). Nomenclature is similar to that used in NONMEM, Monolix and
other similar packages. In the NONMEM world, the <code>ini</code> block
is analogous to <code>$THETA</code>, <code>$OMEGA</code> and
<code>$SIGMA</code> blocks.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span> <span class="co"># Note that arguments to the function are currently</span></span>
<span>  <span class="co"># ignored by nlmixr</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="co"># Initial conditions for population parameters (sometimes</span></span>
<span>    <span class="co"># called THETA parameters) are defined by either '&lt;-' or '='</span></span>
<span>    <span class="va">lCl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>      <span class="co"># log Cl (L/hr)</span></span>
<span>    </span>
<span>    <span class="co"># Note that simple expressions that evaluate to a number are</span></span>
<span>    <span class="co"># OK for defining initial conditions (like in R)</span></span>
<span>    <span class="va">lVc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>  <span class="co"># log V (L)</span></span>
<span>    </span>
<span>    <span class="co">## Also, note that a comment on a parameter is captured as a parameter label</span></span>
<span>    <span class="va">lKa</span> <span class="op">&lt;-</span> <span class="fl">1</span>       <span class="co"># log Ka (1/hr)</span></span>
<span>    </span>
<span>    <span class="co"># Bounds may be specified by c(lower, est, upper), like NONMEM:</span></span>
<span>    <span class="co"># Residuals errors are assumed to be population parameters</span></span>
<span>    <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># IIV terms will be discussed in the next example</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># The model block will be discussed later</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>As shown in the above example:</p>
<ul>
<li>Simple parameter values are specified using an R-compatible
assignment</li>
<li>Boundaries may be specified by
<code>c(lower, est, upper)</code>.</li>
<li>Like NONMEM, <code>c(lower,est)</code> is equivalent to
<code>c(lower,est,Inf)</code>
</li>
<li>Also like NONMEM, <code>c(est)</code> does not specify a lower
bound, and is equivalent to specifying the parameter without using R’s
<code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> function.</li>
</ul>
<p>These parameters can be named using almost any R-compatible name.
Please note that:</p>
<ul>
<li>Residual error estimates should be coded as population estimates
(i.e. using <code>=</code> or <code>&lt;-</code>, not
<code>~</code>).</li>
<li>Variable names that start with <code>_</code> are not supported.
Note that R does not allow variable starting with <code>_</code> to be
assigned without quoting them.</li>
<li>Naming variables that start with <code>rx</code> or
<code>nlmixr</code> is not suggested, since <code>rxode2()</code> and
nlmixr use these prefixes internally for certain estimation routines and
for calculating residuals.</li>
<li>Variable names are case-sensitive, just like they are in R.
<code>CL</code> is not the same as <code>Cl</code>.</li>
</ul>
<p>In mixture models, multivariate normal individual deviations from the
normal population and parameters are estimated (in NONMEM these are
called “ETA” parameters). Additionally, the variance/covariance matrix
of these deviations are is also estimated (in NONMEM this is the “OMEGA”
matrix). These also take initial estimates. In nlmixr, these are
specified by the <code>~</code> operator. This that is typically used in
statistics R for “modeled by”, and was chosen to distinguish these
estimates from the population and residual error parameters.</p>
<p>Continuing from the prior example, we can annotate the estimates for
the between-subject error distribution…</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">lCl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>      ; <span class="fu">label</span><span class="op">(</span><span class="st">"log Cl (L/hr)"</span><span class="op">)</span></span>
<span>    <span class="va">lVc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>   ; <span class="fu">label</span><span class="op">(</span><span class="st">"log V (L)"</span><span class="op">)</span></span>
<span>    <span class="va">lKa</span> <span class="op">&lt;-</span> <span class="fl">1</span>        ; <span class="fu">label</span><span class="op">(</span><span class="st">"log Ka (1/hr)"</span><span class="op">)</span></span>
<span>    <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Initial estimate for ka IIV variance</span></span>
<span>    <span class="co"># Labels work for single parameters</span></span>
<span>    <span class="va">eta.ka</span> <span class="op">~</span> <span class="fl">0.1</span>    <span class="co">## BSV Ka</span></span>
<span></span>
<span>    <span class="co"># For correlated parameters, you specify the names of each</span></span>
<span>    <span class="co"># correlated parameter separated by a addition operator `+`</span></span>
<span>    <span class="co"># and the left handed side specifies the lower triangular</span></span>
<span>    <span class="co"># matrix initial of the covariance matrix.</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">+</span> <span class="va">eta.vc</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,</span>
<span>                        <span class="fl">0.005</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Note that labels do not currently work for correlated</span></span>
<span>    <span class="co"># parameters.  Also, do not put comments inside the lower</span></span>
<span>    <span class="co"># triangular matrix as this will currently break the model.</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># The model block will be discussed later</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>As shown in the above example:</p>
<ul>
<li>Simple variances are specified by the variable name and the estimate
separated by <code>~</code>
</li>
<li>Correlated parameters are specified by the sum of the variable
labels and then the lower triangular matrix of the covariance is
specified on the left handed side of the equation. This is also
separated by <code>~</code>.</li>
<li>The initial estimates are specified on the variance scale, and in
analogy with NONMEM, the square roots of the diagonal elements
correspond to coefficients of variation when used in the exponential IIV
implementation.</li>
</ul>
</div>
<div class="section level4">
<h4 id="the-model-block">The model block<a class="anchor" aria-label="anchor" href="#the-model-block"></a>
</h4>
<p>The <code>model</code> block specifies the model, and is analogous to
the <code>$PK</code>, <code>$PRED</code> and <code>$ERROR</code> blocks
in NONMEM.</p>
<p>Once the initialization block has been defined, you can define a
model in terms of the variables defined in the <code>ini</code> block.
You can also mix <code>rxode2()</code> blocks into the model if
needed.</p>
<p>The current method of defining a nlmixr model is to specify the
parameters, and then any required <code>rxode2()</code> lines.
Continuing the annotated example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">lCl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>       <span class="co"># log Cl (L/hr)</span></span>
<span>    <span class="va">lVc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>   <span class="co"># log Vc (L)</span></span>
<span>    <span class="va">lKA</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>       <span class="co"># log Ka (1/hr)</span></span>
<span>    <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">eta.Cl</span> <span class="op">~</span> <span class="fl">0.1</span>     <span class="co"># BSV Cl</span></span>
<span>    <span class="va">eta.Vc</span> <span class="op">~</span> <span class="fl">0.1</span>     <span class="co"># BSV Vc</span></span>
<span>    <span class="va">eta.KA</span> <span class="op">~</span> <span class="fl">0.1</span>     <span class="co"># BSV Ka</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="co"># Parameters are defined in terms of the previously-defined</span></span>
<span>    <span class="co"># parameter names:</span></span>
<span>    <span class="va">Cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lCl</span> <span class="op">+</span> <span class="va">eta.Cl</span><span class="op">)</span></span>
<span>    <span class="va">Vc</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lVc</span> <span class="op">+</span> <span class="va">eta.Vc</span><span class="op">)</span></span>
<span>    <span class="va">KA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lKA</span> <span class="op">+</span> <span class="va">eta.KA</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Next, the differential equations are defined:</span></span>
<span>    <span class="va">kel</span> <span class="op">&lt;-</span> <span class="va">Cl</span> <span class="op">/</span> <span class="va">Vc</span>;</span>
<span>    </span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span>  <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span>;</span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span>  <span class="op">=</span>  <span class="va">KA</span><span class="op">*</span><span class="va">depot</span><span class="op">-</span><span class="va">kel</span><span class="op">*</span><span class="va">centr</span>;</span>
<span>    </span>
<span>    <span class="co"># And the concentration is then calculated</span></span>
<span>    <span class="va">cp</span> <span class="op">=</span> <span class="va">centr</span> <span class="op">/</span> <span class="va">Vc</span>;</span>
<span>    <span class="co"># Finally, we specify that the plasma concentration follows</span></span>
<span>    <span class="co"># a proportional error distribution (estimated by the parameter </span></span>
<span>    <span class="co"># prop.err)</span></span>
<span>    <span class="va">cp</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>A few points to note:</p>
<ul>
<li>Parameters are defined before the differential equations. Currently
directly defining the differential equations in terms of the population
parameters is not supported.</li>
<li>The differential equations, parameters and error terms are in a
single block, instead of multiple sections.</li>
<li>Additionally state names, calculated variables, also cannot start
with either <code>rx_</code> or <code>nlmixr_</code> since these are
used internally in some estimation routines.</li>
<li>Errors are specified using the tilde, <code>~</code>. Currently you
can use either <code>add(parameter)</code> for additive error,
<code>prop(parameter)</code> for proportional error or
<code>add(parameter1) + prop(parameter2)</code> for combined additive
and proportional error. You can also specify
<code>norm(parameter)</code> for additive error, since it follows a
normal distribution.</li>
<li>Some routines, like <code>saem</code>, require parameters expressed
in terms of
<code>Pop.Parameter + Individual.Deviation.Parameter +   Covariate*Covariate.Parameter</code>.
The order of these parameters does not matter. This is similar to
NONMEM’s mu-referencing, though not as restrictive. This means that for
<code>saem</code>, a parameterization of the form
<code>Cl &lt;- Cl*exp(eta.Cl)</code> is not allowed.</li>
<li>The type of parameter in the model is determined by the
<code>ini</code> block; covariates used in the model are not included in
the <code>ini</code> block. These variables need to be present in the
modeling dataset for the model to run.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="running-models">Running models<a class="anchor" aria-label="anchor" href="#running-models"></a>
</h3>
<p>Models can be fitted several ways, including via the [magrittr]
forward-pipe operator.</p>
<pre><code><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">one.compartment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">nlmixr</span><span class="op">(</span>data <span class="op">=</span> <span class="va">theo_sd</span>, est <span class="op">=</span> <span class="st">"saem"</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">one.compartment</span>, data <span class="op">=</span> <span class="va">theo_sd</span>, est <span class="op">=</span> <span class="st">"saem"</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="va">one.compartment</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">nlmixr</span><span class="op">(</span>data <span class="op">=</span> <span class="va">theo_sd</span>, est <span class="op">=</span> <span class="st">"saem"</span><span class="op">)</span></span></code></pre>
<p>Options to the estimation routines can be specified using nlmeControl
for nlme estimation:</p>
<pre><code><span><span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">one.compartment</span>, <span class="va">theo_sd</span>, est <span class="op">=</span> <span class="st">"nlme"</span>, control <span class="op">=</span> <span class="fu">nlmeControl</span><span class="op">(</span>pnlsTol <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>where options are specified in the <code>nlme</code> documentation.
Options for saem can be specified using <code>saemControl</code>:</p>
<pre><code><span><span class="va">fit5</span> <span class="op">&lt;-</span> <span class="fu">nlmixr</span><span class="op">(</span><span class="va">one.compartment</span>,<span class="va">theo_sd</span>,est<span class="op">=</span><span class="st">"saem"</span>,control<span class="op">=</span><span class="fu">saemControl</span><span class="op">(</span>n.burn<span class="op">=</span><span class="fl">250</span>,n.em<span class="op">=</span><span class="fl">350</span>,print<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>this example specifies 250 burn-in iterations, 350 em iterations and
a print progress every 50 runs.</p>
</div>
<div class="section level3">
<h3 id="model-syntax-for-solved-pk-systems">Model Syntax for solved PK systems<a class="anchor" aria-label="anchor" href="#model-syntax-for-solved-pk-systems"></a>
</h3>
<p>Solved PK systems are also currently supported by nlmixr with the
‘linCmt()’ pseudo-function. An annotated example of a solved system is
below:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">lCl</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>      ; <span class="fu">label</span><span class="op">(</span><span class="st">"log Cl (L/hr)"</span><span class="op">)</span></span>
<span>    <span class="va">lVc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>  ; <span class="fu">label</span><span class="op">(</span><span class="st">"log Vc (L)"</span><span class="op">)</span></span>
<span>    <span class="va">lKA</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>      ; <span class="fu">label</span><span class="op">(</span><span class="st">"log Ka (1/hr)"</span><span class="op">)</span></span>
<span>    <span class="va">prop.err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">eta.Cl</span> <span class="op">~</span> <span class="fl">0.1</span>   <span class="co"># BSV Cl</span></span>
<span>    <span class="va">eta.Vc</span> <span class="op">~</span> <span class="fl">0.1</span>   <span class="co"># BSV Vc</span></span>
<span>    <span class="va">eta.KA</span> <span class="op">~</span> <span class="fl">0.1</span>   <span class="co"># BSV Ka</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">Cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lCl</span> <span class="op">+</span> <span class="va">eta.Cl</span><span class="op">)</span></span>
<span>    <span class="va">Vc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lVc</span> <span class="op">+</span> <span class="va">eta.Vc</span><span class="op">)</span></span>
<span>    <span class="va">KA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lKA</span> <span class="op">+</span> <span class="va">eta.KA</span><span class="op">)</span></span>
<span>    <span class="co">## Instead of specifying the ODEs, you can use</span></span>
<span>    <span class="co">## the linCmt() function to use the solved system.</span></span>
<span>    <span class="co">##</span></span>
<span>    <span class="co">## This function determines the type of PK solved system</span></span>
<span>    <span class="co">## to use by the parameters that are defined.  In this case</span></span>
<span>    <span class="co">## it knows that this is a one-compartment model with first-order</span></span>
<span>    <span class="co">## absorption.</span></span>
<span>    <span class="fu">linCmt</span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>A few things to keep in mind:</p>
<ul>
<li>The solved systems implemented are the one, two and three
compartment models with or without first-order absorption. Each of the
models support a lag time with a tlag parameter.</li>
<li>In general the linear compartment model figures out the model by the
parameter names. <code>nlmixr2</code> currently knows about numbered
volumes, <code>Vc</code>/<code>Vp</code>, Clearances in terms of both
<code>Cl</code> and <code>Q</code>/<code>CLD</code>. Additionally nlmixr
knows about elimination micro-constants (ie <code>K12</code>). Mixing of
these parameters for these models is currently not supported.</li>
</ul>
<p>For the most up-to-date information about <code>linCmt()</code>
models see the <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-model-types.html#solved-compartment-models" class="external-link">rxode2
documentation</a>.</p>
</div>
<div class="section level3">
<h3 id="checking-model-syntax">Checking model syntax<a class="anchor" aria-label="anchor" href="#checking-model-syntax"></a>
</h3>
<p>After specifying the model syntax you can check that nlmixr is
interpreting it correctly by using the nlmixr function on it. Using the
above function we can get:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nlmixr</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre></div>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>C</mi><mi>l</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>l</mi><mi>C</mi><mi>l</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>C</mi><mi>l</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>V</mi><mi>c</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>l</mi><mi>V</mi><mi>c</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>V</mi><mi>c</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>K</mi><mi>A</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>l</mi><mi>K</mi><mi>A</mi></mrow><mo>+</mo><mrow><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>K</mi><mi>A</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>l</mi><mi>i</mi><mi>n</mi><mi>C</mi><mi>m</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>.</mi><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
{Cl} &amp; = \exp\left({lCl}+{eta.Cl}\right) \\
{Vc} &amp; = \exp\left({lVc}+{eta.Vc}\right) \\
{KA} &amp; = \exp\left({lKA}+{eta.KA}\right) \\
linCmt() &amp; \sim prop({prop.err})
\end{align*}</annotation></semantics></math></p>
<p>In general this gives you information about the model (what type of
solved system/<code>rxode2()</code>), initial estimates as well as the
code for the model block.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Fidler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
