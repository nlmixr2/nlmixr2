<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nlmixr2">
<title>Modifying nlmixr2 models by piping • nlmixr2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modifying nlmixr2 models by piping">
<meta property="og:description" content="nlmixr2">
<meta property="og:image" content="https://nlmixr2.github.io/nlmixr2/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nlmixr2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fas fa fas fa-book"></span>
     
    Articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <h6 class="dropdown-header" data-toc-skip>Getting started</h6>
    <a class="dropdown-item" href="../articles/running_nlmixr.html">Introduction to Running Nlmixr</a>
    <a class="dropdown-item" href="../articles/multiple-endpoints.html">Using Multiple Endpoints in Nlmixr</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Going further</h6>
    <a class="dropdown-item" href="../articles/modelPiping.html">Model Piping</a>
    <a class="dropdown-item" href="../articles/broom.html">Sweeping models to tidy datasets (broom)</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/xgxr-nlmixr-ggpmx.html">Integrated development with xgxr/nlmixr/ggPMX</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--example-models">
    <span class="fas fa fas fa-chalkboard-teacher"></span>
     
    Example models
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--example-models">
    <a class="dropdown-item" href="../articles/addingCovariances.html">Phenobarbatol with correlations</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/nimo.html">Nonlinear PK/PD -- Nimotuzumab</a>
    <a class="dropdown-item" href="../articles/mavoglurant.html">PBPK -- Mavoglurant</a>
    <a class="dropdown-item" href="../articles/wbc.html">PKPD -- Myelosuppression model</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixrdevelopment/nlmixr/raw/master/CheatSheet_nlmixr.pdf">
    <span class="fa fa-scroll fa-lg"></span>
     
    Cheat Sheet
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://doi.org/10.1002/psp4.12445">
    <span class="fas fa fas fa-life-ring"></span>
     
    Tutorial
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o fa-lg"></span>
     
    Functions
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixrdevelopment/nlmixr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixrdevelopment/nlmixr/releases">
    <span class="fa fa-download"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="modelPiping_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Modifying nlmixr2 models by piping</h1>
            
            <h4 data-toc-skip class="date">2022-05-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nlmixr2/blob/HEAD/vignettes/modelPiping.Rmd" class="external-link"><code>vignettes/modelPiping.Rmd</code></a></small>
      <div class="d-none name"><code>modelPiping.Rmd</code></div>
    </div>

    
    
<div class="figure">
<img src="logo.png" alt=""><p class="caption">nlmixr</p>
</div>
<div class="section level2">
<h2 id="changing-models-via-piping">Changing models via piping<a class="anchor" aria-label="anchor" href="#changing-models-via-piping"></a>
</h2>
<p>As in the running nlmixr vignette, Let’s start with a very simple PK example, using the single-dose theophylline dataset generously provided by Dr. Robert A. Upton of the University of California, San Francisco:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/nlmixr2/">nlmixr2</a></span><span class="op">)</span>

<span class="va">one.compartment</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span><span class="op">{</span>
    <span class="va">tka</span> <span class="op">&lt;-</span> <span class="fl">0.45</span> <span class="co"># Log Ka</span>
    <span class="va">tcl</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># Log Cl</span>
    <span class="co">## This works with interactive models</span>
    <span class="co">## You may also label the preceding line with label("label text")</span>
    <span class="va">tv</span> <span class="op">&lt;-</span> <span class="fl">3.45</span>; <span class="co"># log V</span>
    <span class="co">## the label("Label name") works with all models</span>
    <span class="va">eta.ka</span> <span class="op">~</span> <span class="fl">0.6</span>
    <span class="va">eta.cl</span> <span class="op">~</span> <span class="fl">0.3</span>
    <span class="va">eta.v</span> <span class="op">~</span> <span class="fl">0.1</span>
    <span class="va">add.sd</span> <span class="op">&lt;-</span> <span class="fl">0.7</span>
  <span class="op">}</span><span class="op">)</span>
  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="op">{</span>
    <span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span> <span class="op">+</span> <span class="va">eta.ka</span><span class="op">)</span>
    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tcl</span> <span class="op">+</span> <span class="va">eta.cl</span><span class="op">)</span>
    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tv</span> <span class="op">+</span> <span class="va">eta.v</span><span class="op">)</span>
    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">ka</span> <span class="op">*</span> <span class="va">depot</span>
    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">center</span><span class="op">)</span> <span class="op">=</span> <span class="va">ka</span> <span class="op">*</span> <span class="va">depot</span> <span class="op">-</span> <span class="va">cl</span> <span class="op">/</span> <span class="va">v</span> <span class="op">*</span> <span class="va">center</span>
    <span class="va">cp</span> <span class="op">=</span> <span class="va">center</span> <span class="op">/</span> <span class="va">v</span> 
    <span class="va">cp</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">add.sd</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We can try the First-Order Conditional Estimation with Interaction (FOCEi) method to find a good solution:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlmixr2est/man/nlmixr2.html" class="external-link">nlmixr</a></span><span class="op">(</span><span class="va">one.compartment</span>, <span class="va">theo_sd</span>, est<span class="op">=</span><span class="st">"focei"</span>,
              control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, 
              table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>npde<span class="op">=</span><span class="cn">TRUE</span>, cwres<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; calculating covariance matrix</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; done</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           OBJF      AIC      BIC Log-likelihood Condition Number</span>
<span class="co">#&gt; FOCEi 116.8139 373.4137 393.5933      -179.7068         73.85496</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            setup optimize covariance table compress    other</span>
<span class="co">#&gt; elapsed 0.015493 0.549031   0.549033 1.853    0.013 6.889443</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        <span style="font-weight: bold;">Parameter</span>  <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span> <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>       Log Ka 0.474  0.209 44.1       1.61 (1.07, 2.42)     68.9     0.384% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>       Log Cl  1.01 0.0943 9.32       2.75 (2.29, 3.31)     26.8      3.87% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>         log V  3.46 0.0403 1.16       31.8 (29.4, 34.4)     13.9      10.3% </span>
<span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>           0.696                               0.696                     </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r,s</span></span>
<span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span>
<span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span>
<span class="co">#&gt;     false convergence (8) </span>
<span class="co">#&gt;   In an ODE system, false convergence may mean "useless" evaluations were performed.</span>
<span class="co">#&gt;   See https://tinyurl.com/yyrrwkce</span>
<span class="co">#&gt;   It could also mean the convergence is poor, check results before accepting fit</span>
<span class="co">#&gt;   You may also try a good derivative free optimization:</span>
<span class="co">#&gt;     nlmixr2(...,control=list(outerOpt="bobyqa"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 26</span></span>
<span class="co">#&gt;   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74 0.096<span style="text-decoration: underline;">7</span>  0.643  1.24   1.24   0     0.74   1.06   0     0.74 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84 3.83   -<span style="color: #BB0000;">0.986</span> -<span style="color: #BB0000;">0.486</span> -<span style="color: #BB0000;">0.486</span>  3.29 -<span style="color: #BB0000;">0.449</span> -<span style="color: #BB0000;">0.242</span>  3.85 -<span style="color: #BB0000;">1.01</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57 6.15    0.422 -<span style="color: #BB0000;">1.71</span>  -<span style="color: #BB0000;">1.71</span>   5.87  0.705  0.287  6.79 -<span style="color: #BB0000;">0.216</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 129 more rows, and 14 more variables: IWRES &lt;dbl&gt;, CPRED &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.ka &lt;dbl&gt;, eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   depot &lt;dbl&gt;, center &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, tad &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   dosenum &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="changing-and-fixing-parameter-values-in-models">Changing and fixing parameter values in models<a class="anchor" aria-label="anchor" href="#changing-and-fixing-parameter-values-in-models"></a>
</h2>
<p>Something that you may want to do is change initial estimates with a model. It is simple to modify the model definition and change them yourself, but you may also want to change them in a specific way; For example try a range of starting values to see how the system behaves (either by full estimation or by a posthoc estimation). In these situations it can be come tedious to modify the models by hand.</p>
<p>nlmixr provides the ability to:</p>
<ol style="list-style-type: decimal">
<li>Change parameter estimates before or after running a model. (ie <code>ini(tka=0.5)</code>)</li>
<li>Fix parameters to arbitrary values, or estimated values (ie <code>ini(tka=fix(0.5))</code> or <code>ini(tka=fix)</code>)</li>
</ol>
<p>The easiest way to illustrate this is by showing a few examples of piping changes to the model:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Example 1 -- Set inital estimate to 0.5 (shown w/posthoc)</span>
<span class="va">one.ka.0.5</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span>tka<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/nlmixr2est/man/nlmixr2.html" class="external-link">nlmixr</a></span><span class="op">(</span>est<span class="op">=</span><span class="st">"posthoc"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, 
           table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cwres<span class="op">=</span><span class="cn">TRUE</span>, npde<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">one.ka.0.5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Example 2 -- Fix tka to 0.5 and re-estimate.</span>
<span class="va">one.ka.0.5</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span>tka<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/fix.html" class="external-link">fix</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/nlmixr2est/man/nlmixr2.html" class="external-link">nlmixr</a></span><span class="op">(</span>est<span class="op">=</span><span class="st">"focei"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,
           table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cwres<span class="op">=</span><span class="cn">TRUE</span>, npde<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; calculating covariance matrix</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; done</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">one.ka.0.5</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           OBJF      AIC      BIC Log-likelihood Condition Number</span>
<span class="co">#&gt; FOCEi 116.8498 371.4495 388.7463      -179.7248         11.40363</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            setup optimize covariance table compress    other</span>
<span class="co">#&gt; elapsed 0.003285 0.309992   0.309994  1.41    0.057 0.366729</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        <span style="font-weight: bold;">Parameter</span>  <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span>  <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>       Log Ka   0.5  <span style="color: #00BB00; font-weight: bold;">FIXED</span> <span style="color: #00BB00; font-weight: bold;">FIXED</span>                    1.65     68.9</span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>       Log Cl  1.01  0.113  11.1       2.75 (2.21, 3.43)     26.8</span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>         log V  3.46 0.0539  1.56       31.8 (28.6, 35.3)     13.9</span>
<span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>           0.696                                0.696         </span>
<span class="co">#&gt;        <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>        0.309% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>         3.89% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>          10.2% </span>
<span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>            </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r,s</span></span>
<span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span>
<span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span>
<span class="co">#&gt;     false convergence (8) </span>
<span class="co">#&gt;   In an ODE system, false convergence may mean "useless" evaluations were performed.</span>
<span class="co">#&gt;   See https://tinyurl.com/yyrrwkce</span>
<span class="co">#&gt;   It could also mean the convergence is poor, check results before accepting fit</span>
<span class="co">#&gt;   You may also try a good derivative free optimization:</span>
<span class="co">#&gt;     nlmixr2(...,control=list(outerOpt="bobyqa"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 26</span></span>
<span class="co">#&gt;   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74 0.096<span style="text-decoration: underline;">7</span>  0.643  1.24   1.24   0     0.74   1.06   0     0.74 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84 3.90   -<span style="color: #BB0000;">1.06</span>  -<span style="color: #BB0000;">0.440</span> -<span style="color: #BB0000;">0.440</span>  3.36 -<span style="color: #BB0000;">0.520</span> -<span style="color: #BB0000;">0.276</span>  3.85 -<span style="color: #BB0000;">1.01</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57 6.23    0.342 -<span style="color: #BB0000;">1.75</span>  -<span style="color: #BB0000;">1.75</span>   5.96  0.611  0.248  6.79 -<span style="color: #BB0000;">0.219</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 129 more rows, and 14 more variables: IWRES &lt;dbl&gt;, CPRED &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.ka &lt;dbl&gt;, eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   depot &lt;dbl&gt;, center &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, tad &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   dosenum &lt;dbl&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Example 3 -- Fix tka to model estimated value and re-estimate.</span>
<span class="va">one.ka.0.5</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span>tka<span class="op">=</span><span class="va">fix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/nlmixr2est/man/nlmixr2.html" class="external-link">nlmixr</a></span><span class="op">(</span>est<span class="op">=</span><span class="st">"focei"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,
           table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cwres<span class="op">=</span><span class="cn">TRUE</span>, npde<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; calculating covariance matrix</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; done</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">one.ka.0.5</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          OBJF      AIC      BIC Log-likelihood Condition Number</span>
<span class="co">#&gt; FOCEi 116.814 371.4137 388.7106      -179.7069         13.60513</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            setup optimize covariance table compress    other</span>
<span class="co">#&gt; elapsed 0.002772 0.338989   0.338991 1.359    0.011 0.304248</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        <span style="font-weight: bold;">Parameter</span>  <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span>  <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>       Log Ka 0.474  <span style="color: #00BB00; font-weight: bold;">FIXED</span> <span style="color: #00BB00; font-weight: bold;">FIXED</span>                    1.61     68.9</span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>       Log Cl  1.01  0.101  9.93       2.75 (2.26, 3.35)     26.8</span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>         log V  3.46 0.0457  1.32       31.8 (29.1, 34.8)     13.9</span>
<span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>           0.696                                0.696         </span>
<span class="co">#&gt;        <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>        0.386% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>         3.87% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>          10.3% </span>
<span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>            </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r,s</span></span>
<span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span>
<span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span>
<span class="co">#&gt;     false convergence (8) </span>
<span class="co">#&gt;   In an ODE system, false convergence may mean "useless" evaluations were performed.</span>
<span class="co">#&gt;   See https://tinyurl.com/yyrrwkce</span>
<span class="co">#&gt;   It could also mean the convergence is poor, check results before accepting fit</span>
<span class="co">#&gt;   You may also try a good derivative free optimization:</span>
<span class="co">#&gt;     nlmixr2(...,control=list(outerOpt="bobyqa"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 26</span></span>
<span class="co">#&gt;   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74 0.096<span style="text-decoration: underline;">7</span>  0.643  1.24   1.24   0     0.74   1.06   0     0.74 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84 3.83   -<span style="color: #BB0000;">0.986</span> -<span style="color: #BB0000;">0.486</span> -<span style="color: #BB0000;">0.486</span>  3.29 -<span style="color: #BB0000;">0.449</span> -<span style="color: #BB0000;">0.242</span>  3.85 -<span style="color: #BB0000;">1.01</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57 6.15    0.422 -<span style="color: #BB0000;">1.71</span>  -<span style="color: #BB0000;">1.71</span>   5.87  0.705  0.287  6.79 -<span style="color: #BB0000;">0.216</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 129 more rows, and 14 more variables: IWRES &lt;dbl&gt;, CPRED &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.ka &lt;dbl&gt;, eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   depot &lt;dbl&gt;, center &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, tad &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   dosenum &lt;dbl&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Example 4 -- Change tka to 0.7 in orginal model function and then estimate</span>
<span class="va">one.ka.0.7</span> <span class="op">&lt;-</span> <span class="va">one.compartment</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span>tka<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/nlmixr2est/man/nlmixr2.html" class="external-link">nlmixr</a></span><span class="op">(</span><span class="va">theo_sd</span>, est<span class="op">=</span><span class="st">"focei"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,
           table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cwres<span class="op">=</span><span class="cn">TRUE</span>, npde<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; calculating covariance matrix</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; done</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">one.ka.0.7</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           OBJF      AIC      BIC Log-likelihood Condition Number</span>
<span class="co">#&gt; FOCEi 116.8133 373.4131 393.5927      -179.7065          49.0338</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            setup optimize covariance table compress    other</span>
<span class="co">#&gt; elapsed 0.002256 0.640932   0.640933 1.575    0.013 2.016879</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        <span style="font-weight: bold;">Parameter</span>  <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span> <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>       Log Ka 0.471  0.202 42.8        1.6 (1.08, 2.38)     69.5     0.996% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>       Log Cl  1.01 0.0757 7.49       2.75 (2.37, 3.19)     26.4      3.12% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>         log V  3.46 0.0543 1.57       31.9 (28.6, 35.4)     13.8      9.93% </span>
<span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>           0.697                               0.697                     </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r,s</span></span>
<span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span>
<span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span>
<span class="co">#&gt;     false convergence (8) </span>
<span class="co">#&gt;   In an ODE system, false convergence may mean "useless" evaluations were performed.</span>
<span class="co">#&gt;   See https://tinyurl.com/yyrrwkce</span>
<span class="co">#&gt;   It could also mean the convergence is poor, check results before accepting fit</span>
<span class="co">#&gt;   You may also try a good derivative free optimization:</span>
<span class="co">#&gt;     nlmixr2(...,control=list(outerOpt="bobyqa"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 26</span></span>
<span class="co">#&gt;   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74 0.096<span style="text-decoration: underline;">8</span>  0.643  1.24   1.24   0     0.74   1.06   0     0.74 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84 3.82   -<span style="color: #BB0000;">0.979</span> -<span style="color: #BB0000;">0.468</span> -<span style="color: #BB0000;">0.468</span>  3.28 -<span style="color: #BB0000;">0.438</span> -<span style="color: #BB0000;">0.235</span>  3.85 -<span style="color: #BB0000;">1.01</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57 6.13    0.437 -<span style="color: #BB0000;">1.75</span>  -<span style="color: #BB0000;">1.75</span>   5.85  0.722  0.293  6.79 -<span style="color: #BB0000;">0.215</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 129 more rows, and 14 more variables: IWRES &lt;dbl&gt;, CPRED &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.ka &lt;dbl&gt;, eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   depot &lt;dbl&gt;, center &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, tad &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   dosenum &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="changing-model-features">Changing model features<a class="anchor" aria-label="anchor" href="#changing-model-features"></a>
</h2>
<p>When developing models, often you add and remove between subject variability to parameters, add covariates to the effects, and/or change the residual errors. You can change lines in the model by piping the fit or the nlmixr model specification function to a <code>model</code></p>
<div class="section level3">
<h3 id="adding-or-removing-between-subject-variability">Adding or Removing between subject variability<a class="anchor" aria-label="anchor" href="#adding-or-removing-between-subject-variability"></a>
</h3>
<p>Often in developing a model you add and remove between subject variability to certain model parameters. For example, you could remove the between subject variability in the ka parameter by changing that line in the model;</p>
<p>For example to remove a eta from a prior fit or prior model specification function, simply pipe it to the model function. You can then re-estimate by piping it to the <code>nlmixr</code> function again.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Remove eta.ka on ka</span>
<span class="va">noEta</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/nlmixr2est/man/nlmixr2.html" class="external-link">nlmixr</a></span><span class="op">(</span>est<span class="op">=</span><span class="st">"focei"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,
           table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cwres<span class="op">=</span><span class="cn">TRUE</span>, npde<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; calculating covariance matrix</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; done</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">noEta</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           OBJF     AIC      BIC Log-likelihood Condition Number</span>
<span class="co">#&gt; FOCEi 176.5812 431.181 448.4778      -209.5905         34.87439</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           setup optimize covariance table compress    other</span>
<span class="co">#&gt; elapsed 0.00274 0.413464   0.413467 2.353    0.025 4.601329</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        <span style="font-weight: bold;">Parameter</span>  <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span> <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>       Log Ka 0.431   0.17 39.5        1.54 (1.1, 2.15)                     </span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>       Log Cl 0.991 0.0745 7.51        2.7 (2.33, 3.12)     30.3      7.76% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>         log V  3.48 0.0485 1.39       32.4 (29.5, 35.7)     15.6      7.93% </span>
<span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>            1.02                                1.02                     </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r,s</span></span>
<span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span>
<span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span>
<span class="co">#&gt;     false convergence (8) </span>
<span class="co">#&gt;   In an ODE system, false convergence may mean "useless" evaluations were performed.</span>
<span class="co">#&gt;   See https://tinyurl.com/yyrrwkce</span>
<span class="co">#&gt;   It could also mean the convergence is poor, check results before accepting fit</span>
<span class="co">#&gt;   You may also try a good derivative free optimization:</span>
<span class="co">#&gt;     nlmixr2(...,control=list(outerOpt="bobyqa"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 25</span></span>
<span class="co">#&gt;   ID     TIME    DV EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74 0.142  0.598  0.915  0.915  0     0.74   0.726  0     0.74 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84 3.24  -<span style="color: #BB0000;">0.397</span> -<span style="color: #BB0000;">0.593</span> -<span style="color: #BB0000;">0.593</span>  3.12 -<span style="color: #BB0000;">0.277</span> -<span style="color: #BB0000;">0.246</span>  3.57 -<span style="color: #BB0000;">0.730</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57 5.70   0.872 -<span style="color: #BB0000;">0.449</span> -<span style="color: #BB0000;">0.449</span>  5.61  0.959  0.723  6.45  0.121</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 129 more rows, and 13 more variables: IWRES &lt;dbl&gt;, CPRED &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;, depot &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   center &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, tad &lt;dbl&gt;, dosenum &lt;dbl&gt;</span></span></code></pre></div>
<p>Of course you could also add an eta on a parameter in the same way;</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">addBackKa</span> <span class="op">&lt;-</span> <span class="va">noEta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="op">{</span><span class="va">ka</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tka</span> <span class="op">+</span> <span class="va">bsv.ka</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span>bsv.ka<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/nlmixr2est/man/nlmixr2.html" class="external-link">nlmixr</a></span><span class="op">(</span>est<span class="op">=</span><span class="st">"focei"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,
           table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cwres<span class="op">=</span><span class="cn">TRUE</span>, npde<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; calculating covariance matrix</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; done</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">addBackKa</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           OBJF      AIC     BIC Log-likelihood Condition Number</span>
<span class="co">#&gt; FOCEi 116.8217 373.4214 393.601      -179.7107         159.1738</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            setup optimize covariance table compress    other</span>
<span class="co">#&gt; elapsed 0.002632 0.589486   0.589488 1.976    0.014 5.769394</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        <span style="font-weight: bold;">Parameter</span>  <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span> <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span> <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>       Log Ka 0.484  0.196 40.4       1.62 (1.11, 2.38)     69.6     0.891% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>       Log Cl  1.01   0.62 61.1       2.76 (0.819, 9.3)     26.8      4.10% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>         log V  3.46 0.0872 2.52       31.8 (26.8, 37.7)     14.1      10.9% </span>
<span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>           0.694                               0.694                     </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r,s</span></span>
<span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span>
<span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span>
<span class="co">#&gt;     false convergence (8) </span>
<span class="co">#&gt;   In an ODE system, false convergence may mean "useless" evaluations were performed.</span>
<span class="co">#&gt;   See https://tinyurl.com/yyrrwkce</span>
<span class="co">#&gt;   It could also mean the convergence is poor, check results before accepting fit</span>
<span class="co">#&gt;   You may also try a good derivative free optimization:</span>
<span class="co">#&gt;     nlmixr2(...,control=list(outerOpt="bobyqa"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 26</span></span>
<span class="co">#&gt;   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74 0.096<span style="text-decoration: underline;">4</span>  0.644  1.50   1.50   0     0.74   1.07   0     0.74 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84 3.67   -<span style="color: #BB0000;">0.826</span> -<span style="color: #BB0000;">0.706</span> -<span style="color: #BB0000;">0.706</span>  3.32 -<span style="color: #BB0000;">0.480</span> -<span style="color: #BB0000;">0.255</span>  3.85 -<span style="color: #BB0000;">1.01</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57 5.95    0.621 -<span style="color: #BB0000;">1.88</span>  -<span style="color: #BB0000;">1.88</span>   5.91  0.663  0.267  6.79 -<span style="color: #BB0000;">0.217</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 129 more rows, and 14 more variables: IWRES &lt;dbl&gt;, CPRED &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;, bsv.ka &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   depot &lt;dbl&gt;, center &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, tad &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   dosenum &lt;dbl&gt;</span></span></code></pre></div>
<p>You can see the name change by examining the <code>omega</code> matrix:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">addBackKa</span><span class="op">$</span><span class="va">omega</span>
<span class="co">#&gt;            eta.cl      eta.v    bsv.ka</span>
<span class="co">#&gt; eta.cl 0.06918013 0.00000000 0.0000000</span>
<span class="co">#&gt; eta.v  0.00000000 0.01968171 0.0000000</span>
<span class="co">#&gt; bsv.ka 0.00000000 0.00000000 0.3946166</span></code></pre></div>
<p>Note that new between subject variability parameters are distinguished from other types of parameters (ie population parameters, and individual covariates) by their name. Parameters starting or ending with the following names are assumed to be between subject variability parameters:</p>
<ul>
<li>eta (from NONMEM convention)</li>
<li>ppv (per patient variability)</li>
<li>psv (per subject variability)</li>
<li>iiv (inter-individual variability)</li>
<li>bsv (between subject variability)</li>
<li>bpv (between patient variability)</li>
</ul>
</div>
<div class="section level3">
<h3 id="adding-covariate-effects">Adding Covariate effects<a class="anchor" aria-label="anchor" href="#adding-covariate-effects"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Note currently cov is needed as a prefix so nlmixr knows this is an</span>
<span class="co">## estimated parameter not a parameter</span>
<span class="va">wt70</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="op">{</span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">tcl</span> <span class="op">+</span> <span class="va">eta.cl</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">WT</span><span class="op">/</span><span class="fl">70</span><span class="op">)</span><span class="op">^</span><span class="va">covWtPow</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span>covWtPow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/fix.html" class="external-link">fix</a></span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span>tka<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/fix.html" class="external-link">fix</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/nlmixr2est/man/nlmixr2.html" class="external-link">nlmixr</a></span><span class="op">(</span>est<span class="op">=</span><span class="st">"focei"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,
         table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cwres<span class="op">=</span><span class="cn">TRUE</span>, npde<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; calculating covariance matrix</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; done</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">wt70</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           OBJF      AIC      BIC Log-likelihood Condition Number</span>
<span class="co">#&gt; FOCEi 116.2107 370.8105 388.1073      -179.4053         10.72451</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            setup optimize covariance table compress    other</span>
<span class="co">#&gt; elapsed 0.006341 0.371239   0.371241 2.178    0.012 5.115179</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          <span style="font-weight: bold;">Parameter</span>  <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span>  <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>         Log Ka   0.5  <span style="color: #00BB00; font-weight: bold;">FIXED</span> <span style="color: #00BB00; font-weight: bold;">FIXED</span>                    1.65     68.9</span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>         Log Cl  1.01 0.0761   7.5        2.76 (2.38, 3.2)     26.7</span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>           log V  3.46 0.0293 0.846         31.7 (30, 33.6)     13.8</span>
<span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>             0.696                                0.696         </span>
<span class="co">#&gt; <span style="font-weight: bold;">covWtPow</span>            0.75  <span style="color: #00BB00; font-weight: bold;">FIXED</span> <span style="color: #00BB00; font-weight: bold;">FIXED</span>                    0.75         </span>
<span class="co">#&gt;          <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>          0.822% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>           6.36% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>            12.1% </span>
<span class="co">#&gt; <span style="font-weight: bold;">add.sd</span>              </span>
<span class="co">#&gt; <span style="font-weight: bold;">covWtPow</span>            </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r,s</span></span>
<span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span>
<span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span>
<span class="co">#&gt;     false convergence (8) </span>
<span class="co">#&gt;   In an ODE system, false convergence may mean "useless" evaluations were performed.</span>
<span class="co">#&gt;   See https://tinyurl.com/yyrrwkce</span>
<span class="co">#&gt;   It could also mean the convergence is poor, check results before accepting fit</span>
<span class="co">#&gt;   You may also try a good derivative free optimization:</span>
<span class="co">#&gt;     nlmixr2(...,control=list(outerOpt="bobyqa"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 27</span></span>
<span class="co">#&gt;   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74 0.096<span style="text-decoration: underline;">7</span>  0.643  1.23   1.23   0     0.74   1.06   0     0.74 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84 3.90   -<span style="color: #BB0000;">1.06</span>  -<span style="color: #BB0000;">0.468</span> -<span style="color: #BB0000;">0.468</span>  3.36 -<span style="color: #BB0000;">0.522</span> -<span style="color: #BB0000;">0.277</span>  3.84 -<span style="color: #BB0000;">1.00</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57 6.22    0.351 -<span style="color: #BB0000;">1.64</span>  -<span style="color: #BB0000;">1.64</span>   5.95  0.617  0.251  6.79 -<span style="color: #BB0000;">0.216</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 129 more rows, and 15 more variables: IWRES &lt;dbl&gt;, CPRED &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.ka &lt;dbl&gt;, eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   depot &lt;dbl&gt;, center &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, tad &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   dosenum &lt;dbl&gt;, WT &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="changing-residual-errors">Changing residual errors<a class="anchor" aria-label="anchor" href="#changing-residual-errors"></a>
</h3>
<p>Changing the residual errors is also just as easy, by simply specifying the error you wish to change:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Since there are 0 predictions in the data, these are changed to</span>
<span class="co">## 0.0150 to show proportional error change.</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="va">theo_sd</span>
<span class="va">d</span><span class="op">$</span><span class="va">DV</span><span class="op">[</span><span class="va">d</span><span class="op">$</span><span class="va">EVID</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">d</span><span class="op">$</span><span class="va">DV</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.0150</span>

<span class="va">addPropModel</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="op">{</span><span class="va">cp</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">add.err</span><span class="op">)</span><span class="op">+</span><span class="fu">prop</span><span class="op">(</span><span class="va">prop.err</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/ini.html" class="external-link">ini</a></span><span class="op">(</span>prop.err<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/nlmixr2est/man/nlmixr2.html" class="external-link">nlmixr</a></span><span class="op">(</span><span class="va">d</span>,est<span class="op">=</span><span class="st">"focei"</span>,
           control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,
           table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cwres<span class="op">=</span><span class="cn">TRUE</span>, npde<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; calculating covariance matrix</span>
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00 </span>
<span class="co">#&gt; done</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">addPropModel</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">── </span><span style="color: #0000BB; font-weight: bold;">nlmix</span><span style="color: #BB0000; font-weight: bold;">r</span><span style="font-weight: bold;"> </span><span style="color: #BBBB00; font-weight: bold;">FOCE</span><span style="color: #BB0000; font-weight: bold;">i</span> (outer: nlminb) ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           OBJF      AIC      BIC Log-likelihood Condition Number</span>
<span class="co">#&gt; FOCEi 104.3506 362.9504 386.0128      -173.4752         58.88045</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Time (sec </span><span style="color: #0000BB; font-weight: bold;">$time</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            setup optimize covariance table compress    other</span>
<span class="co">#&gt; elapsed 0.003293 0.611215   0.611216 2.121    0.025 6.340276</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Population Parameters (</span><span style="color: #0000BB; font-weight: bold;">$parFixed</span><span style="font-weight: bold;"> or </span><span style="color: #0000BB; font-weight: bold;">$parFixedDf</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          <span style="font-weight: bold;">Parameter</span>  <span style="font-weight: bold;">Est.</span>     <span style="font-weight: bold;">SE</span> <span style="font-weight: bold;">%RSE</span> <span style="font-weight: bold;">Back-transformed(95%CI)</span> <span style="font-weight: bold;">BSV(CV%)</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>         Log Ka 0.391  0.196 50.2       1.48 (1.01, 2.17)     69.0</span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>         Log Cl  1.02  0.074 7.23       2.79 (2.41, 3.22)     25.8</span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>           log V  3.47 0.0464 1.34         32 (29.2, 35.1)     12.6</span>
<span class="co">#&gt; <span style="font-weight: bold;">add.err</span>            0.273                               0.273         </span>
<span class="co">#&gt; <span style="font-weight: bold;">prop.err</span>           0.134                               0.134         </span>
<span class="co">#&gt;          <span style="font-weight: bold;">Shrink(SD)%</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">tka</span>           2.00% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tcl</span>           1.18% </span>
<span class="co">#&gt; <span style="font-weight: bold;">tv</span>            15.6% </span>
<span class="co">#&gt; <span style="font-weight: bold;">add.err</span>             </span>
<span class="co">#&gt; <span style="font-weight: bold;">prop.err</span>            </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;   Covariance Type (<span style="color: #0000BB; font-weight: bold;">$covMethod</span>): <span style="font-weight: bold;">r,s</span></span>
<span class="co">#&gt;   No correlations in between subject variability (BSV) matrix</span>
<span class="co">#&gt;   Full BSV covariance (<span style="color: #0000BB; font-weight: bold;">$omega</span>) or correlation (<span style="color: #0000BB; font-weight: bold;">$omegaR</span>; diagonals=SDs) </span>
<span class="co">#&gt;   Distribution stats (mean/skewness/kurtosis/p-value) available in <span style="color: #0000BB; font-weight: bold;">$shrink</span> </span>
<span class="co">#&gt;   Minimization message (<span style="color: #0000BB; font-weight: bold;">$message</span>):  </span>
<span class="co">#&gt;     false convergence (8) </span>
<span class="co">#&gt;   In an ODE system, false convergence may mean "useless" evaluations were performed.</span>
<span class="co">#&gt;   See https://tinyurl.com/yyrrwkce</span>
<span class="co">#&gt;   It could also mean the convergence is poor, check results before accepting fit</span>
<span class="co">#&gt;   You may also try a good derivative free optimization:</span>
<span class="co">#&gt;     nlmixr2(...,control=list(outerOpt="bobyqa"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="font-weight: bold;">── Fit Data (object is a modified </span><span style="color: #0000BB; font-weight: bold;">tibble</span><span style="font-weight: bold;">): ──</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 26</span></span>
<span class="co">#&gt;   ID     TIME    DV  EPRED   ERES   NPDE    NPD  PRED    RES   WRES IPRED   IRES</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1      0     0.74 0.038<span style="text-decoration: underline;">0</span>  0.702  2.13   2.13   0     0.74   2.71   0     0.74 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      0.25  2.84 3.59   -<span style="color: #BB0000;">0.748</span> -<span style="color: #BB0000;">0.915</span> -<span style="color: #BB0000;">0.915</span>  3.05 -<span style="color: #BB0000;">0.212</span> -<span style="color: #BB0000;">0.126</span>  3.46 -<span style="color: #BB0000;">0.624</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1      0.57  6.57 5.86    0.712 -<span style="color: #BB0000;">0.830</span> -<span style="color: #BB0000;">0.830</span>  5.53  1.04   0.428  6.23  0.338</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 129 more rows, and 14 more variables: IWRES &lt;dbl&gt;, CPRED &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   CRES &lt;dbl&gt;, CWRES &lt;dbl&gt;, eta.ka &lt;dbl&gt;, eta.cl &lt;dbl&gt;, eta.v &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   depot &lt;dbl&gt;, center &lt;dbl&gt;, ka &lt;dbl&gt;, cl &lt;dbl&gt;, v &lt;dbl&gt;, tad &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   dosenum &lt;dbl&gt;</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew Fidler, Wenping Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
