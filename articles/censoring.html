<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Censoring in nlmixr • nlmixr2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Censoring in nlmixr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nlmixr2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/running_nlmixr.html">Introduction to Running Nlmixr</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-endpoints.html">Using Multiple Endpoints in Nlmixr</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Going further</h6></li>
    <li><a class="dropdown-item" href="../articles/modelPiping.html">Model Piping</a></li>
    <li><a class="dropdown-item" href="../articles/broom.html">Sweeping models to tidy datasets (broom)</a></li>
    <li><a class="dropdown-item" href="../articles/censoring.html">Censoring in nlmixr2 (M3 and others)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/xgxr-nlmixr-ggpmx.html">Integrated development with xgxr/nlmixr/ggPMX</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/citations.html">Citations of nlmixr2</a></li>
    <li><a class="dropdown-item" href="../articles/nlmixr2-team-and-advisory-committee.html">Who we are</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-example-models" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-chalkboard-teacher"></span> Example models</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-example-models">
<li><a class="dropdown-item" href="../articles/addingCovariances.html">Phenobarbatol with correlations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/nimo.html">Nonlinear PK/PD -- Nimotuzumab</a></li>
    <li><a class="dropdown-item" href="../articles/mavoglurant.html">PBPK -- Mavoglurant</a></li>
    <li><a class="dropdown-item" href="../articles/wbc.html">PKPD -- Myelosuppression model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2/raw/main/CheatSheet_nlmixr_220621.pdf"><span class="fa fa-scroll fa-lg"></span> Cheat Sheet</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://doi.org/10.1002/psp4.12445"><span class="fa fas fa-life-ring"></span> Tutorial</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o fa-lg"></span> Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2/releases"><span class="fa fa-download"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Censoring in nlmixr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nlmixr2/blob/v4.0.0/vignettes/censoring.Rmd" class="external-link"><code>vignettes/censoring.Rmd</code></a></small>
      <div class="d-none name"><code>censoring.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.org/" class="external-link">nlmixr2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">#&gt;   method from   </span></span>
<span><span class="co">#&gt;   +.gg   ggplot2</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching packages</span> ───────────────────────────────────────── nlmixr2 4.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lotri        </span> 1.0.0.<span style="color: #BB0000;">9000</span>     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">nlmixr2plot  </span> 3.0.2     </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">nlmixr2data  </span> 2.0.9          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">rxode2       </span> 4.0.1     </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">nlmixr2est   </span> 4.0.0          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggPMX        </span> 1.3.0     </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">nlmixr2extra </span> 3.0.3          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">xpose.nlmixr2</span> 0.4.1</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Optional Packages Loaded/Ignored</span> ─────────────────────────── nlmixr2 4.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggPMX        </span>     <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">nlmixr2lib</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">xpose.nlmixr2</span>     <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">nlmixr2rpt</span></span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">babelmixr2</span>     <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">nonmem2rx</span></span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">monolix2rx</span>     <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">shinyMixR</span></span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ───────────────────────────────────────────── nlmixr2conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">rxode2</span>::<span style="color: #00BB00;">boxCox()</span>     masks <span style="color: #0000BB;">nlmixr2est</span>::boxCox()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">rxode2</span>::<span style="color: #00BB00;">yeoJohnson()</span> masks <span style="color: #0000BB;">nlmixr2est</span>::yeoJohnson()</span></span></code></pre></div>
<div class="section level2">
<h2 id="censoring-support-in-nlmixr">Censoring support in nlmixr<a class="anchor" aria-label="anchor" href="#censoring-support-in-nlmixr"></a>
</h2>
<p>In general, censoring is when there is an observation that cannot be
measured but the researcher knows something about if it is below or
above a certain number. In 2001, Beal introduced censoring to the
pharmacometric community and described common ways to deal with missing
data. The methods below, and the data structure used in nlmixr to
support them are below:</p>
<table class="table">
<colgroup>
<col width="6%">
<col width="93%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>M1</td>
<td>Ignore the censored data entirely. This can be done by removing the
censored observations from the dataset.</td>
</tr>
<tr class="even">
<td>M2</td>
<td>With this method a single limit is specified and observations below
that limit are considered censored. This is not directly supported in
nlmixr, but can be accomplished by using the M3 method.</td>
</tr>
<tr class="odd">
<td>M3</td>
<td>
<p>Estimate Likelihood where observation is above or below some
censored limit.</p>
<p>When the concentrations are below the limit of quantitation (or left
censored), you can specify this in nlmixr with two columns: DV, CENS.
When a value is censored, DV is the limit of quantification, and CENS is
1. For the rest of the non-censored values, DV keeps its normal value
and CENS is 0.</p>
<p>When the censored value are above a limit of quantitation (or right
censored), the DV remains the limit of quantification and CENS is
-1.</p>
</td>
</tr>
<tr class="even">
<td>M4</td>
<td>
<p>This is an expansion of the M3 method. In cases, like in PK, you
can also assume that the observations are actually positive. Therefore,
you may want to adjust the likelihood to take into consideration this
fact.</p>
<p>This can be accomplished in nlmixr as well by adding a LIMIT column.
In the case of the left censored problem, you can specify the
concentration is between the LIMIT and DV. This works for both the right
and left censored values.</p>
</td>
</tr>
<tr class="odd">
<td>M5</td>
<td>Replace all censored values with Lower Limit of Quantitation divided
by 2. (ie LLOQ/2)</td>
</tr>
<tr class="even">
<td>M6</td>
<td>Replace first censored value of the patient with LLOQ/2 and ignore
the other censored values</td>
</tr>
<tr class="odd">
<td>M7</td>
<td>Replace all LLOQ values with 0</td>
</tr>
</tbody>
</table>
<p>These data columns <code>LIMIT</code> and <code>CENS</code>, are
based on the Monolix method of handling of censored data.</p>
</div>
<div class="section level2">
<h2 id="data-output-for-censored-data-in-nlmixr">Data output for censored data in nlmixr<a class="anchor" aria-label="anchor" href="#data-output-for-censored-data-in-nlmixr"></a>
</h2>
<p>For censored data output, it is often useful to see how the
predictions perform in the censored area. To accomplish this, a
simulated value is used to show the prediction and noise. This is then
used to calculate the standard residual values in nlmixr. By default,
this value is simulated from a truncated normal distribution under the
model assumptions and the censoring information specified in the data
(though you can use the CDF method used in the npde package instead if
you are calculating npdes as well). This simulated value replaces the
original DV and then used to calculate all the residuals requested. The
original limit information will be output in <code>lowerLim</code> and
<code>upperLim</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Fidler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
